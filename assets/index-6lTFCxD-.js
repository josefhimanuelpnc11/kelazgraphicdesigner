var _E=i=>{throw TypeError(i)};var Sg=(i,t,e)=>t.has(i)||_E("Cannot "+e);var we=(i,t,e)=>(Sg(i,t,"read from private field"),e?e.call(i):t.get(i)),di=(i,t,e)=>t.has(i)?_E("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),Wn=(i,t,e,n)=>(Sg(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),fi=(i,t,e)=>(Sg(i,t,"access private method"),e);var bE=(i,t,e,n)=>({set _(s){Wn(i,t,s,e)},get _(){return we(i,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();function VC(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Tg={exports:{}},lu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AE;function UC(){if(AE)return lu;AE=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var u in s)u!=="key"&&(o[u]=s[u])}else o=s;return s=o.ref,{$$typeof:i,type:n,key:l,ref:s!==void 0?s:null,props:o}}return lu.Fragment=t,lu.jsx=e,lu.jsxs=e,lu}var EE;function FC(){return EE||(EE=1,Tg.exports=UC()),Tg.exports}var y=FC(),xg={exports:{}},Ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wE;function BC(){if(wE)return Ft;wE=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.iterator;function b(q){return q===null||typeof q!="object"?null:(q=v&&q[v]||q["@@iterator"],typeof q=="function"?q:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function N(q,st,ct){this.props=q,this.context=st,this.refs=S,this.updater=ct||A}N.prototype.isReactComponent={},N.prototype.setState=function(q,st){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,st,"setState")},N.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function R(){}R.prototype=N.prototype;function V(q,st,ct){this.props=q,this.context=st,this.refs=S,this.updater=ct||A}var M=V.prototype=new R;M.constructor=V,w(M,N.prototype),M.isPureReactComponent=!0;var B=Array.isArray,L={H:null,A:null,T:null,S:null,V:null},F=Object.prototype.hasOwnProperty;function C(q,st,ct,K,ht,Nt){return ct=Nt.ref,{$$typeof:i,type:q,key:st,ref:ct!==void 0?ct:null,props:Nt}}function I(q,st){return C(q.type,st,void 0,void 0,void 0,q.props)}function k(q){return typeof q=="object"&&q!==null&&q.$$typeof===i}function O(q){var st={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ct){return st[ct]})}var U=/\/+/g;function H(q,st){return typeof q=="object"&&q!==null&&q.key!=null?O(""+q.key):st.toString(36)}function j(){}function _t(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(j,j):(q.status="pending",q.then(function(st){q.status==="pending"&&(q.status="fulfilled",q.value=st)},function(st){q.status==="pending"&&(q.status="rejected",q.reason=st)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function Pt(q,st,ct,K,ht){var Nt=typeof q;(Nt==="undefined"||Nt==="boolean")&&(q=null);var bt=!1;if(q===null)bt=!0;else switch(Nt){case"bigint":case"string":case"number":bt=!0;break;case"object":switch(q.$$typeof){case i:case t:bt=!0;break;case m:return bt=q._init,Pt(bt(q._payload),st,ct,K,ht)}}if(bt)return ht=ht(q),bt=K===""?"."+H(q,0):K,B(ht)?(ct="",bt!=null&&(ct=bt.replace(U,"$&/")+"/"),Pt(ht,st,ct,"",function(Hn){return Hn})):ht!=null&&(k(ht)&&(ht=I(ht,ct+(ht.key==null||q&&q.key===ht.key?"":(""+ht.key).replace(U,"$&/")+"/")+bt)),st.push(ht)),1;bt=0;var Ut=K===""?".":K+":";if(B(q))for(var Qt=0;Qt<q.length;Qt++)K=q[Qt],Nt=Ut+H(K,Qt),bt+=Pt(K,st,ct,Nt,ht);else if(Qt=b(q),typeof Qt=="function")for(q=Qt.call(q),Qt=0;!(K=q.next()).done;)K=K.value,Nt=Ut+H(K,Qt++),bt+=Pt(K,st,ct,Nt,ht);else if(Nt==="object"){if(typeof q.then=="function")return Pt(_t(q),st,ct,K,ht);throw st=String(q),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.")}return bt}function W(q,st,ct){if(q==null)return q;var K=[],ht=0;return Pt(q,K,"","",function(Nt){return st.call(ct,Nt,ht++)}),K}function X(q){if(q._status===-1){var st=q._result;st=st(),st.then(function(ct){(q._status===0||q._status===-1)&&(q._status=1,q._result=ct)},function(ct){(q._status===0||q._status===-1)&&(q._status=2,q._result=ct)}),q._status===-1&&(q._status=0,q._result=st)}if(q._status===1)return q._result.default;throw q._result}var ut=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var st=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(st))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function xt(){}return Ft.Children={map:W,forEach:function(q,st,ct){W(q,function(){st.apply(this,arguments)},ct)},count:function(q){var st=0;return W(q,function(){st++}),st},toArray:function(q){return W(q,function(st){return st})||[]},only:function(q){if(!k(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Ft.Component=N,Ft.Fragment=e,Ft.Profiler=s,Ft.PureComponent=V,Ft.StrictMode=n,Ft.Suspense=h,Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Ft.__COMPILER_RUNTIME={__proto__:null,c:function(q){return L.H.useMemoCache(q)}},Ft.cache=function(q){return function(){return q.apply(null,arguments)}},Ft.cloneElement=function(q,st,ct){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var K=w({},q.props),ht=q.key,Nt=void 0;if(st!=null)for(bt in st.ref!==void 0&&(Nt=void 0),st.key!==void 0&&(ht=""+st.key),st)!F.call(st,bt)||bt==="key"||bt==="__self"||bt==="__source"||bt==="ref"&&st.ref===void 0||(K[bt]=st[bt]);var bt=arguments.length-2;if(bt===1)K.children=ct;else if(1<bt){for(var Ut=Array(bt),Qt=0;Qt<bt;Qt++)Ut[Qt]=arguments[Qt+2];K.children=Ut}return C(q.type,ht,void 0,void 0,Nt,K)},Ft.createContext=function(q){return q={$$typeof:l,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:o,_context:q},q},Ft.createElement=function(q,st,ct){var K,ht={},Nt=null;if(st!=null)for(K in st.key!==void 0&&(Nt=""+st.key),st)F.call(st,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(ht[K]=st[K]);var bt=arguments.length-2;if(bt===1)ht.children=ct;else if(1<bt){for(var Ut=Array(bt),Qt=0;Qt<bt;Qt++)Ut[Qt]=arguments[Qt+2];ht.children=Ut}if(q&&q.defaultProps)for(K in bt=q.defaultProps,bt)ht[K]===void 0&&(ht[K]=bt[K]);return C(q,Nt,void 0,void 0,null,ht)},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(q){return{$$typeof:u,render:q}},Ft.isValidElement=k,Ft.lazy=function(q){return{$$typeof:m,_payload:{_status:-1,_result:q},_init:X}},Ft.memo=function(q,st){return{$$typeof:f,type:q,compare:st===void 0?null:st}},Ft.startTransition=function(q){var st=L.T,ct={};L.T=ct;try{var K=q(),ht=L.S;ht!==null&&ht(ct,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(xt,ut)}catch(Nt){ut(Nt)}finally{L.T=st}},Ft.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Ft.use=function(q){return L.H.use(q)},Ft.useActionState=function(q,st,ct){return L.H.useActionState(q,st,ct)},Ft.useCallback=function(q,st){return L.H.useCallback(q,st)},Ft.useContext=function(q){return L.H.useContext(q)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(q,st){return L.H.useDeferredValue(q,st)},Ft.useEffect=function(q,st,ct){var K=L.H;if(typeof ct=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return K.useEffect(q,st)},Ft.useId=function(){return L.H.useId()},Ft.useImperativeHandle=function(q,st,ct){return L.H.useImperativeHandle(q,st,ct)},Ft.useInsertionEffect=function(q,st){return L.H.useInsertionEffect(q,st)},Ft.useLayoutEffect=function(q,st){return L.H.useLayoutEffect(q,st)},Ft.useMemo=function(q,st){return L.H.useMemo(q,st)},Ft.useOptimistic=function(q,st){return L.H.useOptimistic(q,st)},Ft.useReducer=function(q,st,ct){return L.H.useReducer(q,st,ct)},Ft.useRef=function(q){return L.H.useRef(q)},Ft.useState=function(q){return L.H.useState(q)},Ft.useSyncExternalStore=function(q,st,ct){return L.H.useSyncExternalStore(q,st,ct)},Ft.useTransition=function(){return L.H.useTransition()},Ft.version="19.1.1",Ft}var SE;function Hy(){return SE||(SE=1,xg.exports=BC()),xg.exports}var z=Hy();const zC=VC(z);var Cg={exports:{}},cu={},Rg={exports:{}},Ig={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TE;function HC(){return TE||(TE=1,(function(i){function t(W,X){var ut=W.length;W.push(X);t:for(;0<ut;){var xt=ut-1>>>1,q=W[xt];if(0<s(q,X))W[xt]=X,W[ut]=q,ut=xt;else break t}}function e(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var X=W[0],ut=W.pop();if(ut!==X){W[0]=ut;t:for(var xt=0,q=W.length,st=q>>>1;xt<st;){var ct=2*(xt+1)-1,K=W[ct],ht=ct+1,Nt=W[ht];if(0>s(K,ut))ht<q&&0>s(Nt,K)?(W[xt]=Nt,W[ht]=ut,xt=ht):(W[xt]=K,W[ct]=ut,xt=ct);else if(ht<q&&0>s(Nt,ut))W[xt]=Nt,W[ht]=ut,xt=ht;else break t}}return X}function s(W,X){var ut=W.sortIndex-X.sortIndex;return ut!==0?ut:W.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var h=[],f=[],m=1,v=null,b=3,A=!1,w=!1,S=!1,N=!1,R=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function B(W){for(var X=e(f);X!==null;){if(X.callback===null)n(f);else if(X.startTime<=W)n(f),X.sortIndex=X.expirationTime,t(h,X);else break;X=e(f)}}function L(W){if(S=!1,B(W),!w)if(e(h)!==null)w=!0,F||(F=!0,H());else{var X=e(f);X!==null&&Pt(L,X.startTime-W)}}var F=!1,C=-1,I=5,k=-1;function O(){return N?!0:!(i.unstable_now()-k<I)}function U(){if(N=!1,F){var W=i.unstable_now();k=W;var X=!0;try{t:{w=!1,S&&(S=!1,V(C),C=-1),A=!0;var ut=b;try{e:{for(B(W),v=e(h);v!==null&&!(v.expirationTime>W&&O());){var xt=v.callback;if(typeof xt=="function"){v.callback=null,b=v.priorityLevel;var q=xt(v.expirationTime<=W);if(W=i.unstable_now(),typeof q=="function"){v.callback=q,B(W),X=!0;break e}v===e(h)&&n(h),B(W)}else n(h);v=e(h)}if(v!==null)X=!0;else{var st=e(f);st!==null&&Pt(L,st.startTime-W),X=!1}}break t}finally{v=null,b=ut,A=!1}X=void 0}}finally{X?H():F=!1}}}var H;if(typeof M=="function")H=function(){M(U)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,_t=j.port2;j.port1.onmessage=U,H=function(){_t.postMessage(null)}}else H=function(){R(U,0)};function Pt(W,X){C=R(function(){W(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(W){W.callback=null},i.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(W){switch(b){case 1:case 2:case 3:var X=3;break;default:X=b}var ut=b;b=X;try{return W()}finally{b=ut}},i.unstable_requestPaint=function(){N=!0},i.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ut=b;b=W;try{return X()}finally{b=ut}},i.unstable_scheduleCallback=function(W,X,ut){var xt=i.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?xt+ut:xt):ut=xt,W){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ut+q,W={id:m++,callback:X,priorityLevel:W,startTime:ut,expirationTime:q,sortIndex:-1},ut>xt?(W.sortIndex=ut,t(f,W),e(h)===null&&W===e(f)&&(S?(V(C),C=-1):S=!0,Pt(L,ut-xt))):(W.sortIndex=q,t(h,W),w||A||(w=!0,F||(F=!0,H()))),W},i.unstable_shouldYield=O,i.unstable_wrapCallback=function(W){var X=b;return function(){var ut=b;b=X;try{return W.apply(this,arguments)}finally{b=ut}}}})(Ig)),Ig}var xE;function GC(){return xE||(xE=1,Rg.exports=HC()),Rg.exports}var Ng={exports:{}},Cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE;function qC(){if(CE)return Cn;CE=1;var i=Hy();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,f,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:h,containerInfo:f,implementation:m}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Cn.createPortal=function(h,f){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(h,f,null,m)},Cn.flushSync=function(h){var f=l.T,m=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=f,n.p=m,n.d.f()}},Cn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(h,f))},Cn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Cn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var m=f.as,v=u(m,f.crossOrigin),b=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;m==="style"?n.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:A}):m==="script"&&n.d.X(h,{crossOrigin:v,integrity:b,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Cn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var m=u(f.as,f.crossOrigin);n.d.M(h,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(h)},Cn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var m=f.as,v=u(m,f.crossOrigin);n.d.L(h,m,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Cn.preloadModule=function(h,f){if(typeof h=="string")if(f){var m=u(f.as,f.crossOrigin);n.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(h)},Cn.requestFormReset=function(h){n.d.r(h)},Cn.unstable_batchedUpdates=function(h,f){return h(f)},Cn.useFormState=function(h,f,m){return l.H.useFormState(h,f,m)},Cn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Cn.version="19.1.1",Cn}var RE;function $C(){if(RE)return Ng.exports;RE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Ng.exports=qC(),Ng.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE;function KC(){if(IE)return cu;IE=1;var i=GC(),t=Hy(),e=$C();function n(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,c=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(c=a.return),r=a.return;while(r)}return a.tag===3?c:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function u(r){if(o(r)!==r)throw Error(n(188))}function h(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(n(188));return a!==r?null:r}for(var c=r,d=a;;){var g=c.return;if(g===null)break;var _=g.alternate;if(_===null){if(d=g.return,d!==null){c=d;continue}break}if(g.child===_.child){for(_=g.child;_;){if(_===c)return u(g),r;if(_===d)return u(g),a;_=_.sibling}throw Error(n(188))}if(c.return!==d.return)c=g,d=_;else{for(var x=!1,D=g.child;D;){if(D===c){x=!0,c=g,d=_;break}if(D===d){x=!0,d=g,c=_;break}D=D.sibling}if(!x){for(D=_.child;D;){if(D===c){x=!0,c=_,d=g;break}if(D===d){x=!0,d=_,c=g;break}D=D.sibling}if(!x)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?r:a}function f(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=f(r),a!==null)return a;r=r.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),V=Symbol.for("react.consumer"),M=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function H(r){return r===null||typeof r!="object"?null:(r=U&&r[U]||r["@@iterator"],typeof r=="function"?r:null)}var j=Symbol.for("react.client.reference");function _t(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===j?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case w:return"Fragment";case N:return"Profiler";case S:return"StrictMode";case L:return"Suspense";case F:return"SuspenseList";case k:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case M:return(r.displayName||"Context")+".Provider";case V:return(r._context.displayName||"Context")+".Consumer";case B:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case C:return a=r.displayName||null,a!==null?a:_t(r.type)||"Memo";case I:a=r._payload,r=r._init;try{return _t(r(a))}catch{}}return null}var Pt=Array.isArray,W=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ut={pending:!1,data:null,method:null,action:null},xt=[],q=-1;function st(r){return{current:r}}function ct(r){0>q||(r.current=xt[q],xt[q]=null,q--)}function K(r,a){q++,xt[q]=r.current,r.current=a}var ht=st(null),Nt=st(null),bt=st(null),Ut=st(null);function Qt(r,a){switch(K(bt,a),K(Nt,r),K(ht,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?KA(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=KA(a),r=WA(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ct(ht),K(ht,r)}function Hn(){ct(ht),ct(Nt),ct(bt)}function ps(r){r.memoizedState!==null&&K(Ut,r);var a=ht.current,c=WA(a,r.type);a!==c&&(K(Nt,r),K(ht,c))}function Mn(r){Nt.current===r&&(ct(ht),ct(Nt)),Ut.current===r&&(ct(Ut),su._currentValue=ut)}var ft=Object.prototype.hasOwnProperty,Bt=i.unstable_scheduleCallback,me=i.unstable_cancelCallback,Ps=i.unstable_shouldYield,vr=i.unstable_requestPaint,Gn=i.unstable_now,Sp=i.unstable_getCurrentPriorityLevel,ec=i.unstable_ImmediatePriority,Co=i.unstable_UserBlockingPriority,Aa=i.unstable_NormalPriority,Tp=i.unstable_LowPriority,Ro=i.unstable_IdlePriority,nc=i.log,vh=i.unstable_setDisableYieldValue,Ne=null,oe=null;function ts(r){if(typeof nc=="function"&&vh(r),oe&&typeof oe.setStrictMode=="function")try{oe.setStrictMode(Ne,r)}catch{}}var Tn=Math.clz32?Math.clz32:Ea,_h=Math.log,xp=Math.LN2;function Ea(r){return r>>>=0,r===0?32:31-(_h(r)/xp|0)|0}var wa=256,Sa=4194304;function Ls(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Io(r,a,c){var d=r.pendingLanes;if(d===0)return 0;var g=0,_=r.suspendedLanes,x=r.pingedLanes;r=r.warmLanes;var D=d&134217727;return D!==0?(d=D&~_,d!==0?g=Ls(d):(x&=D,x!==0?g=Ls(x):c||(c=D&~r,c!==0&&(g=Ls(c))))):(D=d&~_,D!==0?g=Ls(D):x!==0?g=Ls(x):c||(c=d&~r,c!==0&&(g=Ls(c)))),g===0?0:a!==0&&a!==g&&(a&_)===0&&(_=g&-g,c=a&-a,_>=c||_===32&&(c&4194048)!==0)?a:g}function Ta(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function sc(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ic(){var r=wa;return wa<<=1,(wa&4194048)===0&&(wa=256),r}function rc(){var r=Sa;return Sa<<=1,(Sa&62914560)===0&&(Sa=4194304),r}function Ri(r){for(var a=[],c=0;31>c;c++)a.push(r);return a}function Ii(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ac(r,a,c,d,g,_){var x=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var D=r.entanglements,G=r.expirationTimes,J=r.hiddenUpdates;for(c=x&~c;0<c;){var it=31-Tn(c),ot=1<<it;D[it]=0,G[it]=-1;var tt=J[it];if(tt!==null)for(J[it]=null,it=0;it<tt.length;it++){var et=tt[it];et!==null&&(et.lane&=-536870913)}c&=~ot}d!==0&&Xs(r,d,0),_!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=_&~(x&~a))}function Xs(r,a,c){r.pendingLanes|=a,r.suspendedLanes&=~a;var d=31-Tn(a);r.entangledLanes|=a,r.entanglements[d]=r.entanglements[d]|1073741824|c&4194090}function oc(r,a){var c=r.entangledLanes|=a;for(r=r.entanglements;c;){var d=31-Tn(c),g=1<<d;g&a|r[d]&a&&(r[d]|=a),c&=~g}}function _r(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function No(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function br(){var r=X.p;return r!==0?r:(r=window.event,r===void 0?32:fE(r.type))}function bh(r,a){var c=X.p;try{return X.p=r,a()}finally{X.p=c}}var Ae=Math.random().toString(36).slice(2),tn="__reactFiber$"+Ae,ze="__reactProps$"+Ae,ms="__reactContainer$"+Ae,lc="__reactEvents$"+Ae,Cp="__reactListeners$"+Ae,Ar="__reactHandles$"+Ae,Ah="__reactResources$"+Ae,xa="__reactMarker$"+Ae;function Er(r){delete r[tn],delete r[ze],delete r[lc],delete r[Cp],delete r[Ar]}function Ni(r){var a=r[tn];if(a)return a;for(var c=r.parentNode;c;){if(a=c[ms]||c[tn]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(r=ZA(r);r!==null;){if(c=r[tn])return c;r=ZA(r)}return a}r=c,c=r.parentNode}return null}function Qs(r){if(r=r[tn]||r[ms]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function Zs(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(n(33))}function Pn(r){var a=r[Ah];return a||(a=r[Ah]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Le(r){r[xa]=!0}var cc=new Set,ko={};function Os(r,a){ki(r,a),ki(r+"Capture",a)}function ki(r,a){for(ko[r]=a,r=0;r<a.length;r++)cc.add(a[r])}var Eh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wh={},Ca={};function Sh(r){return ft.call(Ca,r)?!0:ft.call(wh,r)?!1:Eh.test(r)?Ca[r]=!0:(wh[r]=!0,!1)}function wr(r,a,c){if(Sh(a))if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+c)}}function Js(r,a,c){if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+c)}}function gn(r,a,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(a,c,""+d)}}var Ra,Th;function Di(r){if(Ra===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);Ra=a&&a[1]||"",Th=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ra+r+Th}var Do=!1;function Mo(r,a){if(!r||Do)return"";Do=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var ot=function(){throw Error()};if(Object.defineProperty(ot.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ot,[])}catch(et){var tt=et}Reflect.construct(r,[],ot)}else{try{ot.call()}catch(et){tt=et}r.call(ot.prototype)}}else{try{throw Error()}catch(et){tt=et}(ot=r())&&typeof ot.catch=="function"&&ot.catch(function(){})}}catch(et){if(et&&tt&&typeof et.stack=="string")return[et.stack,tt.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=d.DetermineComponentFrameRoot(),x=_[0],D=_[1];if(x&&D){var G=x.split(`
`),J=D.split(`
`);for(g=d=0;d<G.length&&!G[d].includes("DetermineComponentFrameRoot");)d++;for(;g<J.length&&!J[g].includes("DetermineComponentFrameRoot");)g++;if(d===G.length||g===J.length)for(d=G.length-1,g=J.length-1;1<=d&&0<=g&&G[d]!==J[g];)g--;for(;1<=d&&0<=g;d--,g--)if(G[d]!==J[g]){if(d!==1||g!==1)do if(d--,g--,0>g||G[d]!==J[g]){var it=`
`+G[d].replace(" at new "," at ");return r.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",r.displayName)),it}while(1<=d&&0<=g);break}}}finally{Do=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Di(c):""}function uc(r){switch(r.tag){case 26:case 27:case 5:return Di(r.type);case 16:return Di("Lazy");case 13:return Di("Suspense");case 19:return Di("SuspenseList");case 0:case 15:return Mo(r.type,!1);case 11:return Mo(r.type.render,!1);case 1:return Mo(r.type,!0);case 31:return Di("Activity");default:return""}}function Po(r){try{var a="";do a+=uc(r),r=r.return;while(r);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Ln(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function hc(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Rp(r){var a=hc(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),d=""+r[a];if(!r.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,_=c.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return g.call(this)},set:function(x){d=""+x,_.call(this,x)}}),Object.defineProperty(r,a,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(x){d=""+x},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Lo(r){r._valueTracker||(r._valueTracker=Rp(r))}function dc(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var c=a.getValue(),d="";return r&&(d=hc(r)?r.checked?"true":"false":r.value),r=d,r!==c?(a.setValue(r),!0):!1}function Ia(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ip=/[\n"\\]/g;function He(r){return r.replace(Ip,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function es(r,a,c,d,g,_,x,D){r.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.type=x:r.removeAttribute("type"),a!=null?x==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Ln(a)):r.value!==""+Ln(a)&&(r.value=""+Ln(a)):x!=="submit"&&x!=="reset"||r.removeAttribute("value"),a!=null?Sr(r,x,Ln(a)):c!=null?Sr(r,x,Ln(c)):d!=null&&r.removeAttribute("value"),g==null&&_!=null&&(r.defaultChecked=!!_),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+Ln(D):r.removeAttribute("name")}function Na(r,a,c,d,g,_,x,D){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.type=_),a!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||a!=null))return;c=c!=null?""+Ln(c):"",a=a!=null?""+Ln(a):c,D||a===r.value||(r.value=a),r.defaultValue=a}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=D?r.checked:!!d,r.defaultChecked=!!d,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.name=x)}function Sr(r,a,c){a==="number"&&Ia(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Mi(r,a,c,d){if(r=r.options,a){a={};for(var g=0;g<c.length;g++)a["$"+c[g]]=!0;for(c=0;c<r.length;c++)g=a.hasOwnProperty("$"+r[c].value),r[c].selected!==g&&(r[c].selected=g),g&&d&&(r[c].defaultSelected=!0)}else{for(c=""+Ln(c),a=null,g=0;g<r.length;g++){if(r[g].value===c){r[g].selected=!0,d&&(r[g].defaultSelected=!0);return}a!==null||r[g].disabled||(a=r[g])}a!==null&&(a.selected=!0)}}function ue(r,a,c){if(a!=null&&(a=""+Ln(a),a!==r.value&&(r.value=a),c==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=c!=null?""+Ln(c):""}function ka(r,a,c,d){if(a==null){if(d!=null){if(c!=null)throw Error(n(92));if(Pt(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),a=c}c=Ln(a),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d)}function gs(r,a){if(a){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=a;return}}r.textContent=a}var Da=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xh(r,a,c){var d=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":d?r.setProperty(a,c):typeof c!="number"||c===0||Da.has(a)?a==="float"?r.cssFloat=c:r[a]=(""+c).trim():r[a]=c+"px"}function fc(r,a,c){if(a!=null&&typeof a!="object")throw Error(n(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var g in a)d=a[g],a.hasOwnProperty(g)&&c[g]!==d&&xh(r,g,d)}else for(var _ in a)a.hasOwnProperty(_)&&xh(r,_,a[_])}function pc(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Np=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Oo(r){return kp.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Pi=null;function ys(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Li=null,Oi=null;function mc(r){var a=Qs(r);if(a&&(r=a.stateNode)){var c=r[ze]||null;t:switch(r=a.stateNode,a.type){case"input":if(es(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+He(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var d=c[a];if(d!==r&&d.form===r.form){var g=d[ze]||null;if(!g)throw Error(n(90));es(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<c.length;a++)d=c[a],d.form===r.form&&dc(d)}break t;case"textarea":ue(r,c.value,c.defaultValue);break t;case"select":a=c.value,a!=null&&Mi(r,!!c.multiple,a,!1)}}}var ti=!1;function Ch(r,a,c){if(ti)return r(a,c);ti=!0;try{var d=r(a);return d}finally{if(ti=!1,(Li!==null||Oi!==null)&&(bd(),Li&&(a=Li,r=Oi,Oi=Li=null,mc(a),r)))for(a=0;a<r.length;a++)mc(r[a])}}function Ma(r,a){var c=r.stateNode;if(c===null)return null;var d=c[ze]||null;if(d===null)return null;c=d[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break t;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(n(231,a,typeof c));return c}var js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vs=!1;if(js)try{var Pa={};Object.defineProperty(Pa,"passive",{get:function(){vs=!0}}),window.addEventListener("test",Pa,Pa),window.removeEventListener("test",Pa,Pa)}catch{vs=!1}var ei=null,Tr=null,ji=null;function gc(){if(ji)return ji;var r,a=Tr,c=a.length,d,g="value"in ei?ei.value:ei.textContent,_=g.length;for(r=0;r<c&&a[r]===g[r];r++);var x=c-r;for(d=1;d<=x&&a[c-d]===g[_-d];d++);return ji=g.slice(r,1<d?1-d:void 0)}function ni(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function si(){return!0}function yc(){return!1}function ln(r){function a(c,d,g,_,x){this._reactName=c,this._targetInst=g,this.type=d,this.nativeEvent=_,this.target=x,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(c=r[D],this[D]=c?c(_):_[D]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?si:yc,this.isPropagationStopped=yc,this}return m(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=si)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=si)},persist:function(){},isPersistent:si}),a}var re={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jo=ln(re),La=m({},re,{view:0,detail:0}),Rh=ln(La),Vo,Uo,ii,Oa=m({},La,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ua,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ii&&(ii&&r.type==="mousemove"?(Vo=r.screenX-ii.screenX,Uo=r.screenY-ii.screenY):Uo=Vo=0,ii=r),Vo)},movementY:function(r){return"movementY"in r?r.movementY:Uo}}),_s=ln(Oa),Ih=m({},Oa,{dataTransfer:0}),Dp=ln(Ih),ja=m({},La,{relatedTarget:0}),Fo=ln(ja),vc=m({},re,{animationName:0,elapsedTime:0,pseudoElement:0}),Bo=ln(vc),Nh=m({},re,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),zo=ln(Nh),Mp=m({},re,{data:0}),_c=ln(Mp),Va={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bc(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Dh[r])?!!a[r]:!1}function Ua(){return bc}var Mh=m({},La,{key:function(r){if(r.key){var a=Va[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=ni(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?kh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ua,charCode:function(r){return r.type==="keypress"?ni(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ni(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ho=ln(Mh),Ph=m({},Oa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ac=ln(Ph),Vi=m({},La,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ua}),Lh=ln(Vi),Oh=m({},re,{propertyName:0,elapsedTime:0,pseudoElement:0}),jh=ln(Oh),Vh=m({},Oa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Go=ln(Vh),On=m({},re,{newState:0,oldState:0}),Uh=ln(On),Fh=[9,13,27,32],ri=js&&"CompositionEvent"in window,p=null;js&&"documentMode"in document&&(p=document.documentMode);var E=js&&"TextEvent"in window&&!p,T=js&&(!ri||p&&8<p&&11>=p),P=" ",Q=!1;function nt(r,a){switch(r){case"keyup":return Fh.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dt(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Zt=!1;function en(r,a){switch(r){case"compositionend":return dt(a);case"keypress":return a.which!==32?null:(Q=!0,P);case"textInput":return r=a.data,r===P&&Q?null:r;default:return null}}function Jt(r,a){if(Zt)return r==="compositionend"||!ri&&nt(r,a)?(r=gc(),ji=Tr=ei=null,Zt=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return T&&a.locale!=="ko"?null:a.data;default:return null}}var cn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nn(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!cn[r.type]:a==="textarea"}function Ui(r,a,c,d){Li?Oi?Oi.push(d):Oi=[d]:Li=d,a=xd(a,"onChange"),0<a.length&&(c=new jo("onChange","change",null,c,d),r.push({event:c,listeners:a}))}var yn=null,ai=null;function Ec(r){zA(r,0)}function Bh(r){var a=Zs(r);if(dc(a))return r}function c_(r,a){if(r==="change")return a}var u_=!1;if(js){var Pp;if(js){var Lp="oninput"in document;if(!Lp){var h_=document.createElement("div");h_.setAttribute("oninput","return;"),Lp=typeof h_.oninput=="function"}Pp=Lp}else Pp=!1;u_=Pp&&(!document.documentMode||9<document.documentMode)}function d_(){yn&&(yn.detachEvent("onpropertychange",f_),ai=yn=null)}function f_(r){if(r.propertyName==="value"&&Bh(ai)){var a=[];Ui(a,ai,r,ys(r)),Ch(Ec,a)}}function px(r,a,c){r==="focusin"?(d_(),yn=a,ai=c,yn.attachEvent("onpropertychange",f_)):r==="focusout"&&d_()}function mx(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Bh(ai)}function gx(r,a){if(r==="click")return Bh(a)}function yx(r,a){if(r==="input"||r==="change")return Bh(a)}function vx(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var ns=typeof Object.is=="function"?Object.is:vx;function wc(r,a){if(ns(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var c=Object.keys(r),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var g=c[d];if(!ft.call(a,g)||!ns(r[g],a[g]))return!1}return!0}function p_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function m_(r,a){var c=p_(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=a&&d>=a)return{node:c,offset:a-r};r=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=p_(c)}}function g_(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?g_(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function y_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Ia(r.document);a instanceof r.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)r=a.contentWindow;else break;a=Ia(r.document)}return a}function Op(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var _x=js&&"documentMode"in document&&11>=document.documentMode,qo=null,jp=null,Sc=null,Vp=!1;function v_(r,a,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Vp||qo==null||qo!==Ia(d)||(d=qo,"selectionStart"in d&&Op(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Sc&&wc(Sc,d)||(Sc=d,d=xd(jp,"onSelect"),0<d.length&&(a=new jo("onSelect","select",null,a,c),r.push({event:a,listeners:d}),a.target=qo)))}function Fa(r,a){var c={};return c[r.toLowerCase()]=a.toLowerCase(),c["Webkit"+r]="webkit"+a,c["Moz"+r]="moz"+a,c}var $o={animationend:Fa("Animation","AnimationEnd"),animationiteration:Fa("Animation","AnimationIteration"),animationstart:Fa("Animation","AnimationStart"),transitionrun:Fa("Transition","TransitionRun"),transitionstart:Fa("Transition","TransitionStart"),transitioncancel:Fa("Transition","TransitionCancel"),transitionend:Fa("Transition","TransitionEnd")},Up={},__={};js&&(__=document.createElement("div").style,"AnimationEvent"in window||(delete $o.animationend.animation,delete $o.animationiteration.animation,delete $o.animationstart.animation),"TransitionEvent"in window||delete $o.transitionend.transition);function Ba(r){if(Up[r])return Up[r];if(!$o[r])return r;var a=$o[r],c;for(c in a)if(a.hasOwnProperty(c)&&c in __)return Up[r]=a[c];return r}var b_=Ba("animationend"),A_=Ba("animationiteration"),E_=Ba("animationstart"),bx=Ba("transitionrun"),Ax=Ba("transitionstart"),Ex=Ba("transitioncancel"),w_=Ba("transitionend"),S_=new Map,Fp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fp.push("scrollEnd");function Vs(r,a){S_.set(r,a),Os(a,[r])}var T_=new WeakMap;function bs(r,a){if(typeof r=="object"&&r!==null){var c=T_.get(r);return c!==void 0?c:(a={value:r,source:a,stack:Po(a)},T_.set(r,a),a)}return{value:r,source:a,stack:Po(a)}}var As=[],Ko=0,Bp=0;function zh(){for(var r=Ko,a=Bp=Ko=0;a<r;){var c=As[a];As[a++]=null;var d=As[a];As[a++]=null;var g=As[a];As[a++]=null;var _=As[a];if(As[a++]=null,d!==null&&g!==null){var x=d.pending;x===null?g.next=g:(g.next=x.next,x.next=g),d.pending=g}_!==0&&x_(c,g,_)}}function Hh(r,a,c,d){As[Ko++]=r,As[Ko++]=a,As[Ko++]=c,As[Ko++]=d,Bp|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function zp(r,a,c,d){return Hh(r,a,c,d),Gh(r)}function Wo(r,a){return Hh(r,null,null,a),Gh(r)}function x_(r,a,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var g=!1,_=r.return;_!==null;)_.childLanes|=c,d=_.alternate,d!==null&&(d.childLanes|=c),_.tag===22&&(r=_.stateNode,r===null||r._visibility&1||(g=!0)),r=_,_=_.return;return r.tag===3?(_=r.stateNode,g&&a!==null&&(g=31-Tn(c),r=_.hiddenUpdates,d=r[g],d===null?r[g]=[a]:d.push(a),a.lane=c|536870912),_):null}function Gh(r){if(50<Yc)throw Yc=0,Wm=null,Error(n(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Yo={};function wx(r,a,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ss(r,a,c,d){return new wx(r,a,c,d)}function Hp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Fi(r,a){var c=r.alternate;return c===null?(c=ss(r.tag,a,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=a,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,a=r.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function C_(r,a){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,a=c.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function qh(r,a,c,d,g,_){var x=0;if(d=r,typeof r=="function")Hp(r)&&(x=1);else if(typeof r=="string")x=TC(r,c,ht.current)?26:r==="html"||r==="head"||r==="body"?27:5;else t:switch(r){case k:return r=ss(31,c,a,g),r.elementType=k,r.lanes=_,r;case w:return za(c.children,g,_,a);case S:x=8,g|=24;break;case N:return r=ss(12,c,a,g|2),r.elementType=N,r.lanes=_,r;case L:return r=ss(13,c,a,g),r.elementType=L,r.lanes=_,r;case F:return r=ss(19,c,a,g),r.elementType=F,r.lanes=_,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case R:case M:x=10;break t;case V:x=9;break t;case B:x=11;break t;case C:x=14;break t;case I:x=16,d=null;break t}x=29,c=Error(n(130,r===null?"null":typeof r,"")),d=null}return a=ss(x,c,a,g),a.elementType=r,a.type=d,a.lanes=_,a}function za(r,a,c,d){return r=ss(7,r,d,a),r.lanes=c,r}function Gp(r,a,c){return r=ss(6,r,null,a),r.lanes=c,r}function qp(r,a,c){return a=ss(4,r.children!==null?r.children:[],r.key,a),a.lanes=c,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var Xo=[],Qo=0,$h=null,Kh=0,Es=[],ws=0,Ha=null,Bi=1,zi="";function Ga(r,a){Xo[Qo++]=Kh,Xo[Qo++]=$h,$h=r,Kh=a}function R_(r,a,c){Es[ws++]=Bi,Es[ws++]=zi,Es[ws++]=Ha,Ha=r;var d=Bi;r=zi;var g=32-Tn(d)-1;d&=~(1<<g),c+=1;var _=32-Tn(a)+g;if(30<_){var x=g-g%5;_=(d&(1<<x)-1).toString(32),d>>=x,g-=x,Bi=1<<32-Tn(a)+g|c<<g|d,zi=_+r}else Bi=1<<_|c<<g|d,zi=r}function $p(r){r.return!==null&&(Ga(r,1),R_(r,1,0))}function Kp(r){for(;r===$h;)$h=Xo[--Qo],Xo[Qo]=null,Kh=Xo[--Qo],Xo[Qo]=null;for(;r===Ha;)Ha=Es[--ws],Es[ws]=null,zi=Es[--ws],Es[ws]=null,Bi=Es[--ws],Es[ws]=null}var jn=null,ke=null,se=!1,qa=null,oi=!1,Wp=Error(n(519));function $a(r){var a=Error(n(418,""));throw Cc(bs(a,r)),Wp}function I_(r){var a=r.stateNode,c=r.type,d=r.memoizedProps;switch(a[tn]=r,a[ze]=d,c){case"dialog":$t("cancel",a),$t("close",a);break;case"iframe":case"object":case"embed":$t("load",a);break;case"video":case"audio":for(c=0;c<Qc.length;c++)$t(Qc[c],a);break;case"source":$t("error",a);break;case"img":case"image":case"link":$t("error",a),$t("load",a);break;case"details":$t("toggle",a);break;case"input":$t("invalid",a),Na(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Lo(a);break;case"select":$t("invalid",a);break;case"textarea":$t("invalid",a),ka(a,d.value,d.defaultValue,d.children),Lo(a)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||d.suppressHydrationWarning===!0||$A(a.textContent,c)?(d.popover!=null&&($t("beforetoggle",a),$t("toggle",a)),d.onScroll!=null&&$t("scroll",a),d.onScrollEnd!=null&&$t("scrollend",a),d.onClick!=null&&(a.onclick=Cd),a=!0):a=!1,a||$a(r)}function N_(r){for(jn=r.return;jn;)switch(jn.tag){case 5:case 13:oi=!1;return;case 27:case 3:oi=!0;return;default:jn=jn.return}}function Tc(r){if(r!==jn)return!1;if(!se)return N_(r),se=!0,!1;var a=r.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||ug(r.type,r.memoizedProps)),c=!c),c&&ke&&$a(r),N_(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));t:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(c=r.data,c==="/$"){if(a===0){ke=Fs(r.nextSibling);break t}a--}else c!=="$"&&c!=="$!"&&c!=="$?"||a++;r=r.nextSibling}ke=null}}else a===27?(a=ke,Br(r.type)?(r=pg,pg=null,ke=r):ke=a):ke=jn?Fs(r.stateNode.nextSibling):null;return!0}function xc(){ke=jn=null,se=!1}function k_(){var r=qa;return r!==null&&(Kn===null?Kn=r:Kn.push.apply(Kn,r),qa=null),r}function Cc(r){qa===null?qa=[r]:qa.push(r)}var Yp=st(null),Ka=null,Hi=null;function xr(r,a,c){K(Yp,a._currentValue),a._currentValue=c}function Gi(r){r._currentValue=Yp.current,ct(Yp)}function Xp(r,a,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),r===c)break;r=r.return}}function Qp(r,a,c,d){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var _=g.dependencies;if(_!==null){var x=g.child;_=_.firstContext;t:for(;_!==null;){var D=_;_=g;for(var G=0;G<a.length;G++)if(D.context===a[G]){_.lanes|=c,D=_.alternate,D!==null&&(D.lanes|=c),Xp(_.return,c,r),d||(x=null);break t}_=D.next}}else if(g.tag===18){if(x=g.return,x===null)throw Error(n(341));x.lanes|=c,_=x.alternate,_!==null&&(_.lanes|=c),Xp(x,c,r),x=null}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===r){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}}function Rc(r,a,c,d){r=null;for(var g=a,_=!1;g!==null;){if(!_){if((g.flags&524288)!==0)_=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var x=g.alternate;if(x===null)throw Error(n(387));if(x=x.memoizedProps,x!==null){var D=g.type;ns(g.pendingProps.value,x.value)||(r!==null?r.push(D):r=[D])}}else if(g===Ut.current){if(x=g.alternate,x===null)throw Error(n(387));x.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(su):r=[su])}g=g.return}r!==null&&Qp(a,r,c,d),a.flags|=262144}function Wh(r){for(r=r.firstContext;r!==null;){if(!ns(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Wa(r){Ka=r,Hi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function xn(r){return D_(Ka,r)}function Yh(r,a){return Ka===null&&Wa(r),D_(r,a)}function D_(r,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},Hi===null){if(r===null)throw Error(n(308));Hi=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Hi=Hi.next=a;return c}var Sx=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){a.aborted=!0,r.forEach(function(c){return c()})}},Tx=i.unstable_scheduleCallback,xx=i.unstable_NormalPriority,sn={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new Sx,data:new Map,refCount:0}}function Ic(r){r.refCount--,r.refCount===0&&Tx(xx,function(){r.controller.abort()})}var Nc=null,Jp=0,Zo=0,Jo=null;function Cx(r,a){if(Nc===null){var c=Nc=[];Jp=0,Zo=eg(),Jo={status:"pending",value:void 0,then:function(d){c.push(d)}}}return Jp++,a.then(M_,M_),a}function M_(){if(--Jp===0&&Nc!==null){Jo!==null&&(Jo.status="fulfilled");var r=Nc;Nc=null,Zo=0,Jo=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function Rx(r,a){var c=[],d={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return r.then(function(){d.status="fulfilled",d.value=a;for(var g=0;g<c.length;g++)(0,c[g])(a)},function(g){for(d.status="rejected",d.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),d}var P_=W.S;W.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&Cx(r,a),P_!==null&&P_(r,a)};var Ya=st(null);function tm(){var r=Ya.current;return r!==null?r:ye.pooledCache}function Xh(r,a){a===null?K(Ya,Ya.current):K(Ya,a.pool)}function L_(){var r=tm();return r===null?null:{parent:sn._currentValue,pool:r}}var kc=Error(n(460)),O_=Error(n(474)),Qh=Error(n(542)),em={then:function(){}};function j_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Zh(){}function V_(r,a,c){switch(c=r[c],c===void 0?r.push(a):c!==a&&(a.then(Zh,Zh),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,F_(r),r;default:if(typeof a.status=="string")a.then(Zh,Zh);else{if(r=ye,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=a,r.status="pending",r.then(function(d){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=d}},function(d){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,F_(r),r}throw Dc=a,kc}}var Dc=null;function U_(){if(Dc===null)throw Error(n(459));var r=Dc;return Dc=null,r}function F_(r){if(r===kc||r===Qh)throw Error(n(483))}var Cr=!1;function nm(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sm(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Rr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ir(r,a,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(le&2)!==0){var g=d.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),d.pending=a,a=Gh(r),x_(r,null,c),a}return Hh(r,d,a,c),Gh(r)}function Mc(r,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var d=a.lanes;d&=r.pendingLanes,c|=d,a.lanes=c,oc(r,c)}}function im(r,a){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var g=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var x={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?g=_=x:_=_.next=x,c=c.next}while(c!==null);_===null?g=_=a:_=_.next=a}else g=_=a;c={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:_,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=a:r.next=a,c.lastBaseUpdate=a}var rm=!1;function Pc(){if(rm){var r=Jo;if(r!==null)throw r}}function Lc(r,a,c,d){rm=!1;var g=r.updateQueue;Cr=!1;var _=g.firstBaseUpdate,x=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var G=D,J=G.next;G.next=null,x===null?_=J:x.next=J,x=G;var it=r.alternate;it!==null&&(it=it.updateQueue,D=it.lastBaseUpdate,D!==x&&(D===null?it.firstBaseUpdate=J:D.next=J,it.lastBaseUpdate=G))}if(_!==null){var ot=g.baseState;x=0,it=J=G=null,D=_;do{var tt=D.lane&-536870913,et=tt!==D.lane;if(et?(te&tt)===tt:(d&tt)===tt){tt!==0&&tt===Zo&&(rm=!0),it!==null&&(it=it.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});t:{var Mt=r,Ct=D;tt=a;var fe=c;switch(Ct.tag){case 1:if(Mt=Ct.payload,typeof Mt=="function"){ot=Mt.call(fe,ot,tt);break t}ot=Mt;break t;case 3:Mt.flags=Mt.flags&-65537|128;case 0:if(Mt=Ct.payload,tt=typeof Mt=="function"?Mt.call(fe,ot,tt):Mt,tt==null)break t;ot=m({},ot,tt);break t;case 2:Cr=!0}}tt=D.callback,tt!==null&&(r.flags|=64,et&&(r.flags|=8192),et=g.callbacks,et===null?g.callbacks=[tt]:et.push(tt))}else et={lane:tt,tag:D.tag,payload:D.payload,callback:D.callback,next:null},it===null?(J=it=et,G=ot):it=it.next=et,x|=tt;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;et=D,D=et.next,et.next=null,g.lastBaseUpdate=et,g.shared.pending=null}}while(!0);it===null&&(G=ot),g.baseState=G,g.firstBaseUpdate=J,g.lastBaseUpdate=it,_===null&&(g.shared.lanes=0),jr|=x,r.lanes=x,r.memoizedState=ot}}function B_(r,a){if(typeof r!="function")throw Error(n(191,r));r.call(a)}function z_(r,a){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)B_(c[r],a)}var tl=st(null),Jh=st(0);function H_(r,a){r=Qi,K(Jh,r),K(tl,a),Qi=r|a.baseLanes}function am(){K(Jh,Qi),K(tl,tl.current)}function om(){Qi=Jh.current,ct(tl),ct(Jh)}var Nr=0,zt=null,he=null,Ge=null,td=!1,el=!1,Xa=!1,ed=0,Oc=0,nl=null,Ix=0;function Oe(){throw Error(n(321))}function lm(r,a){if(a===null)return!1;for(var c=0;c<a.length&&c<r.length;c++)if(!ns(r[c],a[c]))return!1;return!0}function cm(r,a,c,d,g,_){return Nr=_,zt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=r===null||r.memoizedState===null?xb:Cb,Xa=!1,_=c(d,g),Xa=!1,el&&(_=q_(a,c,d,g)),G_(r),_}function G_(r){W.H=od;var a=he!==null&&he.next!==null;if(Nr=0,Ge=he=zt=null,td=!1,Oc=0,nl=null,a)throw Error(n(300));r===null||un||(r=r.dependencies,r!==null&&Wh(r)&&(un=!0))}function q_(r,a,c,d){zt=r;var g=0;do{if(el&&(nl=null),Oc=0,el=!1,25<=g)throw Error(n(301));if(g+=1,Ge=he=null,r.updateQueue!=null){var _=r.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}W.H=Ox,_=a(c,d)}while(el);return _}function Nx(){var r=W.H,a=r.useState()[0];return a=typeof a.then=="function"?jc(a):a,r=r.useState()[0],(he!==null?he.memoizedState:null)!==r&&(zt.flags|=1024),a}function um(){var r=ed!==0;return ed=0,r}function hm(r,a,c){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~c}function dm(r){if(td){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}td=!1}Nr=0,Ge=he=zt=null,el=!1,Oc=ed=0,nl=null}function qn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?zt.memoizedState=Ge=r:Ge=Ge.next=r,Ge}function qe(){if(he===null){var r=zt.alternate;r=r!==null?r.memoizedState:null}else r=he.next;var a=Ge===null?zt.memoizedState:Ge.next;if(a!==null)Ge=a,he=r;else{if(r===null)throw zt.alternate===null?Error(n(467)):Error(n(310));he=r,r={memoizedState:he.memoizedState,baseState:he.baseState,baseQueue:he.baseQueue,queue:he.queue,next:null},Ge===null?zt.memoizedState=Ge=r:Ge=Ge.next=r}return Ge}function fm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jc(r){var a=Oc;return Oc+=1,nl===null&&(nl=[]),r=V_(nl,r,a),a=zt,(Ge===null?a.memoizedState:Ge.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?xb:Cb),r}function nd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return jc(r);if(r.$$typeof===M)return xn(r)}throw Error(n(438,String(r)))}function pm(r){var a=null,c=zt.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var d=zt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=fm(),zt.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(r),d=0;d<r;d++)c[d]=O;return a.index++,c}function qi(r,a){return typeof a=="function"?a(r):a}function sd(r){var a=qe();return mm(a,he,r)}function mm(r,a,c){var d=r.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var g=r.baseQueue,_=d.pending;if(_!==null){if(g!==null){var x=g.next;g.next=_.next,_.next=x}a.baseQueue=g=_,d.pending=null}if(_=r.baseState,g===null)r.memoizedState=_;else{a=g.next;var D=x=null,G=null,J=a,it=!1;do{var ot=J.lane&-536870913;if(ot!==J.lane?(te&ot)===ot:(Nr&ot)===ot){var tt=J.revertLane;if(tt===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ot===Zo&&(it=!0);else if((Nr&tt)===tt){J=J.next,tt===Zo&&(it=!0);continue}else ot={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},G===null?(D=G=ot,x=_):G=G.next=ot,zt.lanes|=tt,jr|=tt;ot=J.action,Xa&&c(_,ot),_=J.hasEagerState?J.eagerState:c(_,ot)}else tt={lane:ot,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},G===null?(D=G=tt,x=_):G=G.next=tt,zt.lanes|=ot,jr|=ot;J=J.next}while(J!==null&&J!==a);if(G===null?x=_:G.next=D,!ns(_,r.memoizedState)&&(un=!0,it&&(c=Jo,c!==null)))throw c;r.memoizedState=_,r.baseState=x,r.baseQueue=G,d.lastRenderedState=_}return g===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function gm(r){var a=qe(),c=a.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=r;var d=c.dispatch,g=c.pending,_=a.memoizedState;if(g!==null){c.pending=null;var x=g=g.next;do _=r(_,x.action),x=x.next;while(x!==g);ns(_,a.memoizedState)||(un=!0),a.memoizedState=_,a.baseQueue===null&&(a.baseState=_),c.lastRenderedState=_}return[_,d]}function $_(r,a,c){var d=zt,g=qe(),_=se;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=a();var x=!ns((he||g).memoizedState,c);x&&(g.memoizedState=c,un=!0),g=g.queue;var D=Y_.bind(null,d,g,r);if(Vc(2048,8,D,[r]),g.getSnapshot!==a||x||Ge!==null&&Ge.memoizedState.tag&1){if(d.flags|=2048,sl(9,id(),W_.bind(null,d,g,c,a),null),ye===null)throw Error(n(349));_||(Nr&124)!==0||K_(d,a,c)}return c}function K_(r,a,c){r.flags|=16384,r={getSnapshot:a,value:c},a=zt.updateQueue,a===null?(a=fm(),zt.updateQueue=a,a.stores=[r]):(c=a.stores,c===null?a.stores=[r]:c.push(r))}function W_(r,a,c,d){a.value=c,a.getSnapshot=d,X_(a)&&Q_(r)}function Y_(r,a,c){return c(function(){X_(a)&&Q_(r)})}function X_(r){var a=r.getSnapshot;r=r.value;try{var c=a();return!ns(r,c)}catch{return!0}}function Q_(r){var a=Wo(r,2);a!==null&&ls(a,r,2)}function ym(r){var a=qn();if(typeof r=="function"){var c=r;if(r=c(),Xa){ts(!0);try{c()}finally{ts(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:r},a}function Z_(r,a,c,d){return r.baseState=c,mm(r,he,typeof d=="function"?d:qi)}function kx(r,a,c,d,g){if(ad(r))throw Error(n(485));if(r=a.action,r!==null){var _={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){_.listeners.push(x)}};W.T!==null?c(!0):_.isTransition=!1,d(_),c=a.pending,c===null?(_.next=a.pending=_,J_(a,_)):(_.next=c.next,a.pending=c.next=_)}}function J_(r,a){var c=a.action,d=a.payload,g=r.state;if(a.isTransition){var _=W.T,x={};W.T=x;try{var D=c(g,d),G=W.S;G!==null&&G(x,D),tb(r,a,D)}catch(J){vm(r,a,J)}finally{W.T=_}}else try{_=c(g,d),tb(r,a,_)}catch(J){vm(r,a,J)}}function tb(r,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){eb(r,a,d)},function(d){return vm(r,a,d)}):eb(r,a,c)}function eb(r,a,c){a.status="fulfilled",a.value=c,nb(a),r.state=c,a=r.pending,a!==null&&(c=a.next,c===a?r.pending=null:(c=c.next,a.next=c,J_(r,c)))}function vm(r,a,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=c,nb(a),a=a.next;while(a!==d)}r.action=null}function nb(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function sb(r,a){return a}function ib(r,a){if(se){var c=ye.formState;if(c!==null){t:{var d=zt;if(se){if(ke){e:{for(var g=ke,_=oi;g.nodeType!==8;){if(!_){g=null;break e}if(g=Fs(g.nextSibling),g===null){g=null;break e}}_=g.data,g=_==="F!"||_==="F"?g:null}if(g){ke=Fs(g.nextSibling),d=g.data==="F!";break t}}$a(d)}d=!1}d&&(a=c[0])}}return c=qn(),c.memoizedState=c.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sb,lastRenderedState:a},c.queue=d,c=wb.bind(null,zt,d),d.dispatch=c,d=ym(!1),_=wm.bind(null,zt,!1,d.queue),d=qn(),g={state:a,dispatch:null,action:r,pending:null},d.queue=g,c=kx.bind(null,zt,g,_,c),g.dispatch=c,d.memoizedState=r,[a,c,!1]}function rb(r){var a=qe();return ab(a,he,r)}function ab(r,a,c){if(a=mm(r,a,sb)[0],r=sd(qi)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=jc(a)}catch(x){throw x===kc?Qh:x}else d=a;a=qe();var g=a.queue,_=g.dispatch;return c!==a.memoizedState&&(zt.flags|=2048,sl(9,id(),Dx.bind(null,g,c),null)),[d,_,r]}function Dx(r,a){r.action=a}function ob(r){var a=qe(),c=he;if(c!==null)return ab(a,c,r);qe(),a=a.memoizedState,c=qe();var d=c.queue.dispatch;return c.memoizedState=r,[a,d,!1]}function sl(r,a,c,d){return r={tag:r,create:c,deps:d,inst:a,next:null},a=zt.updateQueue,a===null&&(a=fm(),zt.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,a.lastEffect=r),r}function id(){return{destroy:void 0,resource:void 0}}function lb(){return qe().memoizedState}function rd(r,a,c,d){var g=qn();d=d===void 0?null:d,zt.flags|=r,g.memoizedState=sl(1|a,id(),c,d)}function Vc(r,a,c,d){var g=qe();d=d===void 0?null:d;var _=g.memoizedState.inst;he!==null&&d!==null&&lm(d,he.memoizedState.deps)?g.memoizedState=sl(a,_,c,d):(zt.flags|=r,g.memoizedState=sl(1|a,_,c,d))}function cb(r,a){rd(8390656,8,r,a)}function ub(r,a){Vc(2048,8,r,a)}function hb(r,a){return Vc(4,2,r,a)}function db(r,a){return Vc(4,4,r,a)}function fb(r,a){if(typeof a=="function"){r=r();var c=a(r);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function pb(r,a,c){c=c!=null?c.concat([r]):null,Vc(4,4,fb.bind(null,a,r),c)}function _m(){}function mb(r,a){var c=qe();a=a===void 0?null:a;var d=c.memoizedState;return a!==null&&lm(a,d[1])?d[0]:(c.memoizedState=[r,a],r)}function gb(r,a){var c=qe();a=a===void 0?null:a;var d=c.memoizedState;if(a!==null&&lm(a,d[1]))return d[0];if(d=r(),Xa){ts(!0);try{r()}finally{ts(!1)}}return c.memoizedState=[d,a],d}function bm(r,a,c){return c===void 0||(Nr&1073741824)!==0?r.memoizedState=a:(r.memoizedState=c,r=_A(),zt.lanes|=r,jr|=r,c)}function yb(r,a,c,d){return ns(c,a)?c:tl.current!==null?(r=bm(r,c,d),ns(r,a)||(un=!0),r):(Nr&42)===0?(un=!0,r.memoizedState=c):(r=_A(),zt.lanes|=r,jr|=r,a)}function vb(r,a,c,d,g){var _=X.p;X.p=_!==0&&8>_?_:8;var x=W.T,D={};W.T=D,wm(r,!1,a,c);try{var G=g(),J=W.S;if(J!==null&&J(D,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var it=Rx(G,d);Uc(r,a,it,os(r))}else Uc(r,a,d,os(r))}catch(ot){Uc(r,a,{then:function(){},status:"rejected",reason:ot},os())}finally{X.p=_,W.T=x}}function Mx(){}function Am(r,a,c,d){if(r.tag!==5)throw Error(n(476));var g=_b(r).queue;vb(r,g,a,ut,c===null?Mx:function(){return bb(r),c(d)})}function _b(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:ut,baseState:ut,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:ut},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:c},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function bb(r){var a=_b(r).next.queue;Uc(r,a,{},os())}function Em(){return xn(su)}function Ab(){return qe().memoizedState}function Eb(){return qe().memoizedState}function Px(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var c=os();r=Rr(c);var d=Ir(a,r,c);d!==null&&(ls(d,a,c),Mc(d,a,c)),a={cache:Zp()},r.payload=a;return}a=a.return}}function Lx(r,a,c){var d=os();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},ad(r)?Sb(a,c):(c=zp(r,a,c,d),c!==null&&(ls(c,r,d),Tb(c,a,d)))}function wb(r,a,c){var d=os();Uc(r,a,c,d)}function Uc(r,a,c,d){var g={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(ad(r))Sb(a,g);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=a.lastRenderedReducer,_!==null))try{var x=a.lastRenderedState,D=_(x,c);if(g.hasEagerState=!0,g.eagerState=D,ns(D,x))return Hh(r,a,g,0),ye===null&&zh(),!1}catch{}finally{}if(c=zp(r,a,g,d),c!==null)return ls(c,r,d),Tb(c,a,d),!0}return!1}function wm(r,a,c,d){if(d={lane:2,revertLane:eg(),action:d,hasEagerState:!1,eagerState:null,next:null},ad(r)){if(a)throw Error(n(479))}else a=zp(r,c,d,2),a!==null&&ls(a,r,2)}function ad(r){var a=r.alternate;return r===zt||a!==null&&a===zt}function Sb(r,a){el=td=!0;var c=r.pending;c===null?a.next=a:(a.next=c.next,c.next=a),r.pending=a}function Tb(r,a,c){if((c&4194048)!==0){var d=a.lanes;d&=r.pendingLanes,c|=d,a.lanes=c,oc(r,c)}}var od={readContext:xn,use:nd,useCallback:Oe,useContext:Oe,useEffect:Oe,useImperativeHandle:Oe,useLayoutEffect:Oe,useInsertionEffect:Oe,useMemo:Oe,useReducer:Oe,useRef:Oe,useState:Oe,useDebugValue:Oe,useDeferredValue:Oe,useTransition:Oe,useSyncExternalStore:Oe,useId:Oe,useHostTransitionStatus:Oe,useFormState:Oe,useActionState:Oe,useOptimistic:Oe,useMemoCache:Oe,useCacheRefresh:Oe},xb={readContext:xn,use:nd,useCallback:function(r,a){return qn().memoizedState=[r,a===void 0?null:a],r},useContext:xn,useEffect:cb,useImperativeHandle:function(r,a,c){c=c!=null?c.concat([r]):null,rd(4194308,4,fb.bind(null,a,r),c)},useLayoutEffect:function(r,a){return rd(4194308,4,r,a)},useInsertionEffect:function(r,a){rd(4,2,r,a)},useMemo:function(r,a){var c=qn();a=a===void 0?null:a;var d=r();if(Xa){ts(!0);try{r()}finally{ts(!1)}}return c.memoizedState=[d,a],d},useReducer:function(r,a,c){var d=qn();if(c!==void 0){var g=c(a);if(Xa){ts(!0);try{c(a)}finally{ts(!1)}}}else g=a;return d.memoizedState=d.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},d.queue=r,r=r.dispatch=Lx.bind(null,zt,r),[d.memoizedState,r]},useRef:function(r){var a=qn();return r={current:r},a.memoizedState=r},useState:function(r){r=ym(r);var a=r.queue,c=wb.bind(null,zt,a);return a.dispatch=c,[r.memoizedState,c]},useDebugValue:_m,useDeferredValue:function(r,a){var c=qn();return bm(c,r,a)},useTransition:function(){var r=ym(!1);return r=vb.bind(null,zt,r.queue,!0,!1),qn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,c){var d=zt,g=qn();if(se){if(c===void 0)throw Error(n(407));c=c()}else{if(c=a(),ye===null)throw Error(n(349));(te&124)!==0||K_(d,a,c)}g.memoizedState=c;var _={value:c,getSnapshot:a};return g.queue=_,cb(Y_.bind(null,d,_,r),[r]),d.flags|=2048,sl(9,id(),W_.bind(null,d,_,c,a),null),c},useId:function(){var r=qn(),a=ye.identifierPrefix;if(se){var c=zi,d=Bi;c=(d&~(1<<32-Tn(d)-1)).toString(32)+c,a=""+a+"R"+c,c=ed++,0<c&&(a+="H"+c.toString(32)),a+=""}else c=Ix++,a=""+a+"r"+c.toString(32)+"";return r.memoizedState=a},useHostTransitionStatus:Em,useFormState:ib,useActionState:ib,useOptimistic:function(r){var a=qn();a.memoizedState=a.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=wm.bind(null,zt,!0,c),c.dispatch=a,[r,a]},useMemoCache:pm,useCacheRefresh:function(){return qn().memoizedState=Px.bind(null,zt)}},Cb={readContext:xn,use:nd,useCallback:mb,useContext:xn,useEffect:ub,useImperativeHandle:pb,useInsertionEffect:hb,useLayoutEffect:db,useMemo:gb,useReducer:sd,useRef:lb,useState:function(){return sd(qi)},useDebugValue:_m,useDeferredValue:function(r,a){var c=qe();return yb(c,he.memoizedState,r,a)},useTransition:function(){var r=sd(qi)[0],a=qe().memoizedState;return[typeof r=="boolean"?r:jc(r),a]},useSyncExternalStore:$_,useId:Ab,useHostTransitionStatus:Em,useFormState:rb,useActionState:rb,useOptimistic:function(r,a){var c=qe();return Z_(c,he,r,a)},useMemoCache:pm,useCacheRefresh:Eb},Ox={readContext:xn,use:nd,useCallback:mb,useContext:xn,useEffect:ub,useImperativeHandle:pb,useInsertionEffect:hb,useLayoutEffect:db,useMemo:gb,useReducer:gm,useRef:lb,useState:function(){return gm(qi)},useDebugValue:_m,useDeferredValue:function(r,a){var c=qe();return he===null?bm(c,r,a):yb(c,he.memoizedState,r,a)},useTransition:function(){var r=gm(qi)[0],a=qe().memoizedState;return[typeof r=="boolean"?r:jc(r),a]},useSyncExternalStore:$_,useId:Ab,useHostTransitionStatus:Em,useFormState:ob,useActionState:ob,useOptimistic:function(r,a){var c=qe();return he!==null?Z_(c,he,r,a):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:pm,useCacheRefresh:Eb},il=null,Fc=0;function ld(r){var a=Fc;return Fc+=1,il===null&&(il=[]),V_(il,r,a)}function Bc(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function cd(r,a){throw a.$$typeof===v?Error(n(525)):(r=Object.prototype.toString.call(a),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function Rb(r){var a=r._init;return a(r._payload)}function Ib(r){function a(Y,$){if(r){var Z=Y.deletions;Z===null?(Y.deletions=[$],Y.flags|=16):Z.push($)}}function c(Y,$){if(!r)return null;for(;$!==null;)a(Y,$),$=$.sibling;return null}function d(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function g(Y,$){return Y=Fi(Y,$),Y.index=0,Y.sibling=null,Y}function _(Y,$,Z){return Y.index=Z,r?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<$?(Y.flags|=67108866,$):Z):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function x(Y){return r&&Y.alternate===null&&(Y.flags|=67108866),Y}function D(Y,$,Z,at){return $===null||$.tag!==6?($=Gp(Z,Y.mode,at),$.return=Y,$):($=g($,Z),$.return=Y,$)}function G(Y,$,Z,at){var yt=Z.type;return yt===w?it(Y,$,Z.props.children,at,Z.key):$!==null&&($.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===I&&Rb(yt)===$.type)?($=g($,Z.props),Bc($,Z),$.return=Y,$):($=qh(Z.type,Z.key,Z.props,null,Y.mode,at),Bc($,Z),$.return=Y,$)}function J(Y,$,Z,at){return $===null||$.tag!==4||$.stateNode.containerInfo!==Z.containerInfo||$.stateNode.implementation!==Z.implementation?($=qp(Z,Y.mode,at),$.return=Y,$):($=g($,Z.children||[]),$.return=Y,$)}function it(Y,$,Z,at,yt){return $===null||$.tag!==7?($=za(Z,Y.mode,at,yt),$.return=Y,$):($=g($,Z),$.return=Y,$)}function ot(Y,$,Z){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Gp(""+$,Y.mode,Z),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return Z=qh($.type,$.key,$.props,null,Y.mode,Z),Bc(Z,$),Z.return=Y,Z;case A:return $=qp($,Y.mode,Z),$.return=Y,$;case I:var at=$._init;return $=at($._payload),ot(Y,$,Z)}if(Pt($)||H($))return $=za($,Y.mode,Z,null),$.return=Y,$;if(typeof $.then=="function")return ot(Y,ld($),Z);if($.$$typeof===M)return ot(Y,Yh(Y,$),Z);cd(Y,$)}return null}function tt(Y,$,Z,at){var yt=$!==null?$.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return yt!==null?null:D(Y,$,""+Z,at);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case b:return Z.key===yt?G(Y,$,Z,at):null;case A:return Z.key===yt?J(Y,$,Z,at):null;case I:return yt=Z._init,Z=yt(Z._payload),tt(Y,$,Z,at)}if(Pt(Z)||H(Z))return yt!==null?null:it(Y,$,Z,at,null);if(typeof Z.then=="function")return tt(Y,$,ld(Z),at);if(Z.$$typeof===M)return tt(Y,$,Yh(Y,Z),at);cd(Y,Z)}return null}function et(Y,$,Z,at,yt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Y=Y.get(Z)||null,D($,Y,""+at,yt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case b:return Y=Y.get(at.key===null?Z:at.key)||null,G($,Y,at,yt);case A:return Y=Y.get(at.key===null?Z:at.key)||null,J($,Y,at,yt);case I:var Ht=at._init;return at=Ht(at._payload),et(Y,$,Z,at,yt)}if(Pt(at)||H(at))return Y=Y.get(Z)||null,it($,Y,at,yt,null);if(typeof at.then=="function")return et(Y,$,Z,ld(at),yt);if(at.$$typeof===M)return et(Y,$,Z,Yh($,at),yt);cd($,at)}return null}function Mt(Y,$,Z,at){for(var yt=null,Ht=null,At=$,Rt=$=0,dn=null;At!==null&&Rt<Z.length;Rt++){At.index>Rt?(dn=At,At=null):dn=At.sibling;var ne=tt(Y,At,Z[Rt],at);if(ne===null){At===null&&(At=dn);break}r&&At&&ne.alternate===null&&a(Y,At),$=_(ne,$,Rt),Ht===null?yt=ne:Ht.sibling=ne,Ht=ne,At=dn}if(Rt===Z.length)return c(Y,At),se&&Ga(Y,Rt),yt;if(At===null){for(;Rt<Z.length;Rt++)At=ot(Y,Z[Rt],at),At!==null&&($=_(At,$,Rt),Ht===null?yt=At:Ht.sibling=At,Ht=At);return se&&Ga(Y,Rt),yt}for(At=d(At);Rt<Z.length;Rt++)dn=et(At,Y,Rt,Z[Rt],at),dn!==null&&(r&&dn.alternate!==null&&At.delete(dn.key===null?Rt:dn.key),$=_(dn,$,Rt),Ht===null?yt=dn:Ht.sibling=dn,Ht=dn);return r&&At.forEach(function($r){return a(Y,$r)}),se&&Ga(Y,Rt),yt}function Ct(Y,$,Z,at){if(Z==null)throw Error(n(151));for(var yt=null,Ht=null,At=$,Rt=$=0,dn=null,ne=Z.next();At!==null&&!ne.done;Rt++,ne=Z.next()){At.index>Rt?(dn=At,At=null):dn=At.sibling;var $r=tt(Y,At,ne.value,at);if($r===null){At===null&&(At=dn);break}r&&At&&$r.alternate===null&&a(Y,At),$=_($r,$,Rt),Ht===null?yt=$r:Ht.sibling=$r,Ht=$r,At=dn}if(ne.done)return c(Y,At),se&&Ga(Y,Rt),yt;if(At===null){for(;!ne.done;Rt++,ne=Z.next())ne=ot(Y,ne.value,at),ne!==null&&($=_(ne,$,Rt),Ht===null?yt=ne:Ht.sibling=ne,Ht=ne);return se&&Ga(Y,Rt),yt}for(At=d(At);!ne.done;Rt++,ne=Z.next())ne=et(At,Y,Rt,ne.value,at),ne!==null&&(r&&ne.alternate!==null&&At.delete(ne.key===null?Rt:ne.key),$=_(ne,$,Rt),Ht===null?yt=ne:Ht.sibling=ne,Ht=ne);return r&&At.forEach(function(jC){return a(Y,jC)}),se&&Ga(Y,Rt),yt}function fe(Y,$,Z,at){if(typeof Z=="object"&&Z!==null&&Z.type===w&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case b:t:{for(var yt=Z.key;$!==null;){if($.key===yt){if(yt=Z.type,yt===w){if($.tag===7){c(Y,$.sibling),at=g($,Z.props.children),at.return=Y,Y=at;break t}}else if($.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===I&&Rb(yt)===$.type){c(Y,$.sibling),at=g($,Z.props),Bc(at,Z),at.return=Y,Y=at;break t}c(Y,$);break}else a(Y,$);$=$.sibling}Z.type===w?(at=za(Z.props.children,Y.mode,at,Z.key),at.return=Y,Y=at):(at=qh(Z.type,Z.key,Z.props,null,Y.mode,at),Bc(at,Z),at.return=Y,Y=at)}return x(Y);case A:t:{for(yt=Z.key;$!==null;){if($.key===yt)if($.tag===4&&$.stateNode.containerInfo===Z.containerInfo&&$.stateNode.implementation===Z.implementation){c(Y,$.sibling),at=g($,Z.children||[]),at.return=Y,Y=at;break t}else{c(Y,$);break}else a(Y,$);$=$.sibling}at=qp(Z,Y.mode,at),at.return=Y,Y=at}return x(Y);case I:return yt=Z._init,Z=yt(Z._payload),fe(Y,$,Z,at)}if(Pt(Z))return Mt(Y,$,Z,at);if(H(Z)){if(yt=H(Z),typeof yt!="function")throw Error(n(150));return Z=yt.call(Z),Ct(Y,$,Z,at)}if(typeof Z.then=="function")return fe(Y,$,ld(Z),at);if(Z.$$typeof===M)return fe(Y,$,Yh(Y,Z),at);cd(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,$!==null&&$.tag===6?(c(Y,$.sibling),at=g($,Z),at.return=Y,Y=at):(c(Y,$),at=Gp(Z,Y.mode,at),at.return=Y,Y=at),x(Y)):c(Y,$)}return function(Y,$,Z,at){try{Fc=0;var yt=fe(Y,$,Z,at);return il=null,yt}catch(At){if(At===kc||At===Qh)throw At;var Ht=ss(29,At,null,Y.mode);return Ht.lanes=at,Ht.return=Y,Ht}finally{}}}var rl=Ib(!0),Nb=Ib(!1),Ss=st(null),li=null;function kr(r){var a=r.alternate;K(rn,rn.current&1),K(Ss,r),li===null&&(a===null||tl.current!==null||a.memoizedState!==null)&&(li=r)}function kb(r){if(r.tag===22){if(K(rn,rn.current),K(Ss,r),li===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(li=r)}}else Dr()}function Dr(){K(rn,rn.current),K(Ss,Ss.current)}function $i(r){ct(Ss),li===r&&(li=null),ct(rn)}var rn=st(0);function ud(r){for(var a=r;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||fg(c)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Sm(r,a,c,d){a=r.memoizedState,c=c(d,a),c=c==null?a:m({},a,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Tm={enqueueSetState:function(r,a,c){r=r._reactInternals;var d=os(),g=Rr(d);g.payload=a,c!=null&&(g.callback=c),a=Ir(r,g,d),a!==null&&(ls(a,r,d),Mc(a,r,d))},enqueueReplaceState:function(r,a,c){r=r._reactInternals;var d=os(),g=Rr(d);g.tag=1,g.payload=a,c!=null&&(g.callback=c),a=Ir(r,g,d),a!==null&&(ls(a,r,d),Mc(a,r,d))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var c=os(),d=Rr(c);d.tag=2,a!=null&&(d.callback=a),a=Ir(r,d,c),a!==null&&(ls(a,r,c),Mc(a,r,c))}};function Db(r,a,c,d,g,_,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,_,x):a.prototype&&a.prototype.isPureReactComponent?!wc(c,d)||!wc(g,_):!0}function Mb(r,a,c,d){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==r&&Tm.enqueueReplaceState(a,a.state,null)}function Qa(r,a){var c=a;if("ref"in a){c={};for(var d in a)d!=="ref"&&(c[d]=a[d])}if(r=r.defaultProps){c===a&&(c=m({},c));for(var g in r)c[g]===void 0&&(c[g]=r[g])}return c}var hd=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function Pb(r){hd(r)}function Lb(r){console.error(r)}function Ob(r){hd(r)}function dd(r,a){try{var c=r.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function jb(r,a,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function xm(r,a,c){return c=Rr(c),c.tag=3,c.payload={element:null},c.callback=function(){dd(r,a)},c}function Vb(r){return r=Rr(r),r.tag=3,r}function Ub(r,a,c,d){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var _=d.value;r.payload=function(){return g(_)},r.callback=function(){jb(a,c,d)}}var x=c.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(r.callback=function(){jb(a,c,d),typeof g!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function jx(r,a,c,d,g){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=c.alternate,a!==null&&Rc(a,c,g,!0),c=Ss.current,c!==null){switch(c.tag){case 13:return li===null?Xm():c.alternate===null&&De===0&&(De=3),c.flags&=-257,c.flags|=65536,c.lanes=g,d===em?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([d]):a.add(d),Zm(r,d,g)),!1;case 22:return c.flags|=65536,d===em?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([d]):c.add(d)),Zm(r,d,g)),!1}throw Error(n(435,c.tag))}return Zm(r,d,g),Xm(),!1}if(se)return a=Ss.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,d!==Wp&&(r=Error(n(422),{cause:d}),Cc(bs(r,c)))):(d!==Wp&&(a=Error(n(423),{cause:d}),Cc(bs(a,c))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,d=bs(d,c),g=xm(r.stateNode,d,g),im(r,g),De!==4&&(De=2)),!1;var _=Error(n(520),{cause:d});if(_=bs(_,c),Wc===null?Wc=[_]:Wc.push(_),De!==4&&(De=2),a===null)return!0;d=bs(d,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,r=g&-g,c.lanes|=r,r=xm(c.stateNode,d,r),im(c,r),!1;case 1:if(a=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Vr===null||!Vr.has(_))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Vb(g),Ub(g,r,c,d),im(c,g),!1}c=c.return}while(c!==null);return!1}var Fb=Error(n(461)),un=!1;function vn(r,a,c,d){a.child=r===null?Nb(a,null,c,d):rl(a,r.child,c,d)}function Bb(r,a,c,d,g){c=c.render;var _=a.ref;if("ref"in d){var x={};for(var D in d)D!=="ref"&&(x[D]=d[D])}else x=d;return Wa(a),d=cm(r,a,c,x,_,g),D=um(),r!==null&&!un?(hm(r,a,g),Ki(r,a,g)):(se&&D&&$p(a),a.flags|=1,vn(r,a,d,g),a.child)}function zb(r,a,c,d,g){if(r===null){var _=c.type;return typeof _=="function"&&!Hp(_)&&_.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=_,Hb(r,a,_,d,g)):(r=qh(c.type,null,d,a,a.mode,g),r.ref=a.ref,r.return=a,a.child=r)}if(_=r.child,!Pm(r,g)){var x=_.memoizedProps;if(c=c.compare,c=c!==null?c:wc,c(x,d)&&r.ref===a.ref)return Ki(r,a,g)}return a.flags|=1,r=Fi(_,d),r.ref=a.ref,r.return=a,a.child=r}function Hb(r,a,c,d,g){if(r!==null){var _=r.memoizedProps;if(wc(_,d)&&r.ref===a.ref)if(un=!1,a.pendingProps=d=_,Pm(r,g))(r.flags&131072)!==0&&(un=!0);else return a.lanes=r.lanes,Ki(r,a,g)}return Cm(r,a,c,d,g)}function Gb(r,a,c){var d=a.pendingProps,g=d.children,_=r!==null?r.memoizedState:null;if(d.mode==="hidden"){if((a.flags&128)!==0){if(d=_!==null?_.baseLanes|c:c,r!==null){for(g=a.child=r.child,_=0;g!==null;)_=_|g.lanes|g.childLanes,g=g.sibling;a.childLanes=_&~d}else a.childLanes=0,a.child=null;return qb(r,a,d,c)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&Xh(a,_!==null?_.cachePool:null),_!==null?H_(a,_):am(),kb(a);else return a.lanes=a.childLanes=536870912,qb(r,a,_!==null?_.baseLanes|c:c,c)}else _!==null?(Xh(a,_.cachePool),H_(a,_),Dr(),a.memoizedState=null):(r!==null&&Xh(a,null),am(),Dr());return vn(r,a,g,c),a.child}function qb(r,a,c,d){var g=tm();return g=g===null?null:{parent:sn._currentValue,pool:g},a.memoizedState={baseLanes:c,cachePool:g},r!==null&&Xh(a,null),am(),kb(a),r!==null&&Rc(r,a,d,!0),null}function fd(r,a){var c=a.ref;if(c===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(r===null||r.ref!==c)&&(a.flags|=4194816)}}function Cm(r,a,c,d,g){return Wa(a),c=cm(r,a,c,d,void 0,g),d=um(),r!==null&&!un?(hm(r,a,g),Ki(r,a,g)):(se&&d&&$p(a),a.flags|=1,vn(r,a,c,g),a.child)}function $b(r,a,c,d,g,_){return Wa(a),a.updateQueue=null,c=q_(a,d,c,g),G_(r),d=um(),r!==null&&!un?(hm(r,a,_),Ki(r,a,_)):(se&&d&&$p(a),a.flags|=1,vn(r,a,c,_),a.child)}function Kb(r,a,c,d,g){if(Wa(a),a.stateNode===null){var _=Yo,x=c.contextType;typeof x=="object"&&x!==null&&(_=xn(x)),_=new c(d,_),a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Tm,a.stateNode=_,_._reactInternals=a,_=a.stateNode,_.props=d,_.state=a.memoizedState,_.refs={},nm(a),x=c.contextType,_.context=typeof x=="object"&&x!==null?xn(x):Yo,_.state=a.memoizedState,x=c.getDerivedStateFromProps,typeof x=="function"&&(Sm(a,c,x,d),_.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(x=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),x!==_.state&&Tm.enqueueReplaceState(_,_.state,null),Lc(a,d,_,g),Pc(),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(r===null){_=a.stateNode;var D=a.memoizedProps,G=Qa(c,D);_.props=G;var J=_.context,it=c.contextType;x=Yo,typeof it=="object"&&it!==null&&(x=xn(it));var ot=c.getDerivedStateFromProps;it=typeof ot=="function"||typeof _.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,it||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(D||J!==x)&&Mb(a,_,d,x),Cr=!1;var tt=a.memoizedState;_.state=tt,Lc(a,d,_,g),Pc(),J=a.memoizedState,D||tt!==J||Cr?(typeof ot=="function"&&(Sm(a,c,ot,d),J=a.memoizedState),(G=Cr||Db(a,c,G,d,tt,J,x))?(it||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(a.flags|=4194308)):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=J),_.props=d,_.state=J,_.context=x,d=G):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{_=a.stateNode,sm(r,a),x=a.memoizedProps,it=Qa(c,x),_.props=it,ot=a.pendingProps,tt=_.context,J=c.contextType,G=Yo,typeof J=="object"&&J!==null&&(G=xn(J)),D=c.getDerivedStateFromProps,(J=typeof D=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(x!==ot||tt!==G)&&Mb(a,_,d,G),Cr=!1,tt=a.memoizedState,_.state=tt,Lc(a,d,_,g),Pc();var et=a.memoizedState;x!==ot||tt!==et||Cr||r!==null&&r.dependencies!==null&&Wh(r.dependencies)?(typeof D=="function"&&(Sm(a,c,D,d),et=a.memoizedState),(it=Cr||Db(a,c,it,d,tt,et,G)||r!==null&&r.dependencies!==null&&Wh(r.dependencies))?(J||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,et,G),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,et,G)),typeof _.componentDidUpdate=="function"&&(a.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof _.componentDidUpdate!="function"||x===r.memoizedProps&&tt===r.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&tt===r.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=et),_.props=d,_.state=et,_.context=G,d=it):(typeof _.componentDidUpdate!="function"||x===r.memoizedProps&&tt===r.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&tt===r.memoizedState||(a.flags|=1024),d=!1)}return _=d,fd(r,a),d=(a.flags&128)!==0,_||d?(_=a.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:_.render(),a.flags|=1,r!==null&&d?(a.child=rl(a,r.child,null,g),a.child=rl(a,null,c,g)):vn(r,a,c,g),a.memoizedState=_.state,r=a.child):r=Ki(r,a,g),r}function Wb(r,a,c,d){return xc(),a.flags|=256,vn(r,a,c,d),a.child}var Rm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Im(r){return{baseLanes:r,cachePool:L_()}}function Nm(r,a,c){return r=r!==null?r.childLanes&~c:0,a&&(r|=Ts),r}function Yb(r,a,c){var d=a.pendingProps,g=!1,_=(a.flags&128)!==0,x;if((x=_)||(x=r!==null&&r.memoizedState===null?!1:(rn.current&2)!==0),x&&(g=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,r===null){if(se){if(g?kr(a):Dr(),se){var D=ke,G;if(G=D){t:{for(G=D,D=oi;G.nodeType!==8;){if(!D){D=null;break t}if(G=Fs(G.nextSibling),G===null){D=null;break t}}D=G}D!==null?(a.memoizedState={dehydrated:D,treeContext:Ha!==null?{id:Bi,overflow:zi}:null,retryLane:536870912,hydrationErrors:null},G=ss(18,null,null,0),G.stateNode=D,G.return=a,a.child=G,jn=a,ke=null,G=!0):G=!1}G||$a(a)}if(D=a.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return fg(D)?a.lanes=32:a.lanes=536870912,null;$i(a)}return D=d.children,d=d.fallback,g?(Dr(),g=a.mode,D=pd({mode:"hidden",children:D},g),d=za(d,g,c,null),D.return=a,d.return=a,D.sibling=d,a.child=D,g=a.child,g.memoizedState=Im(c),g.childLanes=Nm(r,x,c),a.memoizedState=Rm,d):(kr(a),km(a,D))}if(G=r.memoizedState,G!==null&&(D=G.dehydrated,D!==null)){if(_)a.flags&256?(kr(a),a.flags&=-257,a=Dm(r,a,c)):a.memoizedState!==null?(Dr(),a.child=r.child,a.flags|=128,a=null):(Dr(),g=d.fallback,D=a.mode,d=pd({mode:"visible",children:d.children},D),g=za(g,D,c,null),g.flags|=2,d.return=a,g.return=a,d.sibling=g,a.child=d,rl(a,r.child,null,c),d=a.child,d.memoizedState=Im(c),d.childLanes=Nm(r,x,c),a.memoizedState=Rm,a=g);else if(kr(a),fg(D)){if(x=D.nextSibling&&D.nextSibling.dataset,x)var J=x.dgst;x=J,d=Error(n(419)),d.stack="",d.digest=x,Cc({value:d,source:null,stack:null}),a=Dm(r,a,c)}else if(un||Rc(r,a,c,!1),x=(c&r.childLanes)!==0,un||x){if(x=ye,x!==null&&(d=c&-c,d=(d&42)!==0?1:_r(d),d=(d&(x.suspendedLanes|c))!==0?0:d,d!==0&&d!==G.retryLane))throw G.retryLane=d,Wo(r,d),ls(x,r,d),Fb;D.data==="$?"||Xm(),a=Dm(r,a,c)}else D.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=G.treeContext,ke=Fs(D.nextSibling),jn=a,se=!0,qa=null,oi=!1,r!==null&&(Es[ws++]=Bi,Es[ws++]=zi,Es[ws++]=Ha,Bi=r.id,zi=r.overflow,Ha=a),a=km(a,d.children),a.flags|=4096);return a}return g?(Dr(),g=d.fallback,D=a.mode,G=r.child,J=G.sibling,d=Fi(G,{mode:"hidden",children:d.children}),d.subtreeFlags=G.subtreeFlags&65011712,J!==null?g=Fi(J,g):(g=za(g,D,c,null),g.flags|=2),g.return=a,d.return=a,d.sibling=g,a.child=d,d=g,g=a.child,D=r.child.memoizedState,D===null?D=Im(c):(G=D.cachePool,G!==null?(J=sn._currentValue,G=G.parent!==J?{parent:J,pool:J}:G):G=L_(),D={baseLanes:D.baseLanes|c,cachePool:G}),g.memoizedState=D,g.childLanes=Nm(r,x,c),a.memoizedState=Rm,d):(kr(a),c=r.child,r=c.sibling,c=Fi(c,{mode:"visible",children:d.children}),c.return=a,c.sibling=null,r!==null&&(x=a.deletions,x===null?(a.deletions=[r],a.flags|=16):x.push(r)),a.child=c,a.memoizedState=null,c)}function km(r,a){return a=pd({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function pd(r,a){return r=ss(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Dm(r,a,c){return rl(a,r.child,null,c),r=km(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function Xb(r,a,c){r.lanes|=a;var d=r.alternate;d!==null&&(d.lanes|=a),Xp(r.return,a,c)}function Mm(r,a,c,d,g){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:g}:(_.isBackwards=a,_.rendering=null,_.renderingStartTime=0,_.last=d,_.tail=c,_.tailMode=g)}function Qb(r,a,c){var d=a.pendingProps,g=d.revealOrder,_=d.tail;if(vn(r,a,d.children,c),d=rn.current,(d&2)!==0)d=d&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)t:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Xb(r,c,a);else if(r.tag===19)Xb(r,c,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break t;for(;r.sibling===null;){if(r.return===null||r.return===a)break t;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}switch(K(rn,d),g){case"forwards":for(c=a.child,g=null;c!==null;)r=c.alternate,r!==null&&ud(r)===null&&(g=c),c=c.sibling;c=g,c===null?(g=a.child,a.child=null):(g=c.sibling,c.sibling=null),Mm(a,!1,g,c,_);break;case"backwards":for(c=null,g=a.child,a.child=null;g!==null;){if(r=g.alternate,r!==null&&ud(r)===null){a.child=g;break}r=g.sibling,g.sibling=c,c=g,g=r}Mm(a,!0,c,null,_);break;case"together":Mm(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Ki(r,a,c){if(r!==null&&(a.dependencies=r.dependencies),jr|=a.lanes,(c&a.childLanes)===0)if(r!==null){if(Rc(r,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(n(153));if(a.child!==null){for(r=a.child,c=Fi(r,r.pendingProps),a.child=c,c.return=a;r.sibling!==null;)r=r.sibling,c=c.sibling=Fi(r,r.pendingProps),c.return=a;c.sibling=null}return a.child}function Pm(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&Wh(r)))}function Vx(r,a,c){switch(a.tag){case 3:Qt(a,a.stateNode.containerInfo),xr(a,sn,r.memoizedState.cache),xc();break;case 27:case 5:ps(a);break;case 4:Qt(a,a.stateNode.containerInfo);break;case 10:xr(a,a.type,a.memoizedProps.value);break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(kr(a),a.flags|=128,null):(c&a.child.childLanes)!==0?Yb(r,a,c):(kr(a),r=Ki(r,a,c),r!==null?r.sibling:null);kr(a);break;case 19:var g=(r.flags&128)!==0;if(d=(c&a.childLanes)!==0,d||(Rc(r,a,c,!1),d=(c&a.childLanes)!==0),g){if(d)return Qb(r,a,c);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),K(rn,rn.current),d)break;return null;case 22:case 23:return a.lanes=0,Gb(r,a,c);case 24:xr(a,sn,r.memoizedState.cache)}return Ki(r,a,c)}function Zb(r,a,c){if(r!==null)if(r.memoizedProps!==a.pendingProps)un=!0;else{if(!Pm(r,c)&&(a.flags&128)===0)return un=!1,Vx(r,a,c);un=(r.flags&131072)!==0}else un=!1,se&&(a.flags&1048576)!==0&&R_(a,Kh,a.index);switch(a.lanes=0,a.tag){case 16:t:{r=a.pendingProps;var d=a.elementType,g=d._init;if(d=g(d._payload),a.type=d,typeof d=="function")Hp(d)?(r=Qa(d,r),a.tag=1,a=Kb(null,a,d,r,c)):(a.tag=0,a=Cm(null,a,d,r,c));else{if(d!=null){if(g=d.$$typeof,g===B){a.tag=11,a=Bb(null,a,d,r,c);break t}else if(g===C){a.tag=14,a=zb(null,a,d,r,c);break t}}throw a=_t(d)||d,Error(n(306,a,""))}}return a;case 0:return Cm(r,a,a.type,a.pendingProps,c);case 1:return d=a.type,g=Qa(d,a.pendingProps),Kb(r,a,d,g,c);case 3:t:{if(Qt(a,a.stateNode.containerInfo),r===null)throw Error(n(387));d=a.pendingProps;var _=a.memoizedState;g=_.element,sm(r,a),Lc(a,d,null,c);var x=a.memoizedState;if(d=x.cache,xr(a,sn,d),d!==_.cache&&Qp(a,[sn],c,!0),Pc(),d=x.element,_.isDehydrated)if(_={element:d,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=_,a.memoizedState=_,a.flags&256){a=Wb(r,a,d,c);break t}else if(d!==g){g=bs(Error(n(424)),a),Cc(g),a=Wb(r,a,d,c);break t}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(ke=Fs(r.firstChild),jn=a,se=!0,qa=null,oi=!0,c=Nb(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(xc(),d===g){a=Ki(r,a,c);break t}vn(r,a,d,c)}a=a.child}return a;case 26:return fd(r,a),r===null?(c=nE(a.type,null,a.pendingProps,null))?a.memoizedState=c:se||(c=a.type,r=a.pendingProps,d=Rd(bt.current).createElement(c),d[tn]=a,d[ze]=r,bn(d,c,r),Le(d),a.stateNode=d):a.memoizedState=nE(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return ps(a),r===null&&se&&(d=a.stateNode=JA(a.type,a.pendingProps,bt.current),jn=a,oi=!0,g=ke,Br(a.type)?(pg=g,ke=Fs(d.firstChild)):ke=g),vn(r,a,a.pendingProps.children,c),fd(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&se&&((g=d=ke)&&(d=dC(d,a.type,a.pendingProps,oi),d!==null?(a.stateNode=d,jn=a,ke=Fs(d.firstChild),oi=!1,g=!0):g=!1),g||$a(a)),ps(a),g=a.type,_=a.pendingProps,x=r!==null?r.memoizedProps:null,d=_.children,ug(g,_)?d=null:x!==null&&ug(g,x)&&(a.flags|=32),a.memoizedState!==null&&(g=cm(r,a,Nx,null,null,c),su._currentValue=g),fd(r,a),vn(r,a,d,c),a.child;case 6:return r===null&&se&&((r=c=ke)&&(c=fC(c,a.pendingProps,oi),c!==null?(a.stateNode=c,jn=a,ke=null,r=!0):r=!1),r||$a(a)),null;case 13:return Yb(r,a,c);case 4:return Qt(a,a.stateNode.containerInfo),d=a.pendingProps,r===null?a.child=rl(a,null,d,c):vn(r,a,d,c),a.child;case 11:return Bb(r,a,a.type,a.pendingProps,c);case 7:return vn(r,a,a.pendingProps,c),a.child;case 8:return vn(r,a,a.pendingProps.children,c),a.child;case 12:return vn(r,a,a.pendingProps.children,c),a.child;case 10:return d=a.pendingProps,xr(a,a.type,d.value),vn(r,a,d.children,c),a.child;case 9:return g=a.type._context,d=a.pendingProps.children,Wa(a),g=xn(g),d=d(g),a.flags|=1,vn(r,a,d,c),a.child;case 14:return zb(r,a,a.type,a.pendingProps,c);case 15:return Hb(r,a,a.type,a.pendingProps,c);case 19:return Qb(r,a,c);case 31:return d=a.pendingProps,c=a.mode,d={mode:d.mode,children:d.children},r===null?(c=pd(d,c),c.ref=a.ref,a.child=c,c.return=a,a=c):(c=Fi(r.child,d),c.ref=a.ref,a.child=c,c.return=a,a=c),a;case 22:return Gb(r,a,c);case 24:return Wa(a),d=xn(sn),r===null?(g=tm(),g===null&&(g=ye,_=Zp(),g.pooledCache=_,_.refCount++,_!==null&&(g.pooledCacheLanes|=c),g=_),a.memoizedState={parent:d,cache:g},nm(a),xr(a,sn,g)):((r.lanes&c)!==0&&(sm(r,a),Lc(a,null,null,c),Pc()),g=r.memoizedState,_=a.memoizedState,g.parent!==d?(g={parent:d,cache:d},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),xr(a,sn,d)):(d=_.cache,xr(a,sn,d),d!==g.cache&&Qp(a,[sn],c,!0))),vn(r,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Wi(r){r.flags|=4}function Jb(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!oE(a)){if(a=Ss.current,a!==null&&((te&4194048)===te?li!==null:(te&62914560)!==te&&(te&536870912)===0||a!==li))throw Dc=em,O_;r.flags|=8192}}function md(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?rc():536870912,r.lanes|=a,cl|=a)}function zc(r,a){if(!se)switch(r.tailMode){case"hidden":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Ce(r){var a=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(a)for(var g=r.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=d,r.childLanes=c,a}function Ux(r,a,c){var d=a.pendingProps;switch(Kp(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ce(a),null;case 1:return Ce(a),null;case 3:return c=a.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Gi(sn),Hn(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(Tc(a)?Wi(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,k_())),Ce(a),null;case 26:return c=a.memoizedState,r===null?(Wi(a),c!==null?(Ce(a),Jb(a,c)):(Ce(a),a.flags&=-16777217)):c?c!==r.memoizedState?(Wi(a),Ce(a),Jb(a,c)):(Ce(a),a.flags&=-16777217):(r.memoizedProps!==d&&Wi(a),Ce(a),a.flags&=-16777217),null;case 27:Mn(a),c=bt.current;var g=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Wi(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return Ce(a),null}r=ht.current,Tc(a)?I_(a):(r=JA(g,d,c),a.stateNode=r,Wi(a))}return Ce(a),null;case 5:if(Mn(a),c=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Wi(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return Ce(a),null}if(r=ht.current,Tc(a))I_(a);else{switch(g=Rd(bt.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?r.multiple=!0:d.size&&(r.size=d.size);break;default:r=typeof d.is=="string"?g.createElement(c,{is:d.is}):g.createElement(c)}}r[tn]=a,r[ze]=d;t:for(g=a.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===a)break t;for(;g.sibling===null;){if(g.return===null||g.return===a)break t;g=g.return}g.sibling.return=g.return,g=g.sibling}a.stateNode=r;t:switch(bn(r,c,d),c){case"button":case"input":case"select":case"textarea":r=!!d.autoFocus;break t;case"img":r=!0;break t;default:r=!1}r&&Wi(a)}}return Ce(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==d&&Wi(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(n(166));if(r=bt.current,Tc(a)){if(r=a.stateNode,c=a.memoizedProps,d=null,g=jn,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}r[tn]=a,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||$A(r.nodeValue,c)),r||$a(a)}else r=Rd(r).createTextNode(d),r[tn]=a,a.stateNode=r}return Ce(a),null;case 13:if(d=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Tc(a),d!==null&&d.dehydrated!==null){if(r===null){if(!g)throw Error(n(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[tn]=a}else xc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ce(a),g=!1}else g=k_(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?($i(a),a):($i(a),null)}if($i(a),(a.flags&128)!==0)return a.lanes=c,a;if(c=d!==null,r=r!==null&&r.memoizedState!==null,c){d=a.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var _=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==g&&(d.flags|=2048)}return c!==r&&c&&(a.child.flags|=8192),md(a,a.updateQueue),Ce(a),null;case 4:return Hn(),r===null&&rg(a.stateNode.containerInfo),Ce(a),null;case 10:return Gi(a.type),Ce(a),null;case 19:if(ct(rn),g=a.memoizedState,g===null)return Ce(a),null;if(d=(a.flags&128)!==0,_=g.rendering,_===null)if(d)zc(g,!1);else{if(De!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(_=ud(r),_!==null){for(a.flags|=128,zc(g,!1),r=_.updateQueue,a.updateQueue=r,md(a,r),a.subtreeFlags=0,r=c,c=a.child;c!==null;)C_(c,r),c=c.sibling;return K(rn,rn.current&1|2),a.child}r=r.sibling}g.tail!==null&&Gn()>vd&&(a.flags|=128,d=!0,zc(g,!1),a.lanes=4194304)}else{if(!d)if(r=ud(_),r!==null){if(a.flags|=128,d=!0,r=r.updateQueue,a.updateQueue=r,md(a,r),zc(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!se)return Ce(a),null}else 2*Gn()-g.renderingStartTime>vd&&c!==536870912&&(a.flags|=128,d=!0,zc(g,!1),a.lanes=4194304);g.isBackwards?(_.sibling=a.child,a.child=_):(r=g.last,r!==null?r.sibling=_:a.child=_,g.last=_)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=Gn(),a.sibling=null,r=rn.current,K(rn,d?r&1|2:r&1),a):(Ce(a),null);case 22:case 23:return $i(a),om(),d=a.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(c&536870912)!==0&&(a.flags&128)===0&&(Ce(a),a.subtreeFlags&6&&(a.flags|=8192)):Ce(a),c=a.updateQueue,c!==null&&md(a,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==c&&(a.flags|=2048),r!==null&&ct(Ya),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Gi(sn),Ce(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function Fx(r,a){switch(Kp(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Gi(sn),Hn(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Mn(a),null;case 13:if($i(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(n(340));xc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return ct(rn),null;case 4:return Hn(),null;case 10:return Gi(a.type),null;case 22:case 23:return $i(a),om(),r!==null&&ct(Ya),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Gi(sn),null;case 25:return null;default:return null}}function tA(r,a){switch(Kp(a),a.tag){case 3:Gi(sn),Hn();break;case 26:case 27:case 5:Mn(a);break;case 4:Hn();break;case 13:$i(a);break;case 19:ct(rn);break;case 10:Gi(a.type);break;case 22:case 23:$i(a),om(),r!==null&&ct(Ya);break;case 24:Gi(sn)}}function Hc(r,a){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var g=d.next;c=g;do{if((c.tag&r)===r){d=void 0;var _=c.create,x=c.inst;d=_(),x.destroy=d}c=c.next}while(c!==g)}}catch(D){ge(a,a.return,D)}}function Mr(r,a,c){try{var d=a.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var _=g.next;d=_;do{if((d.tag&r)===r){var x=d.inst,D=x.destroy;if(D!==void 0){x.destroy=void 0,g=a;var G=c,J=D;try{J()}catch(it){ge(g,G,it)}}}d=d.next}while(d!==_)}}catch(it){ge(a,a.return,it)}}function eA(r){var a=r.updateQueue;if(a!==null){var c=r.stateNode;try{z_(a,c)}catch(d){ge(r,r.return,d)}}}function nA(r,a,c){c.props=Qa(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){ge(r,a,d)}}function Gc(r,a){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(g){ge(r,a,g)}}function ci(r,a){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(g){ge(r,a,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){ge(r,a,g)}else c.current=null}function sA(r){var a=r.type,c=r.memoizedProps,d=r.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break t;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(g){ge(r,r.return,g)}}function Lm(r,a,c){try{var d=r.stateNode;oC(d,r.type,c,a),d[ze]=a}catch(g){ge(r,r.return,g)}}function iA(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Br(r.type)||r.tag===4}function Om(r){t:for(;;){for(;r.sibling===null;){if(r.return===null||iA(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Br(r.type)||r.flags&2||r.child===null||r.tag===4)continue t;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function jm(r,a,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(r),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Cd));else if(d!==4&&(d===27&&Br(r.type)&&(c=r.stateNode,a=null),r=r.child,r!==null))for(jm(r,a,c),r=r.sibling;r!==null;)jm(r,a,c),r=r.sibling}function gd(r,a,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?c.insertBefore(r,a):c.appendChild(r);else if(d!==4&&(d===27&&Br(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(gd(r,a,c),r=r.sibling;r!==null;)gd(r,a,c),r=r.sibling}function rA(r){var a=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);bn(a,d,c),a[tn]=r,a[ze]=c}catch(_){ge(r,r.return,_)}}var Yi=!1,je=!1,Vm=!1,aA=typeof WeakSet=="function"?WeakSet:Set,hn=null;function Bx(r,a){if(r=r.containerInfo,lg=Pd,r=y_(r),Op(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else t:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var g=d.anchorOffset,_=d.focusNode;d=d.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break t}var x=0,D=-1,G=-1,J=0,it=0,ot=r,tt=null;e:for(;;){for(var et;ot!==c||g!==0&&ot.nodeType!==3||(D=x+g),ot!==_||d!==0&&ot.nodeType!==3||(G=x+d),ot.nodeType===3&&(x+=ot.nodeValue.length),(et=ot.firstChild)!==null;)tt=ot,ot=et;for(;;){if(ot===r)break e;if(tt===c&&++J===g&&(D=x),tt===_&&++it===d&&(G=x),(et=ot.nextSibling)!==null)break;ot=tt,tt=ot.parentNode}ot=et}c=D===-1||G===-1?null:{start:D,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(cg={focusedElem:r,selectionRange:c},Pd=!1,hn=a;hn!==null;)if(a=hn,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,hn=r;else for(;hn!==null;){switch(a=hn,_=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&_!==null){r=void 0,c=a,g=_.memoizedProps,_=_.memoizedState,d=c.stateNode;try{var Mt=Qa(c.type,g,c.elementType===c.type);r=d.getSnapshotBeforeUpdate(Mt,_),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ct){ge(c,c.return,Ct)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,c=r.nodeType,c===9)dg(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":dg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=a.sibling,r!==null){r.return=a.return,hn=r;break}hn=a.return}}function oA(r,a,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Pr(r,c),d&4&&Hc(5,c);break;case 1:if(Pr(r,c),d&4)if(r=c.stateNode,a===null)try{r.componentDidMount()}catch(x){ge(c,c.return,x)}else{var g=Qa(c.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(g,a,r.__reactInternalSnapshotBeforeUpdate)}catch(x){ge(c,c.return,x)}}d&64&&eA(c),d&512&&Gc(c,c.return);break;case 3:if(Pr(r,c),d&64&&(r=c.updateQueue,r!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{z_(r,a)}catch(x){ge(c,c.return,x)}}break;case 27:a===null&&d&4&&rA(c);case 26:case 5:Pr(r,c),a===null&&d&4&&sA(c),d&512&&Gc(c,c.return);break;case 12:Pr(r,c);break;case 13:Pr(r,c),d&4&&uA(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=Xx.bind(null,c),pC(r,c))));break;case 22:if(d=c.memoizedState!==null||Yi,!d){a=a!==null&&a.memoizedState!==null||je,g=Yi;var _=je;Yi=d,(je=a)&&!_?Lr(r,c,(c.subtreeFlags&8772)!==0):Pr(r,c),Yi=g,je=_}break;case 30:break;default:Pr(r,c)}}function lA(r){var a=r.alternate;a!==null&&(r.alternate=null,lA(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&Er(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ee=null,$n=!1;function Xi(r,a,c){for(c=c.child;c!==null;)cA(r,a,c),c=c.sibling}function cA(r,a,c){if(oe&&typeof oe.onCommitFiberUnmount=="function")try{oe.onCommitFiberUnmount(Ne,c)}catch{}switch(c.tag){case 26:je||ci(c,a),Xi(r,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:je||ci(c,a);var d=Ee,g=$n;Br(c.type)&&(Ee=c.stateNode,$n=!1),Xi(r,a,c),Jc(c.stateNode),Ee=d,$n=g;break;case 5:je||ci(c,a);case 6:if(d=Ee,g=$n,Ee=null,Xi(r,a,c),Ee=d,$n=g,Ee!==null)if($n)try{(Ee.nodeType===9?Ee.body:Ee.nodeName==="HTML"?Ee.ownerDocument.body:Ee).removeChild(c.stateNode)}catch(_){ge(c,a,_)}else try{Ee.removeChild(c.stateNode)}catch(_){ge(c,a,_)}break;case 18:Ee!==null&&($n?(r=Ee,QA(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),ou(r)):QA(Ee,c.stateNode));break;case 4:d=Ee,g=$n,Ee=c.stateNode.containerInfo,$n=!0,Xi(r,a,c),Ee=d,$n=g;break;case 0:case 11:case 14:case 15:je||Mr(2,c,a),je||Mr(4,c,a),Xi(r,a,c);break;case 1:je||(ci(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"&&nA(c,a,d)),Xi(r,a,c);break;case 21:Xi(r,a,c);break;case 22:je=(d=je)||c.memoizedState!==null,Xi(r,a,c),je=d;break;default:Xi(r,a,c)}}function uA(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ou(r)}catch(c){ge(a,a.return,c)}}function zx(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new aA),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new aA),a;default:throw Error(n(435,r.tag))}}function Um(r,a){var c=zx(r);a.forEach(function(d){var g=Qx.bind(null,r,d);c.has(d)||(c.add(d),d.then(g,g))})}function is(r,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var g=c[d],_=r,x=a,D=x;t:for(;D!==null;){switch(D.tag){case 27:if(Br(D.type)){Ee=D.stateNode,$n=!1;break t}break;case 5:Ee=D.stateNode,$n=!1;break t;case 3:case 4:Ee=D.stateNode.containerInfo,$n=!0;break t}D=D.return}if(Ee===null)throw Error(n(160));cA(_,x,g),Ee=null,$n=!1,_=g.alternate,_!==null&&(_.return=null),g.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)hA(a,r),a=a.sibling}var Us=null;function hA(r,a){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:is(a,r),rs(r),d&4&&(Mr(3,r,r.return),Hc(3,r),Mr(5,r,r.return));break;case 1:is(a,r),rs(r),d&512&&(je||c===null||ci(c,c.return)),d&64&&Yi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var g=Us;if(is(a,r),rs(r),d&512&&(je||c===null||ci(c,c.return)),d&4){var _=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){t:{d=r.type,c=r.memoizedProps,g=g.ownerDocument||g;e:switch(d){case"title":_=g.getElementsByTagName("title")[0],(!_||_[xa]||_[tn]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=g.createElement(d),g.head.insertBefore(_,g.querySelector("head > title"))),bn(_,d,c),_[tn]=r,Le(_),d=_;break t;case"link":var x=rE("link","href",g).get(d+(c.href||""));if(x){for(var D=0;D<x.length;D++)if(_=x[D],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){x.splice(D,1);break e}}_=g.createElement(d),bn(_,d,c),g.head.appendChild(_);break;case"meta":if(x=rE("meta","content",g).get(d+(c.content||""))){for(D=0;D<x.length;D++)if(_=x[D],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){x.splice(D,1);break e}}_=g.createElement(d),bn(_,d,c),g.head.appendChild(_);break;default:throw Error(n(468,d))}_[tn]=r,Le(_),d=_}r.stateNode=d}else aE(g,r.type,r.stateNode);else r.stateNode=iE(g,d,r.memoizedProps);else _!==d?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,d===null?aE(g,r.type,r.stateNode):iE(g,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Lm(r,r.memoizedProps,c.memoizedProps)}break;case 27:is(a,r),rs(r),d&512&&(je||c===null||ci(c,c.return)),c!==null&&d&4&&Lm(r,r.memoizedProps,c.memoizedProps);break;case 5:if(is(a,r),rs(r),d&512&&(je||c===null||ci(c,c.return)),r.flags&32){g=r.stateNode;try{gs(g,"")}catch(et){ge(r,r.return,et)}}d&4&&r.stateNode!=null&&(g=r.memoizedProps,Lm(r,g,c!==null?c.memoizedProps:g)),d&1024&&(Vm=!0);break;case 6:if(is(a,r),rs(r),d&4){if(r.stateNode===null)throw Error(n(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(et){ge(r,r.return,et)}}break;case 3:if(kd=null,g=Us,Us=Id(a.containerInfo),is(a,r),Us=g,rs(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{ou(a.containerInfo)}catch(et){ge(r,r.return,et)}Vm&&(Vm=!1,dA(r));break;case 4:d=Us,Us=Id(r.stateNode.containerInfo),is(a,r),rs(r),Us=d;break;case 12:is(a,r),rs(r);break;case 13:is(a,r),rs(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(qm=Gn()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Um(r,d)));break;case 22:g=r.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,J=Yi,it=je;if(Yi=J||g,je=it||G,is(a,r),je=it,Yi=J,rs(r),d&8192)t:for(a=r.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(c===null||G||Yi||je||Za(r)),c=null,a=r;;){if(a.tag===5||a.tag===26){if(c===null){G=c=a;try{if(_=G.stateNode,g)x=_.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{D=G.stateNode;var ot=G.memoizedProps.style,tt=ot!=null&&ot.hasOwnProperty("display")?ot.display:null;D.style.display=tt==null||typeof tt=="boolean"?"":(""+tt).trim()}}catch(et){ge(G,G.return,et)}}}else if(a.tag===6){if(c===null){G=a;try{G.stateNode.nodeValue=g?"":G.memoizedProps}catch(et){ge(G,G.return,et)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break t;for(;a.sibling===null;){if(a.return===null||a.return===r)break t;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Um(r,c))));break;case 19:is(a,r),rs(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Um(r,d)));break;case 30:break;case 21:break;default:is(a,r),rs(r)}}function rs(r){var a=r.flags;if(a&2){try{for(var c,d=r.return;d!==null;){if(iA(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,_=Om(r);gd(r,_,g);break;case 5:var x=c.stateNode;c.flags&32&&(gs(x,""),c.flags&=-33);var D=Om(r);gd(r,D,x);break;case 3:case 4:var G=c.stateNode.containerInfo,J=Om(r);jm(r,J,G);break;default:throw Error(n(161))}}catch(it){ge(r,r.return,it)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function dA(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;dA(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Pr(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)oA(r,a.alternate,a),a=a.sibling}function Za(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Mr(4,a,a.return),Za(a);break;case 1:ci(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&nA(a,a.return,c),Za(a);break;case 27:Jc(a.stateNode);case 26:case 5:ci(a,a.return),Za(a);break;case 22:a.memoizedState===null&&Za(a);break;case 30:Za(a);break;default:Za(a)}r=r.sibling}}function Lr(r,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,g=r,_=a,x=_.flags;switch(_.tag){case 0:case 11:case 15:Lr(g,_,c),Hc(4,_);break;case 1:if(Lr(g,_,c),d=_,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(J){ge(d,d.return,J)}if(d=_,g=d.updateQueue,g!==null){var D=d.stateNode;try{var G=g.shared.hiddenCallbacks;if(G!==null)for(g.shared.hiddenCallbacks=null,g=0;g<G.length;g++)B_(G[g],D)}catch(J){ge(d,d.return,J)}}c&&x&64&&eA(_),Gc(_,_.return);break;case 27:rA(_);case 26:case 5:Lr(g,_,c),c&&d===null&&x&4&&sA(_),Gc(_,_.return);break;case 12:Lr(g,_,c);break;case 13:Lr(g,_,c),c&&x&4&&uA(g,_);break;case 22:_.memoizedState===null&&Lr(g,_,c),Gc(_,_.return);break;case 30:break;default:Lr(g,_,c)}a=a.sibling}}function Fm(r,a){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Ic(c))}function Bm(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Ic(r))}function ui(r,a,c,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)fA(r,a,c,d),a=a.sibling}function fA(r,a,c,d){var g=a.flags;switch(a.tag){case 0:case 11:case 15:ui(r,a,c,d),g&2048&&Hc(9,a);break;case 1:ui(r,a,c,d);break;case 3:ui(r,a,c,d),g&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Ic(r)));break;case 12:if(g&2048){ui(r,a,c,d),r=a.stateNode;try{var _=a.memoizedProps,x=_.id,D=_.onPostCommit;typeof D=="function"&&D(x,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){ge(a,a.return,G)}}else ui(r,a,c,d);break;case 13:ui(r,a,c,d);break;case 23:break;case 22:_=a.stateNode,x=a.alternate,a.memoizedState!==null?_._visibility&2?ui(r,a,c,d):qc(r,a):_._visibility&2?ui(r,a,c,d):(_._visibility|=2,al(r,a,c,d,(a.subtreeFlags&10256)!==0)),g&2048&&Fm(x,a);break;case 24:ui(r,a,c,d),g&2048&&Bm(a.alternate,a);break;default:ui(r,a,c,d)}}function al(r,a,c,d,g){for(g=g&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var _=r,x=a,D=c,G=d,J=x.flags;switch(x.tag){case 0:case 11:case 15:al(_,x,D,G,g),Hc(8,x);break;case 23:break;case 22:var it=x.stateNode;x.memoizedState!==null?it._visibility&2?al(_,x,D,G,g):qc(_,x):(it._visibility|=2,al(_,x,D,G,g)),g&&J&2048&&Fm(x.alternate,x);break;case 24:al(_,x,D,G,g),g&&J&2048&&Bm(x.alternate,x);break;default:al(_,x,D,G,g)}a=a.sibling}}function qc(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=r,d=a,g=d.flags;switch(d.tag){case 22:qc(c,d),g&2048&&Fm(d.alternate,d);break;case 24:qc(c,d),g&2048&&Bm(d.alternate,d);break;default:qc(c,d)}a=a.sibling}}var $c=8192;function ol(r){if(r.subtreeFlags&$c)for(r=r.child;r!==null;)pA(r),r=r.sibling}function pA(r){switch(r.tag){case 26:ol(r),r.flags&$c&&r.memoizedState!==null&&CC(Us,r.memoizedState,r.memoizedProps);break;case 5:ol(r);break;case 3:case 4:var a=Us;Us=Id(r.stateNode.containerInfo),ol(r),Us=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=$c,$c=16777216,ol(r),$c=a):ol(r));break;default:ol(r)}}function mA(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Kc(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];hn=d,yA(d,r)}mA(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)gA(r),r=r.sibling}function gA(r){switch(r.tag){case 0:case 11:case 15:Kc(r),r.flags&2048&&Mr(9,r,r.return);break;case 3:Kc(r);break;case 12:Kc(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,yd(r)):Kc(r);break;default:Kc(r)}}function yd(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];hn=d,yA(d,r)}mA(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Mr(8,a,a.return),yd(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,yd(a));break;default:yd(a)}r=r.sibling}}function yA(r,a){for(;hn!==null;){var c=hn;switch(c.tag){case 0:case 11:case 15:Mr(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Ic(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,hn=d;else t:for(c=r;hn!==null;){d=hn;var g=d.sibling,_=d.return;if(lA(d),d===c){hn=null;break t}if(g!==null){g.return=_,hn=g;break t}hn=_}}}var Hx={getCacheForType:function(r){var a=xn(sn),c=a.data.get(r);return c===void 0&&(c=r(),a.data.set(r,c)),c}},Gx=typeof WeakMap=="function"?WeakMap:Map,le=0,ye=null,qt=null,te=0,ce=0,as=null,Or=!1,ll=!1,zm=!1,Qi=0,De=0,jr=0,Ja=0,Hm=0,Ts=0,cl=0,Wc=null,Kn=null,Gm=!1,qm=0,vd=1/0,_d=null,Vr=null,_n=0,Ur=null,ul=null,hl=0,$m=0,Km=null,vA=null,Yc=0,Wm=null;function os(){if((le&2)!==0&&te!==0)return te&-te;if(W.T!==null){var r=Zo;return r!==0?r:eg()}return br()}function _A(){Ts===0&&(Ts=(te&536870912)===0||se?ic():536870912);var r=Ss.current;return r!==null&&(r.flags|=32),Ts}function ls(r,a,c){(r===ye&&(ce===2||ce===9)||r.cancelPendingCommit!==null)&&(dl(r,0),Fr(r,te,Ts,!1)),Ii(r,c),((le&2)===0||r!==ye)&&(r===ye&&((le&2)===0&&(Ja|=c),De===4&&Fr(r,te,Ts,!1)),hi(r))}function bA(r,a,c){if((le&6)!==0)throw Error(n(327));var d=!c&&(a&124)===0&&(a&r.expiredLanes)===0||Ta(r,a),g=d?Kx(r,a):Qm(r,a,!0),_=d;do{if(g===0){ll&&!d&&Fr(r,a,0,!1);break}else{if(c=r.current.alternate,_&&!qx(c)){g=Qm(r,a,!1),_=!1;continue}if(g===2){if(_=a,r.errorRecoveryDisabledLanes&_)var x=0;else x=r.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;t:{var D=r;g=Wc;var G=D.current.memoizedState.isDehydrated;if(G&&(dl(D,x).flags|=256),x=Qm(D,x,!1),x!==2){if(zm&&!G){D.errorRecoveryDisabledLanes|=_,Ja|=_,g=4;break t}_=Kn,Kn=g,_!==null&&(Kn===null?Kn=_:Kn.push.apply(Kn,_))}g=x}if(_=!1,g!==2)continue}}if(g===1){dl(r,0),Fr(r,a,0,!0);break}t:{switch(d=r,_=g,_){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Fr(d,a,Ts,!Or);break t;case 2:Kn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(g=qm+300-Gn(),10<g)){if(Fr(d,a,Ts,!Or),Io(d,0,!0)!==0)break t;d.timeoutHandle=YA(AA.bind(null,d,c,Kn,_d,Gm,a,Ts,Ja,cl,Or,_,2,-0,0),g);break t}AA(d,c,Kn,_d,Gm,a,Ts,Ja,cl,Or,_,0,-0,0)}}break}while(!0);hi(r)}function AA(r,a,c,d,g,_,x,D,G,J,it,ot,tt,et){if(r.timeoutHandle=-1,ot=a.subtreeFlags,(ot&8192||(ot&16785408)===16785408)&&(nu={stylesheets:null,count:0,unsuspend:xC},pA(a),ot=RC(),ot!==null)){r.cancelPendingCommit=ot(RA.bind(null,r,a,_,c,d,g,x,D,G,it,1,tt,et)),Fr(r,_,x,!J);return}RA(r,a,_,c,d,g,x,D,G)}function qx(r){for(var a=r;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var g=c[d],_=g.getSnapshot;g=g.value;try{if(!ns(_(),g))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Fr(r,a,c,d){a&=~Hm,a&=~Ja,r.suspendedLanes|=a,r.pingedLanes&=~a,d&&(r.warmLanes|=a),d=r.expirationTimes;for(var g=a;0<g;){var _=31-Tn(g),x=1<<_;d[_]=-1,g&=~x}c!==0&&Xs(r,c,a)}function bd(){return(le&6)===0?(Xc(0),!1):!0}function Ym(){if(qt!==null){if(ce===0)var r=qt.return;else r=qt,Hi=Ka=null,dm(r),il=null,Fc=0,r=qt;for(;r!==null;)tA(r.alternate,r),r=r.return;qt=null}}function dl(r,a){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,cC(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Ym(),ye=r,qt=c=Fi(r.current,null),te=a,ce=0,as=null,Or=!1,ll=Ta(r,a),zm=!1,cl=Ts=Hm=Ja=jr=De=0,Kn=Wc=null,Gm=!1,(a&8)!==0&&(a|=a&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=a;0<d;){var g=31-Tn(d),_=1<<g;a|=r[g],d&=~_}return Qi=a,zh(),c}function EA(r,a){zt=null,W.H=od,a===kc||a===Qh?(a=U_(),ce=3):a===O_?(a=U_(),ce=4):ce=a===Fb?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,as=a,qt===null&&(De=1,dd(r,bs(a,r.current)))}function wA(){var r=W.H;return W.H=od,r===null?od:r}function SA(){var r=W.A;return W.A=Hx,r}function Xm(){De=4,Or||(te&4194048)!==te&&Ss.current!==null||(ll=!0),(jr&134217727)===0&&(Ja&134217727)===0||ye===null||Fr(ye,te,Ts,!1)}function Qm(r,a,c){var d=le;le|=2;var g=wA(),_=SA();(ye!==r||te!==a)&&(_d=null,dl(r,a)),a=!1;var x=De;t:do try{if(ce!==0&&qt!==null){var D=qt,G=as;switch(ce){case 8:Ym(),x=6;break t;case 3:case 2:case 9:case 6:Ss.current===null&&(a=!0);var J=ce;if(ce=0,as=null,fl(r,D,G,J),c&&ll){x=0;break t}break;default:J=ce,ce=0,as=null,fl(r,D,G,J)}}$x(),x=De;break}catch(it){EA(r,it)}while(!0);return a&&r.shellSuspendCounter++,Hi=Ka=null,le=d,W.H=g,W.A=_,qt===null&&(ye=null,te=0,zh()),x}function $x(){for(;qt!==null;)TA(qt)}function Kx(r,a){var c=le;le|=2;var d=wA(),g=SA();ye!==r||te!==a?(_d=null,vd=Gn()+500,dl(r,a)):ll=Ta(r,a);t:do try{if(ce!==0&&qt!==null){a=qt;var _=as;e:switch(ce){case 1:ce=0,as=null,fl(r,a,_,1);break;case 2:case 9:if(j_(_)){ce=0,as=null,xA(a);break}a=function(){ce!==2&&ce!==9||ye!==r||(ce=7),hi(r)},_.then(a,a);break t;case 3:ce=7;break t;case 4:ce=5;break t;case 7:j_(_)?(ce=0,as=null,xA(a)):(ce=0,as=null,fl(r,a,_,7));break;case 5:var x=null;switch(qt.tag){case 26:x=qt.memoizedState;case 5:case 27:var D=qt;if(!x||oE(x)){ce=0,as=null;var G=D.sibling;if(G!==null)qt=G;else{var J=D.return;J!==null?(qt=J,Ad(J)):qt=null}break e}}ce=0,as=null,fl(r,a,_,5);break;case 6:ce=0,as=null,fl(r,a,_,6);break;case 8:Ym(),De=6;break t;default:throw Error(n(462))}}Wx();break}catch(it){EA(r,it)}while(!0);return Hi=Ka=null,W.H=d,W.A=g,le=c,qt!==null?0:(ye=null,te=0,zh(),De)}function Wx(){for(;qt!==null&&!Ps();)TA(qt)}function TA(r){var a=Zb(r.alternate,r,Qi);r.memoizedProps=r.pendingProps,a===null?Ad(r):qt=a}function xA(r){var a=r,c=a.alternate;switch(a.tag){case 15:case 0:a=$b(c,a,a.pendingProps,a.type,void 0,te);break;case 11:a=$b(c,a,a.pendingProps,a.type.render,a.ref,te);break;case 5:dm(a);default:tA(c,a),a=qt=C_(a,Qi),a=Zb(c,a,Qi)}r.memoizedProps=r.pendingProps,a===null?Ad(r):qt=a}function fl(r,a,c,d){Hi=Ka=null,dm(a),il=null,Fc=0;var g=a.return;try{if(jx(r,g,a,c,te)){De=1,dd(r,bs(c,r.current)),qt=null;return}}catch(_){if(g!==null)throw qt=g,_;De=1,dd(r,bs(c,r.current)),qt=null;return}a.flags&32768?(se||d===1?r=!0:ll||(te&536870912)!==0?r=!1:(Or=r=!0,(d===2||d===9||d===3||d===6)&&(d=Ss.current,d!==null&&d.tag===13&&(d.flags|=16384))),CA(a,r)):Ad(a)}function Ad(r){var a=r;do{if((a.flags&32768)!==0){CA(a,Or);return}r=a.return;var c=Ux(a.alternate,a,Qi);if(c!==null){qt=c;return}if(a=a.sibling,a!==null){qt=a;return}qt=a=r}while(a!==null);De===0&&(De=5)}function CA(r,a){do{var c=Fx(r.alternate,r);if(c!==null){c.flags&=32767,qt=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(r=r.sibling,r!==null)){qt=r;return}qt=r=c}while(r!==null);De=6,qt=null}function RA(r,a,c,d,g,_,x,D,G){r.cancelPendingCommit=null;do Ed();while(_n!==0);if((le&6)!==0)throw Error(n(327));if(a!==null){if(a===r.current)throw Error(n(177));if(_=a.lanes|a.childLanes,_|=Bp,ac(r,c,_,x,D,G),r===ye&&(qt=ye=null,te=0),ul=a,Ur=r,hl=c,$m=_,Km=g,vA=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Zx(Aa,function(){return MA(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=W.T,W.T=null,g=X.p,X.p=2,x=le,le|=4;try{Bx(r,a,c)}finally{le=x,X.p=g,W.T=d}}_n=1,IA(),NA(),kA()}}function IA(){if(_n===1){_n=0;var r=Ur,a=ul,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null;var d=X.p;X.p=2;var g=le;le|=4;try{hA(a,r);var _=cg,x=y_(r.containerInfo),D=_.focusedElem,G=_.selectionRange;if(x!==D&&D&&D.ownerDocument&&g_(D.ownerDocument.documentElement,D)){if(G!==null&&Op(D)){var J=G.start,it=G.end;if(it===void 0&&(it=J),"selectionStart"in D)D.selectionStart=J,D.selectionEnd=Math.min(it,D.value.length);else{var ot=D.ownerDocument||document,tt=ot&&ot.defaultView||window;if(tt.getSelection){var et=tt.getSelection(),Mt=D.textContent.length,Ct=Math.min(G.start,Mt),fe=G.end===void 0?Ct:Math.min(G.end,Mt);!et.extend&&Ct>fe&&(x=fe,fe=Ct,Ct=x);var Y=m_(D,Ct),$=m_(D,fe);if(Y&&$&&(et.rangeCount!==1||et.anchorNode!==Y.node||et.anchorOffset!==Y.offset||et.focusNode!==$.node||et.focusOffset!==$.offset)){var Z=ot.createRange();Z.setStart(Y.node,Y.offset),et.removeAllRanges(),Ct>fe?(et.addRange(Z),et.extend($.node,$.offset)):(Z.setEnd($.node,$.offset),et.addRange(Z))}}}}for(ot=[],et=D;et=et.parentNode;)et.nodeType===1&&ot.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ot.length;D++){var at=ot[D];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}Pd=!!lg,cg=lg=null}finally{le=g,X.p=d,W.T=c}}r.current=a,_n=2}}function NA(){if(_n===2){_n=0;var r=Ur,a=ul,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=W.T,W.T=null;var d=X.p;X.p=2;var g=le;le|=4;try{oA(r,a.alternate,a)}finally{le=g,X.p=d,W.T=c}}_n=3}}function kA(){if(_n===4||_n===3){_n=0,vr();var r=Ur,a=ul,c=hl,d=vA;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?_n=5:(_n=0,ul=Ur=null,DA(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(Vr=null),No(c),a=a.stateNode,oe&&typeof oe.onCommitFiberRoot=="function")try{oe.onCommitFiberRoot(Ne,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=W.T,g=X.p,X.p=2,W.T=null;try{for(var _=r.onRecoverableError,x=0;x<d.length;x++){var D=d[x];_(D.value,{componentStack:D.stack})}}finally{W.T=a,X.p=g}}(hl&3)!==0&&Ed(),hi(r),g=r.pendingLanes,(c&4194090)!==0&&(g&42)!==0?r===Wm?Yc++:(Yc=0,Wm=r):Yc=0,Xc(0)}}function DA(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Ic(a)))}function Ed(r){return IA(),NA(),kA(),MA()}function MA(){if(_n!==5)return!1;var r=Ur,a=$m;$m=0;var c=No(hl),d=W.T,g=X.p;try{X.p=32>c?32:c,W.T=null,c=Km,Km=null;var _=Ur,x=hl;if(_n=0,ul=Ur=null,hl=0,(le&6)!==0)throw Error(n(331));var D=le;if(le|=4,gA(_.current),fA(_,_.current,x,c),le=D,Xc(0,!1),oe&&typeof oe.onPostCommitFiberRoot=="function")try{oe.onPostCommitFiberRoot(Ne,_)}catch{}return!0}finally{X.p=g,W.T=d,DA(r,a)}}function PA(r,a,c){a=bs(c,a),a=xm(r.stateNode,a,2),r=Ir(r,a,2),r!==null&&(Ii(r,2),hi(r))}function ge(r,a,c){if(r.tag===3)PA(r,r,c);else for(;a!==null;){if(a.tag===3){PA(a,r,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Vr===null||!Vr.has(d))){r=bs(c,r),c=Vb(2),d=Ir(a,c,2),d!==null&&(Ub(c,d,a,r),Ii(d,2),hi(d));break}}a=a.return}}function Zm(r,a,c){var d=r.pingCache;if(d===null){d=r.pingCache=new Gx;var g=new Set;d.set(a,g)}else g=d.get(a),g===void 0&&(g=new Set,d.set(a,g));g.has(c)||(zm=!0,g.add(c),r=Yx.bind(null,r,a,c),a.then(r,r))}function Yx(r,a,c){var d=r.pingCache;d!==null&&d.delete(a),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,ye===r&&(te&c)===c&&(De===4||De===3&&(te&62914560)===te&&300>Gn()-qm?(le&2)===0&&dl(r,0):Hm|=c,cl===te&&(cl=0)),hi(r)}function LA(r,a){a===0&&(a=rc()),r=Wo(r,a),r!==null&&(Ii(r,a),hi(r))}function Xx(r){var a=r.memoizedState,c=0;a!==null&&(c=a.retryLane),LA(r,c)}function Qx(r,a){var c=0;switch(r.tag){case 13:var d=r.stateNode,g=r.memoizedState;g!==null&&(c=g.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(a),LA(r,c)}function Zx(r,a){return Bt(r,a)}var wd=null,pl=null,Jm=!1,Sd=!1,tg=!1,to=0;function hi(r){r!==pl&&r.next===null&&(pl===null?wd=pl=r:pl=pl.next=r),Sd=!0,Jm||(Jm=!0,tC())}function Xc(r,a){if(!tg&&Sd){tg=!0;do for(var c=!1,d=wd;d!==null;){if(r!==0){var g=d.pendingLanes;if(g===0)var _=0;else{var x=d.suspendedLanes,D=d.pingedLanes;_=(1<<31-Tn(42|r)+1)-1,_&=g&~(x&~D),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,UA(d,_))}else _=te,_=Io(d,d===ye?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(_&3)===0||Ta(d,_)||(c=!0,UA(d,_));d=d.next}while(c);tg=!1}}function Jx(){OA()}function OA(){Sd=Jm=!1;var r=0;to!==0&&(lC()&&(r=to),to=0);for(var a=Gn(),c=null,d=wd;d!==null;){var g=d.next,_=jA(d,a);_===0?(d.next=null,c===null?wd=g:c.next=g,g===null&&(pl=c)):(c=d,(r!==0||(_&3)!==0)&&(Sd=!0)),d=g}Xc(r)}function jA(r,a){for(var c=r.suspendedLanes,d=r.pingedLanes,g=r.expirationTimes,_=r.pendingLanes&-62914561;0<_;){var x=31-Tn(_),D=1<<x,G=g[x];G===-1?((D&c)===0||(D&d)!==0)&&(g[x]=sc(D,a)):G<=a&&(r.expiredLanes|=D),_&=~D}if(a=ye,c=te,c=Io(r,r===a?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===a&&(ce===2||ce===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&me(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Ta(r,c)){if(a=c&-c,a===r.callbackPriority)return a;switch(d!==null&&me(d),No(c)){case 2:case 8:c=Co;break;case 32:c=Aa;break;case 268435456:c=Ro;break;default:c=Aa}return d=VA.bind(null,r),c=Bt(c,d),r.callbackPriority=a,r.callbackNode=c,a}return d!==null&&d!==null&&me(d),r.callbackPriority=2,r.callbackNode=null,2}function VA(r,a){if(_n!==0&&_n!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(Ed()&&r.callbackNode!==c)return null;var d=te;return d=Io(r,r===ye?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(bA(r,d,a),jA(r,Gn()),r.callbackNode!=null&&r.callbackNode===c?VA.bind(null,r):null)}function UA(r,a){if(Ed())return null;bA(r,a,!0)}function tC(){uC(function(){(le&6)!==0?Bt(ec,Jx):OA()})}function eg(){return to===0&&(to=ic()),to}function FA(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Oo(""+r)}function BA(r,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,r.id&&c.setAttribute("form",r.id),a.parentNode.insertBefore(c,a),r=new FormData(r),c.parentNode.removeChild(c),r}function eC(r,a,c,d,g){if(a==="submit"&&c&&c.stateNode===g){var _=FA((g[ze]||null).action),x=d.submitter;x&&(a=(a=x[ze]||null)?FA(a.formAction):x.getAttribute("formAction"),a!==null&&(_=a,x=null));var D=new jo("action","action",null,d,g);r.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(to!==0){var G=x?BA(g,x):new FormData(g);Am(c,{pending:!0,data:G,method:g.method,action:_},null,G)}}else typeof _=="function"&&(D.preventDefault(),G=x?BA(g,x):new FormData(g),Am(c,{pending:!0,data:G,method:g.method,action:_},_,G))},currentTarget:g}]})}}for(var ng=0;ng<Fp.length;ng++){var sg=Fp[ng],nC=sg.toLowerCase(),sC=sg[0].toUpperCase()+sg.slice(1);Vs(nC,"on"+sC)}Vs(b_,"onAnimationEnd"),Vs(A_,"onAnimationIteration"),Vs(E_,"onAnimationStart"),Vs("dblclick","onDoubleClick"),Vs("focusin","onFocus"),Vs("focusout","onBlur"),Vs(bx,"onTransitionRun"),Vs(Ax,"onTransitionStart"),Vs(Ex,"onTransitionCancel"),Vs(w_,"onTransitionEnd"),ki("onMouseEnter",["mouseout","mouseover"]),ki("onMouseLeave",["mouseout","mouseover"]),ki("onPointerEnter",["pointerout","pointerover"]),ki("onPointerLeave",["pointerout","pointerover"]),Os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Os("onBeforeInput",["compositionend","keypress","textInput","paste"]),Os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qc));function zA(r,a){a=(a&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],g=d.event;d=d.listeners;t:{var _=void 0;if(a)for(var x=d.length-1;0<=x;x--){var D=d[x],G=D.instance,J=D.currentTarget;if(D=D.listener,G!==_&&g.isPropagationStopped())break t;_=D,g.currentTarget=J;try{_(g)}catch(it){hd(it)}g.currentTarget=null,_=G}else for(x=0;x<d.length;x++){if(D=d[x],G=D.instance,J=D.currentTarget,D=D.listener,G!==_&&g.isPropagationStopped())break t;_=D,g.currentTarget=J;try{_(g)}catch(it){hd(it)}g.currentTarget=null,_=G}}}}function $t(r,a){var c=a[lc];c===void 0&&(c=a[lc]=new Set);var d=r+"__bubble";c.has(d)||(HA(a,r,2,!1),c.add(d))}function ig(r,a,c){var d=0;a&&(d|=4),HA(c,r,d,a)}var Td="_reactListening"+Math.random().toString(36).slice(2);function rg(r){if(!r[Td]){r[Td]=!0,cc.forEach(function(c){c!=="selectionchange"&&(iC.has(c)||ig(c,!1,r),ig(c,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Td]||(a[Td]=!0,ig("selectionchange",!1,a))}}function HA(r,a,c,d){switch(fE(a)){case 2:var g=kC;break;case 8:g=DC;break;default:g=_g}c=g.bind(null,a,c,r),g=void 0,!vs||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),d?g!==void 0?r.addEventListener(a,c,{capture:!0,passive:g}):r.addEventListener(a,c,!0):g!==void 0?r.addEventListener(a,c,{passive:g}):r.addEventListener(a,c,!1)}function ag(r,a,c,d,g){var _=d;if((a&1)===0&&(a&2)===0&&d!==null)t:for(;;){if(d===null)return;var x=d.tag;if(x===3||x===4){var D=d.stateNode.containerInfo;if(D===g)break;if(x===4)for(x=d.return;x!==null;){var G=x.tag;if((G===3||G===4)&&x.stateNode.containerInfo===g)return;x=x.return}for(;D!==null;){if(x=Ni(D),x===null)return;if(G=x.tag,G===5||G===6||G===26||G===27){d=_=x;continue t}D=D.parentNode}}d=d.return}Ch(function(){var J=_,it=ys(c),ot=[];t:{var tt=S_.get(r);if(tt!==void 0){var et=jo,Mt=r;switch(r){case"keypress":if(ni(c)===0)break t;case"keydown":case"keyup":et=Ho;break;case"focusin":Mt="focus",et=Fo;break;case"focusout":Mt="blur",et=Fo;break;case"beforeblur":case"afterblur":et=Fo;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=_s;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Dp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Lh;break;case b_:case A_:case E_:et=Bo;break;case w_:et=jh;break;case"scroll":case"scrollend":et=Rh;break;case"wheel":et=Go;break;case"copy":case"cut":case"paste":et=zo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=Ac;break;case"toggle":case"beforetoggle":et=Uh}var Ct=(a&4)!==0,fe=!Ct&&(r==="scroll"||r==="scrollend"),Y=Ct?tt!==null?tt+"Capture":null:tt;Ct=[];for(var $=J,Z;$!==null;){var at=$;if(Z=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||Z===null||Y===null||(at=Ma($,Y),at!=null&&Ct.push(Zc($,at,Z))),fe)break;$=$.return}0<Ct.length&&(tt=new et(tt,Mt,null,c,it),ot.push({event:tt,listeners:Ct}))}}if((a&7)===0){t:{if(tt=r==="mouseover"||r==="pointerover",et=r==="mouseout"||r==="pointerout",tt&&c!==Pi&&(Mt=c.relatedTarget||c.fromElement)&&(Ni(Mt)||Mt[ms]))break t;if((et||tt)&&(tt=it.window===it?it:(tt=it.ownerDocument)?tt.defaultView||tt.parentWindow:window,et?(Mt=c.relatedTarget||c.toElement,et=J,Mt=Mt?Ni(Mt):null,Mt!==null&&(fe=o(Mt),Ct=Mt.tag,Mt!==fe||Ct!==5&&Ct!==27&&Ct!==6)&&(Mt=null)):(et=null,Mt=J),et!==Mt)){if(Ct=_s,at="onMouseLeave",Y="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Ct=Ac,at="onPointerLeave",Y="onPointerEnter",$="pointer"),fe=et==null?tt:Zs(et),Z=Mt==null?tt:Zs(Mt),tt=new Ct(at,$+"leave",et,c,it),tt.target=fe,tt.relatedTarget=Z,at=null,Ni(it)===J&&(Ct=new Ct(Y,$+"enter",Mt,c,it),Ct.target=Z,Ct.relatedTarget=fe,at=Ct),fe=at,et&&Mt)e:{for(Ct=et,Y=Mt,$=0,Z=Ct;Z;Z=ml(Z))$++;for(Z=0,at=Y;at;at=ml(at))Z++;for(;0<$-Z;)Ct=ml(Ct),$--;for(;0<Z-$;)Y=ml(Y),Z--;for(;$--;){if(Ct===Y||Y!==null&&Ct===Y.alternate)break e;Ct=ml(Ct),Y=ml(Y)}Ct=null}else Ct=null;et!==null&&GA(ot,tt,et,Ct,!1),Mt!==null&&fe!==null&&GA(ot,fe,Mt,Ct,!0)}}t:{if(tt=J?Zs(J):window,et=tt.nodeName&&tt.nodeName.toLowerCase(),et==="select"||et==="input"&&tt.type==="file")var yt=c_;else if(nn(tt))if(u_)yt=yx;else{yt=mx;var Ht=px}else et=tt.nodeName,!et||et.toLowerCase()!=="input"||tt.type!=="checkbox"&&tt.type!=="radio"?J&&pc(J.elementType)&&(yt=c_):yt=gx;if(yt&&(yt=yt(r,J))){Ui(ot,yt,c,it);break t}Ht&&Ht(r,tt,J),r==="focusout"&&J&&tt.type==="number"&&J.memoizedProps.value!=null&&Sr(tt,"number",tt.value)}switch(Ht=J?Zs(J):window,r){case"focusin":(nn(Ht)||Ht.contentEditable==="true")&&(qo=Ht,jp=J,Sc=null);break;case"focusout":Sc=jp=qo=null;break;case"mousedown":Vp=!0;break;case"contextmenu":case"mouseup":case"dragend":Vp=!1,v_(ot,c,it);break;case"selectionchange":if(_x)break;case"keydown":case"keyup":v_(ot,c,it)}var At;if(ri)t:{switch(r){case"compositionstart":var Rt="onCompositionStart";break t;case"compositionend":Rt="onCompositionEnd";break t;case"compositionupdate":Rt="onCompositionUpdate";break t}Rt=void 0}else Zt?nt(r,c)&&(Rt="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Rt="onCompositionStart");Rt&&(T&&c.locale!=="ko"&&(Zt||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Zt&&(At=gc()):(ei=it,Tr="value"in ei?ei.value:ei.textContent,Zt=!0)),Ht=xd(J,Rt),0<Ht.length&&(Rt=new _c(Rt,r,null,c,it),ot.push({event:Rt,listeners:Ht}),At?Rt.data=At:(At=dt(c),At!==null&&(Rt.data=At)))),(At=E?en(r,c):Jt(r,c))&&(Rt=xd(J,"onBeforeInput"),0<Rt.length&&(Ht=new _c("onBeforeInput","beforeinput",null,c,it),ot.push({event:Ht,listeners:Rt}),Ht.data=At)),eC(ot,r,J,c,it)}zA(ot,a)})}function Zc(r,a,c){return{instance:r,listener:a,currentTarget:c}}function xd(r,a){for(var c=a+"Capture",d=[];r!==null;){var g=r,_=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||_===null||(g=Ma(r,c),g!=null&&d.unshift(Zc(r,g,_)),g=Ma(r,a),g!=null&&d.push(Zc(r,g,_))),r.tag===3)return d;r=r.return}return[]}function ml(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function GA(r,a,c,d,g){for(var _=a._reactName,x=[];c!==null&&c!==d;){var D=c,G=D.alternate,J=D.stateNode;if(D=D.tag,G!==null&&G===d)break;D!==5&&D!==26&&D!==27||J===null||(G=J,g?(J=Ma(c,_),J!=null&&x.unshift(Zc(c,J,G))):g||(J=Ma(c,_),J!=null&&x.push(Zc(c,J,G)))),c=c.return}x.length!==0&&r.push({event:a,listeners:x})}var rC=/\r\n?/g,aC=/\u0000|\uFFFD/g;function qA(r){return(typeof r=="string"?r:""+r).replace(rC,`
`).replace(aC,"")}function $A(r,a){return a=qA(a),qA(r)===a}function Cd(){}function de(r,a,c,d,g,_){switch(c){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||gs(r,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&gs(r,""+d);break;case"className":Js(r,"class",d);break;case"tabIndex":Js(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Js(r,c,d);break;case"style":fc(r,d,_);break;case"data":if(a!=="object"){Js(r,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Oo(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(a!=="input"&&de(r,a,"name",g.name,g,null),de(r,a,"formEncType",g.formEncType,g,null),de(r,a,"formMethod",g.formMethod,g,null),de(r,a,"formTarget",g.formTarget,g,null)):(de(r,a,"encType",g.encType,g,null),de(r,a,"method",g.method,g,null),de(r,a,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Oo(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=Cd);break;case"onScroll":d!=null&&$t("scroll",r);break;case"onScrollEnd":d!=null&&$t("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=Oo(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":$t("beforetoggle",r),$t("toggle",r),wr(r,"popover",d);break;case"xlinkActuate":gn(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":gn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":gn(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":gn(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":gn(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":gn(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":gn(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":gn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":gn(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":wr(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Np.get(c)||c,wr(r,c,d))}}function og(r,a,c,d,g,_){switch(c){case"style":fc(r,d,_);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=c}}break;case"children":typeof d=="string"?gs(r,d):(typeof d=="number"||typeof d=="bigint")&&gs(r,""+d);break;case"onScroll":d!=null&&$t("scroll",r);break;case"onScrollEnd":d!=null&&$t("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Cd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ko.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),a=c.slice(2,g?c.length-7:void 0),_=r[ze]||null,_=_!=null?_[c]:null,typeof _=="function"&&r.removeEventListener(a,_,g),typeof d=="function")){typeof _!="function"&&_!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(a,d,g);break t}c in r?r[c]=d:d===!0?r.setAttribute(c,""):wr(r,c,d)}}}function bn(r,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$t("error",r),$t("load",r);var d=!1,g=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var x=c[_];if(x!=null)switch(_){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:de(r,a,_,x,c,null)}}g&&de(r,a,"srcSet",c.srcSet,c,null),d&&de(r,a,"src",c.src,c,null);return;case"input":$t("invalid",r);var D=_=x=g=null,G=null,J=null;for(d in c)if(c.hasOwnProperty(d)){var it=c[d];if(it!=null)switch(d){case"name":g=it;break;case"type":x=it;break;case"checked":G=it;break;case"defaultChecked":J=it;break;case"value":_=it;break;case"defaultValue":D=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,a));break;default:de(r,a,d,it,c,null)}}Na(r,_,D,G,J,x,g,!1),Lo(r);return;case"select":$t("invalid",r),d=x=_=null;for(g in c)if(c.hasOwnProperty(g)&&(D=c[g],D!=null))switch(g){case"value":_=D;break;case"defaultValue":x=D;break;case"multiple":d=D;default:de(r,a,g,D,c,null)}a=_,c=x,r.multiple=!!d,a!=null?Mi(r,!!d,a,!1):c!=null&&Mi(r,!!d,c,!0);return;case"textarea":$t("invalid",r),_=g=d=null;for(x in c)if(c.hasOwnProperty(x)&&(D=c[x],D!=null))switch(x){case"value":d=D;break;case"defaultValue":g=D;break;case"children":_=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:de(r,a,x,D,c,null)}ka(r,d,g,_),Lo(r);return;case"option":for(G in c)if(c.hasOwnProperty(G)&&(d=c[G],d!=null))switch(G){case"selected":r.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:de(r,a,G,d,c,null)}return;case"dialog":$t("beforetoggle",r),$t("toggle",r),$t("cancel",r),$t("close",r);break;case"iframe":case"object":$t("load",r);break;case"video":case"audio":for(d=0;d<Qc.length;d++)$t(Qc[d],r);break;case"image":$t("error",r),$t("load",r);break;case"details":$t("toggle",r);break;case"embed":case"source":case"link":$t("error",r),$t("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in c)if(c.hasOwnProperty(J)&&(d=c[J],d!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:de(r,a,J,d,c,null)}return;default:if(pc(a)){for(it in c)c.hasOwnProperty(it)&&(d=c[it],d!==void 0&&og(r,a,it,d,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(d=c[D],d!=null&&de(r,a,D,d,c,null))}function oC(r,a,c,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,_=null,x=null,D=null,G=null,J=null,it=null;for(et in c){var ot=c[et];if(c.hasOwnProperty(et)&&ot!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":G=ot;default:d.hasOwnProperty(et)||de(r,a,et,null,d,ot)}}for(var tt in d){var et=d[tt];if(ot=c[tt],d.hasOwnProperty(tt)&&(et!=null||ot!=null))switch(tt){case"type":_=et;break;case"name":g=et;break;case"checked":J=et;break;case"defaultChecked":it=et;break;case"value":x=et;break;case"defaultValue":D=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(n(137,a));break;default:et!==ot&&de(r,a,tt,et,d,ot)}}es(r,x,D,G,J,it,_,g);return;case"select":et=x=D=tt=null;for(_ in c)if(G=c[_],c.hasOwnProperty(_)&&G!=null)switch(_){case"value":break;case"multiple":et=G;default:d.hasOwnProperty(_)||de(r,a,_,null,d,G)}for(g in d)if(_=d[g],G=c[g],d.hasOwnProperty(g)&&(_!=null||G!=null))switch(g){case"value":tt=_;break;case"defaultValue":D=_;break;case"multiple":x=_;default:_!==G&&de(r,a,g,_,d,G)}a=D,c=x,d=et,tt!=null?Mi(r,!!c,tt,!1):!!d!=!!c&&(a!=null?Mi(r,!!c,a,!0):Mi(r,!!c,c?[]:"",!1));return;case"textarea":et=tt=null;for(D in c)if(g=c[D],c.hasOwnProperty(D)&&g!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:de(r,a,D,null,d,g)}for(x in d)if(g=d[x],_=c[x],d.hasOwnProperty(x)&&(g!=null||_!=null))switch(x){case"value":tt=g;break;case"defaultValue":et=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==_&&de(r,a,x,g,d,_)}ue(r,tt,et);return;case"option":for(var Mt in c)if(tt=c[Mt],c.hasOwnProperty(Mt)&&tt!=null&&!d.hasOwnProperty(Mt))switch(Mt){case"selected":r.selected=!1;break;default:de(r,a,Mt,null,d,tt)}for(G in d)if(tt=d[G],et=c[G],d.hasOwnProperty(G)&&tt!==et&&(tt!=null||et!=null))switch(G){case"selected":r.selected=tt&&typeof tt!="function"&&typeof tt!="symbol";break;default:de(r,a,G,tt,d,et)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ct in c)tt=c[Ct],c.hasOwnProperty(Ct)&&tt!=null&&!d.hasOwnProperty(Ct)&&de(r,a,Ct,null,d,tt);for(J in d)if(tt=d[J],et=c[J],d.hasOwnProperty(J)&&tt!==et&&(tt!=null||et!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,a));break;default:de(r,a,J,tt,d,et)}return;default:if(pc(a)){for(var fe in c)tt=c[fe],c.hasOwnProperty(fe)&&tt!==void 0&&!d.hasOwnProperty(fe)&&og(r,a,fe,void 0,d,tt);for(it in d)tt=d[it],et=c[it],!d.hasOwnProperty(it)||tt===et||tt===void 0&&et===void 0||og(r,a,it,tt,d,et);return}}for(var Y in c)tt=c[Y],c.hasOwnProperty(Y)&&tt!=null&&!d.hasOwnProperty(Y)&&de(r,a,Y,null,d,tt);for(ot in d)tt=d[ot],et=c[ot],!d.hasOwnProperty(ot)||tt===et||tt==null&&et==null||de(r,a,ot,tt,d,et)}var lg=null,cg=null;function Rd(r){return r.nodeType===9?r:r.ownerDocument}function KA(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function WA(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function ug(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var hg=null;function lC(){var r=window.event;return r&&r.type==="popstate"?r===hg?!1:(hg=r,!0):(hg=null,!1)}var YA=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,XA=typeof Promise=="function"?Promise:void 0,uC=typeof queueMicrotask=="function"?queueMicrotask:typeof XA<"u"?function(r){return XA.resolve(null).then(r).catch(hC)}:YA;function hC(r){setTimeout(function(){throw r})}function Br(r){return r==="head"}function QA(r,a){var c=a,d=0,g=0;do{var _=c.nextSibling;if(r.removeChild(c),_&&_.nodeType===8)if(c=_.data,c==="/$"){if(0<d&&8>d){c=d;var x=r.ownerDocument;if(c&1&&Jc(x.documentElement),c&2&&Jc(x.body),c&4)for(c=x.head,Jc(c),x=c.firstChild;x;){var D=x.nextSibling,G=x.nodeName;x[xa]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=D}}if(g===0){r.removeChild(_),ou(a);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:d=c.charCodeAt(0)-48;else d=0;c=_}while(c);ou(a)}function dg(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":dg(c),Er(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function dC(r,a,c,d){for(;r.nodeType===1;){var g=c;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[xa])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(_=r.getAttribute("rel"),_==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(_!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(_=r.getAttribute("src"),(_!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&_&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var _=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===_)return r}else return r;if(r=Fs(r.nextSibling),r===null)break}return null}function fC(r,a,c){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Fs(r.nextSibling),r===null))return null;return r}function fg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function pC(r,a){var c=r.ownerDocument;if(r.data!=="$?"||c.readyState==="complete")a();else{var d=function(){a(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function Fs(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var pg=null;function ZA(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(a===0)return r;a--}else c==="/$"&&a++}r=r.previousSibling}return null}function JA(r,a,c){switch(a=Rd(c),r){case"html":if(r=a.documentElement,!r)throw Error(n(452));return r;case"head":if(r=a.head,!r)throw Error(n(453));return r;case"body":if(r=a.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Jc(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);Er(r)}var xs=new Map,tE=new Set;function Id(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Zi=X.d;X.d={f:mC,r:gC,D:yC,C:vC,L:_C,m:bC,X:EC,S:AC,M:wC};function mC(){var r=Zi.f(),a=bd();return r||a}function gC(r){var a=Qs(r);a!==null&&a.tag===5&&a.type==="form"?bb(a):Zi.r(r)}var gl=typeof document>"u"?null:document;function eE(r,a,c){var d=gl;if(d&&typeof a=="string"&&a){var g=He(a);g='link[rel="'+r+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),tE.has(g)||(tE.add(g),r={rel:r,crossOrigin:c,href:a},d.querySelector(g)===null&&(a=d.createElement("link"),bn(a,"link",r),Le(a),d.head.appendChild(a)))}}function yC(r){Zi.D(r),eE("dns-prefetch",r,null)}function vC(r,a){Zi.C(r,a),eE("preconnect",r,a)}function _C(r,a,c){Zi.L(r,a,c);var d=gl;if(d&&r&&a){var g='link[rel="preload"][as="'+He(a)+'"]';a==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+He(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+He(c.imageSizes)+'"]')):g+='[href="'+He(r)+'"]';var _=g;switch(a){case"style":_=yl(r);break;case"script":_=vl(r)}xs.has(_)||(r=m({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:r,as:a},c),xs.set(_,r),d.querySelector(g)!==null||a==="style"&&d.querySelector(tu(_))||a==="script"&&d.querySelector(eu(_))||(a=d.createElement("link"),bn(a,"link",r),Le(a),d.head.appendChild(a)))}}function bC(r,a){Zi.m(r,a);var c=gl;if(c&&r){var d=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+He(d)+'"][href="'+He(r)+'"]',_=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=vl(r)}if(!xs.has(_)&&(r=m({rel:"modulepreload",href:r},a),xs.set(_,r),c.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(eu(_)))return}d=c.createElement("link"),bn(d,"link",r),Le(d),c.head.appendChild(d)}}}function AC(r,a,c){Zi.S(r,a,c);var d=gl;if(d&&r){var g=Pn(d).hoistableStyles,_=yl(r);a=a||"default";var x=g.get(_);if(!x){var D={loading:0,preload:null};if(x=d.querySelector(tu(_)))D.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":a},c),(c=xs.get(_))&&mg(r,c);var G=x=d.createElement("link");Le(G),bn(G,"link",r),G._p=new Promise(function(J,it){G.onload=J,G.onerror=it}),G.addEventListener("load",function(){D.loading|=1}),G.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Nd(x,a,d)}x={type:"stylesheet",instance:x,count:1,state:D},g.set(_,x)}}}function EC(r,a){Zi.X(r,a);var c=gl;if(c&&r){var d=Pn(c).hoistableScripts,g=vl(r),_=d.get(g);_||(_=c.querySelector(eu(g)),_||(r=m({src:r,async:!0},a),(a=xs.get(g))&&gg(r,a),_=c.createElement("script"),Le(_),bn(_,"link",r),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(g,_))}}function wC(r,a){Zi.M(r,a);var c=gl;if(c&&r){var d=Pn(c).hoistableScripts,g=vl(r),_=d.get(g);_||(_=c.querySelector(eu(g)),_||(r=m({src:r,async:!0,type:"module"},a),(a=xs.get(g))&&gg(r,a),_=c.createElement("script"),Le(_),bn(_,"link",r),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(g,_))}}function nE(r,a,c,d){var g=(g=bt.current)?Id(g):null;if(!g)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=yl(c.href),c=Pn(g).hoistableStyles,d=c.get(a),d||(d={type:"style",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=yl(c.href);var _=Pn(g).hoistableStyles,x=_.get(r);if(x||(g=g.ownerDocument||g,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(r,x),(_=g.querySelector(tu(r)))&&!_._p&&(x.instance=_,x.state.loading=5),xs.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},xs.set(r,c),_||SC(g,r,c,x.state))),a&&d===null)throw Error(n(528,""));return x}if(a&&d!==null)throw Error(n(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=vl(c),c=Pn(g).hoistableScripts,d=c.get(a),d||(d={type:"script",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function yl(r){return'href="'+He(r)+'"'}function tu(r){return'link[rel="stylesheet"]['+r+"]"}function sE(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function SC(r,a,c,d){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=r.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),bn(a,"link",c),Le(a),r.head.appendChild(a))}function vl(r){return'[src="'+He(r)+'"]'}function eu(r){return"script[async]"+r}function iE(r,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var d=r.querySelector('style[data-href~="'+He(c.href)+'"]');if(d)return a.instance=d,Le(d),d;var g=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Le(d),bn(d,"style",g),Nd(d,c.precedence,r),a.instance=d;case"stylesheet":g=yl(c.href);var _=r.querySelector(tu(g));if(_)return a.state.loading|=4,a.instance=_,Le(_),_;d=sE(c),(g=xs.get(g))&&mg(d,g),_=(r.ownerDocument||r).createElement("link"),Le(_);var x=_;return x._p=new Promise(function(D,G){x.onload=D,x.onerror=G}),bn(_,"link",d),a.state.loading|=4,Nd(_,c.precedence,r),a.instance=_;case"script":return _=vl(c.src),(g=r.querySelector(eu(_)))?(a.instance=g,Le(g),g):(d=c,(g=xs.get(_))&&(d=m({},c),gg(d,g)),r=r.ownerDocument||r,g=r.createElement("script"),Le(g),bn(g,"link",d),r.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,Nd(d,c.precedence,r));return a.instance}function Nd(r,a,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,_=g,x=0;x<d.length;x++){var D=d[x];if(D.dataset.precedence===a)_=D;else if(_!==g)break}_?_.parentNode.insertBefore(r,_.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(r,a.firstChild))}function mg(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function gg(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var kd=null;function rE(r,a,c){if(kd===null){var d=new Map,g=kd=new Map;g.set(c,d)}else g=kd,d=g.get(c),d||(d=new Map,g.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),g=0;g<c.length;g++){var _=c[g];if(!(_[xa]||_[tn]||r==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var x=_.getAttribute(a)||"";x=r+x;var D=d.get(x);D?D.push(_):d.set(x,[_])}}return d}function aE(r,a,c){r=r.ownerDocument||r,r.head.insertBefore(c,a==="title"?r.querySelector("head > title"):null)}function TC(r,a,c){if(c===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function oE(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var nu=null;function xC(){}function CC(r,a,c){if(nu===null)throw Error(n(475));var d=nu;if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var g=yl(c.href),_=r.querySelector(tu(g));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(d.count++,d=Dd.bind(d),r.then(d,d)),a.state.loading|=4,a.instance=_,Le(_);return}_=r.ownerDocument||r,c=sE(c),(g=xs.get(g))&&mg(c,g),_=_.createElement("link"),Le(_);var x=_;x._p=new Promise(function(D,G){x.onload=D,x.onerror=G}),bn(_,"link",c),a.instance=_}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(d.count++,a=Dd.bind(d),r.addEventListener("load",a),r.addEventListener("error",a))}}function RC(){if(nu===null)throw Error(n(475));var r=nu;return r.stylesheets&&r.count===0&&yg(r,r.stylesheets),0<r.count?function(a){var c=setTimeout(function(){if(r.stylesheets&&yg(r,r.stylesheets),r.unsuspend){var d=r.unsuspend;r.unsuspend=null,d()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(c)}}:null}function Dd(){if(this.count--,this.count===0){if(this.stylesheets)yg(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Md=null;function yg(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Md=new Map,a.forEach(IC,r),Md=null,Dd.call(r))}function IC(r,a){if(!(a.state.loading&4)){var c=Md.get(r);if(c)var d=c.get(null);else{c=new Map,Md.set(r,c);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<g.length;_++){var x=g[_];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(c.set(x.dataset.precedence,x),d=x)}d&&c.set(null,d)}g=a.instance,x=g.getAttribute("data-precedence"),_=c.get(x)||d,_===d&&c.set(null,g),c.set(x,g),this.count++,d=Dd.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),_?_.parentNode.insertBefore(g,_.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),a.state.loading|=4}}var su={$$typeof:M,Provider:null,Consumer:null,_currentValue:ut,_currentValue2:ut,_threadCount:0};function NC(r,a,c,d,g,_,x,D){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ri(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ri(0),this.hiddenUpdates=Ri(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=_,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function lE(r,a,c,d,g,_,x,D,G,J,it,ot){return r=new NC(r,a,c,x,D,G,J,ot),a=1,_===!0&&(a|=24),_=ss(3,null,null,a),r.current=_,_.stateNode=r,a=Zp(),a.refCount++,r.pooledCache=a,a.refCount++,_.memoizedState={element:d,isDehydrated:c,cache:a},nm(_),r}function cE(r){return r?(r=Yo,r):Yo}function uE(r,a,c,d,g,_){g=cE(g),d.context===null?d.context=g:d.pendingContext=g,d=Rr(a),d.payload={element:c},_=_===void 0?null:_,_!==null&&(d.callback=_),c=Ir(r,d,a),c!==null&&(ls(c,r,a),Mc(c,r,a))}function hE(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<a?c:a}}function vg(r,a){hE(r,a),(r=r.alternate)&&hE(r,a)}function dE(r){if(r.tag===13){var a=Wo(r,67108864);a!==null&&ls(a,r,67108864),vg(r,67108864)}}var Pd=!0;function kC(r,a,c,d){var g=W.T;W.T=null;var _=X.p;try{X.p=2,_g(r,a,c,d)}finally{X.p=_,W.T=g}}function DC(r,a,c,d){var g=W.T;W.T=null;var _=X.p;try{X.p=8,_g(r,a,c,d)}finally{X.p=_,W.T=g}}function _g(r,a,c,d){if(Pd){var g=bg(d);if(g===null)ag(r,a,d,Ld,c),pE(r,d);else if(PC(g,r,a,c,d))d.stopPropagation();else if(pE(r,d),a&4&&-1<MC.indexOf(r)){for(;g!==null;){var _=Qs(g);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var x=Ls(_.pendingLanes);if(x!==0){var D=_;for(D.pendingLanes|=2,D.entangledLanes|=2;x;){var G=1<<31-Tn(x);D.entanglements[1]|=G,x&=~G}hi(_),(le&6)===0&&(vd=Gn()+500,Xc(0))}}break;case 13:D=Wo(_,2),D!==null&&ls(D,_,2),bd(),vg(_,2)}if(_=bg(d),_===null&&ag(r,a,d,Ld,c),_===g)break;g=_}g!==null&&d.stopPropagation()}else ag(r,a,d,null,c)}}function bg(r){return r=ys(r),Ag(r)}var Ld=null;function Ag(r){if(Ld=null,r=Ni(r),r!==null){var a=o(r);if(a===null)r=null;else{var c=a.tag;if(c===13){if(r=l(a),r!==null)return r;r=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Ld=r,null}function fE(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Sp()){case ec:return 2;case Co:return 8;case Aa:case Tp:return 32;case Ro:return 268435456;default:return 32}default:return 32}}var Eg=!1,zr=null,Hr=null,Gr=null,iu=new Map,ru=new Map,qr=[],MC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pE(r,a){switch(r){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":iu.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ru.delete(a.pointerId)}}function au(r,a,c,d,g,_){return r===null||r.nativeEvent!==_?(r={blockedOn:a,domEventName:c,eventSystemFlags:d,nativeEvent:_,targetContainers:[g]},a!==null&&(a=Qs(a),a!==null&&dE(a)),r):(r.eventSystemFlags|=d,a=r.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),r)}function PC(r,a,c,d,g){switch(a){case"focusin":return zr=au(zr,r,a,c,d,g),!0;case"dragenter":return Hr=au(Hr,r,a,c,d,g),!0;case"mouseover":return Gr=au(Gr,r,a,c,d,g),!0;case"pointerover":var _=g.pointerId;return iu.set(_,au(iu.get(_)||null,r,a,c,d,g)),!0;case"gotpointercapture":return _=g.pointerId,ru.set(_,au(ru.get(_)||null,r,a,c,d,g)),!0}return!1}function mE(r){var a=Ni(r.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){r.blockedOn=a,bh(r.priority,function(){if(c.tag===13){var d=os();d=_r(d);var g=Wo(c,d);g!==null&&ls(g,c,d),vg(c,d)}});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Od(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var c=bg(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);Pi=d,c.target.dispatchEvent(d),Pi=null}else return a=Qs(c),a!==null&&dE(a),r.blockedOn=c,!1;a.shift()}return!0}function gE(r,a,c){Od(r)&&c.delete(a)}function LC(){Eg=!1,zr!==null&&Od(zr)&&(zr=null),Hr!==null&&Od(Hr)&&(Hr=null),Gr!==null&&Od(Gr)&&(Gr=null),iu.forEach(gE),ru.forEach(gE)}function jd(r,a){r.blockedOn===a&&(r.blockedOn=null,Eg||(Eg=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,LC)))}var Vd=null;function yE(r){Vd!==r&&(Vd=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Vd===r&&(Vd=null);for(var a=0;a<r.length;a+=3){var c=r[a],d=r[a+1],g=r[a+2];if(typeof d!="function"){if(Ag(d||c)===null)continue;break}var _=Qs(c);_!==null&&(r.splice(a,3),a-=3,Am(_,{pending:!0,data:g,method:c.method,action:d},d,g))}}))}function ou(r){function a(G){return jd(G,r)}zr!==null&&jd(zr,r),Hr!==null&&jd(Hr,r),Gr!==null&&jd(Gr,r),iu.forEach(a),ru.forEach(a);for(var c=0;c<qr.length;c++){var d=qr[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<qr.length&&(c=qr[0],c.blockedOn===null);)mE(c),c.blockedOn===null&&qr.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var g=c[d],_=c[d+1],x=g[ze]||null;if(typeof _=="function")x||yE(c);else if(x){var D=null;if(_&&_.hasAttribute("formAction")){if(g=_,x=_[ze]||null)D=x.formAction;else if(Ag(g)!==null)continue}else D=x.action;typeof D=="function"?c[d+1]=D:(c.splice(d,3),d-=3),yE(c)}}}function wg(r){this._internalRoot=r}Ud.prototype.render=wg.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(n(409));var c=a.current,d=os();uE(c,d,r,a,null,null)},Ud.prototype.unmount=wg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;uE(r.current,2,null,r,null,null),bd(),a[ms]=null}};function Ud(r){this._internalRoot=r}Ud.prototype.unstable_scheduleHydration=function(r){if(r){var a=br();r={blockedOn:null,target:r,priority:a};for(var c=0;c<qr.length&&a!==0&&a<qr[c].priority;c++);qr.splice(c,0,r),c===0&&mE(r)}};var vE=t.version;if(vE!=="19.1.1")throw Error(n(527,vE,"19.1.1"));X.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(a),r=r!==null?f(r):null,r=r===null?null:r.stateNode,r};var OC={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fd.isDisabled&&Fd.supportsFiber)try{Ne=Fd.inject(OC),oe=Fd}catch{}}return cu.createRoot=function(r,a){if(!s(r))throw Error(n(299));var c=!1,d="",g=Pb,_=Lb,x=Ob,D=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(_=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(D=a.unstable_transitionCallbacks)),a=lE(r,1,!1,null,null,c,d,g,_,x,D,null),r[ms]=a.current,rg(r),new wg(a)},cu.hydrateRoot=function(r,a,c){if(!s(r))throw Error(n(299));var d=!1,g="",_=Pb,x=Lb,D=Ob,G=null,J=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(x=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(G=c.unstable_transitionCallbacks),c.formState!==void 0&&(J=c.formState)),a=lE(r,1,!0,a,c??null,d,g,_,x,D,G,J),a.context=cE(null),c=a.current,d=os(),d=_r(d),g=Rr(d),g.callback=null,Ir(c,g,d),c=d,a.current.lanes=c,Ii(a,c),hi(a),r[ms]=a.current,rg(r),new Ud(a)},cu.version="19.1.1",cu}var NE;function WC(){if(NE)return Cg.exports;NE=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(t){console.error(t)}}return i(),Cg.exports=KC(),Cg.exports}var YC=WC();/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var kE="popstate";function XC(i={}){function t(s,o){let{pathname:l="/",search:u="",hash:h=""}=bo(s.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),sy("",{pathname:l,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function e(s,o){let l=s.document.querySelector("base"),u="";if(l&&l.getAttribute("href")){let h=s.location.href,f=h.indexOf("#");u=f===-1?h:h.slice(0,f)}return u+"#"+(typeof o=="string"?o:Pu(o))}function n(s,o){ks(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return ZC(t,e,n,i)}function xe(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function ks(i,t){if(!i){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function QC(){return Math.random().toString(36).substring(2,10)}function DE(i,t){return{usr:i.state,key:i.key,idx:t}}function sy(i,t,e=null,n){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof t=="string"?bo(t):t,state:e,key:t&&t.key||n||QC()}}function Pu({pathname:i="/",search:t="",hash:e=""}){return t&&t!=="?"&&(i+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(i+=e.charAt(0)==="#"?e:"#"+e),i}function bo(i){let t={};if(i){let e=i.indexOf("#");e>=0&&(t.hash=i.substring(e),i=i.substring(0,e));let n=i.indexOf("?");n>=0&&(t.search=i.substring(n),i=i.substring(0,n)),i&&(t.pathname=i)}return t}function ZC(i,t,e,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,l=s.history,u="POP",h=null,f=m();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function m(){return(l.state||{idx:null}).idx}function v(){u="POP";let N=m(),R=N==null?null:N-f;f=N,h&&h({action:u,location:S.location,delta:R})}function b(N,R){u="PUSH";let V=sy(S.location,N,R);e&&e(V,N),f=m()+1;let M=DE(V,f),B=S.createHref(V);try{l.pushState(M,"",B)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(B)}o&&h&&h({action:u,location:S.location,delta:1})}function A(N,R){u="REPLACE";let V=sy(S.location,N,R);e&&e(V,N),f=m();let M=DE(V,f),B=S.createHref(V);l.replaceState(M,"",B),o&&h&&h({action:u,location:S.location,delta:0})}function w(N){return JC(N)}let S={get action(){return u},get location(){return i(s,l)},listen(N){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(kE,v),h=N,()=>{s.removeEventListener(kE,v),h=null}},createHref(N){return t(s,N)},createURL:w,encodeLocation(N){let R=w(N);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:b,replace:A,go(N){return l.go(N)}};return S}function JC(i,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),xe(e,"No window.location.(origin|href) available to create URL");let n=typeof i=="string"?i:Pu(i);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=e+n),new URL(n,e)}function U0(i,t,e="/"){return tR(i,t,e,!1)}function tR(i,t,e,n){let s=typeof t=="string"?bo(t):t,o=hr(s.pathname||"/",e);if(o==null)return null;let l=F0(i);eR(l);let u=null;for(let h=0;u==null&&h<l.length;++h){let f=dR(o);u=uR(l[h],f,n)}return u}function F0(i,t=[],e=[],n="",s=!1){let o=(l,u,h=s,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&h)return;xe(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let v=or([n,m.relativePath]),b=e.concat(m);l.children&&l.children.length>0&&(xe(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),F0(l.children,t,b,v,h)),!(l.path==null&&!l.index)&&t.push({path:v,score:lR(v,l.index),routesMeta:b})};return i.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let h of B0(l.path))o(l,u,!0,h)}),t}function B0(i){let t=i.split("/");if(t.length===0)return[];let[e,...n]=t,s=e.endsWith("?"),o=e.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let l=B0(n.join("/")),u=[];return u.push(...l.map(h=>h===""?o:[o,h].join("/"))),s&&u.push(...l),u.map(h=>i.startsWith("/")&&h===""?"/":h)}function eR(i){i.sort((t,e)=>t.score!==e.score?e.score-t.score:cR(t.routesMeta.map(n=>n.childrenIndex),e.routesMeta.map(n=>n.childrenIndex)))}var nR=/^:[\w-]+$/,sR=3,iR=2,rR=1,aR=10,oR=-2,ME=i=>i==="*";function lR(i,t){let e=i.split("/"),n=e.length;return e.some(ME)&&(n+=oR),t&&(n+=iR),e.filter(s=>!ME(s)).reduce((s,o)=>s+(nR.test(o)?sR:o===""?rR:aR),n)}function cR(i,t){return i.length===t.length&&i.slice(0,-1).every((n,s)=>n===t[s])?i[i.length-1]-t[t.length-1]:0}function uR(i,t,e=!1){let{routesMeta:n}=i,s={},o="/",l=[];for(let u=0;u<n.length;++u){let h=n[u],f=u===n.length-1,m=o==="/"?t:t.slice(o.length)||"/",v=_f({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},m),b=h.route;if(!v&&f&&e&&!n[n.length-1].route.index&&(v=_f({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!v)return null;Object.assign(s,v.params),l.push({params:s,pathname:or([o,v.pathname]),pathnameBase:gR(or([o,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(o=or([o,v.pathnameBase]))}return l}function _f(i,t){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[e,n]=hR(i.path,i.caseSensitive,i.end),s=t.match(e);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:n.reduce((f,{paramName:m,isOptional:v},b)=>{if(m==="*"){let w=u[b]||"";l=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const A=u[b];return v&&!A?f[m]=void 0:f[m]=(A||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:l,pattern:i}}function hR(i,t=!1,e=!0){ks(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let n=[],s="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(n.push({paramName:"*"}),s+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":i!==""&&i!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function dR(i){try{return i.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ks(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),i}}function hr(i,t){if(t==="/")return i;if(!i.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,n=i.charAt(e);return n&&n!=="/"?null:i.slice(e)||"/"}function fR(i,t="/"){let{pathname:e,search:n="",hash:s=""}=typeof i=="string"?bo(i):i;return{pathname:e?e.startsWith("/")?e:pR(e,t):t,search:yR(n),hash:vR(s)}}function pR(i,t){let e=t.replace(/\/+$/,"").split("/");return i.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function kg(i,t,e,n){return`Cannot include a '${i}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mR(i){return i.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function Gy(i){let t=mR(i);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function qy(i,t,e,n=!1){let s;typeof i=="string"?s=bo(i):(s={...i},xe(!s.pathname||!s.pathname.includes("?"),kg("?","pathname","search",s)),xe(!s.pathname||!s.pathname.includes("#"),kg("#","pathname","hash",s)),xe(!s.search||!s.search.includes("#"),kg("#","search","hash",s)));let o=i===""||s.pathname==="",l=o?"/":s.pathname,u;if(l==null)u=e;else{let v=t.length-1;if(!n&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),v-=1;s.pathname=b.join("/")}u=v>=0?t[v]:"/"}let h=fR(s,u),f=l&&l!=="/"&&l.endsWith("/"),m=(o||l===".")&&e.endsWith("/");return!h.pathname.endsWith("/")&&(f||m)&&(h.pathname+="/"),h}var or=i=>i.join("/").replace(/\/\/+/g,"/"),gR=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),yR=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,vR=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function _R(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var z0=["POST","PUT","PATCH","DELETE"];new Set(z0);var bR=["GET",...z0];new Set(bR);var ql=z.createContext(null);ql.displayName="DataRouter";var Gf=z.createContext(null);Gf.displayName="DataRouterState";z.createContext(!1);var H0=z.createContext({isTransitioning:!1});H0.displayName="ViewTransition";var AR=z.createContext(new Map);AR.displayName="Fetchers";var ER=z.createContext(null);ER.displayName="Await";var Ws=z.createContext(null);Ws.displayName="Navigation";var Wu=z.createContext(null);Wu.displayName="Location";var Ys=z.createContext({outlet:null,matches:[],isDataRoute:!1});Ys.displayName="Route";var $y=z.createContext(null);$y.displayName="RouteError";function wR(i,{relative:t}={}){xe($l(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:n}=z.useContext(Ws),{hash:s,pathname:o,search:l}=Yu(i,{relative:t}),u=o;return e!=="/"&&(u=o==="/"?e:or([e,o])),n.createHref({pathname:u,search:l,hash:s})}function $l(){return z.useContext(Wu)!=null}function pa(){return xe($l(),"useLocation() may be used only in the context of a <Router> component."),z.useContext(Wu).location}var G0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function q0(i){z.useContext(Ws).static||z.useLayoutEffect(i)}function Ky(){let{isDataRoute:i}=z.useContext(Ys);return i?OR():SR()}function SR(){xe($l(),"useNavigate() may be used only in the context of a <Router> component.");let i=z.useContext(ql),{basename:t,navigator:e}=z.useContext(Ws),{matches:n}=z.useContext(Ys),{pathname:s}=pa(),o=JSON.stringify(Gy(n)),l=z.useRef(!1);return q0(()=>{l.current=!0}),z.useCallback((h,f={})=>{if(ks(l.current,G0),!l.current)return;if(typeof h=="number"){e.go(h);return}let m=qy(h,JSON.parse(o),s,f.relative==="path");i==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:or([t,m.pathname])),(f.replace?e.replace:e.push)(m,f.state,f)},[t,e,o,s,i])}z.createContext(null);function $0(){let{matches:i}=z.useContext(Ys),t=i[i.length-1];return t?t.params:{}}function Yu(i,{relative:t}={}){let{matches:e}=z.useContext(Ys),{pathname:n}=pa(),s=JSON.stringify(Gy(e));return z.useMemo(()=>qy(i,JSON.parse(s),n,t==="path"),[i,s,n,t])}function TR(i,t){return K0(i,t)}function K0(i,t,e,n){xe($l(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=z.useContext(Ws),{matches:o}=z.useContext(Ys),l=o[o.length-1],u=l?l.params:{},h=l?l.pathname:"/",f=l?l.pathnameBase:"/",m=l&&l.route;{let R=m&&m.path||"";W0(h,!m||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let v=pa(),b;if(t){let R=typeof t=="string"?bo(t):t;xe(f==="/"||R.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${R.pathname}" was given in the \`location\` prop.`),b=R}else b=v;let A=b.pathname||"/",w=A;if(f!=="/"){let R=f.replace(/^\//,"").split("/");w="/"+A.replace(/^\//,"").split("/").slice(R.length).join("/")}let S=U0(i,{pathname:w});ks(m||S!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),ks(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=NR(S&&S.map(R=>Object.assign({},R,{params:Object.assign({},u,R.params),pathname:or([f,s.encodeLocation?s.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?f:or([f,s.encodeLocation?s.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),o,e,n);return t&&N?z.createElement(Wu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},N):N}function xR(){let i=LR(),t=_R(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),e=i instanceof Error?i.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",i),l=z.createElement(z.Fragment,null,z.createElement("p",null," Hey developer "),z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",z.createElement("code",{style:o},"ErrorBoundary")," or"," ",z.createElement("code",{style:o},"errorElement")," prop on your route.")),z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),e?z.createElement("pre",{style:s},e):null,l)}var CR=z.createElement(xR,null),RR=class extends z.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,t){return t.location!==i.location||t.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:t.error,location:t.location,revalidation:i.revalidation||t.revalidation}}componentDidCatch(i,t){console.error("React Router caught the following error during render",i,t)}render(){return this.state.error!==void 0?z.createElement(Ys.Provider,{value:this.props.routeContext},z.createElement($y.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function IR({routeContext:i,match:t,children:e}){let n=z.useContext(ql);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),z.createElement(Ys.Provider,{value:i},e)}function NR(i,t=[],e=null,n=null){if(i==null){if(!e)return null;if(e.errors)i=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)i=e.matches;else return null}let s=i,o=e?.errors;if(o!=null){let h=s.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);xe(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,h+1))}let l=!1,u=-1;if(e)for(let h=0;h<s.length;h++){let f=s[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:m,errors:v}=e,b=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||b){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((h,f,m)=>{let v,b=!1,A=null,w=null;e&&(v=o&&f.route.id?o[f.route.id]:void 0,A=f.route.errorElement||CR,l&&(u<0&&m===0?(W0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):u===m&&(b=!0,w=f.route.hydrateFallbackElement||null)));let S=t.concat(s.slice(0,m+1)),N=()=>{let R;return v?R=A:b?R=w:f.route.Component?R=z.createElement(f.route.Component,null):f.route.element?R=f.route.element:R=h,z.createElement(IR,{match:f,routeContext:{outlet:h,matches:S,isDataRoute:e!=null},children:R})};return e&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?z.createElement(RR,{location:e.location,revalidation:e.revalidation,component:A,error:v,children:N(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):N()},null)}function Wy(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function kR(i){let t=z.useContext(ql);return xe(t,Wy(i)),t}function DR(i){let t=z.useContext(Gf);return xe(t,Wy(i)),t}function MR(i){let t=z.useContext(Ys);return xe(t,Wy(i)),t}function Yy(i){let t=MR(i),e=t.matches[t.matches.length-1];return xe(e.route.id,`${i} can only be used on routes that contain a unique "id"`),e.route.id}function PR(){return Yy("useRouteId")}function LR(){let i=z.useContext($y),t=DR("useRouteError"),e=Yy("useRouteError");return i!==void 0?i:t.errors?.[e]}function OR(){let{router:i}=kR("useNavigate"),t=Yy("useNavigate"),e=z.useRef(!1);return q0(()=>{e.current=!0}),z.useCallback(async(s,o={})=>{ks(e.current,G0),e.current&&(typeof s=="number"?i.navigate(s):await i.navigate(s,{fromRouteId:t,...o}))},[i,t])}var PE={};function W0(i,t,e){!t&&!PE[i]&&(PE[i]=!0,ks(!1,e))}z.memo(jR);function jR({routes:i,future:t,state:e}){return K0(i,void 0,e,t)}function Cl({to:i,replace:t,state:e,relative:n}){xe($l(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=z.useContext(Ws);ks(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=z.useContext(Ys),{pathname:l}=pa(),u=Ky(),h=qy(i,Gy(o),l,n==="path"),f=JSON.stringify(h);return z.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:n})},[u,f,n,t,e]),null}function Ji(i){xe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function VR({basename:i="/",children:t=null,location:e,navigationType:n="POP",navigator:s,static:o=!1}){xe(!$l(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=i.replace(/^\/*/,"/"),u=z.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);typeof e=="string"&&(e=bo(e));let{pathname:h="/",search:f="",hash:m="",state:v=null,key:b="default"}=e,A=z.useMemo(()=>{let w=hr(h,l);return w==null?null:{location:{pathname:w,search:f,hash:m,state:v,key:b},navigationType:n}},[l,h,f,m,v,b,n]);return ks(A!=null,`<Router basename="${l}"> is not able to match the URL "${h}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:z.createElement(Ws.Provider,{value:u},z.createElement(Wu.Provider,{children:t,value:A}))}function UR({children:i,location:t}){return TR(iy(i),t)}function iy(i,t=[]){let e=[];return z.Children.forEach(i,(n,s)=>{if(!z.isValidElement(n))return;let o=[...t,s];if(n.type===z.Fragment){e.push.apply(e,iy(n.props.children,o));return}xe(n.type===Ji,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xe(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=iy(n.props.children,o)),e.push(l)}),e}var sf="get",rf="application/x-www-form-urlencoded";function qf(i){return i!=null&&typeof i.tagName=="string"}function FR(i){return qf(i)&&i.tagName.toLowerCase()==="button"}function BR(i){return qf(i)&&i.tagName.toLowerCase()==="form"}function zR(i){return qf(i)&&i.tagName.toLowerCase()==="input"}function HR(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function GR(i,t){return i.button===0&&(!t||t==="_self")&&!HR(i)}var Bd=null;function qR(){if(Bd===null)try{new FormData(document.createElement("form"),0),Bd=!1}catch{Bd=!0}return Bd}var $R=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dg(i){return i!=null&&!$R.has(i)?(ks(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${rf}"`),null):i}function KR(i,t){let e,n,s,o,l;if(BR(i)){let u=i.getAttribute("action");n=u?hr(u,t):null,e=i.getAttribute("method")||sf,s=Dg(i.getAttribute("enctype"))||rf,o=new FormData(i)}else if(FR(i)||zR(i)&&(i.type==="submit"||i.type==="image")){let u=i.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=i.getAttribute("formaction")||u.getAttribute("action");if(n=h?hr(h,t):null,e=i.getAttribute("formmethod")||u.getAttribute("method")||sf,s=Dg(i.getAttribute("formenctype"))||Dg(u.getAttribute("enctype"))||rf,o=new FormData(u,i),!qR()){let{name:f,type:m,value:v}=i;if(m==="image"){let b=f?`${f}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else f&&o.append(f,v)}}else{if(qf(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=sf,n=null,s=rf,l=i}return o&&s==="text/plain"&&(l=o,o=void 0),{action:n,method:e.toLowerCase(),encType:s,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xy(i,t){if(i===!1||i===null||typeof i>"u")throw new Error(t)}function WR(i,t,e){let n=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return n.pathname==="/"?n.pathname=`_root.${e}`:t&&hr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${e}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${e}`,n}async function YR(i,t){if(i.id in t)return t[i.id];try{let e=await import(i.module);return t[i.id]=e,e}catch(e){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function XR(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function QR(i,t,e){let n=await Promise.all(i.map(async s=>{let o=t.routes[s.route.id];if(o){let l=await YR(o,e);return l.links?l.links():[]}return[]}));return eI(n.flat(1).filter(XR).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function LE(i,t,e,n,s,o){let l=(h,f)=>e[f]?h.route.id!==e[f].route.id:!0,u=(h,f)=>e[f].pathname!==h.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==h.params["*"];return o==="assets"?t.filter((h,f)=>l(h,f)||u(h,f)):o==="data"?t.filter((h,f)=>{let m=n.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(l(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function ZR(i,t,{includeHydrateFallback:e}={}){return JR(i.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function JR(i){return[...new Set(i)]}function tI(i){let t={},e=Object.keys(i).sort();for(let n of e)t[n]=i[n];return t}function eI(i,t){let e=new Set;return new Set(t),i.reduce((n,s)=>{let o=JSON.stringify(tI(s));return e.has(o)||(e.add(o),n.push({key:o,link:s})),n},[])}function Y0(){let i=z.useContext(ql);return Xy(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function nI(){let i=z.useContext(Gf);return Xy(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Qy=z.createContext(void 0);Qy.displayName="FrameworkContext";function X0(){let i=z.useContext(Qy);return Xy(i,"You must render this element inside a <HydratedRouter> element"),i}function sI(i,t){let e=z.useContext(Qy),[n,s]=z.useState(!1),[o,l]=z.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:m,onTouchStart:v}=t,b=z.useRef(null);z.useEffect(()=>{if(i==="render"&&l(!0),i==="viewport"){let S=R=>{R.forEach(V=>{l(V.isIntersecting)})},N=new IntersectionObserver(S,{threshold:.5});return b.current&&N.observe(b.current),()=>{N.disconnect()}}},[i]),z.useEffect(()=>{if(n){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[n]);let A=()=>{s(!0)},w=()=>{s(!1),l(!1)};return e?i!=="intent"?[o,b,{}]:[o,b,{onFocus:uu(u,A),onBlur:uu(h,w),onMouseEnter:uu(f,A),onMouseLeave:uu(m,w),onTouchStart:uu(v,A)}]:[!1,b,{}]}function uu(i,t){return e=>{i&&i(e),e.defaultPrevented||t(e)}}function iI({page:i,...t}){let{router:e}=Y0(),n=z.useMemo(()=>U0(e.routes,i,e.basename),[e.routes,i,e.basename]);return n?z.createElement(aI,{page:i,matches:n,...t}):null}function rI(i){let{manifest:t,routeModules:e}=X0(),[n,s]=z.useState([]);return z.useEffect(()=>{let o=!1;return QR(i,t,e).then(l=>{o||s(l)}),()=>{o=!0}},[i,t,e]),n}function aI({page:i,matches:t,...e}){let n=pa(),{manifest:s,routeModules:o}=X0(),{basename:l}=Y0(),{loaderData:u,matches:h}=nI(),f=z.useMemo(()=>LE(i,t,h,s,n,"data"),[i,t,h,s,n]),m=z.useMemo(()=>LE(i,t,h,s,n,"assets"),[i,t,h,s,n]),v=z.useMemo(()=>{if(i===n.pathname+n.search+n.hash)return[];let w=new Set,S=!1;if(t.forEach(R=>{let V=s.routes[R.route.id];!V||!V.hasLoader||(!f.some(M=>M.route.id===R.route.id)&&R.route.id in u&&o[R.route.id]?.shouldRevalidate||V.hasClientLoader?S=!0:w.add(R.route.id))}),w.size===0)return[];let N=WR(i,l,"data");return S&&w.size>0&&N.searchParams.set("_routes",t.filter(R=>w.has(R.route.id)).map(R=>R.route.id).join(",")),[N.pathname+N.search]},[l,u,n,s,f,t,i,o]),b=z.useMemo(()=>ZR(m,s),[m,s]),A=rI(m);return z.createElement(z.Fragment,null,v.map(w=>z.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...e})),b.map(w=>z.createElement("link",{key:w,rel:"modulepreload",href:w,...e})),A.map(({key:w,link:S})=>z.createElement("link",{key:w,nonce:e.nonce,...S})))}function oI(...i){return t=>{i.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var Q0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Q0&&(window.__reactRouterVersion="7.8.1")}catch{}function lI({basename:i,children:t,window:e}){let n=z.useRef();n.current==null&&(n.current=XC({window:e,v5Compat:!0}));let s=n.current,[o,l]=z.useState({action:s.action,location:s.location}),u=z.useCallback(h=>{z.startTransition(()=>l(h))},[l]);return z.useLayoutEffect(()=>s.listen(u),[s,u]),z.createElement(VR,{basename:i,children:t,location:o.location,navigationType:o.action,navigator:s})}var Z0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ns=z.forwardRef(function({onClick:t,discover:e="render",prefetch:n="none",relative:s,reloadDocument:o,replace:l,state:u,target:h,to:f,preventScrollReset:m,viewTransition:v,...b},A){let{basename:w}=z.useContext(Ws),S=typeof f=="string"&&Z0.test(f),N,R=!1;if(typeof f=="string"&&S&&(N=f,Q0))try{let k=new URL(window.location.href),O=f.startsWith("//")?new URL(k.protocol+f):new URL(f),U=hr(O.pathname,w);O.origin===k.origin&&U!=null?f=U+O.search+O.hash:R=!0}catch{ks(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let V=wR(f,{relative:s}),[M,B,L]=sI(n,b),F=dI(f,{replace:l,state:u,target:h,preventScrollReset:m,relative:s,viewTransition:v});function C(k){t&&t(k),k.defaultPrevented||F(k)}let I=z.createElement("a",{...b,...L,href:N||V,onClick:R||o?t:C,ref:oI(A,B),target:h,"data-discover":!S&&e==="render"?"true":void 0});return M&&!S?z.createElement(z.Fragment,null,I,z.createElement(iI,{page:V})):I});Ns.displayName="Link";var cI=z.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:n="",end:s=!1,style:o,to:l,viewTransition:u,children:h,...f},m){let v=Yu(l,{relative:f.relative}),b=pa(),A=z.useContext(Gf),{navigator:w,basename:S}=z.useContext(Ws),N=A!=null&&yI(v)&&u===!0,R=w.encodeLocation?w.encodeLocation(v).pathname:v.pathname,V=b.pathname,M=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;e||(V=V.toLowerCase(),M=M?M.toLowerCase():null,R=R.toLowerCase()),M&&S&&(M=hr(M,S)||M);const B=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let L=V===R||!s&&V.startsWith(R)&&V.charAt(B)==="/",F=M!=null&&(M===R||!s&&M.startsWith(R)&&M.charAt(R.length)==="/"),C={isActive:L,isPending:F,isTransitioning:N},I=L?t:void 0,k;typeof n=="function"?k=n(C):k=[n,L?"active":null,F?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let O=typeof o=="function"?o(C):o;return z.createElement(Ns,{...f,"aria-current":I,className:k,ref:m,style:O,to:l,viewTransition:u},typeof h=="function"?h(C):h)});cI.displayName="NavLink";var uI=z.forwardRef(({discover:i="render",fetcherKey:t,navigate:e,reloadDocument:n,replace:s,state:o,method:l=sf,action:u,onSubmit:h,relative:f,preventScrollReset:m,viewTransition:v,...b},A)=>{let w=mI(),S=gI(u,{relative:f}),N=l.toLowerCase()==="get"?"get":"post",R=typeof u=="string"&&Z0.test(u),V=M=>{if(h&&h(M),M.defaultPrevented)return;M.preventDefault();let B=M.nativeEvent.submitter,L=B?.getAttribute("formmethod")||l;w(B||M.currentTarget,{fetcherKey:t,method:L,navigate:e,replace:s,state:o,relative:f,preventScrollReset:m,viewTransition:v})};return z.createElement("form",{ref:A,method:N,action:S,onSubmit:n?h:V,...b,"data-discover":!R&&i==="render"?"true":void 0})});uI.displayName="Form";function hI(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function J0(i){let t=z.useContext(ql);return xe(t,hI(i)),t}function dI(i,{target:t,replace:e,state:n,preventScrollReset:s,relative:o,viewTransition:l}={}){let u=Ky(),h=pa(),f=Yu(i,{relative:o});return z.useCallback(m=>{if(GR(m,t)){m.preventDefault();let v=e!==void 0?e:Pu(h)===Pu(f);u(i,{replace:v,state:n,preventScrollReset:s,relative:o,viewTransition:l})}},[h,u,f,e,n,t,i,s,o,l])}var fI=0,pI=()=>`__${String(++fI)}__`;function mI(){let{router:i}=J0("useSubmit"),{basename:t}=z.useContext(Ws),e=PR();return z.useCallback(async(n,s={})=>{let{action:o,method:l,encType:u,formData:h,body:f}=KR(n,t);if(s.navigate===!1){let m=s.fetcherKey||pI();await i.fetch(m,e,s.action||o,{preventScrollReset:s.preventScrollReset,formData:h,body:f,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await i.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:h,body:f,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:e,flushSync:s.flushSync,viewTransition:s.viewTransition})},[i,t,e])}function gI(i,{relative:t}={}){let{basename:e}=z.useContext(Ws),n=z.useContext(Ys);xe(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...Yu(i||".",{relative:t})},l=pa();if(i==null){o.search=l.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(m=>m==="")){u.delete("index"),h.filter(v=>v).forEach(v=>u.append("index",v));let m=u.toString();o.search=m?`?${m}`:""}}return(!i||i===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(o.pathname=o.pathname==="/"?e:or([e,o.pathname])),Pu(o)}function yI(i,{relative:t}={}){let e=z.useContext(H0);xe(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=J0("useViewTransitionState"),s=Yu(i,{relative:t});if(!e.isTransitioning)return!1;let o=hr(e.currentLocation.pathname,n)||e.currentLocation.pathname,l=hr(e.nextLocation.pathname,n)||e.nextLocation.pathname;return _f(s.pathname,l)!=null||_f(s.pathname,o)!=null}const vI=()=>{};var OE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=function(i){const t=[];let e=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},_I=function(i){const t=[];let e=0,n=0;for(;e<i.length;){const s=i[e++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=i[e++];t[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=i[e++],l=i[e++],u=i[e++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;t[n++]=String.fromCharCode(55296+(h>>10)),t[n++]=String.fromCharCode(56320+(h&1023))}else{const o=i[e++],l=i[e++];t[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return t.join("")},eS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,t){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const o=i[s],l=s+1<i.length,u=l?i[s+1]:0,h=s+2<i.length,f=h?i[s+2]:0,m=o>>2,v=(o&3)<<4|u>>4;let b=(u&15)<<2|f>>6,A=f&63;h||(A=64,l||(b=64)),n.push(e[m],e[v],e[b],e[A])}return n.join("")},encodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(i):this.encodeByteArray(tS(i),t)},decodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(i):_I(this.decodeStringToByteArray(i,t))},decodeStringToByteArray(i,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const o=e[i.charAt(s++)],u=s<i.length?e[i.charAt(s)]:0;++s;const f=s<i.length?e[i.charAt(s)]:64;++s;const v=s<i.length?e[i.charAt(s)]:64;if(++s,o==null||u==null||f==null||v==null)throw new bI;const b=o<<2|u>>4;if(n.push(b),f!==64){const A=u<<4&240|f>>2;if(n.push(A),v!==64){const w=f<<6&192|v;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class bI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AI=function(i){const t=tS(i);return eS.encodeByteArray(t,!0)},bf=function(i){return AI(i).replace(/\./g,"")},nS=function(i){try{return eS.decodeString(i,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=()=>EI().__FIREBASE_DEFAULTS__,SI=()=>{if(typeof process>"u"||typeof OE>"u")return;const i=OE.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},TI=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=i&&nS(i[1]);return t&&JSON.parse(t)},$f=()=>{try{return vI()||wI()||SI()||TI()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},sS=i=>$f()?.emulatorHosts?.[i],iS=i=>{const t=sS(i);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},rS=()=>$f()?.config,aS=i=>$f()?.[`_${i}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ao(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Zy(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(i,t){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",s=i.iat||0,o=i.sub||i.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...i};return[bf(JSON.stringify(e)),bf(JSON.stringify(l)),""].join(".")}const xu={};function CI(){const i={prod:[],emulator:[]};for(const t of Object.keys(xu))xu[t]?i.emulator.push(t):i.prod.push(t);return i}function RI(i){let t=document.getElementById(i),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",i),e=!0),{created:e,element:t}}let jE=!1;function Jy(i,t){if(typeof window>"u"||typeof document>"u"||!Ao(window.location.host)||xu[i]===t||xu[i]||jE)return;xu[i]=t;function e(b){return`__firebase__banner__${b}`}const n="__firebase__banner",o=CI().prod.length>0;function l(){const b=document.getElementById(n);b&&b.remove()}function u(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,A){b.setAttribute("width","24"),b.setAttribute("id",A),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function f(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{jE=!0,l()},b}function m(b,A){b.setAttribute("id",A),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=RI(n),A=e("text"),w=document.getElementById(A)||document.createElement("span"),S=e("learnmore"),N=document.getElementById(S)||document.createElement("a"),R=e("preprendIcon"),V=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const M=b.element;u(M),m(N,S);const B=f();h(V,R),M.append(V,w,N,B),document.body.appendChild(M)}o?(w.innerText="Preview backend disconnected.",V.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(V.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function II(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dn())}function NI(){const i=$f()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DI(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function MI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PI(){const i=Dn();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function LI(){return!NI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OI(){try{return typeof indexedDB=="object"}catch{return!1}}function jI(){return new Promise((i,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="FirebaseError";class xi extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=VI,Object.setPrototypeOf(this,xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xu.prototype.create)}}class Xu{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],l=o?UI(o,n):"Error",u=`${this.serviceName}: ${l} (${s}).`;return new xi(s,u,n)}}function UI(i,t){return i.replace(FI,(e,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const FI=/\{\$([^}]+)}/g;function BI(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}function uo(i,t){if(i===t)return!0;const e=Object.keys(i),n=Object.keys(t);for(const s of e){if(!n.includes(s))return!1;const o=i[s],l=t[s];if(VE(o)&&VE(l)){if(!uo(o,l))return!1}else if(o!==l)return!1}for(const s of n)if(!e.includes(s))return!1;return!0}function VE(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(i){const t=[];for(const[e,n]of Object.entries(i))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function yu(i){const t={};return i.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,o]=n.split("=");t[decodeURIComponent(s)]=decodeURIComponent(o)}}),t}function vu(i){const t=i.indexOf("?");if(!t)return"";const e=i.indexOf("#",t);return i.substring(t,e>0?e:void 0)}function zI(i,t){const e=new HI(i,t);return e.subscribe.bind(e)}class HI{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let s;if(t===void 0&&e===void 0&&n===void 0)throw new Error("Missing Observer.");GI(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:n},s.next===void 0&&(s.next=Mg),s.error===void 0&&(s.error=Mg),s.complete===void 0&&(s.complete=Mg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GI(i,t){if(typeof i!="object"||i===null)return!1;for(const e of t)if(e in i&&typeof i[e]=="function")return!0;return!1}function Mg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(i){return i&&i._delegate?i._delegate:i}class ra{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new xI;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(KI(t))try{this.getOrInitializeService({instanceIdentifier:eo})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(t=eo){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=eo){return this.instances.has(t)}getOptions(t=eo){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(s)}return s}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(n)??new Set;s.add(t),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&t(o,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$I(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=eo){return this.component?this.component.multipleInstances?t:eo:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $I(i){return i===eo?void 0:i}function KI(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new qI(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Kt||(Kt={}));const YI={debug:Kt.DEBUG,verbose:Kt.VERBOSE,info:Kt.INFO,warn:Kt.WARN,error:Kt.ERROR,silent:Kt.SILENT},XI=Kt.INFO,QI={[Kt.DEBUG]:"log",[Kt.VERBOSE]:"log",[Kt.INFO]:"info",[Kt.WARN]:"warn",[Kt.ERROR]:"error"},ZI=(i,t,...e)=>{if(t<i.logLevel)return;const n=new Date().toISOString(),s=QI[t];if(s)console[s](`[${n}]  ${i.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class tv{constructor(t){this.name=t,this._logLevel=XI,this._logHandler=ZI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Kt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?YI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Kt.DEBUG,...t),this._logHandler(this,Kt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Kt.VERBOSE,...t),this._logHandler(this,Kt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Kt.INFO,...t),this._logHandler(this,Kt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Kt.WARN,...t),this._logHandler(this,Kt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Kt.ERROR,...t),this._logHandler(this,Kt.ERROR,...t)}}const JI=(i,t)=>t.some(e=>i instanceof e);let UE,FE;function tN(){return UE||(UE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eN(){return FE||(FE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lS=new WeakMap,ry=new WeakMap,cS=new WeakMap,Pg=new WeakMap,ev=new WeakMap;function nN(i){const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("success",o),i.removeEventListener("error",l)},o=()=>{e(ea(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",o),i.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&lS.set(e,i)}).catch(()=>{}),ev.set(t,i),t}function sN(i){if(ry.has(i))return;const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("complete",o),i.removeEventListener("error",l),i.removeEventListener("abort",l)},o=()=>{e(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",o),i.addEventListener("error",l),i.addEventListener("abort",l)});ry.set(i,t)}let ay={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return ry.get(i);if(t==="objectStoreNames")return i.objectStoreNames||cS.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return ea(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function iN(i){ay=i(ay)}function rN(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=i.call(Lg(this),t,...e);return cS.set(n,t.sort?t.sort():[t]),ea(n)}:eN().includes(i)?function(...t){return i.apply(Lg(this),t),ea(lS.get(this))}:function(...t){return ea(i.apply(Lg(this),t))}}function aN(i){return typeof i=="function"?rN(i):(i instanceof IDBTransaction&&sN(i),JI(i,tN())?new Proxy(i,ay):i)}function ea(i){if(i instanceof IDBRequest)return nN(i);if(Pg.has(i))return Pg.get(i);const t=aN(i);return t!==i&&(Pg.set(i,t),ev.set(t,i)),t}const Lg=i=>ev.get(i);function oN(i,t,{blocked:e,upgrade:n,blocking:s,terminated:o}={}){const l=indexedDB.open(i,t),u=ea(l);return n&&l.addEventListener("upgradeneeded",h=>{n(ea(l.result),h.oldVersion,h.newVersion,ea(l.transaction),h)}),e&&l.addEventListener("blocked",h=>e(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),u}const lN=["get","getKey","getAll","getAllKeys","count"],cN=["put","add","delete","clear"],Og=new Map;function BE(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(Og.get(t))return Og.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=cN.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||lN.includes(e)))return;const o=async function(l,...u){const h=this.transaction(l,s?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(u.shift())),(await Promise.all([f[e](...u),s&&h.done]))[0]};return Og.set(t,o),o}iN(i=>({...i,get:(t,e,n)=>BE(t,e)||i.get(t,e,n),has:(t,e)=>!!BE(t,e)||i.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(hN(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function hN(i){return i.getComponent()?.type==="VERSION"}const oy="@firebase/app",zE="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr=new tv("@firebase/app"),dN="@firebase/app-compat",fN="@firebase/analytics-compat",pN="@firebase/analytics",mN="@firebase/app-check-compat",gN="@firebase/app-check",yN="@firebase/auth",vN="@firebase/auth-compat",_N="@firebase/database",bN="@firebase/data-connect",AN="@firebase/database-compat",EN="@firebase/functions",wN="@firebase/functions-compat",SN="@firebase/installations",TN="@firebase/installations-compat",xN="@firebase/messaging",CN="@firebase/messaging-compat",RN="@firebase/performance",IN="@firebase/performance-compat",NN="@firebase/remote-config",kN="@firebase/remote-config-compat",DN="@firebase/storage",MN="@firebase/storage-compat",PN="@firebase/firestore",LN="@firebase/ai",ON="@firebase/firestore-compat",jN="firebase",VN="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly="[DEFAULT]",UN={[oy]:"fire-core",[dN]:"fire-core-compat",[pN]:"fire-analytics",[fN]:"fire-analytics-compat",[gN]:"fire-app-check",[mN]:"fire-app-check-compat",[yN]:"fire-auth",[vN]:"fire-auth-compat",[_N]:"fire-rtdb",[bN]:"fire-data-connect",[AN]:"fire-rtdb-compat",[EN]:"fire-fn",[wN]:"fire-fn-compat",[SN]:"fire-iid",[TN]:"fire-iid-compat",[xN]:"fire-fcm",[CN]:"fire-fcm-compat",[RN]:"fire-perf",[IN]:"fire-perf-compat",[NN]:"fire-rc",[kN]:"fire-rc-compat",[DN]:"fire-gcs",[MN]:"fire-gcs-compat",[PN]:"fire-fst",[ON]:"fire-fst-compat",[LN]:"fire-vertex","fire-js":"fire-js",[jN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af=new Map,FN=new Map,cy=new Map;function HE(i,t){try{i.container.addComponent(t)}catch(e){dr.debug(`Component ${t.name} failed to register with FirebaseApp ${i.name}`,e)}}function ho(i){const t=i.name;if(cy.has(t))return dr.debug(`There were multiple attempts to register component ${t}.`),!1;cy.set(t,i);for(const e of Af.values())HE(e,i);for(const e of FN.values())HE(e,i);return!0}function Kf(i,t){const e=i.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),i.container.getProvider(t)}function Zn(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},na=new Xu("app","Firebase",BN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw na.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=VN;function uS(i,t={}){let e=i;typeof t!="object"&&(t={name:t});const n={name:ly,automaticDataCollectionEnabled:!0,...t},s=n.name;if(typeof s!="string"||!s)throw na.create("bad-app-name",{appName:String(s)});if(e||(e=rS()),!e)throw na.create("no-options");const o=Af.get(s);if(o){if(uo(e,o.options)&&uo(n,o.config))return o;throw na.create("duplicate-app",{appName:s})}const l=new WI(s);for(const h of cy.values())l.addComponent(h);const u=new zN(e,n,l);return Af.set(s,u),u}function nv(i=ly){const t=Af.get(i);if(!t&&i===ly&&rS())return uS();if(!t)throw na.create("no-app",{appName:i});return t}function _i(i,t,e){let n=UN[i]??i;e&&(n+=`-${e}`);const s=n.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const l=[`Unable to register library "${n}" with version "${t}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),dr.warn(l.join(" "));return}ho(new ra(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN="firebase-heartbeat-database",GN=1,Lu="firebase-heartbeat-store";let jg=null;function hS(){return jg||(jg=oN(HN,GN,{upgrade:(i,t)=>{switch(t){case 0:try{i.createObjectStore(Lu)}catch(e){console.warn(e)}}}}).catch(i=>{throw na.create("idb-open",{originalErrorMessage:i.message})})),jg}async function qN(i){try{const e=(await hS()).transaction(Lu),n=await e.objectStore(Lu).get(dS(i));return await e.done,n}catch(t){if(t instanceof xi)dr.warn(t.message);else{const e=na.create("idb-get",{originalErrorMessage:t?.message});dr.warn(e.message)}}}async function GE(i,t){try{const n=(await hS()).transaction(Lu,"readwrite");await n.objectStore(Lu).put(t,dS(i)),await n.done}catch(e){if(e instanceof xi)dr.warn(e.message);else{const n=na.create("idb-set",{originalErrorMessage:e?.message});dr.warn(n.message)}}}function dS(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=1024,KN=30;class WN{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new XN(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=qE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>KN){const s=QN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){dr.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=qE(),{heartbeatsToSend:e,unsentEntries:n}=YN(this._heartbeatsCache.heartbeats),s=bf(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return dr.warn(t),""}}}function qE(){return new Date().toISOString().substring(0,10)}function YN(i,t=$N){const e=[];let n=i.slice();for(const s of i){const o=e.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),$E(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),$E(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class XN{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OI()?jI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await qN(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return GE(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return GE(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function $E(i){return bf(JSON.stringify({version:2,heartbeats:i})).length}function QN(i){if(i.length===0)return-1;let t=0,e=i[0].date;for(let n=1;n<i.length;n++)i[n].date<e&&(e=i[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(i){ho(new ra("platform-logger",t=>new uN(t),"PRIVATE")),ho(new ra("heartbeat",t=>new WN(t),"PRIVATE")),_i(oy,zE,i),_i(oy,zE,"esm2020"),_i("fire-js","")}ZN("");function fS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JN=fS,pS=new Xu("auth","Firebase",fS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef=new tv("@firebase/auth");function tk(i,...t){Ef.logLevel<=Kt.WARN&&Ef.warn(`Auth (${Eo}): ${i}`,...t)}function af(i,...t){Ef.logLevel<=Kt.ERROR&&Ef.error(`Auth (${Eo}): ${i}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(i,...t){throw iv(i,...t)}function Gs(i,...t){return iv(i,...t)}function sv(i,t,e){const n={...JN(),[t]:e};return new Xu("auth","Firebase",n).create(t,{appName:i.name})}function lr(i){return sv(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ek(i,t,e){const n=e;if(!(t instanceof n))throw n.name!==t.constructor.name&&Ds(i,"argument-error"),sv(i,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function iv(i,...t){if(typeof i!="string"){const e=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=i.name),i._errorFactory.create(e,...n)}return pS.create(i,...t)}function kt(i,t,...e){if(!i)throw iv(t,...e)}function rr(i){const t="INTERNAL ASSERTION FAILED: "+i;throw af(t),new Error(t)}function fr(i,t){i||rr(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(){return typeof self<"u"&&self.location?.href||""}function nk(){return KE()==="http:"||KE()==="https:"}function KE(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nk()||DI()||"connection"in navigator)?navigator.onLine:!0}function ik(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(t,e){this.shortDelay=t,this.longDelay=e,fr(e>t,"Short delay should be less than long delay!"),this.isMobile=II()||MI()}get(){return sk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(i,t){fr(i.emulator,"Emulator should always be set here");const{url:e}=i.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;rr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;rr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;rr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ok=new Zu(3e4,6e4);function ma(i,t){return i.tenantId&&!t.tenantId?{...t,tenantId:i.tenantId}:t}async function ga(i,t,e,n,s={}){return gS(i,s,async()=>{let o={},l={};n&&(t==="GET"?l=n:o={body:JSON.stringify(n)});const u=Qu({key:i.config.apiKey,...l}).slice(1),h=await i._getAdditionalHeaders();h["Content-Type"]="application/json",i.languageCode&&(h["X-Firebase-Locale"]=i.languageCode);const f={method:t,headers:h,...o};return kI()||(f.referrerPolicy="no-referrer"),i.emulatorConfig&&Ao(i.emulatorConfig.host)&&(f.credentials="include"),mS.fetch()(await yS(i,i.config.apiHost,e,u),f)})}async function gS(i,t,e){i._canInitEmulator=!1;const n={...rk,...t};try{const s=new ck(i),o=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw zd(i,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,f]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw zd(i,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw zd(i,"email-already-in-use",l);if(h==="USER_DISABLED")throw zd(i,"user-disabled",l);const m=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw sv(i,m,f);Ds(i,m)}}catch(s){if(s instanceof xi)throw s;Ds(i,"network-request-failed",{message:String(s)})}}async function Ju(i,t,e,n,s={}){const o=await ga(i,t,e,n,s);return"mfaPendingCredential"in o&&Ds(i,"multi-factor-auth-required",{_serverResponse:o}),o}async function yS(i,t,e,n){const s=`${t}${e}?${n}`,o=i,l=o.config.emulator?rv(i.config,s):`${i.config.apiScheme}://${s}`;return ak.includes(e)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function lk(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ck{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,n)=>{this.timer=setTimeout(()=>n(Gs(this.auth,"network-request-failed")),ok.get())})}}function zd(i,t,e){const n={appName:i.name};e.email&&(n.email=e.email),e.phoneNumber&&(n.phoneNumber=e.phoneNumber);const s=Gs(i,t,n);return s.customData._tokenResponse=e,s}function WE(i){return i!==void 0&&i.enterprise!==void 0}class uk{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return lk(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function hk(i,t){return ga(i,"GET","/v2/recaptchaConfig",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(i,t){return ga(i,"POST","/v1/accounts:delete",t)}async function wf(i,t){return ga(i,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(i){if(i)try{const t=new Date(Number(i));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function fk(i,t=!1){const e=Fe(i),n=await e.getIdToken(t),s=av(n);kt(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o?.sign_in_provider;return{claims:s,token:n,authTime:Cu(Vg(s.auth_time)),issuedAtTime:Cu(Vg(s.iat)),expirationTime:Cu(Vg(s.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Vg(i){return Number(i)*1e3}function av(i){const[t,e,n]=i.split(".");if(t===void 0||e===void 0||n===void 0)return af("JWT malformed, contained fewer than 3 sections"),null;try{const s=nS(e);return s?JSON.parse(s):(af("Failed to decode base64 JWT payload"),null)}catch(s){return af("Caught error parsing JWT payload as JSON",s?.toString()),null}}function YE(i){const t=av(i);return kt(t,"internal-error"),kt(typeof t.exp<"u","internal-error"),kt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(i,t,e=!1){if(e)return t;try{return await t}catch(n){throw n instanceof xi&&pk(n)&&i.auth.currentUser===i&&await i.auth.signOut(),n}}function pk({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cu(this.lastLoginAt),this.creationTime=Cu(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sf(i){const t=i.auth,e=await i.getIdToken(),n=await Ou(i,wf(t,{idToken:e}));kt(n?.users.length,t,"internal-error");const s=n.users[0];i._notifyReloadListener(s);const o=s.providerUserInfo?.length?vS(s.providerUserInfo):[],l=yk(i.providerData,o),u=i.isAnonymous,h=!(i.email&&s.passwordHash)&&!l?.length,f=u?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new hy(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(i,m)}async function gk(i){const t=Fe(i);await Sf(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function yk(i,t){return[...i.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function vS(i){return i.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vk(i,t){const e=await gS(i,{},async()=>{const n=Qu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:o}=i.config,l=await yS(i,s,"/v1/token",`key=${o}`),u=await i._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return i.emulatorConfig&&Ao(i.emulatorConfig.host)&&(h.credentials="include"),mS.fetch()(l,h)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function _k(i,t){return ga(i,"POST","/v2/accounts:revokeToken",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){kt(t.idToken,"internal-error"),kt(typeof t.idToken<"u","internal-error"),kt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):YE(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){kt(t.length!==0,"internal-error");const e=YE(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(kt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:s,expiresIn:o}=await vk(t,e);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,e){const{refreshToken:n,accessToken:s,expirationTime:o}=e,l=new kl;return n&&(kt(typeof n=="string","internal-error",{appName:t}),l.refreshToken=n),s&&(kt(typeof s=="string","internal-error",{appName:t}),l.accessToken=s),o&&(kt(typeof o=="number","internal-error",{appName:t}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new kl,this.toJSON())}_performRefresh(){return rr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(i,t){kt(typeof i=="string"||typeof i>"u","internal-error",{appName:t})}class zs{constructor({uid:t,auth:e,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new mk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hy(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ou(this,this.stsTokenManager.getToken(this.auth,t));return kt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return fk(this,t)}reload(){return gk(this)}_assign(t){this!==t&&(kt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new zs({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Sf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zn(this.auth.app))return Promise.reject(lr(this.auth));const t=await this.getIdToken();return await Ou(this,dk(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const n=e.displayName??void 0,s=e.email??void 0,o=e.phoneNumber??void 0,l=e.photoURL??void 0,u=e.tenantId??void 0,h=e._redirectEventId??void 0,f=e.createdAt??void 0,m=e.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:A,providerData:w,stsTokenManager:S}=e;kt(v&&S,t,"internal-error");const N=kl.fromJSON(this.name,S);kt(typeof v=="string",t,"internal-error"),Kr(n,t.name),Kr(s,t.name),kt(typeof b=="boolean",t,"internal-error"),kt(typeof A=="boolean",t,"internal-error"),Kr(o,t.name),Kr(l,t.name),Kr(u,t.name),Kr(h,t.name),Kr(f,t.name),Kr(m,t.name);const R=new zs({uid:v,auth:t,email:s,emailVerified:b,displayName:n,isAnonymous:A,photoURL:l,phoneNumber:o,tenantId:u,stsTokenManager:N,createdAt:f,lastLoginAt:m});return w&&Array.isArray(w)&&(R.providerData=w.map(V=>({...V}))),h&&(R._redirectEventId=h),R}static async _fromIdTokenResponse(t,e,n=!1){const s=new kl;s.updateFromServerResponse(e);const o=new zs({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await Sf(o),o}static async _fromGetAccountInfoResponse(t,e,n){const s=e.users[0];kt(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?vS(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!o?.length,u=new kl;u.updateFromIdToken(n);const h=new zs({uid:s.localId,auth:t,stsTokenManager:u,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new hy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(h,f),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE=new Map;function ar(i){fr(i instanceof Function,"Expected a class definition");let t=XE.get(i);return t?(fr(t instanceof i,"Instance stored in cache mismatched with class"),t):(t=new i,XE.set(i,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}_S.type="NONE";const QE=_S;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(i,t,e){return`firebase:${i}:${t}:${e}`}class Dl{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=of(this.userKey,s.apiKey,o),this.fullPersistenceKey=of("persistence",s.apiKey,o),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await wf(this.auth,{idToken:t}).catch(()=>{});return e?zs._fromGetAccountInfoResponse(this.auth,e,t):null}return zs._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Dl(ar(QE),t,n);const s=(await Promise.all(e.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||ar(QE);const l=of(n,t.config.apiKey,t.name);let u=null;for(const f of e)try{const m=await f._get(l);if(m){let v;if(typeof m=="string"){const b=await wf(t,{idToken:m}).catch(()=>{});if(!b)break;v=await zs._fromGetAccountInfoResponse(t,b,m)}else v=zs._fromJSON(t,m);f!==o&&(u=v),o=f;break}}catch{}const h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Dl(o,t,n):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(e.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new Dl(o,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(i){const t=i.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(wS(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(bS(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(TS(t))return"Blackberry";if(xS(t))return"Webos";if(AS(t))return"Safari";if((t.includes("chrome/")||ES(t))&&!t.includes("edge/"))return"Chrome";if(SS(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=i.match(e);if(n?.length===2)return n[1]}return"Other"}function bS(i=Dn()){return/firefox\//i.test(i)}function AS(i=Dn()){const t=i.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ES(i=Dn()){return/crios\//i.test(i)}function wS(i=Dn()){return/iemobile/i.test(i)}function SS(i=Dn()){return/android/i.test(i)}function TS(i=Dn()){return/blackberry/i.test(i)}function xS(i=Dn()){return/webos/i.test(i)}function ov(i=Dn()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function bk(i=Dn()){return ov(i)&&!!window.navigator?.standalone}function Ak(){return PI()&&document.documentMode===10}function CS(i=Dn()){return ov(i)||SS(i)||xS(i)||TS(i)||/windows phone/i.test(i)||wS(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(i,t=[]){let e;switch(i){case"Browser":e=ZE(Dn());break;case"Worker":e=`${ZE(Dn())}-${i}`;break;default:e=i}const n=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Eo}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=o=>new Promise((l,u)=>{try{const h=t(o);l(h)}catch(h){u(h)}});n.onAbort=e,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(n){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wk(i,t={}){return ga(i,"GET","/v2/passwordPolicy",ma(i,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=6;class Tk{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??Sk,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(t,e,n,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new Ek(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ar(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Dl.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await wf(this,{idToken:t}),n=await zs._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(Zn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let n=e,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=n?._redirectEventId,u=await this.tryRedirectSignIn(t);(!o||o===l)&&u?.user&&(n=u.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Sf(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=ik()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Zn(this.app))return Promise.reject(lr(this));const e=t?Fe(t):null;return e&&kt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&kt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Zn(this.app)?Promise.reject(lr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Zn(this.app)?Promise.reject(lr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ar(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await wk(this),e=new Tk(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new Xu("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(n.tenantId=this.tenantId),await _k(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ar(t)||this._popupRedirectResolver;kt(e,this,"argument-error"),this.redirectPersistenceManager=await Dl.create(this,[ar(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,s){if(this._deleted)return()=>{};const o=typeof e=="function"?e:e.next.bind(e);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(kt(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof e=="function"){const h=t.addObserver(e,n,s);return()=>{l=!0,h()}}else{const h=t.addObserver(e);return()=>{l=!0,h()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=RS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){if(Zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&tk(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ya(i){return Fe(i)}class JE{constructor(t){this.auth=t,this.observer=null,this.addObserver=zI(e=>this.observer=e)}get next(){return kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ck(i){Wf=i}function IS(i){return Wf.loadJS(i)}function Rk(){return Wf.recaptchaEnterpriseScript}function Ik(){return Wf.gapiScript}function Nk(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class kk{constructor(){this.enterprise=new Dk}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class Dk{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const Mk="recaptcha-enterprise",NS="NO_RECAPTCHA";class Pk{constructor(t){this.type=Mk,this.auth=ya(t)}async verify(t="verify",e=!1){async function n(o){if(!e){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{hk(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const f=new uk(h);return o.tenantId==null?o._agentRecaptchaConfig=f:o._tenantRecaptchaConfigs[o.tenantId]=f,l(f.siteKey)}}).catch(h=>{u(h)})})}function s(o,l,u){const h=window.grecaptcha;WE(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:t}).then(f=>{l(f)}).catch(()=>{l(NS)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new kk().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(u=>{if(!e&&WE(window.grecaptcha))s(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=Rk();h.length!==0&&(h+=u),IS(h).then(()=>{s(u,o,l)}).catch(f=>{l(f)})}}).catch(u=>{l(u)})})}}async function tw(i,t,e,n=!1,s=!1){const o=new Pk(i);let l;if(s)l=NS;else try{l=await o.verify(e)}catch{l=await o.verify(e,!0)}const u={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,f=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function dy(i,t,e,n,s){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await tw(i,t,e,e==="getOobCode");return n(i,o)}else return n(i,t).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await tw(i,t,e,e==="getOobCode");return n(i,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(i,t){const e=Kf(i,"auth");if(e.isInitialized()){const s=e.getImmediate(),o=e.getOptions();if(uo(o,t??{}))return s;Ds(s,"already-initialized")}return e.initialize({options:t})}function Ok(i,t){const e=t?.persistence||[],n=(Array.isArray(e)?e:[e]).map(ar);t?.errorMap&&i._updateErrorMap(t.errorMap),i._initializeWithPersistence(n,t?.popupRedirectResolver)}function jk(i,t,e){const n=ya(i);kt(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,o=kS(t),{host:l,port:u}=Vk(t),h=u===null?"":`:${u}`,f={url:`${o}//${l}${h}/`},m=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){kt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),kt(uo(f,n.config.emulator)&&uo(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Ao(l)?(Zy(`${o}//${l}${h}`),Jy("Auth",!0)):Uk()}function kS(i){const t=i.indexOf(":");return t<0?"":i.substr(0,t+1)}function Vk(i){const t=kS(i),e=/(\/\/)?([^?#/]+)/.exec(i.substr(t.length));if(!e)return{host:"",port:null};const n=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:ew(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:ew(l)}}}function ew(i){if(!i)return null;const t=Number(i);return isNaN(t)?null:t}function Uk(){function i(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return rr("not implemented")}_getIdTokenResponse(t){return rr("not implemented")}_linkToIdToken(t,e){return rr("not implemented")}_getReauthenticationResolver(t){return rr("not implemented")}}async function Fk(i,t){return ga(i,"POST","/v1/accounts:signUp",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(i,t){return Ju(i,"POST","/v1/accounts:signInWithPassword",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zk(i,t){return Ju(i,"POST","/v1/accounts:signInWithEmailLink",ma(i,t))}async function Hk(i,t){return Ju(i,"POST","/v1/accounts:signInWithEmailLink",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju extends lv{constructor(t,e,n,s=null){super("password",n),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new ju(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new ju(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dy(t,e,"signInWithPassword",Bk);case"emailLink":return zk(t,{email:this._email,oobCode:this._password});default:Ds(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const n={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dy(t,n,"signUpPassword",Fk);case"emailLink":return Hk(t,{idToken:e,email:this._email,oobCode:this._password});default:Ds(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(i,t){return Ju(i,"POST","/v1/accounts:signInWithIdp",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk="http://localhost";class fo extends lv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new fo(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ds("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s,...o}=e;if(!n||!s)return null;const l=new fo(n,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(t){const e=this.buildRequest();return Ml(t,e)}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,Ml(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ml(t,e)}buildRequest(){const t={requestUri:Gk,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Qu(e)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $k(i){const t=yu(vu(i)).link,e=t?yu(vu(t)).deep_link_id:null,n=yu(vu(i)).deep_link_id;return(n?yu(vu(n)).link:null)||n||e||t||i}class cv{constructor(t){const e=yu(vu(t)),n=e.apiKey??null,s=e.oobCode??null,o=qk(e.mode??null);kt(n&&s&&o,"argument-error"),this.apiKey=n,this.operation=o,this.code=s,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=$k(t);try{return new cv(e)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(){this.providerId=Kl.PROVIDER_ID}static credential(t,e){return ju._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=cv.parseLink(e);return kt(n,"argument-error"),ju._fromEmailAndCode(t,n.code,n.tenantId)}}Kl.PROVIDER_ID="password";Kl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Kl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th extends uv{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends th{constructor(){super("facebook.com")}static credential(t){return fo._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Yr.credentialFromTaggedObject(t)}static credentialFromError(t){return Yr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Yr.credential(t.oauthAccessToken)}catch{return null}}}Yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends th{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return fo._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return ir.credentialFromTaggedObject(t)}static credentialFromError(t){return ir.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return ir.credential(e,n)}catch{return null}}}ir.GOOGLE_SIGN_IN_METHOD="google.com";ir.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends th{constructor(){super("github.com")}static credential(t){return fo._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Xr.credentialFromTaggedObject(t)}static credentialFromError(t){return Xr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Xr.credential(t.oauthAccessToken)}catch{return null}}}Xr.GITHUB_SIGN_IN_METHOD="github.com";Xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr extends th{constructor(){super("twitter.com")}static credential(t,e){return fo._fromParams({providerId:Qr.PROVIDER_ID,signInMethod:Qr.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Qr.credentialFromTaggedObject(t)}static credentialFromError(t){return Qr.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return Qr.credential(e,n)}catch{return null}}}Qr.TWITTER_SIGN_IN_METHOD="twitter.com";Qr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(i,t){return Ju(i,"POST","/v1/accounts:signUp",ma(i,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,s=!1){const o=await zs._fromIdTokenResponse(t,n,s),l=nw(n);return new po({user:o,providerId:l,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const s=nw(n);return new po({user:t,providerId:s,_tokenResponse:n,operationType:e})}}function nw(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf extends xi{constructor(t,e,n,s){super(e.code,e.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Tf.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,s){return new Tf(t,e,n,s)}}function DS(i,t,e,n){return(t==="reauthenticate"?e._getReauthenticationResolver(i):e._getIdTokenResponse(i)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Tf._fromErrorAndOperation(i,o,t,n):o})}async function Wk(i,t,e=!1){const n=await Ou(i,t._linkToIdToken(i.auth,await i.getIdToken()),e);return po._forOperation(i,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yk(i,t,e=!1){const{auth:n}=i;if(Zn(n.app))return Promise.reject(lr(n));const s="reauthenticate";try{const o=await Ou(i,DS(n,s,t,i),e);kt(o.idToken,n,"internal-error");const l=av(o.idToken);kt(l,n,"internal-error");const{sub:u}=l;return kt(i.uid===u,n,"user-mismatch"),po._forOperation(i,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&Ds(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MS(i,t,e=!1){if(Zn(i.app))return Promise.reject(lr(i));const n="signIn",s=await DS(i,n,t),o=await po._fromIdTokenResponse(i,n,s);return e||await i._updateCurrentUser(o.user),o}async function Xk(i,t){return MS(ya(i),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PS(i){const t=ya(i);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Qk(i,t,e){if(Zn(i.app))return Promise.reject(lr(i));const n=ya(i),l=await dy(n,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kk).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&PS(i),h}),u=await po._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function Zk(i,t,e){return Zn(i.app)?Promise.reject(lr(i)):Xk(Fe(i),Kl.credential(t,e)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&PS(i),n})}function Jk(i,t,e,n){return Fe(i).onIdTokenChanged(t,e,n)}function tD(i,t,e){return Fe(i).beforeAuthStateChanged(t,e)}function eD(i,t,e,n){return Fe(i).onAuthStateChanged(t,e,n)}function nD(i){return Fe(i).signOut()}const xf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(xf,"1"),this.storage.removeItem(xf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=1e3,iD=10;class OS extends LS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=CS(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),s=this.localCache[e];n!==s&&t(e,s,n)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const n=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!e&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);Ak()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,iD):s()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},sD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}OS.type="LOCAL";const rD=OS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS extends LS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}jS.type="SESSION";const VS=jS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(i){return Promise.all(i.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const n=new Yf(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:s,data:o}=e.data,l=this.handlersMap[s];if(!l?.size)return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const u=Array.from(l).map(async f=>f(e.origin,o)),h=await aD(u);e.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(i="",t=10){let e="";for(let n=0;n<t;n++)e+=Math.floor(Math.random()*10);return i+e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const f=hv("",20);s.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(v){const b=v;if(b.data.eventId===f)switch(b.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(b.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:f,data:e},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(){return window}function lD(i){bi().location.href=i}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(){return typeof bi().WorkerGlobalScope<"u"&&typeof bi().importScripts=="function"}async function cD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uD(){return navigator?.serviceWorker?.controller||null}function hD(){return US()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="firebaseLocalStorageDb",dD=1,Cf="firebaseLocalStorage",BS="fbase_key";class eh{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Xf(i,t){return i.transaction([Cf],t?"readwrite":"readonly").objectStore(Cf)}function fD(){const i=indexedDB.deleteDatabase(FS);return new eh(i).toPromise()}function fy(){const i=indexedDB.open(FS,dD);return new Promise((t,e)=>{i.addEventListener("error",()=>{e(i.error)}),i.addEventListener("upgradeneeded",()=>{const n=i.result;try{n.createObjectStore(Cf,{keyPath:BS})}catch(s){e(s)}}),i.addEventListener("success",async()=>{const n=i.result;n.objectStoreNames.contains(Cf)?t(n):(n.close(),await fD(),t(await fy()))})})}async function sw(i,t,e){const n=Xf(i,!0).put({[BS]:t,value:e});return new eh(n).toPromise()}async function pD(i,t){const e=Xf(i,!1).get(t),n=await new eh(e).toPromise();return n===void 0?null:n.value}function iw(i,t){const e=Xf(i,!0).delete(t);return new eh(e).toPromise()}const mD=800,gD=3;class zS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fy(),this.db)}async _withRetries(t){let e=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(e++>gD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return US()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yf._getInstance(hD()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await cD(),!this.activeServiceWorker)return;this.sender=new oD(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||uD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await fy();return await sw(t,xf,"1"),await iw(t,xf),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>sw(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(n=>pD(n,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>iw(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const o=Xf(s,!1).getAll();return new eh(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:o}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}zS.type="LOCAL";const yD=zS;new Zu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(i,t){return t?ar(t):(kt(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv extends lv{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ml(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ml(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ml(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function vD(i){return MS(i.auth,new dv(i),i.bypassAuthState)}function _D(i){const{auth:t,user:e}=i;return kt(e,t,"internal-error"),Yk(e,new dv(i),i.bypassAuthState)}async function bD(i){const{auth:t,user:e}=i;return kt(e,t,"internal-error"),Wk(e,new dv(i),i.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(t,e,n,s,o=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:s,tenantId:o,error:l,type:u}=t;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:e,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(f){this.reject(f)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return vD;case"linkViaPopup":case"linkViaRedirect":return bD;case"reauthViaPopup":case"reauthViaRedirect":return _D;default:Ds(this.auth,"internal-error")}}resolve(t){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){fr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new Zu(2e3,1e4);async function ED(i,t,e){if(Zn(i.app))return Promise.reject(Gs(i,"operation-not-supported-in-this-environment"));const n=ya(i);ek(i,t,uv);const s=HS(n,e);return new so(n,"signInViaPopup",t,s).executeNotNull()}class so extends GS{constructor(t,e,n,s,o){super(t,e,s,o),this.provider=n,this.authWindow=null,this.pollId=null,so.currentPopupAction&&so.currentPopupAction.cancel(),so.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return kt(t,this.auth,"internal-error"),t}async onExecution(){fr(this.filter.length===1,"Popup operations only handle one event");const t=hv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Gs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Gs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,so.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,AD.get())};t()}}so.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD="pendingRedirect",lf=new Map;class SD extends GS{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=lf.get(this.auth._key());if(!t){try{const n=await TD(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(e){t=()=>Promise.reject(e)}lf.set(this.auth._key(),t)}return this.bypassAuthState||lf.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TD(i,t){const e=RD(t),n=CD(i);if(!await n._isAvailable())return!1;const s=await n._get(e)==="true";return await n._remove(e),s}function xD(i,t){lf.set(i._key(),t)}function CD(i){return ar(i._redirectPersistence)}function RD(i){return of(wD,i.config.apiKey,i.name)}async function ID(i,t,e=!1){if(Zn(i.app))return Promise.reject(lr(i));const n=ya(i),s=HS(n,t),l=await new SD(n,s,e).execute();return l&&!e&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,t)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND=600*1e3;class kD{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!DD(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!qS(t)){const n=t.error.code?.split("auth/")[1]||"internal-error";e.onError(Gs(this.auth,n))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=ND&&this.cachedEventUids.clear(),this.cachedEventUids.has(rw(t))}saveEventToCache(t){this.cachedEventUids.add(rw(t)),this.lastProcessedEventTime=Date.now()}}function rw(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(t=>t).join("-")}function qS({type:i,error:t}){return i==="unknown"&&t?.code==="auth/no-auth-event"}function DD(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qS(i);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MD(i,t={}){return ga(i,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,LD=/^https?/;async function OD(i){if(i.config.emulator)return;const{authorizedDomains:t}=await MD(i);for(const e of t)try{if(jD(e))return}catch{}Ds(i,"unauthorized-domain")}function jD(i){const t=uy(),{protocol:e,hostname:n}=new URL(t);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&n===""?e==="chrome-extension:"&&i.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&l.hostname===n}if(!LD.test(e))return!1;if(PD.test(i))return n===i;const s=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=new Zu(3e4,6e4);function aw(){const i=bi().___jsl;if(i?.H){for(const t of Object.keys(i.H))if(i.H[t].r=i.H[t].r||[],i.H[t].L=i.H[t].L||[],i.H[t].r=[...i.H[t].L],i.CP)for(let e=0;e<i.CP.length;e++)i.CP[e]=null}}function UD(i){return new Promise((t,e)=>{function n(){aw(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{aw(),e(Gs(i,"network-request-failed"))},timeout:VD.get()})}if(bi().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(bi().gapi?.load)n();else{const s=Nk("iframefcb");return bi()[s]=()=>{gapi.load?n():e(Gs(i,"network-request-failed"))},IS(`${Ik()}?onload=${s}`).catch(o=>e(o))}}).catch(t=>{throw cf=null,t})}let cf=null;function FD(i){return cf=cf||UD(i),cf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=new Zu(5e3,15e3),zD="__/auth/iframe",HD="emulator/auth/iframe",GD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $D(i){const t=i.config;kt(t.authDomain,i,"auth-domain-config-required");const e=t.emulator?rv(t,HD):`https://${i.config.authDomain}/${zD}`,n={apiKey:t.apiKey,appName:i.name,v:Eo},s=qD.get(i.config.apiHost);s&&(n.eid=s);const o=i._getFrameworks();return o.length&&(n.fw=o.join(",")),`${e}?${Qu(n).slice(1)}`}async function KD(i){const t=await FD(i),e=bi().gapi;return kt(e,i,"internal-error"),t.open({where:document.body,url:$D(i),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GD,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const l=Gs(i,"network-request-failed"),u=bi().setTimeout(()=>{o(l)},BD.get());function h(){bi().clearTimeout(u),s(n)}n.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YD=500,XD=600,QD="_blank",ZD="http://localhost";class ow{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function JD(i,t,e,n=YD,s=XD){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h={...WD,width:n.toString(),height:s.toString(),top:o,left:l},f=Dn().toLowerCase();e&&(u=ES(f)?QD:e),bS(f)&&(t=t||ZD,h.scrollbars="yes");const m=Object.entries(h).reduce((b,[A,w])=>`${b}${A}=${w},`,"");if(bk(f)&&u!=="_self")return tM(t||"",u),new ow(null);const v=window.open(t||"",u,m);kt(v,i,"popup-blocked");try{v.focus()}catch{}return new ow(v)}function tM(i,t){const e=document.createElement("a");e.href=i,e.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM="__/auth/handler",nM="emulator/auth/handler",sM=encodeURIComponent("fac");async function lw(i,t,e,n,s,o){kt(i.config.authDomain,i,"auth-domain-config-required"),kt(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:e,redirectUrl:n,v:Eo,eventId:s};if(t instanceof uv){t.setDefaultLanguage(i.languageCode),l.providerId=t.providerId||"",BI(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[m,v]of Object.entries({}))l[m]=v}if(t instanceof th){const m=t.getScopes().filter(v=>v!=="");m.length>0&&(l.scopes=m.join(","))}i.tenantId&&(l.tid=i.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const h=await i._getAppCheckToken(),f=h?`#${sM}=${encodeURIComponent(h)}`:"";return`${iM(i)}?${Qu(u).slice(1)}${f}`}function iM({config:i}){return i.emulator?rv(i,nM):`https://${i.authDomain}/${eM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="webStorageSupport";class rM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VS,this._completeRedirectFn=ID,this._overrideRedirectResult=xD}async _openPopup(t,e,n,s){fr(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const o=await lw(t,e,n,uy(),s);return JD(t,o,hv())}async _openRedirect(t,e,n,s){await this._originValidation(t);const o=await lw(t,e,n,uy(),s);return lD(o),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:o}=this.eventManagers[e];return s?Promise.resolve(s):(fr(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await KD(t),n=new kD(t);return e.register("authEvent",s=>(kt(s?.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ug,{type:Ug},s=>{const o=s?.[0]?.[Ug];o!==void 0&&e(!!o),Ds(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=OD(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return CS()||AS()||ov()}}const aM=rM;var cw="@firebase/auth",uw="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(n=>{t(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lM(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cM(i){ho(new ra("auth",(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),o=t.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;kt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:u,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RS(i)},f=new xk(n,s,o,h);return Ok(f,e),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),ho(new ra("auth-internal",t=>{const e=ya(t.getProvider("auth").getImmediate());return(n=>new oM(n))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),_i(cw,uw,lM(i)),_i(cw,uw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM=300,hM=aS("authIdTokenMaxAge")||uM;let hw=null;const dM=i=>async t=>{const e=t&&await t.getIdTokenResult(),n=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>hM)return;const s=e?.token;hw!==s&&(hw=s,await fetch(i,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function fM(i=nv()){const t=Kf(i,"auth");if(t.isInitialized())return t.getImmediate();const e=Lk(i,{popupRedirectResolver:aM,persistence:[yD,rD,VS]}),n=aS("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=dM(o.toString());tD(e,l,()=>l(e.currentUser)),Jk(e,u=>l(u))}}const s=sS("auth");return s&&jk(e,`http://${s}`),e}function pM(){return document.getElementsByTagName("head")?.[0]??document}Ck({loadJS(i){return new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src",i),n.onload=t,n.onerror=s=>{const o=Gs("internal-error");o.customData=s,e(o)},n.type="text/javascript",n.charset="UTF-8",pM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cM("Browser");var mM="firebase",gM="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_i(mM,gM,"app");var dw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var sa,$S;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(C,I){function k(){}k.prototype=I.prototype,C.D=I.prototype,C.prototype=new k,C.prototype.constructor=C,C.C=function(O,U,H){for(var j=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)j[_t-2]=arguments[_t];return I.prototype[U].apply(O,j)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,e),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,I,k){k||(k=0);var O=Array(16);if(typeof I=="string")for(var U=0;16>U;++U)O[U]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(U=0;16>U;++U)O[U]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=C.g[0],k=C.g[1],U=C.g[2];var H=C.g[3],j=I+(H^k&(U^H))+O[0]+3614090360&4294967295;I=k+(j<<7&4294967295|j>>>25),j=H+(U^I&(k^U))+O[1]+3905402710&4294967295,H=I+(j<<12&4294967295|j>>>20),j=U+(k^H&(I^k))+O[2]+606105819&4294967295,U=H+(j<<17&4294967295|j>>>15),j=k+(I^U&(H^I))+O[3]+3250441966&4294967295,k=U+(j<<22&4294967295|j>>>10),j=I+(H^k&(U^H))+O[4]+4118548399&4294967295,I=k+(j<<7&4294967295|j>>>25),j=H+(U^I&(k^U))+O[5]+1200080426&4294967295,H=I+(j<<12&4294967295|j>>>20),j=U+(k^H&(I^k))+O[6]+2821735955&4294967295,U=H+(j<<17&4294967295|j>>>15),j=k+(I^U&(H^I))+O[7]+4249261313&4294967295,k=U+(j<<22&4294967295|j>>>10),j=I+(H^k&(U^H))+O[8]+1770035416&4294967295,I=k+(j<<7&4294967295|j>>>25),j=H+(U^I&(k^U))+O[9]+2336552879&4294967295,H=I+(j<<12&4294967295|j>>>20),j=U+(k^H&(I^k))+O[10]+4294925233&4294967295,U=H+(j<<17&4294967295|j>>>15),j=k+(I^U&(H^I))+O[11]+2304563134&4294967295,k=U+(j<<22&4294967295|j>>>10),j=I+(H^k&(U^H))+O[12]+1804603682&4294967295,I=k+(j<<7&4294967295|j>>>25),j=H+(U^I&(k^U))+O[13]+4254626195&4294967295,H=I+(j<<12&4294967295|j>>>20),j=U+(k^H&(I^k))+O[14]+2792965006&4294967295,U=H+(j<<17&4294967295|j>>>15),j=k+(I^U&(H^I))+O[15]+1236535329&4294967295,k=U+(j<<22&4294967295|j>>>10),j=I+(U^H&(k^U))+O[1]+4129170786&4294967295,I=k+(j<<5&4294967295|j>>>27),j=H+(k^U&(I^k))+O[6]+3225465664&4294967295,H=I+(j<<9&4294967295|j>>>23),j=U+(I^k&(H^I))+O[11]+643717713&4294967295,U=H+(j<<14&4294967295|j>>>18),j=k+(H^I&(U^H))+O[0]+3921069994&4294967295,k=U+(j<<20&4294967295|j>>>12),j=I+(U^H&(k^U))+O[5]+3593408605&4294967295,I=k+(j<<5&4294967295|j>>>27),j=H+(k^U&(I^k))+O[10]+38016083&4294967295,H=I+(j<<9&4294967295|j>>>23),j=U+(I^k&(H^I))+O[15]+3634488961&4294967295,U=H+(j<<14&4294967295|j>>>18),j=k+(H^I&(U^H))+O[4]+3889429448&4294967295,k=U+(j<<20&4294967295|j>>>12),j=I+(U^H&(k^U))+O[9]+568446438&4294967295,I=k+(j<<5&4294967295|j>>>27),j=H+(k^U&(I^k))+O[14]+3275163606&4294967295,H=I+(j<<9&4294967295|j>>>23),j=U+(I^k&(H^I))+O[3]+4107603335&4294967295,U=H+(j<<14&4294967295|j>>>18),j=k+(H^I&(U^H))+O[8]+1163531501&4294967295,k=U+(j<<20&4294967295|j>>>12),j=I+(U^H&(k^U))+O[13]+2850285829&4294967295,I=k+(j<<5&4294967295|j>>>27),j=H+(k^U&(I^k))+O[2]+4243563512&4294967295,H=I+(j<<9&4294967295|j>>>23),j=U+(I^k&(H^I))+O[7]+1735328473&4294967295,U=H+(j<<14&4294967295|j>>>18),j=k+(H^I&(U^H))+O[12]+2368359562&4294967295,k=U+(j<<20&4294967295|j>>>12),j=I+(k^U^H)+O[5]+4294588738&4294967295,I=k+(j<<4&4294967295|j>>>28),j=H+(I^k^U)+O[8]+2272392833&4294967295,H=I+(j<<11&4294967295|j>>>21),j=U+(H^I^k)+O[11]+1839030562&4294967295,U=H+(j<<16&4294967295|j>>>16),j=k+(U^H^I)+O[14]+4259657740&4294967295,k=U+(j<<23&4294967295|j>>>9),j=I+(k^U^H)+O[1]+2763975236&4294967295,I=k+(j<<4&4294967295|j>>>28),j=H+(I^k^U)+O[4]+1272893353&4294967295,H=I+(j<<11&4294967295|j>>>21),j=U+(H^I^k)+O[7]+4139469664&4294967295,U=H+(j<<16&4294967295|j>>>16),j=k+(U^H^I)+O[10]+3200236656&4294967295,k=U+(j<<23&4294967295|j>>>9),j=I+(k^U^H)+O[13]+681279174&4294967295,I=k+(j<<4&4294967295|j>>>28),j=H+(I^k^U)+O[0]+3936430074&4294967295,H=I+(j<<11&4294967295|j>>>21),j=U+(H^I^k)+O[3]+3572445317&4294967295,U=H+(j<<16&4294967295|j>>>16),j=k+(U^H^I)+O[6]+76029189&4294967295,k=U+(j<<23&4294967295|j>>>9),j=I+(k^U^H)+O[9]+3654602809&4294967295,I=k+(j<<4&4294967295|j>>>28),j=H+(I^k^U)+O[12]+3873151461&4294967295,H=I+(j<<11&4294967295|j>>>21),j=U+(H^I^k)+O[15]+530742520&4294967295,U=H+(j<<16&4294967295|j>>>16),j=k+(U^H^I)+O[2]+3299628645&4294967295,k=U+(j<<23&4294967295|j>>>9),j=I+(U^(k|~H))+O[0]+4096336452&4294967295,I=k+(j<<6&4294967295|j>>>26),j=H+(k^(I|~U))+O[7]+1126891415&4294967295,H=I+(j<<10&4294967295|j>>>22),j=U+(I^(H|~k))+O[14]+2878612391&4294967295,U=H+(j<<15&4294967295|j>>>17),j=k+(H^(U|~I))+O[5]+4237533241&4294967295,k=U+(j<<21&4294967295|j>>>11),j=I+(U^(k|~H))+O[12]+1700485571&4294967295,I=k+(j<<6&4294967295|j>>>26),j=H+(k^(I|~U))+O[3]+2399980690&4294967295,H=I+(j<<10&4294967295|j>>>22),j=U+(I^(H|~k))+O[10]+4293915773&4294967295,U=H+(j<<15&4294967295|j>>>17),j=k+(H^(U|~I))+O[1]+2240044497&4294967295,k=U+(j<<21&4294967295|j>>>11),j=I+(U^(k|~H))+O[8]+1873313359&4294967295,I=k+(j<<6&4294967295|j>>>26),j=H+(k^(I|~U))+O[15]+4264355552&4294967295,H=I+(j<<10&4294967295|j>>>22),j=U+(I^(H|~k))+O[6]+2734768916&4294967295,U=H+(j<<15&4294967295|j>>>17),j=k+(H^(U|~I))+O[13]+1309151649&4294967295,k=U+(j<<21&4294967295|j>>>11),j=I+(U^(k|~H))+O[4]+4149444226&4294967295,I=k+(j<<6&4294967295|j>>>26),j=H+(k^(I|~U))+O[11]+3174756917&4294967295,H=I+(j<<10&4294967295|j>>>22),j=U+(I^(H|~k))+O[2]+718787259&4294967295,U=H+(j<<15&4294967295|j>>>17),j=k+(H^(U|~I))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(U+(j<<21&4294967295|j>>>11))&4294967295,C.g[2]=C.g[2]+U&4294967295,C.g[3]=C.g[3]+H&4294967295}n.prototype.u=function(C,I){I===void 0&&(I=C.length);for(var k=I-this.blockSize,O=this.B,U=this.h,H=0;H<I;){if(U==0)for(;H<=k;)s(this,C,H),H+=this.blockSize;if(typeof C=="string"){for(;H<I;)if(O[U++]=C.charCodeAt(H++),U==this.blockSize){s(this,O),U=0;break}}else for(;H<I;)if(O[U++]=C[H++],U==this.blockSize){s(this,O),U=0;break}}this.h=U,this.o+=I},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;var k=8*this.o;for(I=C.length-8;I<C.length;++I)C[I]=k&255,k/=256;for(this.u(C),C=Array(16),I=k=0;4>I;++I)for(var O=0;32>O;O+=8)C[k++]=this.g[I]>>>O&255;return C};function o(C,I){var k=u;return Object.prototype.hasOwnProperty.call(k,C)?k[C]:k[C]=I(C)}function l(C,I){this.h=I;for(var k=[],O=!0,U=C.length-1;0<=U;U--){var H=C[U]|0;O&&H==I||(k[U]=H,O=!1)}this.g=k}var u={};function h(C){return-128<=C&&128>C?o(C,function(I){return new l([I|0],0>I?-1:0)}):new l([C|0],0>C?-1:0)}function f(C){if(isNaN(C)||!isFinite(C))return v;if(0>C)return N(f(-C));for(var I=[],k=1,O=0;C>=k;O++)I[O]=C/k|0,k*=4294967296;return new l(I,0)}function m(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return N(m(C.substring(1),I));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=f(Math.pow(I,8)),O=v,U=0;U<C.length;U+=8){var H=Math.min(8,C.length-U),j=parseInt(C.substring(U,U+H),I);8>H?(H=f(Math.pow(I,H)),O=O.j(H).add(f(j))):(O=O.j(k),O=O.add(f(j)))}return O}var v=h(0),b=h(1),A=h(16777216);i=l.prototype,i.m=function(){if(S(this))return-N(this).m();for(var C=0,I=1,k=0;k<this.g.length;k++){var O=this.i(k);C+=(0<=O?O:4294967296+O)*I,I*=4294967296}return C},i.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(S(this))return"-"+N(this).toString(C);for(var I=f(Math.pow(C,6)),k=this,O="";;){var U=B(k,I).g;k=R(k,U.j(I));var H=((0<k.g.length?k.g[0]:k.h)>>>0).toString(C);if(k=U,w(k))return H+O;for(;6>H.length;)H="0"+H;O=H+O}},i.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(var I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function S(C){return C.h==-1}i.l=function(C){return C=R(this,C),S(C)?-1:w(C)?0:1};function N(C){for(var I=C.g.length,k=[],O=0;O<I;O++)k[O]=~C.g[O];return new l(k,~C.h).add(b)}i.abs=function(){return S(this)?N(this):this},i.add=function(C){for(var I=Math.max(this.g.length,C.g.length),k=[],O=0,U=0;U<=I;U++){var H=O+(this.i(U)&65535)+(C.i(U)&65535),j=(H>>>16)+(this.i(U)>>>16)+(C.i(U)>>>16);O=j>>>16,H&=65535,j&=65535,k[U]=j<<16|H}return new l(k,k[k.length-1]&-2147483648?-1:0)};function R(C,I){return C.add(N(I))}i.j=function(C){if(w(this)||w(C))return v;if(S(this))return S(C)?N(this).j(N(C)):N(N(this).j(C));if(S(C))return N(this.j(N(C)));if(0>this.l(A)&&0>C.l(A))return f(this.m()*C.m());for(var I=this.g.length+C.g.length,k=[],O=0;O<2*I;O++)k[O]=0;for(O=0;O<this.g.length;O++)for(var U=0;U<C.g.length;U++){var H=this.i(O)>>>16,j=this.i(O)&65535,_t=C.i(U)>>>16,Pt=C.i(U)&65535;k[2*O+2*U]+=j*Pt,V(k,2*O+2*U),k[2*O+2*U+1]+=H*Pt,V(k,2*O+2*U+1),k[2*O+2*U+1]+=j*_t,V(k,2*O+2*U+1),k[2*O+2*U+2]+=H*_t,V(k,2*O+2*U+2)}for(O=0;O<I;O++)k[O]=k[2*O+1]<<16|k[2*O];for(O=I;O<2*I;O++)k[O]=0;return new l(k,0)};function V(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function M(C,I){this.g=C,this.h=I}function B(C,I){if(w(I))throw Error("division by zero");if(w(C))return new M(v,v);if(S(C))return I=B(N(C),I),new M(N(I.g),N(I.h));if(S(I))return I=B(C,N(I)),new M(N(I.g),I.h);if(30<C.g.length){if(S(C)||S(I))throw Error("slowDivide_ only works with positive integers.");for(var k=b,O=I;0>=O.l(C);)k=L(k),O=L(O);var U=F(k,1),H=F(O,1);for(O=F(O,2),k=F(k,2);!w(O);){var j=H.add(O);0>=j.l(C)&&(U=U.add(k),H=j),O=F(O,1),k=F(k,1)}return I=R(C,U.j(I)),new M(U,I)}for(U=v;0<=C.l(I);){for(k=Math.max(1,Math.floor(C.m()/I.m())),O=Math.ceil(Math.log(k)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),H=f(k),j=H.j(I);S(j)||0<j.l(C);)k-=O,H=f(k),j=H.j(I);w(H)&&(H=b),U=U.add(H),C=R(C,j)}return new M(U,C)}i.A=function(C){return B(this,C).h},i.and=function(C){for(var I=Math.max(this.g.length,C.g.length),k=[],O=0;O<I;O++)k[O]=this.i(O)&C.i(O);return new l(k,this.h&C.h)},i.or=function(C){for(var I=Math.max(this.g.length,C.g.length),k=[],O=0;O<I;O++)k[O]=this.i(O)|C.i(O);return new l(k,this.h|C.h)},i.xor=function(C){for(var I=Math.max(this.g.length,C.g.length),k=[],O=0;O<I;O++)k[O]=this.i(O)^C.i(O);return new l(k,this.h^C.h)};function L(C){for(var I=C.g.length+1,k=[],O=0;O<I;O++)k[O]=C.i(O)<<1|C.i(O-1)>>>31;return new l(k,C.h)}function F(C,I){var k=I>>5;I%=32;for(var O=C.g.length-k,U=[],H=0;H<O;H++)U[H]=0<I?C.i(H+k)>>>I|C.i(H+k+1)<<32-I:C.i(H+k);return new l(U,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,$S=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=m,sa=l}).apply(typeof dw<"u"?dw:typeof self<"u"?self:typeof window<"u"?window:{});var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var KS,_u,WS,uf,py,YS,XS,QS;(function(){var i,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,E,T){return p==Array.prototype||p==Object.prototype||(p[E]=T.value),p};function e(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hd=="object"&&Hd];for(var E=0;E<p.length;++E){var T=p[E];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var n=e(this);function s(p,E){if(E)t:{var T=n;p=p.split(".");for(var P=0;P<p.length-1;P++){var Q=p[P];if(!(Q in T))break t;T=T[Q]}p=p[p.length-1],P=T[p],E=E(P),E!=P&&E!=null&&t(T,p,{configurable:!0,writable:!0,value:E})}}function o(p,E){p instanceof String&&(p+="");var T=0,P=!1,Q={next:function(){if(!P&&T<p.length){var nt=T++;return{value:E(nt,p[nt]),done:!1}}return P=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}s("Array.prototype.values",function(p){return p||function(){return o(this,function(E,T){return T})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function h(p){var E=typeof p;return E=E!="object"?E:p?Array.isArray(p)?"array":E:"null",E=="array"||E=="object"&&typeof p.length=="number"}function f(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function m(p,E,T){return p.call.apply(p.bind,arguments)}function v(p,E,T){if(!p)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,P),p.apply(E,Q)}}return function(){return p.apply(E,arguments)}}function b(p,E,T){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:v,b.apply(null,arguments)}function A(p,E){var T=Array.prototype.slice.call(arguments,1);return function(){var P=T.slice();return P.push.apply(P,arguments),p.apply(this,P)}}function w(p,E){function T(){}T.prototype=E.prototype,p.aa=E.prototype,p.prototype=new T,p.prototype.constructor=p,p.Qb=function(P,Q,nt){for(var dt=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)dt[Zt-2]=arguments[Zt];return E.prototype[Q].apply(P,dt)}}function S(p){const E=p.length;if(0<E){const T=Array(E);for(let P=0;P<E;P++)T[P]=p[P];return T}return[]}function N(p,E){for(let T=1;T<arguments.length;T++){const P=arguments[T];if(h(P)){const Q=p.length||0,nt=P.length||0;p.length=Q+nt;for(let dt=0;dt<nt;dt++)p[Q+dt]=P[dt]}else p.push(P)}}class R{constructor(E,T){this.i=E,this.j=T,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function V(p){return/^[\s\xa0]*$/.test(p)}function M(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function B(p){return B[" "](p),p}B[" "]=function(){};var L=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function F(p,E,T){for(const P in p)E.call(T,p[P],P,p)}function C(p,E){for(const T in p)E.call(void 0,p[T],T,p)}function I(p){const E={};for(const T in p)E[T]=p[T];return E}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(p,E){let T,P;for(let Q=1;Q<arguments.length;Q++){P=arguments[Q];for(T in P)p[T]=P[T];for(let nt=0;nt<k.length;nt++)T=k[nt],Object.prototype.hasOwnProperty.call(P,T)&&(p[T]=P[T])}}function U(p){var E=1;p=p.split(":");const T=[];for(;0<E&&p.length;)T.push(p.shift()),E--;return p.length&&T.push(p.join(":")),T}function H(p){u.setTimeout(()=>{throw p},0)}function j(){var p=xt;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class _t{constructor(){this.h=this.g=null}add(E,T){const P=Pt.get();P.set(E,T),this.h?this.h.next=P:this.g=P,this.h=P}}var Pt=new R(()=>new W,p=>p.reset());class W{constructor(){this.next=this.g=this.h=null}set(E,T){this.h=E,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let X,ut=!1,xt=new _t,q=()=>{const p=u.Promise.resolve(void 0);X=()=>{p.then(st)}};var st=()=>{for(var p;p=j();){try{p.h.call(p.g)}catch(T){H(T)}var E=Pt;E.j(p),100>E.h&&(E.h++,p.next=E.g,E.g=p)}ut=!1};function ct(){this.s=this.s,this.C=this.C}ct.prototype.s=!1,ct.prototype.ma=function(){this.s||(this.s=!0,this.N())},ct.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var ht=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const T=()=>{};u.addEventListener("test",T,E),u.removeEventListener("test",T,E)}catch{}return p})();function Nt(p,E){if(K.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var T=this.type=p.type,P=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget){if(L){t:{try{B(E.nodeName);var Q=!0;break t}catch{}Q=!1}Q||(E=null)}}else T=="mouseover"?E=p.fromElement:T=="mouseout"&&(E=p.toElement);this.relatedTarget=E,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:bt[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Nt.aa.h.call(this)}}w(Nt,K);var bt={2:"touch",3:"pen",4:"mouse"};Nt.prototype.h=function(){Nt.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ut="closure_listenable_"+(1e6*Math.random()|0),Qt=0;function Hn(p,E,T,P,Q){this.listener=p,this.proxy=null,this.src=E,this.type=T,this.capture=!!P,this.ha=Q,this.key=++Qt,this.da=this.fa=!1}function ps(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Mn(p){this.src=p,this.g={},this.h=0}Mn.prototype.add=function(p,E,T,P,Q){var nt=p.toString();p=this.g[nt],p||(p=this.g[nt]=[],this.h++);var dt=Bt(p,E,P,Q);return-1<dt?(E=p[dt],T||(E.fa=!1)):(E=new Hn(E,this.src,nt,!!P,Q),E.fa=T,p.push(E)),E};function ft(p,E){var T=E.type;if(T in p.g){var P=p.g[T],Q=Array.prototype.indexOf.call(P,E,void 0),nt;(nt=0<=Q)&&Array.prototype.splice.call(P,Q,1),nt&&(ps(E),p.g[T].length==0&&(delete p.g[T],p.h--))}}function Bt(p,E,T,P){for(var Q=0;Q<p.length;++Q){var nt=p[Q];if(!nt.da&&nt.listener==E&&nt.capture==!!T&&nt.ha==P)return Q}return-1}var me="closure_lm_"+(1e6*Math.random()|0),Ps={};function vr(p,E,T,P,Q){if(Array.isArray(E)){for(var nt=0;nt<E.length;nt++)vr(p,E[nt],T,P,Q);return null}return T=vh(T),p&&p[Ut]?p.K(E,T,f(P)?!!P.capture:!1,Q):Gn(p,E,T,!1,P,Q)}function Gn(p,E,T,P,Q,nt){if(!E)throw Error("Invalid event type");var dt=f(Q)?!!Q.capture:!!Q,Zt=Ro(p);if(Zt||(p[me]=Zt=new Mn(p)),T=Zt.add(E,T,P,dt,nt),T.proxy)return T;if(P=Sp(),T.proxy=P,P.src=p,P.listener=T,p.addEventListener)ht||(Q=dt),Q===void 0&&(Q=!1),p.addEventListener(E.toString(),P,Q);else if(p.attachEvent)p.attachEvent(Aa(E.toString()),P);else if(p.addListener&&p.removeListener)p.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Sp(){function p(T){return E.call(p.src,p.listener,T)}const E=Tp;return p}function ec(p,E,T,P,Q){if(Array.isArray(E))for(var nt=0;nt<E.length;nt++)ec(p,E[nt],T,P,Q);else P=f(P)?!!P.capture:!!P,T=vh(T),p&&p[Ut]?(p=p.i,E=String(E).toString(),E in p.g&&(nt=p.g[E],T=Bt(nt,T,P,Q),-1<T&&(ps(nt[T]),Array.prototype.splice.call(nt,T,1),nt.length==0&&(delete p.g[E],p.h--)))):p&&(p=Ro(p))&&(E=p.g[E.toString()],p=-1,E&&(p=Bt(E,T,P,Q)),(T=-1<p?E[p]:null)&&Co(T))}function Co(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[Ut])ft(E.i,p);else{var T=p.type,P=p.proxy;E.removeEventListener?E.removeEventListener(T,P,p.capture):E.detachEvent?E.detachEvent(Aa(T),P):E.addListener&&E.removeListener&&E.removeListener(P),(T=Ro(E))?(ft(T,p),T.h==0&&(T.src=null,E[me]=null)):ps(p)}}}function Aa(p){return p in Ps?Ps[p]:Ps[p]="on"+p}function Tp(p,E){if(p.da)p=!0;else{E=new Nt(E,this);var T=p.listener,P=p.ha||p.src;p.fa&&Co(p),p=T.call(P,E)}return p}function Ro(p){return p=p[me],p instanceof Mn?p:null}var nc="__closure_events_fn_"+(1e9*Math.random()>>>0);function vh(p){return typeof p=="function"?p:(p[nc]||(p[nc]=function(E){return p.handleEvent(E)}),p[nc])}function Ne(){ct.call(this),this.i=new Mn(this),this.M=this,this.F=null}w(Ne,ct),Ne.prototype[Ut]=!0,Ne.prototype.removeEventListener=function(p,E,T,P){ec(this,p,E,T,P)};function oe(p,E){var T,P=p.F;if(P)for(T=[];P;P=P.F)T.push(P);if(p=p.M,P=E.type||E,typeof E=="string")E=new K(E,p);else if(E instanceof K)E.target=E.target||p;else{var Q=E;E=new K(P,p),O(E,Q)}if(Q=!0,T)for(var nt=T.length-1;0<=nt;nt--){var dt=E.g=T[nt];Q=ts(dt,P,!0,E)&&Q}if(dt=E.g=p,Q=ts(dt,P,!0,E)&&Q,Q=ts(dt,P,!1,E)&&Q,T)for(nt=0;nt<T.length;nt++)dt=E.g=T[nt],Q=ts(dt,P,!1,E)&&Q}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var p=this.i,E;for(E in p.g){for(var T=p.g[E],P=0;P<T.length;P++)ps(T[P]);delete p.g[E],p.h--}}this.F=null},Ne.prototype.K=function(p,E,T,P){return this.i.add(String(p),E,!1,T,P)},Ne.prototype.L=function(p,E,T,P){return this.i.add(String(p),E,!0,T,P)};function ts(p,E,T,P){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();for(var Q=!0,nt=0;nt<E.length;++nt){var dt=E[nt];if(dt&&!dt.da&&dt.capture==T){var Zt=dt.listener,en=dt.ha||dt.src;dt.fa&&ft(p.i,dt),Q=Zt.call(en,P)!==!1&&Q}}return Q&&!P.defaultPrevented}function Tn(p,E,T){if(typeof p=="function")T&&(p=b(p,T));else if(p&&typeof p.handleEvent=="function")p=b(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:u.setTimeout(p,E||0)}function _h(p){p.g=Tn(()=>{p.g=null,p.i&&(p.i=!1,_h(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class xp extends ct{constructor(E,T){super(),this.m=E,this.l=T,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:_h(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ea(p){ct.call(this),this.h=p,this.g={}}w(Ea,ct);var wa=[];function Sa(p){F(p.g,function(E,T){this.g.hasOwnProperty(T)&&Co(E)},p),p.g={}}Ea.prototype.N=function(){Ea.aa.N.call(this),Sa(this)},Ea.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ls=u.JSON.stringify,Io=u.JSON.parse,Ta=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function sc(){}sc.prototype.h=null;function ic(p){return p.h||(p.h=p.i())}function rc(){}var Ri={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ii(){K.call(this,"d")}w(Ii,K);function ac(){K.call(this,"c")}w(ac,K);var Xs={},oc=null;function _r(){return oc=oc||new Ne}Xs.La="serverreachability";function No(p){K.call(this,Xs.La,p)}w(No,K);function br(p){const E=_r();oe(E,new No(E))}Xs.STAT_EVENT="statevent";function bh(p,E){K.call(this,Xs.STAT_EVENT,p),this.stat=E}w(bh,K);function Ae(p){const E=_r();oe(E,new bh(E,p))}Xs.Ma="timingevent";function tn(p,E){K.call(this,Xs.Ma,p),this.size=E}w(tn,K);function ze(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},E)}function ms(){this.g=!0}ms.prototype.xa=function(){this.g=!1};function lc(p,E,T,P,Q,nt){p.info(function(){if(p.g)if(nt)for(var dt="",Zt=nt.split("&"),en=0;en<Zt.length;en++){var Jt=Zt[en].split("=");if(1<Jt.length){var cn=Jt[0];Jt=Jt[1];var nn=cn.split("_");dt=2<=nn.length&&nn[1]=="type"?dt+(cn+"="+Jt+"&"):dt+(cn+"=redacted&")}}else dt=null;else dt=nt;return"XMLHTTP REQ ("+P+") [attempt "+Q+"]: "+E+`
`+T+`
`+dt})}function Cp(p,E,T,P,Q,nt,dt){p.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+Q+"]: "+E+`
`+T+`
`+nt+" "+dt})}function Ar(p,E,T,P){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+xa(p,T)+(P?" "+P:"")})}function Ah(p,E){p.info(function(){return"TIMEOUT: "+E})}ms.prototype.info=function(){};function xa(p,E){if(!p.g)return E;if(!E)return null;try{var T=JSON.parse(E);if(T){for(p=0;p<T.length;p++)if(Array.isArray(T[p])){var P=T[p];if(!(2>P.length)){var Q=P[1];if(Array.isArray(Q)&&!(1>Q.length)){var nt=Q[0];if(nt!="noop"&&nt!="stop"&&nt!="close")for(var dt=1;dt<Q.length;dt++)Q[dt]=""}}}}return Ls(T)}catch{return E}}var Er={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ni={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Qs;function Zs(){}w(Zs,sc),Zs.prototype.g=function(){return new XMLHttpRequest},Zs.prototype.i=function(){return{}},Qs=new Zs;function Pn(p,E,T,P){this.j=p,this.i=E,this.l=T,this.R=P||1,this.U=new Ea(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}var cc={},ko={};function Os(p,E,T){p.L=1,p.v=ka(es(E)),p.m=T,p.P=!0,ki(p,null)}function ki(p,E){p.F=Date.now(),Ca(p),p.A=es(p.v);var T=p.A,P=p.R;Array.isArray(P)||(P=[String(P)]),mc(T.i,"t",P),p.C=0,T=p.j.J,p.h=new Le,p.g=jh(p.j,T?E:null,!p.m),0<p.O&&(p.M=new xp(b(p.Y,p,p.g),p.O)),E=p.U,T=p.g,P=p.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(wa[0]=Q.toString()),Q=wa);for(var nt=0;nt<Q.length;nt++){var dt=vr(T,Q[nt],P||E.handleEvent,!1,E.h||E);if(!dt)break;E.g[dt.key]=dt}E=p.H?I(p.H):{},p.m?(p.u||(p.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,E)):(p.u="GET",p.g.ea(p.A,p.u,null,E)),br(),lc(p.i,p.u,p.A,p.l,p.R,p.m)}Pn.prototype.ca=function(p){p=p.target;const E=this.M;E&&_s(p)==3?E.j():this.Y(p)},Pn.prototype.Y=function(p){try{if(p==this.g)t:{const nn=_s(this.g);var E=this.g.Ba();const Ui=this.g.Z();if(!(3>nn)&&(nn!=3||this.g&&(this.h.h||this.g.oa()||Ih(this.g)))){this.J||nn!=4||E==7||(E==8||0>=Ui?br(3):br(2)),wr(this);var T=this.g.Z();this.X=T;e:if(Eh(this)){var P=Ih(this.g);p="";var Q=P.length,nt=_s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){gn(this),Js(this);var dt="";break e}this.h.i=new u.TextDecoder}for(E=0;E<Q;E++)this.h.h=!0,p+=this.h.i.decode(P[E],{stream:!(nt&&E==Q-1)});P.length=0,this.h.g+=p,this.C=0,dt=this.h.g}else dt=this.g.oa();if(this.o=T==200,Cp(this.i,this.u,this.A,this.l,this.R,nn,T),this.o){if(this.T&&!this.K){e:{if(this.g){var Zt,en=this.g;if((Zt=en.g?en.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(Zt)){var Jt=Zt;break e}}Jt=null}if(T=Jt)Ar(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ra(this,T);else{this.o=!1,this.s=3,Ae(12),gn(this),Js(this);break t}}if(this.P){T=!0;let yn;for(;!this.J&&this.C<dt.length;)if(yn=wh(this,dt),yn==ko){nn==4&&(this.s=4,Ae(14),T=!1),Ar(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==cc){this.s=4,Ae(15),Ar(this.i,this.l,dt,"[Invalid Chunk]"),T=!1;break}else Ar(this.i,this.l,yn,null),Ra(this,yn);if(Eh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nn!=4||dt.length!=0||this.h.h||(this.s=1,Ae(16),T=!1),this.o=this.o&&T,!T)Ar(this.i,this.l,dt,"[Invalid Chunked Response]"),gn(this),Js(this);else if(0<dt.length&&!this.W){this.W=!0;var cn=this.j;cn.g==this&&cn.ba&&!cn.M&&(cn.j.info("Great, no buffering proxy detected. Bytes received: "+dt.length),Ua(cn),cn.M=!0,Ae(11))}}else Ar(this.i,this.l,dt,null),Ra(this,dt);nn==4&&gn(this),this.o&&!this.J&&(nn==4?Ph(this.j,this):(this.o=!1,Ca(this)))}else Dp(this.g),T==400&&0<dt.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),gn(this),Js(this)}}}catch{}finally{}};function Eh(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function wh(p,E){var T=p.C,P=E.indexOf(`
`,T);return P==-1?ko:(T=Number(E.substring(T,P)),isNaN(T)?cc:(P+=1,P+T>E.length?ko:(E=E.slice(P,P+T),p.C=P+T,E)))}Pn.prototype.cancel=function(){this.J=!0,gn(this)};function Ca(p){p.S=Date.now()+p.I,Sh(p,p.I)}function Sh(p,E){if(p.B!=null)throw Error("WatchDog timer not null");p.B=ze(b(p.ba,p),E)}function wr(p){p.B&&(u.clearTimeout(p.B),p.B=null)}Pn.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Ah(this.i,this.A),this.L!=2&&(br(),Ae(17)),gn(this),this.s=2,Js(this)):Sh(this,this.S-p)};function Js(p){p.j.G==0||p.J||Ph(p.j,p)}function gn(p){wr(p);var E=p.M;E&&typeof E.ma=="function"&&E.ma(),p.M=null,Sa(p.U),p.g&&(E=p.g,p.g=null,E.abort(),E.ma())}function Ra(p,E){try{var T=p.j;if(T.G!=0&&(T.g==p||uc(T.h,p))){if(!p.K&&uc(T.h,p)&&T.G==3){try{var P=T.Da.g.parse(E)}catch{P=null}if(Array.isArray(P)&&P.length==3){var Q=P;if(Q[0]==0){t:if(!T.u){if(T.g)if(T.g.F+3e3<p.F)Ho(T),Bo(T);else break t;bc(T),Ae(18)}}else T.za=Q[1],0<T.za-T.T&&37500>Q[2]&&T.F&&T.v==0&&!T.C&&(T.C=ze(b(T.Za,T),6e3));if(1>=Mo(T.h)&&T.ca){try{T.ca()}catch{}T.ca=void 0}}else Vi(T,11)}else if((p.K||T.g==p)&&Ho(T),!V(E))for(Q=T.Da.g.parse(E),E=0;E<Q.length;E++){let Jt=Q[E];if(T.T=Jt[0],Jt=Jt[1],T.G==2)if(Jt[0]=="c"){T.K=Jt[1],T.ia=Jt[2];const cn=Jt[3];cn!=null&&(T.la=cn,T.j.info("VER="+T.la));const nn=Jt[4];nn!=null&&(T.Aa=nn,T.j.info("SVER="+T.Aa));const Ui=Jt[5];Ui!=null&&typeof Ui=="number"&&0<Ui&&(P=1.5*Ui,T.L=P,T.j.info("backChannelRequestTimeoutMs_="+P)),P=T;const yn=p.g;if(yn){const ai=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ai){var nt=P.h;nt.g||ai.indexOf("spdy")==-1&&ai.indexOf("quic")==-1&&ai.indexOf("h2")==-1||(nt.j=nt.l,nt.g=new Set,nt.h&&(Po(nt,nt.h),nt.h=null))}if(P.D){const Ec=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(P.ya=Ec,ue(P.I,P.D,Ec))}}T.G=3,T.l&&T.l.ua(),T.ba&&(T.R=Date.now()-p.F,T.j.info("Handshake RTT: "+T.R+"ms")),P=T;var dt=p;if(P.qa=Oh(P,P.J?P.ia:null,P.W),dt.K){Ln(P.h,dt);var Zt=dt,en=P.L;en&&(Zt.I=en),Zt.B&&(wr(Zt),Ca(Zt)),P.g=dt}else Dh(P);0<T.i.length&&zo(T)}else Jt[0]!="stop"&&Jt[0]!="close"||Vi(T,7);else T.G==3&&(Jt[0]=="stop"||Jt[0]=="close"?Jt[0]=="stop"?Vi(T,7):vc(T):Jt[0]!="noop"&&T.l&&T.l.ta(Jt),T.v=0)}}br(4)}catch{}}var Th=class{constructor(p,E){this.g=p,this.map=E}};function Di(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Do(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Mo(p){return p.h?1:p.g?p.g.size:0}function uc(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function Po(p,E){p.g?p.g.add(E):p.h=E}function Ln(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}Di.prototype.cancel=function(){if(this.i=hc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function hc(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const T of p.g.values())E=E.concat(T.D);return E}return S(p.i)}function Rp(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var E=[],T=p.length,P=0;P<T;P++)E.push(p[P]);return E}E=[],T=0;for(P in p)E[T++]=p[P];return E}function Lo(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var E=[];p=p.length;for(var T=0;T<p;T++)E.push(T);return E}E=[],T=0;for(const P in p)E[T++]=P;return E}}}function dc(p,E){if(p.forEach&&typeof p.forEach=="function")p.forEach(E,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,E,void 0);else for(var T=Lo(p),P=Rp(p),Q=P.length,nt=0;nt<Q;nt++)E.call(void 0,P[nt],T&&T[nt],p)}var Ia=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ip(p,E){if(p){p=p.split("&");for(var T=0;T<p.length;T++){var P=p[T].indexOf("="),Q=null;if(0<=P){var nt=p[T].substring(0,P);Q=p[T].substring(P+1)}else nt=p[T];E(nt,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function He(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof He){this.h=p.h,Na(this,p.j),this.o=p.o,this.g=p.g,Sr(this,p.s),this.l=p.l;var E=p.i,T=new Pi;T.i=E.i,E.g&&(T.g=new Map(E.g),T.h=E.h),Mi(this,T),this.m=p.m}else p&&(E=String(p).match(Ia))?(this.h=!1,Na(this,E[1]||"",!0),this.o=gs(E[2]||""),this.g=gs(E[3]||"",!0),Sr(this,E[4]),this.l=gs(E[5]||"",!0),Mi(this,E[6]||"",!0),this.m=gs(E[7]||"")):(this.h=!1,this.i=new Pi(null,this.h))}He.prototype.toString=function(){var p=[],E=this.j;E&&p.push(Da(E,fc,!0),":");var T=this.g;return(T||E=="file")&&(p.push("//"),(E=this.o)&&p.push(Da(E,fc,!0),"@"),p.push(encodeURIComponent(String(T)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.s,T!=null&&p.push(":",String(T))),(T=this.l)&&(this.g&&T.charAt(0)!="/"&&p.push("/"),p.push(Da(T,T.charAt(0)=="/"?Np:pc,!0))),(T=this.i.toString())&&p.push("?",T),(T=this.m)&&p.push("#",Da(T,Oo)),p.join("")};function es(p){return new He(p)}function Na(p,E,T){p.j=T?gs(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function Sr(p,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);p.s=E}else p.s=null}function Mi(p,E,T){E instanceof Pi?(p.i=E,Ch(p.i,p.h)):(T||(E=Da(E,kp)),p.i=new Pi(E,p.h))}function ue(p,E,T){p.i.set(E,T)}function ka(p){return ue(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function gs(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Da(p,E,T){return typeof p=="string"?(p=encodeURI(p).replace(E,xh),T&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function xh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var fc=/[#\/\?@]/g,pc=/[#\?:]/g,Np=/[#\?]/g,kp=/[#\?@]/g,Oo=/#/g;function Pi(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function ys(p){p.g||(p.g=new Map,p.h=0,p.i&&Ip(p.i,function(E,T){p.add(decodeURIComponent(E.replace(/\+/g," ")),T)}))}i=Pi.prototype,i.add=function(p,E){ys(this),this.i=null,p=ti(this,p);var T=this.g.get(p);return T||this.g.set(p,T=[]),T.push(E),this.h+=1,this};function Li(p,E){ys(p),E=ti(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function Oi(p,E){return ys(p),E=ti(p,E),p.g.has(E)}i.forEach=function(p,E){ys(this),this.g.forEach(function(T,P){T.forEach(function(Q){p.call(E,Q,P,this)},this)},this)},i.na=function(){ys(this);const p=Array.from(this.g.values()),E=Array.from(this.g.keys()),T=[];for(let P=0;P<E.length;P++){const Q=p[P];for(let nt=0;nt<Q.length;nt++)T.push(E[P])}return T},i.V=function(p){ys(this);let E=[];if(typeof p=="string")Oi(this,p)&&(E=E.concat(this.g.get(ti(this,p))));else{p=Array.from(this.g.values());for(let T=0;T<p.length;T++)E=E.concat(p[T])}return E},i.set=function(p,E){return ys(this),this.i=null,p=ti(this,p),Oi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},i.get=function(p,E){return p?(p=this.V(p),0<p.length?String(p[0]):E):E};function mc(p,E,T){Li(p,E),0<T.length&&(p.i=null,p.g.set(ti(p,E),S(T)),p.h+=T.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(var T=0;T<E.length;T++){var P=E[T];const nt=encodeURIComponent(String(P)),dt=this.V(P);for(P=0;P<dt.length;P++){var Q=nt;dt[P]!==""&&(Q+="="+encodeURIComponent(String(dt[P]))),p.push(Q)}}return this.i=p.join("&")};function ti(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function Ch(p,E){E&&!p.j&&(ys(p),p.i=null,p.g.forEach(function(T,P){var Q=P.toLowerCase();P!=Q&&(Li(this,P),mc(this,Q,T))},p)),p.j=E}function Ma(p,E){const T=new ms;if(u.Image){const P=new Image;P.onload=A(vs,T,"TestLoadImage: loaded",!0,E,P),P.onerror=A(vs,T,"TestLoadImage: error",!1,E,P),P.onabort=A(vs,T,"TestLoadImage: abort",!1,E,P),P.ontimeout=A(vs,T,"TestLoadImage: timeout",!1,E,P),u.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=p}else E(!1)}function js(p,E){const T=new ms,P=new AbortController,Q=setTimeout(()=>{P.abort(),vs(T,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:P.signal}).then(nt=>{clearTimeout(Q),nt.ok?vs(T,"TestPingServer: ok",!0,E):vs(T,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(Q),vs(T,"TestPingServer: error",!1,E)})}function vs(p,E,T,P,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),P(T)}catch{}}function Pa(){this.g=new Ta}function ei(p,E,T){const P=T||"";try{dc(p,function(Q,nt){let dt=Q;f(Q)&&(dt=Ls(Q)),E.push(P+nt+"="+encodeURIComponent(dt))})}catch(Q){throw E.push(P+"type="+encodeURIComponent("_badmap")),Q}}function Tr(p){this.l=p.Ub||null,this.j=p.eb||!1}w(Tr,sc),Tr.prototype.g=function(){return new ji(this.l,this.j)},Tr.prototype.i=(function(p){return function(){return p}})({});function ji(p,E){Ne.call(this),this.D=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(ji,Ne),i=ji.prototype,i.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=E,this.readyState=1,si(this)},i.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(E.body=p),(this.D||u).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ni(this)),this.readyState=0},i.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,si(this)),this.g&&(this.readyState=3,si(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gc(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function gc(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}i.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?ni(this):si(this),this.readyState==3&&gc(this)}},i.Ra=function(p){this.g&&(this.response=this.responseText=p,ni(this))},i.Qa=function(p){this.g&&(this.response=p,ni(this))},i.ga=function(){this.g&&ni(this)};function ni(p){p.readyState=4,p.l=null,p.j=null,p.v=null,si(p)}i.setRequestHeader=function(p,E){this.u.append(p,E)},i.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var T=E.next();!T.done;)T=T.value,p.push(T[0]+": "+T[1]),T=E.next();return p.join(`\r
`)};function si(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(ji.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function yc(p){let E="";return F(p,function(T,P){E+=P,E+=":",E+=T,E+=`\r
`}),E}function ln(p,E,T){t:{for(P in T){var P=!1;break t}P=!0}P||(T=yc(T),typeof p=="string"?T!=null&&encodeURIComponent(String(T)):ue(p,E,T))}function re(p){Ne.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(re,Ne);var jo=/^https?$/i,La=["POST","PUT"];i=re.prototype,i.Ha=function(p){this.J=p},i.ea=function(p,E,T,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Qs.g(),this.v=this.o?ic(this.o):ic(Qs),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(nt){Rh(this,nt);return}if(p=T||"",T=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var Q in P)T.set(Q,P[Q]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const nt of P.keys())T.set(nt,P.get(nt));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(T.keys()).find(nt=>nt.toLowerCase()=="content-type"),Q=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(La,E,void 0))||P||Q||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[nt,dt]of T)this.g.setRequestHeader(nt,dt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Oa(this),this.u=!0,this.g.send(p),this.u=!1}catch(nt){Rh(this,nt)}};function Rh(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.m=5,Vo(p),ii(p)}function Vo(p){p.A||(p.A=!0,oe(p,"complete"),oe(p,"error"))}i.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,oe(this,"complete"),oe(this,"abort"),ii(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),re.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Uo(this):this.bb())},i.bb=function(){Uo(this)};function Uo(p){if(p.h&&typeof l<"u"&&(!p.v[1]||_s(p)!=4||p.Z()!=2)){if(p.u&&_s(p)==4)Tn(p.Ea,0,p);else if(oe(p,"readystatechange"),_s(p)==4){p.h=!1;try{const dt=p.Z();t:switch(dt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break t;default:E=!1}var T;if(!(T=E)){var P;if(P=dt===0){var Q=String(p.D).match(Ia)[1]||null;!Q&&u.self&&u.self.location&&(Q=u.self.location.protocol.slice(0,-1)),P=!jo.test(Q?Q.toLowerCase():"")}T=P}if(T)oe(p,"complete"),oe(p,"success");else{p.m=6;try{var nt=2<_s(p)?p.g.statusText:""}catch{nt=""}p.l=nt+" ["+p.Z()+"]",Vo(p)}}finally{ii(p)}}}}function ii(p,E){if(p.g){Oa(p);const T=p.g,P=p.v[0]?()=>{}:null;p.g=null,p.v=null,E||oe(p,"ready");try{T.onreadystatechange=P}catch{}}}function Oa(p){p.I&&(u.clearTimeout(p.I),p.I=null)}i.isActive=function(){return!!this.g};function _s(p){return p.g?p.g.readyState:0}i.Z=function(){try{return 2<_s(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),Io(E)}};function Ih(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Dp(p){const E={};p=(p.g&&2<=_s(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<p.length;P++){if(V(p[P]))continue;var T=U(p[P]);const Q=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const nt=E[Q]||[];E[Q]=nt,nt.push(T)}C(E,function(P){return P.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ja(p,E,T){return T&&T.internalChannelParams&&T.internalChannelParams[p]||E}function Fo(p){this.Aa=0,this.i=[],this.j=new ms,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ja("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ja("baseRetryDelayMs",5e3,p),this.cb=ja("retryDelaySeedMs",1e4,p),this.Wa=ja("forwardChannelMaxRetries",2,p),this.wa=ja("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Di(p&&p.concurrentRequestLimit),this.Da=new Pa,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=Fo.prototype,i.la=8,i.G=1,i.connect=function(p,E,T,P){Ae(0),this.W=p,this.H=E||{},T&&P!==void 0&&(this.H.OSID=T,this.H.OAID=P),this.F=this.X,this.I=Oh(this,null,this.W),zo(this)};function vc(p){if(Nh(p),p.G==3){var E=p.U++,T=es(p.I);if(ue(T,"SID",p.K),ue(T,"RID",E),ue(T,"TYPE","terminate"),Va(p,T),E=new Pn(p,p.j,E),E.L=2,E.v=ka(es(T)),T=!1,u.navigator&&u.navigator.sendBeacon)try{T=u.navigator.sendBeacon(E.v.toString(),"")}catch{}!T&&u.Image&&(new Image().src=E.v,T=!0),T||(E.g=jh(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Ca(E)}Lh(p)}function Bo(p){p.g&&(Ua(p),p.g.cancel(),p.g=null)}function Nh(p){Bo(p),p.u&&(u.clearTimeout(p.u),p.u=null),Ho(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function zo(p){if(!Do(p.h)&&!p.s){p.s=!0;var E=p.Ga;X||q(),ut||(X(),ut=!0),xt.add(E,p),p.B=0}}function Mp(p,E){return Mo(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=E.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=ze(b(p.Ga,p,E),Ac(p,p.B)),p.B++,!0)}i.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const Q=new Pn(this,this.j,p);let nt=this.o;if(this.S&&(nt?(nt=I(nt),O(nt,this.S)):nt=this.S),this.m!==null||this.O||(Q.H=nt,nt=null),this.P)t:{for(var E=0,T=0;T<this.i.length;T++){e:{var P=this.i[T];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break e}P=void 0}if(P===void 0)break;if(E+=P,4096<E){E=T;break t}if(E===4096||T===this.i.length-1){E=T+1;break t}}E=1e3}else E=1e3;E=kh(this,Q,E),T=es(this.I),ue(T,"RID",p),ue(T,"CVER",22),this.D&&ue(T,"X-HTTP-Session-Id",this.D),Va(this,T),nt&&(this.O?E="headers="+encodeURIComponent(String(yc(nt)))+"&"+E:this.m&&ln(T,this.m,nt)),Po(this.h,Q),this.Ua&&ue(T,"TYPE","init"),this.P?(ue(T,"$req",E),ue(T,"SID","null"),Q.T=!0,Os(Q,T,null)):Os(Q,T,E),this.G=2}}else this.G==3&&(p?_c(this,p):this.i.length==0||Do(this.h)||_c(this))};function _c(p,E){var T;E?T=E.l:T=p.U++;const P=es(p.I);ue(P,"SID",p.K),ue(P,"RID",T),ue(P,"AID",p.T),Va(p,P),p.m&&p.o&&ln(P,p.m,p.o),T=new Pn(p,p.j,T,p.B+1),p.m===null&&(T.H=p.o),E&&(p.i=E.D.concat(p.i)),E=kh(p,T,1e3),T.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Po(p.h,T),Os(T,P,E)}function Va(p,E){p.H&&F(p.H,function(T,P){ue(E,P,T)}),p.l&&dc({},function(T,P){ue(E,P,T)})}function kh(p,E,T){T=Math.min(p.i.length,T);var P=p.l?b(p.l.Na,p.l,p):null;t:{var Q=p.i;let nt=-1;for(;;){const dt=["count="+T];nt==-1?0<T?(nt=Q[0].g,dt.push("ofs="+nt)):nt=0:dt.push("ofs="+nt);let Zt=!0;for(let en=0;en<T;en++){let Jt=Q[en].g;const cn=Q[en].map;if(Jt-=nt,0>Jt)nt=Math.max(0,Q[en].g-100),Zt=!1;else try{ei(cn,dt,"req"+Jt+"_")}catch{P&&P(cn)}}if(Zt){P=dt.join("&");break t}}}return p=p.i.splice(0,T),E.D=p,P}function Dh(p){if(!p.g&&!p.u){p.Y=1;var E=p.Fa;X||q(),ut||(X(),ut=!0),xt.add(E,p),p.v=0}}function bc(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=ze(b(p.Fa,p),Ac(p,p.v)),p.v++,!0)}i.Fa=function(){if(this.u=null,Mh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=ze(b(this.ab,this),p)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ae(10),Bo(this),Mh(this))};function Ua(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function Mh(p){p.g=new Pn(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var E=es(p.qa);ue(E,"RID","rpc"),ue(E,"SID",p.K),ue(E,"AID",p.T),ue(E,"CI",p.F?"0":"1"),!p.F&&p.ja&&ue(E,"TO",p.ja),ue(E,"TYPE","xmlhttp"),Va(p,E),p.m&&p.o&&ln(E,p.m,p.o),p.L&&(p.g.I=p.L);var T=p.g;p=p.ia,T.L=1,T.v=ka(es(E)),T.m=null,T.P=!0,ki(T,p)}i.Za=function(){this.C!=null&&(this.C=null,Bo(this),bc(this),Ae(19))};function Ho(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Ph(p,E){var T=null;if(p.g==E){Ho(p),Ua(p),p.g=null;var P=2}else if(uc(p.h,E))T=E.D,Ln(p.h,E),P=1;else return;if(p.G!=0){if(E.o)if(P==1){T=E.m?E.m.length:0,E=Date.now()-E.F;var Q=p.B;P=_r(),oe(P,new tn(P,T)),zo(p)}else Dh(p);else if(Q=E.s,Q==3||Q==0&&0<E.X||!(P==1&&Mp(p,E)||P==2&&bc(p)))switch(T&&0<T.length&&(E=p.h,E.i=E.i.concat(T)),Q){case 1:Vi(p,5);break;case 4:Vi(p,10);break;case 3:Vi(p,6);break;default:Vi(p,2)}}}function Ac(p,E){let T=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(T*=2),T*E}function Vi(p,E){if(p.j.info("Error code "+E),E==2){var T=b(p.fb,p),P=p.Xa;const Q=!P;P=new He(P||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Na(P,"https"),ka(P),Q?Ma(P.toString(),T):js(P.toString(),T)}else Ae(2);p.G=0,p.l&&p.l.sa(E),Lh(p),Nh(p)}i.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Ae(2)):(this.j.info("Failed to ping google.com"),Ae(1))};function Lh(p){if(p.G=0,p.ka=[],p.l){const E=hc(p.h);(E.length!=0||p.i.length!=0)&&(N(p.ka,E),N(p.ka,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.ra()}}function Oh(p,E,T){var P=T instanceof He?es(T):new He(T);if(P.g!="")E&&(P.g=E+"."+P.g),Sr(P,P.s);else{var Q=u.location;P=Q.protocol,E=E?E+"."+Q.hostname:Q.hostname,Q=+Q.port;var nt=new He(null);P&&Na(nt,P),E&&(nt.g=E),Q&&Sr(nt,Q),T&&(nt.l=T),P=nt}return T=p.D,E=p.ya,T&&E&&ue(P,T,E),ue(P,"VER",p.la),Va(p,P),P}function jh(p,E,T){if(E&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Ca&&!p.pa?new re(new Tr({eb:T})):new re(p.pa),E.Ha(p.J),E}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vh(){}i=Vh.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Go(){}Go.prototype.g=function(p,E){return new On(p,E)};function On(p,E){Ne.call(this),this.g=new Fo(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(p?p["X-WebChannel-Client-Profile"]=E.va:p={"X-WebChannel-Client-Profile":E.va}),this.g.S=p,(p=E&&E.Sb)&&!V(p)&&(this.g.m=p),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!V(E)&&(this.g.D=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new ri(this)}w(On,Ne),On.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){vc(this.g)},On.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var T={};T.__data__=p,p=T}else this.u&&(T={},T.__data__=Ls(p),p=T);E.i.push(new Th(E.Ya++,p)),E.G==3&&zo(E)},On.prototype.N=function(){this.g.l=null,delete this.j,vc(this.g),delete this.g,On.aa.N.call(this)};function Uh(p){Ii.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){t:{for(const T in E){p=T;break t}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}w(Uh,Ii);function Fh(){ac.call(this),this.status=1}w(Fh,ac);function ri(p){this.g=p}w(ri,Vh),ri.prototype.ua=function(){oe(this.g,"a")},ri.prototype.ta=function(p){oe(this.g,new Uh(p))},ri.prototype.sa=function(p){oe(this.g,new Fh)},ri.prototype.ra=function(){oe(this.g,"b")},Go.prototype.createWebChannel=Go.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,QS=function(){return new Go},XS=function(){return _r()},YS=Xs,py={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Er.NO_ERROR=0,Er.TIMEOUT=8,Er.HTTP_ERROR=6,uf=Er,Ni.COMPLETE="complete",WS=Ni,rc.EventType=Ri,Ri.OPEN="a",Ri.CLOSE="b",Ri.ERROR="c",Ri.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,_u=rc,re.prototype.listenOnce=re.prototype.L,re.prototype.getLastError=re.prototype.Ka,re.prototype.getLastErrorCode=re.prototype.Ba,re.prototype.getStatus=re.prototype.Z,re.prototype.getResponseJson=re.prototype.Oa,re.prototype.getResponseText=re.prototype.oa,re.prototype.send=re.prototype.ea,re.prototype.setWithCredentials=re.prototype.Ha,KS=re}).apply(typeof Hd<"u"?Hd:typeof self<"u"?self:typeof window<"u"?window:{});const fw="@firebase/firestore",pw="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Nn.UNAUTHENTICATED=new Nn(null),Nn.GOOGLE_CREDENTIALS=new Nn("google-credentials-uid"),Nn.FIRST_PARTY=new Nn("first-party-uid"),Nn.MOCK_USER=new Nn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=new tv("@firebase/firestore");function _l(){return mo.logLevel}function mt(i,...t){if(mo.logLevel<=Kt.DEBUG){const e=t.map(fv);mo.debug(`Firestore (${Wl}): ${i}`,...e)}}function pr(i,...t){if(mo.logLevel<=Kt.ERROR){const e=t.map(fv);mo.error(`Firestore (${Wl}): ${i}`,...e)}}function go(i,...t){if(mo.logLevel<=Kt.WARN){const e=t.map(fv);mo.warn(`Firestore (${Wl}): ${i}`,...e)}}function fv(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(e){return JSON.stringify(e)})(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(i,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,ZS(i,n,e)}function ZS(i,t,e){let n=`FIRESTORE (${Wl}) INTERNAL ASSERTION FAILED: ${t} (ID: ${i.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw pr(n),new Error(n)}function ae(i,t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,i||ZS(t,s,n)}function Vt(i,t){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends xi{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class tT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Nn.UNAUTHENTICATED)))}shutdown(){}}class yM{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class vM{constructor(t){this.t=t,this.currentUser=Nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){ae(this.o===void 0,42304);let n=this.i;const s=h=>this.i!==n?(n=this.i,e(h)):Promise.resolve();let o=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new cr,t.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const h=o;t.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},u=h=>{mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new cr)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((n=>this.i!==t?(mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ae(typeof n.accessToken=="string",31837,{l:n}),new JS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ae(t===null||typeof t=="string",2055,{h:t}),new Nn(t)}}class _M{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=Nn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bM{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new _M(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Nn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mw{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AM{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zn(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){ae(this.o===void 0,3512);const n=o=>{o.error!=null&&mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,mt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable((()=>n(o)))};const s=o=>{mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mw(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(ae(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new mw(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(i){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(i);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<i;n++)e[n]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=EM(40);for(let o=0;o<s.length;++o)n.length<20&&s[o]<e&&(n+=t.charAt(s[o]%62))}return n}}function Wt(i,t){return i<t?-1:i>t?1:0}function my(i,t){const e=Math.min(i.length,t.length);for(let n=0;n<e;n++){const s=i.charAt(n),o=t.charAt(n);if(s!==o)return Fg(s)===Fg(o)?Wt(s,o):Fg(s)?1:-1}return Wt(i.length,t.length)}const wM=55296,SM=57343;function Fg(i){const t=i.charCodeAt(0);return t>=wM&&t<=SM}function Vl(i,t,e){return i.length===t.length&&i.every(((n,s)=>e(n,t[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw="__name__";class yi{constructor(t,e,n){e===void 0?e=0:e>t.length&&Dt(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&Dt(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return yi.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof yi?t.forEach((n=>{e.push(n)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const o=yi.compareSegments(t.get(s),e.get(s));if(o!==0)return o}return Wt(t.length,e.length)}static compareSegments(t,e){const n=yi.isNumericId(t),s=yi.isNumericId(e);return n&&!s?-1:!n&&s?1:n&&s?yi.extractNumericId(t).compare(yi.extractNumericId(e)):my(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return sa.fromString(t.substring(4,t.length-2))}}class _e extends yi{construct(t,e,n){return new _e(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new pt(rt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((s=>s.length>0)))}return new _e(e)}static emptyPath(){return new _e([])}}const TM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pn extends yi{construct(t,e,n){return new pn(t,e,n)}static isValidIdentifier(t){return TM.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gw}static keyField(){return new pn([gw])}static fromServerFormat(t){const e=[];let n="",s=0;const o=()=>{if(n.length===0)throw new pt(rt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let l=!1;for(;s<t.length;){const u=t[s];if(u==="\\"){if(s+1===t.length)throw new pt(rt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const h=t[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new pt(rt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=h,s+=2}else u==="`"?(l=!l,s++):u!=="."||l?(n+=u,s++):(o(),s++)}if(o(),l)throw new pt(rt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new pn(e)}static emptyPath(){return new pn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(t){this.path=t}static fromPath(t){return new wt(_e.fromString(t))}static fromName(t){return new wt(_e.fromString(t).popFirst(5))}static empty(){return new wt(_e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&_e.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return _e.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new wt(new _e(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(i,t,e){if(!e)throw new pt(rt.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${t}.`)}function nT(i,t,e,n){if(t===!0&&n===!0)throw new pt(rt.INVALID_ARGUMENT,`${i} and ${e} cannot be used together.`)}function yw(i){if(!wt.isDocumentKey(i))throw new pt(rt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function vw(i){if(wt.isDocumentKey(i))throw new pt(rt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function sT(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Zf(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const t=(function(n){return n.constructor?n.constructor.name:null})(i);return t?`a custom ${t} object`:"an object"}}return typeof i=="function"?"a function":Dt(12329,{type:typeof i})}function fs(i,t){if("_delegate"in i&&(i=i._delegate),!(i instanceof t)){if(t.name===i.constructor.name)throw new pt(rt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Zf(i);throw new pt(rt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return i}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Je(i,t){const e={typeString:i};return t&&(e.value=t),e}function nh(i,t){if(!sT(i))throw new pt(rt.INVALID_ARGUMENT,"JSON must be an object");let e;for(const n in t)if(t[n]){const s=t[n].typeString,o="value"in t[n]?{value:t[n].value}:void 0;if(!(n in i)){e=`JSON missing required field: '${n}'`;break}const l=i[n];if(s&&typeof l!==s){e=`JSON field '${n}' must be a ${s}.`;break}if(o!==void 0&&l!==o.value){e=`Expected '${n}' field to equal '${o.value}'`;break}}if(e)throw new pt(rt.INVALID_ARGUMENT,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=-62135596800,bw=1e6;class be{static now(){return be.fromMillis(Date.now())}static fromDate(t){return be.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*bw);return new be(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new pt(rt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new pt(rt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<_w)throw new pt(rt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new pt(rt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bw}_compareTo(t){return this.seconds===t.seconds?Wt(this.nanoseconds,t.nanoseconds):Wt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(nh(t,be._jsonSchema))return new be(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-_w;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}be._jsonSchemaVersion="firestore/timestamp/1.0",be._jsonSchema={type:Je("string",be._jsonSchemaVersion),seconds:Je("number"),nanoseconds:Je("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{static fromTimestamp(t){return new Lt(t)}static min(){return new Lt(new be(0,0))}static max(){return new Lt(new be(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu=-1;function xM(i,t){const e=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=Lt.fromTimestamp(n===1e9?new be(e+1,0):new be(e,n));return new aa(s,wt.empty(),t)}function CM(i){return new aa(i.readTime,i.key,Vu)}class aa{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new aa(Lt.min(),wt.empty(),Vu)}static max(){return new aa(Lt.max(),wt.empty(),Vu)}}function RM(i,t){let e=i.readTime.compareTo(t.readTime);return e!==0?e:(e=wt.comparator(i.documentKey,t.documentKey),e!==0?e:Wt(i.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yl(i){if(i.code!==rt.FAILED_PRECONDITION||i.message!==IM)throw i;mt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new lt(((n,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(n,s)},this.catchCallback=o=>{this.wrapFailure(e,o).next(n,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof lt?e:lt.resolve(e)}catch(e){return lt.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):lt.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):lt.reject(e)}static resolve(t){return new lt(((e,n)=>{e(t)}))}static reject(t){return new lt(((e,n)=>{n(t)}))}static waitFor(t){return new lt(((e,n)=>{let s=0,o=0,l=!1;t.forEach((u=>{++s,u.next((()=>{++o,l&&o===s&&e()}),(h=>n(h)))})),l=!0,o===s&&e()}))}static or(t){let e=lt.resolve(!1);for(const n of t)e=e.next((s=>s?lt.resolve(s):n()));return e}static forEach(t,e){const n=[];return t.forEach(((s,o)=>{n.push(e.call(this,s,o))})),this.waitFor(n)}static mapArray(t,e){return new lt(((n,s)=>{const o=t.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const f=h;e(t[f]).next((m=>{l[f]=m,++u,u===o&&n(l)}),(m=>s(m)))}}))}static doWhile(t,e){return new lt(((n,s)=>{const o=()=>{t()===!0?e().next((()=>{o()}),s):n()};o()}))}}function kM(i){const t=i.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Xl(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>e.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Jf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=-1;function tp(i){return i==null}function Rf(i){return i===0&&1/i==-1/0}function DM(i){return typeof i=="number"&&Number.isInteger(i)&&!Rf(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="";function MM(i){let t="";for(let e=0;e<i.length;e++)t.length>0&&(t=Aw(t)),t=PM(i.get(e),t);return Aw(t)}function PM(i,t){let e=t;const n=i.length;for(let s=0;s<n;s++){const o=i.charAt(s);switch(o){case"\0":e+="";break;case iT:e+="";break;default:e+=o}}return e}function Aw(i){return i+iT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(i){let t=0;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t++;return t}function va(i,t){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t(e,i[e])}function rT(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(t,e){this.comparator=t,this.root=e||En.EMPTY}insert(t,e){return new Ie(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,En.BLACK,null,null))}remove(t){return new Ie(this.comparator,this.root.remove(t,this.comparator).copy(null,null,En.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return e+n.left.size;s<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Gd(this.root,t,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Gd(this.root,t,this.comparator,!0)}}class Gd{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?n(t.key,e):1,e&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class En{constructor(t,e,n,s,o){this.key=t,this.value=e,this.color=n??En.RED,this.left=s??En.EMPTY,this.right=o??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,s,o){return new En(t??this.key,e??this.value,n??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const o=n(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,e,n),null):o===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return En.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Dt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Dt(27949);return t+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt(57766)}get value(){throw Dt(16141)}get color(){throw Dt(16727)}get left(){throw Dt(29726)}get right(){throw Dt(36894)}copy(t,e,n,s,o){return this}insert(t,e,n){return new En(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(t){this.comparator=t,this.data=new Ie(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new ww(this.data.getIterator())}getIteratorFrom(t){return new ww(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((n=>{e=e.add(n)})),e}isEqual(t){if(!(t instanceof on)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=n.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new on(this.comparator);return e.data=t,e}}class ww{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(t){this.fields=t,t.sort(pn.comparator)}static empty(){return new ds([])}unionWith(t){let e=new on(pn.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new ds(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Vl(this.fields,t.fields,((e,n)=>e.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new aT("Invalid base64 string: "+o):o}})(t);return new mn(e)}static fromUint8Array(t){const e=(function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o})(t);return new mn(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Wt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}mn.EMPTY_BYTE_STRING=new mn("");const LM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oa(i){if(ae(!!i,39018),typeof i=="string"){let t=0;const e=LM.exec(i);if(ae(!!e,46558,{timestamp:i}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Ue(i.seconds),nanos:Ue(i.nanos)}}function Ue(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function la(i){return typeof i=="string"?mn.fromBase64String(i):mn.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="server_timestamp",lT="__type__",cT="__previous_value__",uT="__local_write_time__";function mv(i){return(i?.mapValue?.fields||{})[lT]?.stringValue===oT}function ep(i){const t=i.mapValue.fields[cT];return mv(t)?ep(t):t}function Uu(i){const t=oa(i.mapValue.fields[uT].timestampValue);return new be(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(t,e,n,s,o,l,u,h,f,m){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=f,this.isUsingEmulator=m}}const If="(default)";class Ul{constructor(t,e){this.projectId=t,this.database=e||If}static empty(){return new Ul("","")}get isDefaultDatabase(){return this.database===If}isEqual(t){return t instanceof Ul&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="__type__",jM="__max__",qd={mapValue:{}},dT="__vector__",Nf="value";function ca(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?mv(i)?4:UM(i)?9007199254740991:VM(i)?10:11:Dt(28295,{value:i})}function wi(i,t){if(i===t)return!0;const e=ca(i);if(e!==ca(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return Uu(i).isEqual(Uu(t));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=oa(s.timestampValue),u=oa(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(i,t);case 5:return i.stringValue===t.stringValue;case 6:return(function(s,o){return la(s.bytesValue).isEqual(la(o.bytesValue))})(i,t);case 7:return i.referenceValue===t.referenceValue;case 8:return(function(s,o){return Ue(s.geoPointValue.latitude)===Ue(o.geoPointValue.latitude)&&Ue(s.geoPointValue.longitude)===Ue(o.geoPointValue.longitude)})(i,t);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Ue(s.integerValue)===Ue(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=Ue(s.doubleValue),u=Ue(o.doubleValue);return l===u?Rf(l)===Rf(u):isNaN(l)&&isNaN(u)}return!1})(i,t);case 9:return Vl(i.arrayValue.values||[],t.arrayValue.values||[],wi);case 10:case 11:return(function(s,o){const l=s.mapValue.fields||{},u=o.mapValue.fields||{};if(Ew(l)!==Ew(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!wi(l[h],u[h])))return!1;return!0})(i,t);default:return Dt(52216,{left:i})}}function Fu(i,t){return(i.values||[]).find((e=>wi(e,t)))!==void 0}function Fl(i,t){if(i===t)return 0;const e=ca(i),n=ca(t);if(e!==n)return Wt(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return Wt(i.booleanValue,t.booleanValue);case 2:return(function(o,l){const u=Ue(o.integerValue||o.doubleValue),h=Ue(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(i,t);case 3:return Sw(i.timestampValue,t.timestampValue);case 4:return Sw(Uu(i),Uu(t));case 5:return my(i.stringValue,t.stringValue);case 6:return(function(o,l){const u=la(o),h=la(l);return u.compareTo(h)})(i.bytesValue,t.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let f=0;f<u.length&&f<h.length;f++){const m=Wt(u[f],h[f]);if(m!==0)return m}return Wt(u.length,h.length)})(i.referenceValue,t.referenceValue);case 8:return(function(o,l){const u=Wt(Ue(o.latitude),Ue(l.latitude));return u!==0?u:Wt(Ue(o.longitude),Ue(l.longitude))})(i.geoPointValue,t.geoPointValue);case 9:return Tw(i.arrayValue,t.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},f=u[Nf]?.arrayValue,m=h[Nf]?.arrayValue,v=Wt(f?.values?.length||0,m?.values?.length||0);return v!==0?v:Tw(f,m)})(i.mapValue,t.mapValue);case 11:return(function(o,l){if(o===qd.mapValue&&l===qd.mapValue)return 0;if(o===qd.mapValue)return 1;if(l===qd.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),f=l.fields||{},m=Object.keys(f);h.sort(),m.sort();for(let v=0;v<h.length&&v<m.length;++v){const b=my(h[v],m[v]);if(b!==0)return b;const A=Fl(u[h[v]],f[m[v]]);if(A!==0)return A}return Wt(h.length,m.length)})(i.mapValue,t.mapValue);default:throw Dt(23264,{he:e})}}function Sw(i,t){if(typeof i=="string"&&typeof t=="string"&&i.length===t.length)return Wt(i,t);const e=oa(i),n=oa(t),s=Wt(e.seconds,n.seconds);return s!==0?s:Wt(e.nanos,n.nanos)}function Tw(i,t){const e=i.values||[],n=t.values||[];for(let s=0;s<e.length&&s<n.length;++s){const o=Fl(e[s],n[s]);if(o)return o}return Wt(e.length,n.length)}function Bl(i){return gy(i)}function gy(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(e){const n=oa(e);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(e){return la(e).toBase64()})(i.bytesValue):"referenceValue"in i?(function(e){return wt.fromName(e).toString()})(i.referenceValue):"geoPointValue"in i?(function(e){return`geo(${e.latitude},${e.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(e){let n="[",s=!0;for(const o of e.values||[])s?s=!1:n+=",",n+=gy(o);return n+"]"})(i.arrayValue):"mapValue"in i?(function(e){const n=Object.keys(e.fields||{}).sort();let s="{",o=!0;for(const l of n)o?o=!1:s+=",",s+=`${l}:${gy(e.fields[l])}`;return s+"}"})(i.mapValue):Dt(61005,{value:i})}function hf(i){switch(ca(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ep(i);return t?16+hf(t):16;case 5:return 2*i.stringValue.length;case 6:return la(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,o)=>s+hf(o)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return va(n.fields,((o,l)=>{s+=o.length+hf(l)})),s})(i.mapValue);default:throw Dt(13486,{value:i})}}function xw(i,t){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${t.path.canonicalString()}`}}function yy(i){return!!i&&"integerValue"in i}function gv(i){return!!i&&"arrayValue"in i}function Cw(i){return!!i&&"nullValue"in i}function Rw(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function df(i){return!!i&&"mapValue"in i}function VM(i){return(i?.mapValue?.fields||{})[hT]?.stringValue===dT}function Ru(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const t={mapValue:{fields:{}}};return va(i.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Ru(n))),t}if(i.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(i.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Ru(i.arrayValue.values[e]);return t}return{...i}}function UM(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===jM}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(t){this.value=t}static empty(){return new Jn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!df(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ru(e)}setAll(t){let e=pn.emptyPath(),n={},s=[];t.forEach(((l,u)=>{if(!e.isImmediateParentOf(u)){const h=this.getFieldsMap(e);this.applyChanges(h,n,s),n={},s=[],e=u.popLast()}l?n[u.lastSegment()]=Ru(l):s.push(u.lastSegment())}));const o=this.getFieldsMap(e);this.applyChanges(o,n,s)}delete(t){const e=this.field(t.popLast());df(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return wi(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=e.mapValue.fields[t.get(n)];df(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,n){va(e,((s,o)=>t[s]=o));for(const s of n)delete t[s]}clone(){return new Jn(Ru(this.value))}}function fT(i){const t=[];return va(i.fields,((e,n)=>{const s=new pn([e]);if(df(n)){const o=fT(n.mapValue).fields;if(o.length===0)t.push(s);else for(const l of o)t.push(s.child(l))}else t.push(s)})),new ds(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(t,e,n,s,o,l,u){this.key=t,this.documentType=e,this.version=n,this.readTime=s,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(t){return new kn(t,0,Lt.min(),Lt.min(),Lt.min(),Jn.empty(),0)}static newFoundDocument(t,e,n,s){return new kn(t,1,e,Lt.min(),n,s,0)}static newNoDocument(t,e){return new kn(t,2,e,Lt.min(),Lt.min(),Jn.empty(),0)}static newUnknownDocument(t,e){return new kn(t,3,e,Lt.min(),Lt.min(),Jn.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Jn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof kn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(t,e){this.position=t,this.inclusive=e}}function Iw(i,t,e){let n=0;for(let s=0;s<i.position.length;s++){const o=t[s],l=i.position[s];if(o.field.isKeyField()?n=wt.comparator(wt.fromName(l.referenceValue),e.key):n=Fl(l,e.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Nw(i,t){if(i===null)return t===null;if(t===null||i.inclusive!==t.inclusive||i.position.length!==t.position.length)return!1;for(let e=0;e<i.position.length;e++)if(!wi(i.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(t,e="asc"){this.field=t,this.dir=e}}function FM(i,t){return i.dir===t.dir&&i.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{}class Qe extends pT{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new zM(t,e,n):e==="array-contains"?new qM(t,n):e==="in"?new $M(t,n):e==="not-in"?new KM(t,n):e==="array-contains-any"?new WM(t,n):new Qe(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new HM(t,n):new GM(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Fl(e,this.value)):e!==null&&ca(this.value)===ca(e)&&this.matchesComparison(Fl(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ks extends pT{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new Ks(t,e)}matches(t){return mT(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function mT(i){return i.op==="and"}function gT(i){return BM(i)&&mT(i)}function BM(i){for(const t of i.filters)if(t instanceof Ks)return!1;return!0}function vy(i){if(i instanceof Qe)return i.field.canonicalString()+i.op.toString()+Bl(i.value);if(gT(i))return i.filters.map((t=>vy(t))).join(",");{const t=i.filters.map((e=>vy(e))).join(",");return`${i.op}(${t})`}}function yT(i,t){return i instanceof Qe?(function(n,s){return s instanceof Qe&&n.op===s.op&&n.field.isEqual(s.field)&&wi(n.value,s.value)})(i,t):i instanceof Ks?(function(n,s){return s instanceof Ks&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((o,l,u)=>o&&yT(l,s.filters[u])),!0):!1})(i,t):void Dt(19439)}function vT(i){return i instanceof Qe?(function(e){return`${e.field.canonicalString()} ${e.op} ${Bl(e.value)}`})(i):i instanceof Ks?(function(e){return e.op.toString()+" {"+e.getFilters().map(vT).join(" ,")+"}"})(i):"Filter"}class zM extends Qe{constructor(t,e,n){super(t,e,n),this.key=wt.fromName(n.referenceValue)}matches(t){const e=wt.comparator(t.key,this.key);return this.matchesComparison(e)}}class HM extends Qe{constructor(t,e){super(t,"in",e),this.keys=_T("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class GM extends Qe{constructor(t,e){super(t,"not-in",e),this.keys=_T("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function _T(i,t){return(t.arrayValue?.values||[]).map((e=>wt.fromName(e.referenceValue)))}class qM extends Qe{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return gv(e)&&Fu(e.arrayValue,this.value)}}class $M extends Qe{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Fu(this.value.arrayValue,e)}}class KM extends Qe{constructor(t,e){super(t,"not-in",e)}matches(t){if(Fu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Fu(this.value.arrayValue,e)}}class WM extends Qe{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!gv(e)||!e.arrayValue.values)&&e.arrayValue.values.some((n=>Fu(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(t,e=null,n=[],s=[],o=null,l=null,u=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=s,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function kw(i,t=null,e=[],n=[],s=null,o=null,l=null){return new YM(i,t,e,n,s,o,l)}function yv(i){const t=Vt(i);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((n=>vy(n))).join(","),e+="|ob:",e+=t.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),tp(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((n=>Bl(n))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((n=>Bl(n))).join(",")),t.Te=e}return t.Te}function vv(i,t){if(i.limit!==t.limit||i.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<i.orderBy.length;e++)if(!FM(i.orderBy[e],t.orderBy[e]))return!1;if(i.filters.length!==t.filters.length)return!1;for(let e=0;e<i.filters.length;e++)if(!yT(i.filters[e],t.filters[e]))return!1;return i.collectionGroup===t.collectionGroup&&!!i.path.isEqual(t.path)&&!!Nw(i.startAt,t.startAt)&&Nw(i.endAt,t.endAt)}function _y(i){return wt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(t,e=null,n=[],s=[],o=null,l="F",u=null,h=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=s,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function XM(i,t,e,n,s,o,l,u){return new Ql(i,t,e,n,s,o,l,u)}function _v(i){return new Ql(i)}function Dw(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function bT(i){return i.collectionGroup!==null}function Iu(i){const t=Vt(i);if(t.Ie===null){t.Ie=[];const e=new Set;for(const o of t.explicitOrderBy)t.Ie.push(o),e.add(o.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new on(pn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((f=>{f.isInequality()&&(u=u.add(f.field))}))})),u})(t).forEach((o=>{e.has(o.canonicalString())||o.isKeyField()||t.Ie.push(new Bu(o,n))})),e.has(pn.keyField().canonicalString())||t.Ie.push(new Bu(pn.keyField(),n))}return t.Ie}function Ai(i){const t=Vt(i);return t.Ee||(t.Ee=QM(t,Iu(i))),t.Ee}function QM(i,t){if(i.limitType==="F")return kw(i.path,i.collectionGroup,t,i.filters,i.limit,i.startAt,i.endAt);{t=t.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new Bu(s.field,o)}));const e=i.endAt?new kf(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new kf(i.startAt.position,i.startAt.inclusive):null;return kw(i.path,i.collectionGroup,t,i.filters,i.limit,e,n)}}function by(i,t){const e=i.filters.concat([t]);return new Ql(i.path,i.collectionGroup,i.explicitOrderBy.slice(),e,i.limit,i.limitType,i.startAt,i.endAt)}function Ay(i,t,e){return new Ql(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),t,e,i.startAt,i.endAt)}function np(i,t){return vv(Ai(i),Ai(t))&&i.limitType===t.limitType}function AT(i){return`${yv(Ai(i))}|lt:${i.limitType}`}function bl(i){return`Query(target=${(function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map((s=>vT(s))).join(", ")}]`),tp(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>Bl(s))).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>Bl(s))).join(",")),`Target(${n})`})(Ai(i))}; limitType=${i.limitType})`}function sp(i,t){return t.isFoundDocument()&&(function(n,s){const o=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):wt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(i,t)&&(function(n,s){for(const o of Iu(n))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(i,t)&&(function(n,s){for(const o of n.filters)if(!o.matches(s))return!1;return!0})(i,t)&&(function(n,s){return!(n.startAt&&!(function(l,u,h){const f=Iw(l,u,h);return l.inclusive?f<=0:f<0})(n.startAt,Iu(n),s)||n.endAt&&!(function(l,u,h){const f=Iw(l,u,h);return l.inclusive?f>=0:f>0})(n.endAt,Iu(n),s))})(i,t)}function ZM(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function ET(i){return(t,e)=>{let n=!1;for(const s of Iu(i)){const o=JM(s,t,e);if(o!==0)return o;n=n||s.field.isKeyField()}return 0}}function JM(i,t,e){const n=i.field.isKeyField()?wt.comparator(t.key,e.key):(function(o,l,u){const h=l.data.field(o),f=u.data.field(o);return h!==null&&f!==null?Fl(h,f):Dt(42886)})(i.field,t,e);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return Dt(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n!==void 0){for(const[s,o]of n)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,e]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[e]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){va(this.inner,((e,n)=>{for(const[s,o]of n)t(s,o)}))}isEmpty(){return rT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=new Ie(wt.comparator);function mr(){return tP}const wT=new Ie(wt.comparator);function bu(...i){let t=wT;for(const e of i)t=t.insert(e.key,e);return t}function ST(i){let t=wT;return i.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function io(){return Nu()}function TT(){return Nu()}function Nu(){return new wo((i=>i.toString()),((i,t)=>i.isEqual(t)))}const eP=new Ie(wt.comparator),nP=new on(wt.comparator);function Yt(...i){let t=nP;for(const e of i)t=t.add(e);return t}const sP=new on(Wt);function iP(){return sP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(i,t){if(i.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rf(t)?"-0":t}}function xT(i){return{integerValue:""+i}}function rP(i,t){return DM(t)?xT(t):bv(i,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this._=void 0}}function aP(i,t,e){return i instanceof zu?(function(s,o){const l={fields:{[lT]:{stringValue:oT},[uT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&mv(o)&&(o=ep(o)),o&&(l.fields[cT]=o),{mapValue:l}})(e,t):i instanceof Hu?RT(i,t):i instanceof Gu?IT(i,t):(function(s,o){const l=CT(s,o),u=Mw(l)+Mw(s.Ae);return yy(l)&&yy(s.Ae)?xT(u):bv(s.serializer,u)})(i,t)}function oP(i,t,e){return i instanceof Hu?RT(i,t):i instanceof Gu?IT(i,t):e}function CT(i,t){return i instanceof Df?(function(n){return yy(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(t)?t:{integerValue:0}:null}class zu extends ip{}class Hu extends ip{constructor(t){super(),this.elements=t}}function RT(i,t){const e=NT(t);for(const n of i.elements)e.some((s=>wi(s,n)))||e.push(n);return{arrayValue:{values:e}}}class Gu extends ip{constructor(t){super(),this.elements=t}}function IT(i,t){let e=NT(t);for(const n of i.elements)e=e.filter((s=>!wi(s,n)));return{arrayValue:{values:e}}}class Df extends ip{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Mw(i){return Ue(i.integerValue||i.doubleValue)}function NT(i){return gv(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(t,e){this.field=t,this.transform=e}}function cP(i,t){return i.field.isEqual(t.field)&&(function(n,s){return n instanceof Hu&&s instanceof Hu||n instanceof Gu&&s instanceof Gu?Vl(n.elements,s.elements,wi):n instanceof Df&&s instanceof Df?wi(n.Ae,s.Ae):n instanceof zu&&s instanceof zu})(i.transform,t.transform)}class uP{constructor(t,e){this.version=t,this.transformResults=e}}class zn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new zn}static exists(t){return new zn(void 0,t)}static updateTime(t){return new zn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ff(i,t){return i.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(i.updateTime):i.exists===void 0||i.exists===t.isFoundDocument()}class rp{}function kT(i,t){if(!i.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return i.isNoDocument()?new ap(i.key,zn.none()):new sh(i.key,i.data,zn.none());{const e=i.data,n=Jn.empty();let s=new on(pn.comparator);for(let o of t.fields)if(!s.has(o)){let l=e.field(o);l===null&&o.length>1&&(o=o.popLast(),l=e.field(o)),l===null?n.delete(o):n.set(o,l),s=s.add(o)}return new _a(i.key,n,new ds(s.toArray()),zn.none())}}function hP(i,t,e){i instanceof sh?(function(s,o,l){const u=s.value.clone(),h=Lw(s.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(i,t,e):i instanceof _a?(function(s,o,l){if(!ff(s.precondition,o))return void o.convertToUnknownDocument(l.version);const u=Lw(s.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(DT(s)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(i,t,e):(function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function ku(i,t,e,n){return i instanceof sh?(function(o,l,u,h){if(!ff(o.precondition,l))return u;const f=o.value.clone(),m=Ow(o.fieldTransforms,h,l);return f.setAll(m),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null})(i,t,e,n):i instanceof _a?(function(o,l,u,h){if(!ff(o.precondition,l))return u;const f=Ow(o.fieldTransforms,h,l),m=l.data;return m.setAll(DT(o)),m.setAll(f),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(i,t,e,n):(function(o,l,u){return ff(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(i,t,e)}function dP(i,t){let e=null;for(const n of i.fieldTransforms){const s=t.data.field(n.field),o=CT(n.transform,s||null);o!=null&&(e===null&&(e=Jn.empty()),e.set(n.field,o))}return e||null}function Pw(i,t){return i.type===t.type&&!!i.key.isEqual(t.key)&&!!i.precondition.isEqual(t.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Vl(n,s,((o,l)=>cP(o,l)))})(i.fieldTransforms,t.fieldTransforms)&&(i.type===0?i.value.isEqual(t.value):i.type!==1||i.data.isEqual(t.data)&&i.fieldMask.isEqual(t.fieldMask))}class sh extends rp{constructor(t,e,n,s=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class _a extends rp{constructor(t,e,n,s,o=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function DT(i){const t=new Map;return i.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const n=i.data.field(e);t.set(e,n)}})),t}function Lw(i,t,e){const n=new Map;ae(i.length===e.length,32656,{Re:e.length,Ve:i.length});for(let s=0;s<e.length;s++){const o=i[s],l=o.transform,u=t.data.field(o.field);n.set(o.field,oP(l,u,e[s]))}return n}function Ow(i,t,e){const n=new Map;for(const s of i){const o=s.transform,l=e.data.field(s.field);n.set(s.field,aP(o,l,t))}return n}class ap extends rp{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fP extends rp{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(t,e,n,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&hP(o,t,n[s])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=ku(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=ku(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=TT();return this.mutations.forEach((s=>{const o=t.get(s.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=e.has(s.key)?null:u;const h=kT(l,u);h!==null&&n.set(s.key,h),l.isValidDocument()||l.convertToNoDocument(Lt.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Yt())}isEqual(t){return this.batchId===t.batchId&&Vl(this.mutations,t.mutations,((e,n)=>Pw(e,n)))&&Vl(this.baseMutations,t.baseMutations,((e,n)=>Pw(e,n)))}}class Av{constructor(t,e,n,s){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=s}static from(t,e,n){ae(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let s=(function(){return eP})();const o=t.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,n[l].version);return new Av(t,e,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(t,e){this.count=t,this.unchangedNames=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye,ee;function yP(i){switch(i){case rt.OK:return Dt(64938);case rt.CANCELLED:case rt.UNKNOWN:case rt.DEADLINE_EXCEEDED:case rt.RESOURCE_EXHAUSTED:case rt.INTERNAL:case rt.UNAVAILABLE:case rt.UNAUTHENTICATED:return!1;case rt.INVALID_ARGUMENT:case rt.NOT_FOUND:case rt.ALREADY_EXISTS:case rt.PERMISSION_DENIED:case rt.FAILED_PRECONDITION:case rt.ABORTED:case rt.OUT_OF_RANGE:case rt.UNIMPLEMENTED:case rt.DATA_LOSS:return!0;default:return Dt(15467,{code:i})}}function MT(i){if(i===void 0)return pr("GRPC error has no .code"),rt.UNKNOWN;switch(i){case Ye.OK:return rt.OK;case Ye.CANCELLED:return rt.CANCELLED;case Ye.UNKNOWN:return rt.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return rt.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return rt.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return rt.INTERNAL;case Ye.UNAVAILABLE:return rt.UNAVAILABLE;case Ye.UNAUTHENTICATED:return rt.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return rt.INVALID_ARGUMENT;case Ye.NOT_FOUND:return rt.NOT_FOUND;case Ye.ALREADY_EXISTS:return rt.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return rt.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return rt.FAILED_PRECONDITION;case Ye.ABORTED:return rt.ABORTED;case Ye.OUT_OF_RANGE:return rt.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return rt.UNIMPLEMENTED;case Ye.DATA_LOSS:return rt.DATA_LOSS;default:return Dt(39323,{code:i})}}(ee=Ye||(Ye={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P=new sa([4294967295,4294967295],0);function jw(i){const t=vP().encode(i),e=new $S;return e.update(t),new Uint8Array(e.digest())}function Vw(i){const t=new DataView(i.buffer),e=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new sa([e,n],0),new sa([s,o],0)]}class Ev{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new Au(`Invalid padding: ${e}`);if(n<0)throw new Au(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new Au(`Invalid hash count: ${n}`);if(t.length===0&&e!==0)throw new Au(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=sa.fromNumber(this.ge)}ye(t,e,n){let s=t.add(e.multiply(sa.fromNumber(n)));return s.compare(_P)===1&&(s=new sa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=jw(t),[n,s]=Vw(e);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,s,o);if(!this.we(l))return!1}return!0}static create(t,e,n){const s=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),l=new Ev(o,s,e);return n.forEach((u=>l.insert(u))),l}insert(t){if(this.ge===0)return;const e=jw(t),[n,s]=Vw(e);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,s,o);this.Se(l)}}Se(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class Au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(t,e,n,s,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const s=new Map;return s.set(t,ih.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new op(Lt.min(),s,new Ie(Wt),mr(),Yt())}}class ih{constructor(t,e,n,s,o){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new ih(n,e,Yt(),Yt(),Yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(t,e,n,s){this.be=t,this.removedTargetIds=e,this.key=n,this.De=s}}class PT{constructor(t,e){this.targetId=t,this.Ce=e}}class LT{constructor(t,e,n=mn.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=s}}class Uw{constructor(){this.ve=0,this.Fe=Fw(),this.Me=mn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=Yt(),e=Yt(),n=Yt();return this.Fe.forEach(((s,o)=>{switch(o){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:n=n.add(s);break;default:Dt(38017,{changeType:o})}})),new ih(this.Me,this.xe,t,e,n)}qe(){this.Oe=!1,this.Fe=Fw()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,ae(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bP{constructor(t){this.Ge=t,this.ze=new Map,this.je=mr(),this.Je=$d(),this.He=$d(),this.Ye=new Ie(Wt)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const n=this.nt(e);switch(t.state){case 0:this.rt(e)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),n.Le(t.resumeToken));break;default:Dt(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((n,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,n=t.Ce.count,s=this.ot(e);if(s){const o=s.target;if(_y(o))if(n===0){const l=new wt(o.path);this.et(e,l,kn.newNoDocument(l,Lt.min()))}else ae(n===1,20013,{expectedCount:n});else{const l=this._t(e);if(l!==n){const u=this.ut(t),h=u?this.ct(u,t,l):1;if(h!==0){this.it(e);const f=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,f)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:o=0}=e;let l,u;try{l=la(n).toUint8Array()}catch(h){if(h instanceof aT)return go("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Ev(l,s,o)}catch(h){return go(h instanceof Au?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(t,e,n){return e.Ce.count===n-this.Pt(t,e.targetId)?0:2}Pt(t,e){const n=this.Ge.getRemoteKeysForTarget(e);let s=0;return n.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;t.mightContain(u)||(this.et(e,o,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&_y(u.target)){const h=new wt(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,kn.newNoDocument(h,t))}o.Be&&(e.set(l,o.ke()),o.qe())}}));let n=Yt();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const f=this.ot(h);return!f||f.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(t)));const s=new op(t,e,this.Ye,this.je,n);return this.je=mr(),this.Je=$d(),this.He=$d(),this.Ye=new Ie(Wt),s}Xe(t,e){if(!this.rt(t))return;const n=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,n),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,n){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),n&&(this.je=this.je.insert(e,n))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Uw,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new on(Wt),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new on(Wt),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||mt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Uw),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function $d(){return new Ie(wt.comparator)}function Fw(){return new Ie(wt.comparator)}const AP={asc:"ASCENDING",desc:"DESCENDING"},EP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wP={and:"AND",or:"OR"};class SP{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ey(i,t){return i.useProto3Json||tp(t)?t:{value:t}}function Mf(i,t){return i.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function OT(i,t){return i.useProto3Json?t.toBase64():t.toUint8Array()}function TP(i,t){return Mf(i,t.toTimestamp())}function Ei(i){return ae(!!i,49232),Lt.fromTimestamp((function(e){const n=oa(e);return new be(n.seconds,n.nanos)})(i))}function wv(i,t){return wy(i,t).canonicalString()}function wy(i,t){const e=(function(s){return new _e(["projects",s.projectId,"databases",s.database])})(i).child("documents");return t===void 0?e:e.child(t)}function jT(i){const t=_e.fromString(i);return ae(zT(t),10190,{key:t.toString()}),t}function Sy(i,t){return wv(i.databaseId,t.path)}function Bg(i,t){const e=jT(t);if(e.get(1)!==i.databaseId.projectId)throw new pt(rt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+i.databaseId.projectId);if(e.get(3)!==i.databaseId.database)throw new pt(rt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+i.databaseId.database);return new wt(UT(e))}function VT(i,t){return wv(i.databaseId,t)}function xP(i){const t=jT(i);return t.length===4?_e.emptyPath():UT(t)}function Ty(i){return new _e(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function UT(i){return ae(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Bw(i,t,e){return{name:Sy(i,t),fields:e.value.mapValue.fields}}function CP(i,t){let e;if("targetChange"in t){t.targetChange;const n=(function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Dt(39313,{state:f})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],o=(function(f,m){return f.useProto3Json?(ae(m===void 0||typeof m=="string",58123),mn.fromBase64String(m||"")):(ae(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),mn.fromUint8Array(m||new Uint8Array))})(i,t.targetChange.resumeToken),l=t.targetChange.cause,u=l&&(function(f){const m=f.code===void 0?rt.UNKNOWN:MT(f.code);return new pt(m,f.message||"")})(l);e=new LT(n,s,o,u||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=Bg(i,n.document.name),o=Ei(n.document.updateTime),l=n.document.createTime?Ei(n.document.createTime):Lt.min(),u=new Jn({mapValue:{fields:n.document.fields}}),h=kn.newFoundDocument(s,o,l,u),f=n.targetIds||[],m=n.removedTargetIds||[];e=new pf(f,m,h.key,h)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=Bg(i,n.document),o=n.readTime?Ei(n.readTime):Lt.min(),l=kn.newNoDocument(s,o),u=n.removedTargetIds||[];e=new pf([],u,l.key,l)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=Bg(i,n.document),o=n.removedTargetIds||[];e=new pf([],o,s,null)}else{if(!("filter"in t))return Dt(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:o}=n,l=new gP(s,o),u=n.targetId;e=new PT(u,l)}}return e}function RP(i,t){let e;if(t instanceof sh)e={update:Bw(i,t.key,t.value)};else if(t instanceof ap)e={delete:Sy(i,t.key)};else if(t instanceof _a)e={update:Bw(i,t.key,t.data),updateMask:jP(t.fieldMask)};else{if(!(t instanceof fP))return Dt(16599,{Vt:t.type});e={verify:Sy(i,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((n=>(function(o,l){const u=l.transform;if(u instanceof zu)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Hu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Gu)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Df)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Dt(20930,{transform:l.transform})})(0,n)))),t.precondition.isNone||(e.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:TP(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Dt(27497)})(i,t.precondition)),e}function IP(i,t){return i&&i.length>0?(ae(t!==void 0,14353),i.map((e=>(function(s,o){let l=s.updateTime?Ei(s.updateTime):Ei(o);return l.isEqual(Lt.min())&&(l=Ei(o)),new uP(l,s.transformResults||[])})(e,t)))):[]}function NP(i,t){return{documents:[VT(i,t.path)]}}function kP(i,t){const e={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=VT(i,s);const o=(function(f){if(f.length!==0)return BT(Ks.create(f,"and"))})(t.filters);o&&(e.structuredQuery.where=o);const l=(function(f){if(f.length!==0)return f.map((m=>(function(b){return{field:Al(b.field),direction:PP(b.dir)}})(m)))})(t.orderBy);l&&(e.structuredQuery.orderBy=l);const u=Ey(i,t.limit);return u!==null&&(e.structuredQuery.limit=u),t.startAt&&(e.structuredQuery.startAt=(function(f){return{before:f.inclusive,values:f.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(f){return{before:!f.inclusive,values:f.position}})(t.endAt)),{ft:e,parent:s}}function DP(i){let t=xP(i.parent);const e=i.structuredQuery,n=e.from?e.from.length:0;let s=null;if(n>0){ae(n===1,65062);const m=e.from[0];m.allDescendants?s=m.collectionId:t=t.child(m.collectionId)}let o=[];e.where&&(o=(function(v){const b=FT(v);return b instanceof Ks&&gT(b)?b.getFilters():[b]})(e.where));let l=[];e.orderBy&&(l=(function(v){return v.map((b=>(function(w){return new Bu(El(w.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(b)))})(e.orderBy));let u=null;e.limit&&(u=(function(v){let b;return b=typeof v=="object"?v.value:v,tp(b)?null:b})(e.limit));let h=null;e.startAt&&(h=(function(v){const b=!!v.before,A=v.values||[];return new kf(A,b)})(e.startAt));let f=null;return e.endAt&&(f=(function(v){const b=!v.before,A=v.values||[];return new kf(A,b)})(e.endAt)),XM(t,s,l,o,u,"F",h,f)}function MP(i,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function FT(i){return i.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=El(e.unaryFilter.field);return Qe.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=El(e.unaryFilter.field);return Qe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=El(e.unaryFilter.field);return Qe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=El(e.unaryFilter.field);return Qe.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Dt(61313);default:return Dt(60726)}})(i):i.fieldFilter!==void 0?(function(e){return Qe.create(El(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Dt(58110);default:return Dt(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(e){return Ks.create(e.compositeFilter.filters.map((n=>FT(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Dt(1026)}})(e.compositeFilter.op))})(i):Dt(30097,{filter:i})}function PP(i){return AP[i]}function LP(i){return EP[i]}function OP(i){return wP[i]}function Al(i){return{fieldPath:i.canonicalString()}}function El(i){return pn.fromServerFormat(i.fieldPath)}function BT(i){return i instanceof Qe?(function(e){if(e.op==="=="){if(Rw(e.value))return{unaryFilter:{field:Al(e.field),op:"IS_NAN"}};if(Cw(e.value))return{unaryFilter:{field:Al(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Rw(e.value))return{unaryFilter:{field:Al(e.field),op:"IS_NOT_NAN"}};if(Cw(e.value))return{unaryFilter:{field:Al(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Al(e.field),op:LP(e.op),value:e.value}}})(i):i instanceof Ks?(function(e){const n=e.getFilters().map((s=>BT(s)));return n.length===1?n[0]:{compositeFilter:{op:OP(e.op),filters:n}}})(i):Dt(54877,{filter:i})}function jP(i){const t=[];return i.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function zT(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(t,e,n,s,o=Lt.min(),l=Lt.min(),u=mn.EMPTY_BYTE_STRING,h=null){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(t){return new ta(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ta(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(t){this.yt=t}}function UP(i){const t=DP({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Ay(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this.Cn=new BP}addToCollectionParentIndex(t,e){return this.Cn.add(e),lt.resolve()}getCollectionParents(t,e){return lt.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return lt.resolve()}deleteFieldIndex(t,e){return lt.resolve()}deleteAllFieldIndexes(t){return lt.resolve()}createTargetIndexes(t,e){return lt.resolve()}getDocumentsMatchingTarget(t,e){return lt.resolve(null)}getIndexType(t,e){return lt.resolve(0)}getFieldIndexes(t,e){return lt.resolve([])}getNextCollectionGroupToUpdate(t){return lt.resolve(null)}getMinOffset(t,e){return lt.resolve(aa.min())}getMinOffsetFromCollectionGroup(t,e){return lt.resolve(aa.min())}updateCollectionGroup(t,e,n){return lt.resolve()}updateIndexEntries(t,e){return lt.resolve()}}class BP{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e]||new on(_e.comparator),o=!s.has(n);return this.index[e]=s.add(n),o}has(t){const e=t.lastSegment(),n=t.popLast(),s=this.index[e];return s&&s.has(n)}getEntries(t){return(this.index[t]||new on(_e.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},HT=41943040;class Qn{static withCacheSize(t){return new Qn(t,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qn.DEFAULT_COLLECTION_PERCENTILE=10,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qn.DEFAULT=new Qn(HT,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qn.DISABLED=new Qn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new zl(0)}static cr(){return new zl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="LruGarbageCollector",zP=1048576;function Gw([i,t],[e,n]){const s=Wt(i,e);return s===0?Wt(t,n):s}class HP{constructor(t){this.Ir=t,this.buffer=new on(Gw),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const n=this.buffer.last();Gw(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}}get maxValue(){return this.buffer.last()[0]}}class GP{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){mt(Hw,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Xl(e)?mt(Hw,"Ignoring IndexedDB error during garbage collection: ",e):await Yl(e)}await this.Vr(3e5)}))}}class qP{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((n=>Math.floor(e/100*n)))}nthSequenceNumber(t,e){if(e===0)return lt.resolve(Jf.ce);const n=new HP(e);return this.mr.forEachTarget(t,(s=>n.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>n.Ar(s))))).next((()=>n.maxValue))}removeTargets(t,e,n){return this.mr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(mt("LruGarbageCollector","Garbage collection skipped; disabled"),lt.resolve(zw)):this.getCacheSize(t).next((n=>n<this.params.cacheSizeCollectionThreshold?(mt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zw):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let n,s,o,l,u,h,f;const m=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(mt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,l=Date.now(),this.nthSequenceNumber(t,s)))).next((v=>(n=v,u=Date.now(),this.removeTargets(t,n,e)))).next((v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(t,n)))).next((v=>(f=Date.now(),_l()<=Kt.DEBUG&&mt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${s} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(f-h)+`ms
Total Duration: ${f-m}ms`),lt.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:v}))))}}function $P(i,t){return new qP(i,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(){this.changes=new wo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,kn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return n!==void 0?lt.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(t,e,n,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(n=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(n!==null&&ku(n.mutation,s,ds.empty(),be.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.getLocalViewOfDocuments(t,n,Yt()).next((()=>n))))}getLocalViewOfDocuments(t,e,n=Yt()){const s=io();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,n).next((o=>{let l=bu();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const n=io();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,Yt())))}populateOverlays(t,e,n){const s=[];return n.forEach((o=>{e.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(t,s).next((o=>{o.forEach(((l,u)=>{e.set(l,u)}))}))}computeViews(t,e,n,s){let o=mr();const l=Nu(),u=(function(){return Nu()})();return e.forEach(((h,f)=>{const m=n.get(f.key);s.has(f.key)&&(m===void 0||m.mutation instanceof _a)?o=o.insert(f.key,f):m!==void 0?(l.set(f.key,m.mutation.getFieldMask()),ku(m.mutation,f,m.mutation.getFieldMask(),be.now())):l.set(f.key,ds.empty())})),this.recalculateAndSaveOverlays(t,o).next((h=>(h.forEach(((f,m)=>l.set(f,m))),e.forEach(((f,m)=>u.set(f,new WP(m,l.get(f)??null)))),u)))}recalculateAndSaveOverlays(t,e){const n=Nu();let s=new Ie(((l,u)=>l-u)),o=Yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const u of l)u.keys().forEach((h=>{const f=e.get(h);if(f===null)return;let m=n.get(h)||ds.empty();m=u.applyToLocalView(f,m),n.set(h,m);const v=(s.get(u.batchId)||Yt()).add(h);s=s.insert(u.batchId,v)}))})).next((()=>{const l=[],u=s.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),f=h.key,m=h.value,v=TT();m.forEach((b=>{if(!o.has(b)){const A=kT(e.get(b),n.get(b));A!==null&&v.set(b,A),o=o.add(b)}})),l.push(this.documentOverlayCache.saveOverlays(t,f,v))}return lt.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((n=>this.recalculateAndSaveOverlays(t,n)))}getDocumentsMatchingQuery(t,e,n,s){return(function(l){return wt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):bT(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,s):this.getDocumentsMatchingCollectionQuery(t,e,n,s)}getNextDocuments(t,e,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,s).next((o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,s-o.size):lt.resolve(io());let u=Vu,h=o;return l.next((f=>lt.forEach(f,((m,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(m)?lt.resolve():this.remoteDocumentCache.getEntry(t,m).next((b=>{h=h.insert(m,b)}))))).next((()=>this.populateOverlays(t,f,o))).next((()=>this.computeViews(t,h,f,Yt()))).next((m=>({batchId:u,changes:ST(m)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new wt(e)).next((n=>{let s=bu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,s){const o=e.collectionGroup;let l=bu();return this.indexManager.getCollectionParents(t,o).next((u=>lt.forEach(u,(h=>{const f=(function(v,b){return new Ql(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(e,h.child(o));return this.getDocumentsMatchingCollectionQuery(t,f,n,s).next((m=>{m.forEach(((v,b)=>{l=l.insert(v,b)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,n,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,o,s)))).next((l=>{o.forEach(((h,f)=>{const m=f.getKey();l.get(m)===null&&(l=l.insert(m,kn.newInvalidDocument(m)))}));let u=bu();return l.forEach(((h,f)=>{const m=o.get(h);m!==void 0&&ku(m.mutation,f,ds.empty(),be.now()),sp(e,f)&&(u=u.insert(h,f))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return lt.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:Ei(s.createTime)}})(e)),lt.resolve()}getNamedQuery(t,e){return lt.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:UP(s.bundledQuery),readTime:Ei(s.readTime)}})(e)),lt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(){this.overlays=new Ie(wt.comparator),this.qr=new Map}getOverlay(t,e){return lt.resolve(this.overlays.get(e))}getOverlays(t,e){const n=io();return lt.forEach(e,(s=>this.getOverlay(t,s).next((o=>{o!==null&&n.set(s,o)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((s,o)=>{this.St(t,e,o)})),lt.resolve()}removeOverlaysForBatchId(t,e,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),lt.resolve()}getOverlaysForCollection(t,e,n){const s=io(),o=e.length+1,l=new wt(e.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,f=h.getKey();if(!e.isPrefixOf(f.path))break;f.path.length===o&&h.largestBatchId>n&&s.set(h.getKey(),h)}return lt.resolve(s)}getOverlaysForCollectionGroup(t,e,n,s){let o=new Ie(((f,m)=>f-m));const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===e&&f.largestBatchId>n){let m=o.get(f.largestBatchId);m===null&&(m=io(),o=o.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const u=io(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((f,m)=>u.set(f,m))),!(u.size()>=s)););return lt.resolve(u)}St(t,e,n){const s=this.overlays.get(n.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new mP(e,n));let o=this.qr.get(e);o===void 0&&(o=Yt(),this.qr.set(e,o)),this.qr.set(e,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(){this.sessionToken=mn.EMPTY_BYTE_STRING}getSessionToken(t){return lt.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,lt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(){this.Qr=new on(fn.$r),this.Ur=new on(fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const n=new fn(t,e);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,e){t.forEach((n=>this.addReference(n,e)))}removeReference(t,e){this.Gr(new fn(t,e))}zr(t,e){t.forEach((n=>this.removeReference(n,e)))}jr(t){const e=new wt(new _e([])),n=new fn(e,t),s=new fn(e,t+1),o=[];return this.Ur.forEachInRange([n,s],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new wt(new _e([])),n=new fn(e,t),s=new fn(e,t+1);let o=Yt();return this.Ur.forEachInRange([n,s],(l=>{o=o.add(l.key)})),o}containsKey(t){const e=new fn(t,0),n=this.Qr.firstAfterOrEqual(e);return n!==null&&t.isEqual(n.key)}}class fn{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return wt.comparator(t.key,e.key)||Wt(t.Yr,e.Yr)}static Kr(t,e){return Wt(t.Yr,e.Yr)||wt.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new on(fn.$r)}checkEmpty(t){return lt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,n,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new pP(o,e,n,s);this.mutationQueue.push(l);for(const u of s)this.Zr=this.Zr.add(new fn(u.key,o)),this.indexManager.addToCollectionParentIndex(t,u.key.path.popLast());return lt.resolve(l)}lookupMutationBatch(t,e){return lt.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,s=this.ei(n),o=s<0?0:s;return lt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return lt.resolve(this.mutationQueue.length===0?pv:this.tr-1)}getAllMutationBatches(t){return lt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new fn(e,0),s=new fn(e,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,s],(l=>{const u=this.Xr(l.Yr);o.push(u)})),lt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new on(Wt);return e.forEach((s=>{const o=new fn(s,0),l=new fn(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{n=n.add(u.Yr)}))})),lt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,s=n.length+1;let o=n;wt.isDocumentKey(o)||(o=o.child(""));const l=new fn(new wt(o),0);let u=new on(Wt);return this.Zr.forEachWhile((h=>{const f=h.key.path;return!!n.isPrefixOf(f)&&(f.length===s&&(u=u.add(h.Yr)),!0)}),l),lt.resolve(this.ti(u))}ti(t){const e=[];return t.forEach((n=>{const s=this.Xr(n);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){ae(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return lt.forEach(e.mutations,(s=>{const o=new fn(s.key,e.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=n}))}ir(t){}containsKey(t,e){const n=new fn(e,0),s=this.Zr.firstAfterOrEqual(n);return lt.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,lt.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(t){this.ri=t,this.docs=(function(){return new Ie(wt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,s=this.docs.get(n),o=s?s.size:0,l=this.ri(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return lt.resolve(n?n.document.mutableCopy():kn.newInvalidDocument(e))}getEntries(t,e){let n=mr();return e.forEach((s=>{const o=this.docs.get(s);n=n.insert(s,o?o.document.mutableCopy():kn.newInvalidDocument(s))})),lt.resolve(n)}getDocumentsMatchingQuery(t,e,n,s){let o=mr();const l=e.path,u=new wt(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:f,value:{document:m}}=h.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||RM(CM(m),n)<=0||(s.has(m.key)||sp(e,m))&&(o=o.insert(m.key,m.mutableCopy()))}return lt.resolve(o)}getAllFromCollectionGroup(t,e,n,s){Dt(9500)}ii(t,e){return lt.forEach(this.docs,(n=>e(n)))}newChangeBuffer(t){return new e2(this)}getSize(t){return lt.resolve(this.size)}}class e2 extends KP{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(n)})),lt.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(t){this.persistence=t,this.si=new wo((e=>yv(e)),vv),this.lastRemoteSnapshotVersion=Lt.min(),this.highestTargetId=0,this.oi=0,this._i=new Sv,this.targetCount=0,this.ai=zl.ur()}forEachTarget(t,e){return this.si.forEach(((n,s)=>e(s))),lt.resolve()}getLastRemoteSnapshotVersion(t){return lt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return lt.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),lt.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.oi&&(this.oi=e),lt.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new zl(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,lt.resolve()}updateTargetData(t,e){return this.Pr(e),lt.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,lt.resolve()}removeTargets(t,e,n){let s=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=e&&n.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(t,u.targetId)),s++)})),lt.waitFor(o).next((()=>s))}getTargetCount(t){return lt.resolve(this.targetCount)}getTargetData(t,e){const n=this.si.get(e)||null;return lt.resolve(n)}addMatchingKeys(t,e,n){return this._i.Wr(e,n),lt.resolve()}removeMatchingKeys(t,e,n){this._i.zr(e,n);const s=this.persistence.referenceDelegate,o=[];return s&&e.forEach((l=>{o.push(s.markPotentiallyOrphaned(t,l))})),lt.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),lt.resolve()}getMatchingKeysForTargetId(t,e){const n=this._i.Hr(e);return lt.resolve(n)}containsKey(t,e){return lt.resolve(this._i.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(t,e){this.ui={},this.overlays={},this.ci=new Jf(0),this.li=!1,this.li=!0,this.hi=new ZP,this.referenceDelegate=t(this),this.Pi=new n2(this),this.indexManager=new FP,this.remoteDocumentCache=(function(s){return new t2(s)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new VP(e),this.Ii=new XP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new QP,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ui[t.toKey()];return n||(n=new JP(e,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,n){mt("MemoryPersistence","Starting transaction:",t);const s=new s2(this.ci.next());return this.referenceDelegate.Ei(),n(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(t,e){return lt.or(Object.values(this.ui).map((n=>()=>n.containsKey(t,e))))}}class s2 extends NM{constructor(t){super(),this.currentSequenceNumber=t}}class Tv{constructor(t){this.persistence=t,this.Ri=new Sv,this.Vi=null}static mi(t){return new Tv(t)}get fi(){if(this.Vi)return this.Vi;throw Dt(60996)}addReference(t,e,n){return this.Ri.addReference(n,e),this.fi.delete(n.toString()),lt.resolve()}removeReference(t,e,n){return this.Ri.removeReference(n,e),this.fi.add(n.toString()),lt.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),lt.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return lt.forEach(this.fi,(n=>{const s=wt.fromPath(n);return this.gi(t,s).next((o=>{o||e.removeEntry(s,Lt.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((n=>{n?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return lt.or([()=>lt.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class Pf{constructor(t,e){this.persistence=t,this.pi=new wo((n=>MM(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=$P(this,e)}static mi(t,e){return new Pf(t,e)}Ei(){}di(t){return lt.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((n=>e.next((s=>n+s))))}wr(t){let e=0;return this.pr(t,(n=>{e++})).next((()=>e))}pr(t,e){return lt.forEach(this.pi,((n,s)=>this.br(t,n,s).next((o=>o?lt.resolve():e(s)))))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(t,(l=>this.br(t,l,e).next((u=>{u||(n++,o.removeEntry(l,Lt.min()))})))).next((()=>o.apply(t))).next((()=>n))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),lt.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),lt.resolve()}removeReference(t,e,n){return this.pi.set(n,t.currentSequenceNumber),lt.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),lt.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=hf(t.data.value)),e}br(t,e,n){return lt.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return lt.resolve(s!==void 0&&s>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(t,e,n,s){this.targetId=t,this.fromCache=e,this.Es=n,this.ds=s}static As(t,e){let n=Yt(),s=Yt();for(const o of e.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new xv(t,e.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return LI()?8:kM(Dn())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,n,s){const o={result:null};return this.ys(t,e).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(t,e,s,n).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new i2;return this.Ss(t,e,l).next((u=>{if(o.result=u,this.Vs)return this.bs(t,e,l,u.size)}))})).next((()=>o.result))}bs(t,e,n,s){return n.documentReadCount<this.fs?(_l()<=Kt.DEBUG&&mt("QueryEngine","SDK will not create cache indexes for query:",bl(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),lt.resolve()):(_l()<=Kt.DEBUG&&mt("QueryEngine","Query:",bl(e),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(_l()<=Kt.DEBUG&&mt("QueryEngine","The SDK decides to create cache indexes for query:",bl(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ai(e))):lt.resolve())}ys(t,e){if(Dw(e))return lt.resolve(null);let n=Ai(e);return this.indexManager.getIndexType(t,n).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=Ay(e,null,"F"),n=Ai(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((o=>{const l=Yt(...o);return this.ps.getDocuments(t,l).next((u=>this.indexManager.getMinOffset(t,n).next((h=>{const f=this.Ds(e,u);return this.Cs(e,f,l,h.readTime)?this.ys(t,Ay(e,null,"F")):this.vs(t,f,e,h)}))))})))))}ws(t,e,n,s){return Dw(e)||s.isEqual(Lt.min())?lt.resolve(null):this.ps.getDocuments(t,n).next((o=>{const l=this.Ds(e,o);return this.Cs(e,l,n,s)?lt.resolve(null):(_l()<=Kt.DEBUG&&mt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bl(e)),this.vs(t,l,e,xM(s,Vu)).next((u=>u)))}))}Ds(t,e){let n=new on(ET(t));return e.forEach(((s,o)=>{sp(t,o)&&(n=n.add(o))})),n}Cs(t,e,n,s){if(t.limit===null)return!1;if(n.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(t,e,n){return _l()<=Kt.DEBUG&&mt("QueryEngine","Using full collection scan to execute query:",bl(e)),this.ps.getDocumentsMatchingQuery(t,e,aa.min(),n)}vs(t,e,n,s){return this.ps.getDocumentsMatchingQuery(t,n,s).next((o=>(e.forEach((l=>{o=o.insert(l.key,l)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv="LocalStore",a2=3e8;class o2{constructor(t,e,n,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new Ie(Wt),this.xs=new wo((o=>yv(o)),vv),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new YP(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function l2(i,t,e,n){return new o2(i,t,e,n)}async function qT(i,t){const e=Vt(i);return await e.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return e.mutationQueue.getAllMutationBatches(n).next((o=>(s=o,e.Bs(t),e.mutationQueue.getAllMutationBatches(n)))).next((o=>{const l=[],u=[];let h=Yt();for(const f of s){l.push(f.batchId);for(const m of f.mutations)h=h.add(m.key)}for(const f of o){u.push(f.batchId);for(const m of f.mutations)h=h.add(m.key)}return e.localDocuments.getDocuments(n,h).next((f=>({Ls:f,removedBatchIds:l,addedBatchIds:u})))}))}))}function c2(i,t){const e=Vt(i);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const s=t.batch.keys(),o=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,f,m){const v=f.batch,b=v.keys();let A=lt.resolve();return b.forEach((w=>{A=A.next((()=>m.getEntry(h,w))).next((S=>{const N=f.docVersions.get(w);ae(N!==null,48541),S.version.compareTo(N)<0&&(v.applyToRemoteDocument(S,f),S.isValidDocument()&&(S.setReadTime(f.commitVersion),m.addEntry(S)))}))})),A.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(e,n,t,o).next((()=>o.apply(n))).next((()=>e.mutationQueue.performConsistencyCheck(n))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Yt();for(let f=0;f<u.mutationResults.length;++f)u.mutationResults[f].transformResults.length>0&&(h=h.add(u.batch.mutations[f].key));return h})(t)))).next((()=>e.localDocuments.getDocuments(n,s)))}))}function $T(i){const t=Vt(i);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function u2(i,t){const e=Vt(i),n=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const u=[];t.targetChanges.forEach(((m,v)=>{const b=s.get(v);if(!b)return;u.push(e.Pi.removeMatchingKeys(o,m.removedDocuments,v).next((()=>e.Pi.addMatchingKeys(o,m.addedDocuments,v))));let A=b.withSequenceNumber(o.currentSequenceNumber);t.targetMismatches.get(v)!==null?A=A.withResumeToken(mn.EMPTY_BYTE_STRING,Lt.min()).withLastLimboFreeSnapshotVersion(Lt.min()):m.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(m.resumeToken,n)),s=s.insert(v,A),(function(S,N,R){return S.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=a2?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(b,A,m)&&u.push(e.Pi.updateTargetData(o,A))}));let h=mr(),f=Yt();if(t.documentUpdates.forEach((m=>{t.resolvedLimboDocuments.has(m)&&u.push(e.persistence.referenceDelegate.updateLimboDocument(o,m))})),u.push(h2(o,l,t.documentUpdates).next((m=>{h=m.ks,f=m.qs}))),!n.isEqual(Lt.min())){const m=e.Pi.getLastRemoteSnapshotVersion(o).next((v=>e.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(m)}return lt.waitFor(u).next((()=>l.apply(o))).next((()=>e.localDocuments.getLocalViewOfDocuments(o,h,f))).next((()=>h))})).then((o=>(e.Ms=s,o)))}function h2(i,t,e){let n=Yt(),s=Yt();return e.forEach((o=>n=n.add(o))),t.getEntries(i,n).next((o=>{let l=mr();return e.forEach(((u,h)=>{const f=o.get(u);h.isFoundDocument()!==f.isFoundDocument()&&(s=s.add(u)),h.isNoDocument()&&h.version.isEqual(Lt.min())?(t.removeEntry(u,h.readTime),l=l.insert(u,h)):!f.isValidDocument()||h.version.compareTo(f.version)>0||h.version.compareTo(f.version)===0&&f.hasPendingWrites?(t.addEntry(h),l=l.insert(u,h)):mt(Cv,"Ignoring outdated watch update for ",u,". Current version:",f.version," Watch version:",h.version)})),{ks:l,qs:s}}))}function d2(i,t){const e=Vt(i);return e.persistence.runTransaction("Get next mutation batch","readonly",(n=>(t===void 0&&(t=pv),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t))))}function f2(i,t){const e=Vt(i);return e.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return e.Pi.getTargetData(n,t).next((o=>o?(s=o,lt.resolve(s)):e.Pi.allocateTargetId(n).next((l=>(s=new ta(t,l,"TargetPurposeListen",n.currentSequenceNumber),e.Pi.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=e.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(n.targetId,n),e.xs.set(t,n.targetId)),n}))}async function xy(i,t,e){const n=Vt(i),s=n.Ms.get(t),o=e?"readwrite":"readwrite-primary";try{e||await n.persistence.runTransaction("Release target",o,(l=>n.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!Xl(l))throw l;mt(Cv,`Failed to update sequence numbers for target ${t}: ${l}`)}n.Ms=n.Ms.remove(t),n.xs.delete(s.target)}function qw(i,t,e){const n=Vt(i);let s=Lt.min(),o=Yt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,f,m){const v=Vt(h),b=v.xs.get(m);return b!==void 0?lt.resolve(v.Ms.get(b)):v.Pi.getTargetData(f,m)})(n,l,Ai(t)).next((u=>{if(u)return s=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,t,e?s:Lt.min(),e?o:Yt()))).next((u=>(p2(n,ZM(t),u),{documents:u,Qs:o})))))}function p2(i,t,e){let n=i.Os.get(t)||Lt.min();e.forEach(((s,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),i.Os.set(t,n)}class $w{constructor(){this.activeTargetIds=iP()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class m2{constructor(){this.Mo=new $w,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,n){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new $w,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="ConnectivityMonitor";class Ww{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){mt(Kw,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){mt(Kw,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kd=null;function Cy(){return Kd===null?Kd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Kd++,"0x"+Kd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="RestConnection",y2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class v2{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===If?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(t,e,n,s,o){const l=Cy(),u=this.zo(t,e.toUriEncodedString());mt(zg,`Sending RPC '${t}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,o);const{host:f}=new URL(u),m=Ao(f);return this.Jo(t,u,h,n,m).then((v=>(mt(zg,`Received RPC '${t}' ${l}: `,v),v)),(v=>{throw go(zg,`RPC '${t}' ${l} failed with error: `,v,"url: ",u,"request:",n),v}))}Ho(t,e,n,s,o,l){return this.Go(t,e,n,s,o)}jo(t,e,n){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wl})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,o)=>t[o]=s)),n&&n.headers.forEach(((s,o)=>t[o]=s))}zo(t,e){const n=y2[t];return`${this.Uo}/v1/${e}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="WebChannelConnection";class b2 extends v2{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,n,s,o){const l=Cy();return new Promise(((u,h)=>{const f=new KS;f.setWithCredentials(!0),f.listenOnce(WS.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case uf.NO_ERROR:const v=f.getResponseJson();mt(Rn,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(v)),u(v);break;case uf.TIMEOUT:mt(Rn,`RPC '${t}' ${l} timed out`),h(new pt(rt.DEADLINE_EXCEEDED,"Request time out"));break;case uf.HTTP_ERROR:const b=f.getStatus();if(mt(Rn,`RPC '${t}' ${l} failed with status:`,b,"response text:",f.getResponseText()),b>0){let A=f.getResponseJson();Array.isArray(A)&&(A=A[0]);const w=A?.error;if(w&&w.status&&w.message){const S=(function(R){const V=R.toLowerCase().replace(/_/g,"-");return Object.values(rt).indexOf(V)>=0?V:rt.UNKNOWN})(w.status);h(new pt(S,w.message))}else h(new pt(rt.UNKNOWN,"Server responded with status "+f.getStatus()))}else h(new pt(rt.UNAVAILABLE,"Connection failed."));break;default:Dt(9055,{l_:t,streamId:l,h_:f.getLastErrorCode(),P_:f.getLastError()})}}finally{mt(Rn,`RPC '${t}' ${l} completed.`)}}));const m=JSON.stringify(s);mt(Rn,`RPC '${t}' ${l} sending request:`,s),f.send(e,"POST",m,n,15)}))}T_(t,e,n){const s=Cy(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=QS(),u=XS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(h.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,e,n),h.encodeInitMessageHeaders=!0;const m=o.join("");mt(Rn,`Creating RPC '${t}' stream ${s}: ${m}`,h);const v=l.createWebChannel(m,h);this.I_(v);let b=!1,A=!1;const w=new _2({Yo:N=>{A?mt(Rn,`Not sending because RPC '${t}' stream ${s} is closed:`,N):(b||(mt(Rn,`Opening RPC '${t}' stream ${s} transport.`),v.open(),b=!0),mt(Rn,`RPC '${t}' stream ${s} sending:`,N),v.send(N))},Zo:()=>v.close()}),S=(N,R,V)=>{N.listen(R,(M=>{try{V(M)}catch(B){setTimeout((()=>{throw B}),0)}}))};return S(v,_u.EventType.OPEN,(()=>{A||(mt(Rn,`RPC '${t}' stream ${s} transport opened.`),w.o_())})),S(v,_u.EventType.CLOSE,(()=>{A||(A=!0,mt(Rn,`RPC '${t}' stream ${s} transport closed`),w.a_(),this.E_(v))})),S(v,_u.EventType.ERROR,(N=>{A||(A=!0,go(Rn,`RPC '${t}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),w.a_(new pt(rt.UNAVAILABLE,"The operation could not be completed")))})),S(v,_u.EventType.MESSAGE,(N=>{if(!A){const R=N.data[0];ae(!!R,16349);const V=R,M=V?.error||V[0]?.error;if(M){mt(Rn,`RPC '${t}' stream ${s} received error:`,M);const B=M.status;let L=(function(I){const k=Ye[I];if(k!==void 0)return MT(k)})(B),F=M.message;L===void 0&&(L=rt.INTERNAL,F="Unknown error status: "+B+" with message "+M.message),A=!0,w.a_(new pt(L,F)),v.close()}else mt(Rn,`RPC '${t}' stream ${s} received:`,R),w.u_(R)}})),S(u,YS.STAT_EVENT,(N=>{N.stat===py.PROXY?mt(Rn,`RPC '${t}' stream ${s} detected buffering proxy`):N.stat===py.NOPROXY&&mt(Rn,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function Hg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(i){return new SP(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(t,e,n=1e3,s=1.5,o=6e4){this.Mi=t,this.timerId=e,this.d_=n,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-n);s>0&&mt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="PersistentStream";class WT{constructor(t,e,n,s,o,l,u,h){this.Mi=t,this.S_=n,this.b_=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new KT(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===rt.RESOURCE_EXHAUSTED?(pr(e.toString()),pr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===rt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===e&&this.G_(n,s)}),(n=>{t((()=>{const s=new pt(rt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(t,e){const n=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return mt(Yw,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(mt(Yw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class A2 extends WT{constructor(t,e,n,s,o,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,s,l),this.serializer=o}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=CP(this.serializer,t),n=(function(o){if(!("targetChange"in o))return Lt.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Lt.min():l.readTime?Ei(l.readTime):Lt.min()})(t);return this.listener.H_(e,n)}Y_(t){const e={};e.database=Ty(this.serializer),e.addTarget=(function(o,l){let u;const h=l.target;if(u=_y(h)?{documents:NP(o,h)}:{query:kP(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=OT(o,l.resumeToken);const f=Ey(o,l.expectedCount);f!==null&&(u.expectedCount=f)}else if(l.snapshotVersion.compareTo(Lt.min())>0){u.readTime=Mf(o,l.snapshotVersion.toTimestamp());const f=Ey(o,l.expectedCount);f!==null&&(u.expectedCount=f)}return u})(this.serializer,t);const n=MP(this.serializer,t);n&&(e.labels=n),this.q_(e)}Z_(t){const e={};e.database=Ty(this.serializer),e.removeTarget=t,this.q_(e)}}class E2 extends WT{constructor(t,e,n,s,o,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,s,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return ae(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ae(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ae(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=IP(t.writeResults,t.commitTime),n=Ei(t.commitTime);return this.listener.na(n,e)}ra(){const t={};t.database=Ty(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((n=>RP(this.serializer,n)))};this.q_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{}class S2 extends w2{constructor(t,e,n,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new pt(rt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(t,wy(e,n),s,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===rt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new pt(rt.UNKNOWN,o.toString())}))}Ho(t,e,n,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(t,wy(e,n),s,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===rt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new pt(rt.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class T2{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pr(e),this.aa=!1):mt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="RemoteStore";class x2{constructor(t,e,n,s,o){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{So(this)&&(mt(yo,"Restarting streams for network reachability change."),await(async function(h){const f=Vt(h);f.Ea.add(4),await rh(f),f.Ra.set("Unknown"),f.Ea.delete(4),await cp(f)})(this))}))})),this.Ra=new T2(n,s)}}async function cp(i){if(So(i))for(const t of i.da)await t(!0)}async function rh(i){for(const t of i.da)await t(!1)}function YT(i,t){const e=Vt(i);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),kv(e)?Nv(e):Zl(e).O_()&&Iv(e,t))}function Rv(i,t){const e=Vt(i),n=Zl(e);e.Ia.delete(t),n.O_()&&XT(e,t),e.Ia.size===0&&(n.O_()?n.L_():So(e)&&e.Ra.set("Unknown"))}function Iv(i,t){if(i.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Lt.min())>0){const e=i.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Zl(i).Y_(t)}function XT(i,t){i.Va.Ue(t),Zl(i).Z_(t)}function Nv(i){i.Va=new bP({getRemoteKeysForTarget:t=>i.remoteSyncer.getRemoteKeysForTarget(t),At:t=>i.Ia.get(t)||null,ht:()=>i.datastore.serializer.databaseId}),Zl(i).start(),i.Ra.ua()}function kv(i){return So(i)&&!Zl(i).x_()&&i.Ia.size>0}function So(i){return Vt(i).Ea.size===0}function QT(i){i.Va=void 0}async function C2(i){i.Ra.set("Online")}async function R2(i){i.Ia.forEach(((t,e)=>{Iv(i,t)}))}async function I2(i,t){QT(i),kv(i)?(i.Ra.ha(t),Nv(i)):i.Ra.set("Unknown")}async function N2(i,t,e){if(i.Ra.set("Online"),t instanceof LT&&t.state===2&&t.cause)try{await(async function(s,o){const l=o.cause;for(const u of o.targetIds)s.Ia.has(u)&&(await s.remoteSyncer.rejectListen(u,l),s.Ia.delete(u),s.Va.removeTarget(u))})(i,t)}catch(n){mt(yo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Lf(i,n)}else if(t instanceof pf?i.Va.Ze(t):t instanceof PT?i.Va.st(t):i.Va.tt(t),!e.isEqual(Lt.min()))try{const n=await $T(i.localStore);e.compareTo(n)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((h,f)=>{if(h.resumeToken.approximateByteSize()>0){const m=o.Ia.get(f);m&&o.Ia.set(f,m.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,f)=>{const m=o.Ia.get(h);if(!m)return;o.Ia.set(h,m.withResumeToken(mn.EMPTY_BYTE_STRING,m.snapshotVersion)),XT(o,h);const v=new ta(m.target,h,f,m.sequenceNumber);Iv(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(i,e)}catch(n){mt(yo,"Failed to raise snapshot:",n),await Lf(i,n)}}async function Lf(i,t,e){if(!Xl(t))throw t;i.Ea.add(1),await rh(i),i.Ra.set("Offline"),e||(e=()=>$T(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{mt(yo,"Retrying IndexedDB access"),await e(),i.Ea.delete(1),await cp(i)}))}function ZT(i,t){return t().catch((e=>Lf(i,e,t)))}async function up(i){const t=Vt(i),e=ua(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:pv;for(;k2(t);)try{const s=await d2(t.localStore,n);if(s===null){t.Ta.length===0&&e.L_();break}n=s.batchId,D2(t,s)}catch(s){await Lf(t,s)}JT(t)&&t1(t)}function k2(i){return So(i)&&i.Ta.length<10}function D2(i,t){i.Ta.push(t);const e=ua(i);e.O_()&&e.X_&&e.ea(t.mutations)}function JT(i){return So(i)&&!ua(i).x_()&&i.Ta.length>0}function t1(i){ua(i).start()}async function M2(i){ua(i).ra()}async function P2(i){const t=ua(i);for(const e of i.Ta)t.ea(e.mutations)}async function L2(i,t,e){const n=i.Ta.shift(),s=Av.from(n,t,e);await ZT(i,(()=>i.remoteSyncer.applySuccessfulWrite(s))),await up(i)}async function O2(i,t){t&&ua(i).X_&&await(async function(n,s){if((function(l){return yP(l)&&l!==rt.ABORTED})(s.code)){const o=n.Ta.shift();ua(n).B_(),await ZT(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,s))),await up(n)}})(i,t),JT(i)&&t1(i)}async function Xw(i,t){const e=Vt(i);e.asyncQueue.verifyOperationInProgress(),mt(yo,"RemoteStore received new credentials");const n=So(e);e.Ea.add(3),await rh(e),n&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await cp(e)}async function j2(i,t){const e=Vt(i);t?(e.Ea.delete(2),await cp(e)):t||(e.Ea.add(2),await rh(e),e.Ra.set("Unknown"))}function Zl(i){return i.ma||(i.ma=(function(e,n,s){const o=Vt(e);return o.sa(),new A2(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(i.datastore,i.asyncQueue,{Xo:C2.bind(null,i),t_:R2.bind(null,i),r_:I2.bind(null,i),H_:N2.bind(null,i)}),i.da.push((async t=>{t?(i.ma.B_(),kv(i)?Nv(i):i.Ra.set("Unknown")):(await i.ma.stop(),QT(i))}))),i.ma}function ua(i){return i.fa||(i.fa=(function(e,n,s){const o=Vt(e);return o.sa(),new E2(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:M2.bind(null,i),r_:O2.bind(null,i),ta:P2.bind(null,i),na:L2.bind(null,i)}),i.da.push((async t=>{t?(i.fa.B_(),await up(i)):(await i.fa.stop(),i.Ta.length>0&&(mt(yo,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(t,e,n,s,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=s,this.removalCallback=o,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,s,o){const l=Date.now()+n,u=new Dv(t,e,l,s,o);return u.start(n),u}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(rt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mv(i,t){if(pr("AsyncQueue",`${t}: ${i}`),Xl(i))return new pt(rt.UNAVAILABLE,`${t}: ${i}`);throw i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{static emptySet(t){return new Pl(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||wt.comparator(e.key,n.key):(e,n)=>wt.comparator(e.key,n.key),this.keyedMap=bu(),this.sortedSet=new Ie(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Pl)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=n.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const n=new Pl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(){this.ga=new Ie(wt.comparator)}track(t){const e=t.doc.key,n=this.ga.get(e);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(e,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(e,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(e):t.type===1&&n.type===2?this.ga=this.ga.insert(e,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Dt(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,n)=>{t.push(n)})),t}}class Hl{constructor(t,e,n,s,o,l,u,h,f){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=f}static fromInitialDocuments(t,e,n,s,o){const l=[];return e.forEach((u=>{l.push({type:0,doc:u})})),new Hl(t,e,Pl.emptySet(e),l,n,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&np(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==n[s].type||!e[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class U2{constructor(){this.queries=Zw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const s=Vt(e),o=s.queries;s.queries=Zw(),o.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new pt(rt.ABORTED,"Firestore shutting down"))}}function Zw(){return new wo((i=>AT(i)),np)}async function e1(i,t){const e=Vt(i);let n=3;const s=t.query;let o=e.queries.get(s);o?!o.ba()&&t.Da()&&(n=2):(o=new V2,n=t.Da()?0:1);try{switch(n){case 0:o.wa=await e.onListen(s,!0);break;case 1:o.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(l){const u=Mv(l,`Initialization of query '${bl(t.query)}' failed`);return void t.onError(u)}e.queries.set(s,o),o.Sa.push(t),t.va(e.onlineState),o.wa&&t.Fa(o.wa)&&Pv(e)}async function n1(i,t){const e=Vt(i),n=t.query;let s=3;const o=e.queries.get(n);if(o){const l=o.Sa.indexOf(t);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?s=t.Da()?0:1:!o.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(n),e.onUnlisten(n,!0);case 1:return e.queries.delete(n),e.onUnlisten(n,!1);case 2:return e.onLastRemoteStoreUnlisten(n);default:return}}function F2(i,t){const e=Vt(i);let n=!1;for(const s of t){const o=s.query,l=e.queries.get(o);if(l){for(const u of l.Sa)u.Fa(s)&&(n=!0);l.wa=s}}n&&Pv(e)}function B2(i,t,e){const n=Vt(i),s=n.queries.get(t);if(s)for(const o of s.Sa)o.onError(e);n.queries.delete(t)}function Pv(i){i.Ca.forEach((t=>{t.next()}))}var Ry,Jw;(Jw=Ry||(Ry={})).Ma="default",Jw.Cache="cache";class s1{constructor(t,e,n){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new Hl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const n=e!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Hl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Ry.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(t){this.key=t}}class r1{constructor(t){this.key=t}}class z2{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Yt(),this.mutatedKeys=Yt(),this.eu=ET(t),this.tu=new Pl(this.eu)}get nu(){return this.Ya}ru(t,e){const n=e?e.iu:new Qw,s=e?e.tu:this.tu;let o=e?e.mutatedKeys:this.mutatedKeys,l=s,u=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,f=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((m,v)=>{const b=s.get(m),A=sp(this.query,v)?v:null,w=!!b&&this.mutatedKeys.has(b.key),S=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let N=!1;b&&A?b.data.isEqual(A.data)?w!==S&&(n.track({type:3,doc:A}),N=!0):this.su(b,A)||(n.track({type:2,doc:A}),N=!0,(h&&this.eu(A,h)>0||f&&this.eu(A,f)<0)&&(u=!0)):!b&&A?(n.track({type:0,doc:A}),N=!0):b&&!A&&(n.track({type:1,doc:b}),N=!0,(h||f)&&(u=!0)),N&&(A?(l=l.add(A),o=S?o.add(m):o.delete(m)):(l=l.delete(m),o=o.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),o=o.delete(m.key),n.track({type:1,doc:m})}return{tu:l,iu:n,Cs:u,mutatedKeys:o}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,s){const o=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const l=t.iu.ya();l.sort(((m,v)=>(function(A,w){const S=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt(20277,{Rt:N})}};return S(A)-S(w)})(m.type,v.type)||this.eu(m.doc,v.doc))),this.ou(n),s=s??!1;const u=e&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,f=h!==this.Za;return this.Za=h,l.length!==0||f?{snapshot:new Hl(this.query,t.tu,o,l,t.mutatedKeys,h===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Qw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=Yt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const e=[];return t.forEach((n=>{this.Xa.has(n)||e.push(new r1(n))})),this.Xa.forEach((n=>{t.has(n)||e.push(new i1(n))})),e}cu(t){this.Ya=t.Qs,this.Xa=Yt();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Hl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Lv="SyncEngine";class H2{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class G2{constructor(t){this.key=t,this.hu=!1}}class q2{constructor(t,e,n,s,o,l){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new wo((u=>AT(u)),np),this.Iu=new Map,this.Eu=new Set,this.du=new Ie(wt.comparator),this.Au=new Map,this.Ru=new Sv,this.Vu={},this.mu=new Map,this.fu=zl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $2(i,t,e=!0){const n=h1(i);let s;const o=n.Tu.get(t);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await a1(n,t,e,!0),s}async function K2(i,t){const e=h1(i);await a1(e,t,!0,!1)}async function a1(i,t,e,n){const s=await f2(i.localStore,Ai(t)),o=s.targetId,l=i.sharedClientState.addLocalQueryTarget(o,e);let u;return n&&(u=await W2(i,t,o,l==="current",s.resumeToken)),i.isPrimaryClient&&e&&YT(i.remoteStore,s),u}async function W2(i,t,e,n,s){i.pu=(v,b,A)=>(async function(S,N,R,V){let M=N.view.ru(R);M.Cs&&(M=await qw(S.localStore,N.query,!1).then((({documents:C})=>N.view.ru(C,M))));const B=V&&V.targetChanges.get(N.targetId),L=V&&V.targetMismatches.get(N.targetId)!=null,F=N.view.applyChanges(M,S.isPrimaryClient,B,L);return e0(S,N.targetId,F.au),F.snapshot})(i,v,b,A);const o=await qw(i.localStore,t,!0),l=new z2(t,o.Qs),u=l.ru(o.documents),h=ih.createSynthesizedTargetChangeForCurrentChange(e,n&&i.onlineState!=="Offline",s),f=l.applyChanges(u,i.isPrimaryClient,h);e0(i,e,f.au);const m=new H2(t,e,l);return i.Tu.set(t,m),i.Iu.has(e)?i.Iu.get(e).push(t):i.Iu.set(e,[t]),f.snapshot}async function Y2(i,t,e){const n=Vt(i),s=n.Tu.get(t),o=n.Iu.get(s.targetId);if(o.length>1)return n.Iu.set(s.targetId,o.filter((l=>!np(l,t)))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await xy(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),e&&Rv(n.remoteStore,s.targetId),Iy(n,s.targetId)})).catch(Yl)):(Iy(n,s.targetId),await xy(n.localStore,s.targetId,!0))}async function X2(i,t){const e=Vt(i),n=e.Tu.get(t),s=e.Iu.get(n.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(n.targetId),Rv(e.remoteStore,n.targetId))}async function Q2(i,t,e){const n=iL(i);try{const s=await(function(l,u){const h=Vt(l),f=be.now(),m=u.reduce(((A,w)=>A.add(w.key)),Yt());let v,b;return h.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let w=mr(),S=Yt();return h.Ns.getEntries(A,m).next((N=>{w=N,w.forEach(((R,V)=>{V.isValidDocument()||(S=S.add(R))}))})).next((()=>h.localDocuments.getOverlayedDocuments(A,w))).next((N=>{v=N;const R=[];for(const V of u){const M=dP(V,v.get(V.key).overlayedDocument);M!=null&&R.push(new _a(V.key,M,fT(M.value.mapValue),zn.exists(!0)))}return h.mutationQueue.addMutationBatch(A,f,R,u)})).next((N=>{b=N;const R=N.applyToLocalDocumentSet(v,S);return h.documentOverlayCache.saveOverlays(A,N.batchId,R)}))})).then((()=>({batchId:b.batchId,changes:ST(v)})))})(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),(function(l,u,h){let f=l.Vu[l.currentUser.toKey()];f||(f=new Ie(Wt)),f=f.insert(u,h),l.Vu[l.currentUser.toKey()]=f})(n,s.batchId,e),await ah(n,s.changes),await up(n.remoteStore)}catch(s){const o=Mv(s,"Failed to persist write");e.reject(o)}}async function o1(i,t){const e=Vt(i);try{const n=await u2(e.localStore,t);t.targetChanges.forEach(((s,o)=>{const l=e.Au.get(o);l&&(ae(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?ae(l.hu,14607):s.removedDocuments.size>0&&(ae(l.hu,42227),l.hu=!1))})),await ah(e,n,t)}catch(n){await Yl(n)}}function t0(i,t,e){const n=Vt(i);if(n.isPrimaryClient&&e===0||!n.isPrimaryClient&&e===1){const s=[];n.Tu.forEach(((o,l)=>{const u=l.view.va(t);u.snapshot&&s.push(u.snapshot)})),(function(l,u){const h=Vt(l);h.onlineState=u;let f=!1;h.queries.forEach(((m,v)=>{for(const b of v.Sa)b.va(u)&&(f=!0)})),f&&Pv(h)})(n.eventManager,t),s.length&&n.Pu.H_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function Z2(i,t,e){const n=Vt(i);n.sharedClientState.updateQueryState(t,"rejected",e);const s=n.Au.get(t),o=s&&s.key;if(o){let l=new Ie(wt.comparator);l=l.insert(o,kn.newNoDocument(o,Lt.min()));const u=Yt().add(o),h=new op(Lt.min(),new Map,new Ie(Wt),l,u);await o1(n,h),n.du=n.du.remove(o),n.Au.delete(t),Ov(n)}else await xy(n.localStore,t,!1).then((()=>Iy(n,t,e))).catch(Yl)}async function J2(i,t){const e=Vt(i),n=t.batch.batchId;try{const s=await c2(e.localStore,t);c1(e,n,null),l1(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),await ah(e,s)}catch(s){await Yl(s)}}async function tL(i,t,e){const n=Vt(i);try{const s=await(function(l,u){const h=Vt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(f=>{let m;return h.mutationQueue.lookupMutationBatch(f,u).next((v=>(ae(v!==null,37113),m=v.keys(),h.mutationQueue.removeMutationBatch(f,v)))).next((()=>h.mutationQueue.performConsistencyCheck(f))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(f,m,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m))).next((()=>h.localDocuments.getDocuments(f,m)))}))})(n.localStore,t);c1(n,t,e),l1(n,t),n.sharedClientState.updateMutationState(t,"rejected",e),await ah(n,s)}catch(s){await Yl(s)}}function l1(i,t){(i.mu.get(t)||[]).forEach((e=>{e.resolve()})),i.mu.delete(t)}function c1(i,t,e){const n=Vt(i);let s=n.Vu[n.currentUser.toKey()];if(s){const o=s.get(t);o&&(e?o.reject(e):o.resolve(),s=s.remove(t)),n.Vu[n.currentUser.toKey()]=s}}function Iy(i,t,e=null){i.sharedClientState.removeLocalQueryTarget(t);for(const n of i.Iu.get(t))i.Tu.delete(n),e&&i.Pu.yu(n,e);i.Iu.delete(t),i.isPrimaryClient&&i.Ru.jr(t).forEach((n=>{i.Ru.containsKey(n)||u1(i,n)}))}function u1(i,t){i.Eu.delete(t.path.canonicalString());const e=i.du.get(t);e!==null&&(Rv(i.remoteStore,e),i.du=i.du.remove(t),i.Au.delete(e),Ov(i))}function e0(i,t,e){for(const n of e)n instanceof i1?(i.Ru.addReference(n.key,t),eL(i,n)):n instanceof r1?(mt(Lv,"Document no longer in limbo: "+n.key),i.Ru.removeReference(n.key,t),i.Ru.containsKey(n.key)||u1(i,n.key)):Dt(19791,{wu:n})}function eL(i,t){const e=t.key,n=e.path.canonicalString();i.du.get(e)||i.Eu.has(n)||(mt(Lv,"New document in limbo: "+e),i.Eu.add(n),Ov(i))}function Ov(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const t=i.Eu.values().next().value;i.Eu.delete(t);const e=new wt(_e.fromString(t)),n=i.fu.next();i.Au.set(n,new G2(e)),i.du=i.du.insert(e,n),YT(i.remoteStore,new ta(Ai(_v(e.path)),n,"TargetPurposeLimboResolution",Jf.ce))}}async function ah(i,t,e){const n=Vt(i),s=[],o=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,t,e).then((f=>{if((f||e)&&n.isPrimaryClient){const m=f?!f.fromCache:e?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,m?"current":"not-current")}if(f){s.push(f);const m=xv.As(h.targetId,f);o.push(m)}})))})),await Promise.all(l),n.Pu.H_(s),await(async function(h,f){const m=Vt(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>lt.forEach(f,(b=>lt.forEach(b.Es,(A=>m.persistence.referenceDelegate.addReference(v,b.targetId,A))).next((()=>lt.forEach(b.ds,(A=>m.persistence.referenceDelegate.removeReference(v,b.targetId,A)))))))))}catch(v){if(!Xl(v))throw v;mt(Cv,"Failed to update sequence numbers: "+v)}for(const v of f){const b=v.targetId;if(!v.fromCache){const A=m.Ms.get(b),w=A.snapshotVersion,S=A.withLastLimboFreeSnapshotVersion(w);m.Ms=m.Ms.insert(b,S)}}})(n.localStore,o))}async function nL(i,t){const e=Vt(i);if(!e.currentUser.isEqual(t)){mt(Lv,"User change. New user:",t.toKey());const n=await qT(e.localStore,t);e.currentUser=t,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new pt(rt.CANCELLED,l))}))})),o.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await ah(e,n.Ls)}}function sL(i,t){const e=Vt(i),n=e.Au.get(t);if(n&&n.hu)return Yt().add(n.key);{let s=Yt();const o=e.Iu.get(t);if(!o)return s;for(const l of o){const u=e.Tu.get(l);s=s.unionWith(u.view.nu)}return s}}function h1(i){const t=Vt(i);return t.remoteStore.remoteSyncer.applyRemoteEvent=o1.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=sL.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Z2.bind(null,t),t.Pu.H_=F2.bind(null,t.eventManager),t.Pu.yu=B2.bind(null,t.eventManager),t}function iL(i){const t=Vt(i);return t.remoteStore.remoteSyncer.applySuccessfulWrite=J2.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=tL.bind(null,t),t}class Of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=lp(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return l2(this.persistence,new r2,t.initialUser,this.serializer)}Cu(t){return new GT(Tv.mi,this.serializer)}Du(t){return new m2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Of.provider={build:()=>new Of};class rL extends Of{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){ae(this.persistence.referenceDelegate instanceof Pf,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new GP(n,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new GT((n=>Pf.mi(n,e)),this.serializer)}}class Ny{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>t0(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=nL.bind(null,this.syncEngine),await j2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new U2})()}createDatastore(t){const e=lp(t.databaseInfo.databaseId),n=(function(o){return new b2(o)})(t.databaseInfo);return(function(o,l,u,h){return new S2(o,l,u,h)})(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return(function(n,s,o,l,u){return new x2(n,s,o,l,u)})(this.localStore,this.datastore,t.asyncQueue,(e=>t0(this.syncEngine,e,0)),(function(){return Ww.v()?new Ww:new g2})())}createSyncEngine(t,e){return(function(s,o,l,u,h,f,m){const v=new q2(s,o,l,u,h,f);return m&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const n=Vt(e);mt(yo,"RemoteStore shutting down."),n.Ea.add(5),await rh(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ny.provider={build:()=>new Ny};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):pr("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="FirestoreClient";class aL{constructor(t,e,n,s,o){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=s,this.user=Nn.UNAUTHENTICATED,this.clientId=Qf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async l=>{mt(ha,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(mt(ha,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Mv(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Gg(i,t){i.asyncQueue.verifyOperationInProgress(),mt(ha,"Initializing OfflineComponentProvider");const e=i.configuration;await t.initialize(e);let n=e.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await qT(t.localStore,s),n=s)})),t.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=t}async function n0(i,t){i.asyncQueue.verifyOperationInProgress();const e=await oL(i);mt(ha,"Initializing OnlineComponentProvider"),await t.initialize(e,i.configuration),i.setCredentialChangeListener((n=>Xw(t.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>Xw(t.remoteStore,s))),i._onlineComponents=t}async function oL(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){mt(ha,"Using user provided OfflineComponentProvider");try{await Gg(i,i._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===rt.FAILED_PRECONDITION||s.code===rt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;go("Error using user provided cache. Falling back to memory cache: "+e),await Gg(i,new Of)}}else mt(ha,"Using default OfflineComponentProvider"),await Gg(i,new rL(void 0));return i._offlineComponents}async function f1(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(mt(ha,"Using user provided OnlineComponentProvider"),await n0(i,i._uninitializedComponentsProvider._online)):(mt(ha,"Using default OnlineComponentProvider"),await n0(i,new Ny))),i._onlineComponents}function lL(i){return f1(i).then((t=>t.syncEngine))}async function p1(i){const t=await f1(i),e=t.eventManager;return e.onListen=$2.bind(null,t.syncEngine),e.onUnlisten=Y2.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=K2.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=X2.bind(null,t.syncEngine),e}function cL(i,t,e={}){const n=new cr;return i.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,f){const m=new d1({next:b=>{m.Nu(),l.enqueueAndForget((()=>n1(o,v)));const A=b.docs.has(u);!A&&b.fromCache?f.reject(new pt(rt.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&b.fromCache&&h&&h.source==="server"?f.reject(new pt(rt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(b)},error:b=>f.reject(b)}),v=new s1(_v(u.path),m,{includeMetadataChanges:!0,qa:!0});return e1(o,v)})(await p1(i),i.asyncQueue,t,e,n))),n.promise}function uL(i,t,e={}){const n=new cr;return i.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,f){const m=new d1({next:b=>{m.Nu(),l.enqueueAndForget((()=>n1(o,v))),b.fromCache&&h.source==="server"?f.reject(new pt(rt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(b)},error:b=>f.reject(b)}),v=new s1(u,m,{includeMetadataChanges:!0,qa:!0});return e1(o,v)})(await p1(i),i.asyncQueue,t,e,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m1(i){const t={};return i.timeoutSeconds!==void 0&&(t.timeoutSeconds=i.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1="firestore.googleapis.com",i0=!0;class r0{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new pt(rt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=g1,this.ssl=i0}else this.host=t.host,this.ssl=t.ssl??i0;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=HT;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<zP)throw new pt(rt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}nT("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=m1(t.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new pt(rt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new pt(rt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new pt(rt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class hp{constructor(t,e,n,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(rt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new pt(rt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r0(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new tT;switch(n.type){case"firstParty":return new bM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new pt(rt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const n=s0.get(e);n&&(mt("ComponentProvider","Removing Datastore"),s0.delete(e),n.terminate())})(this),Promise.resolve()}}function y1(i,t,e,n={}){i=fs(i,hp);const s=Ao(t),o=i._getSettings(),l={...o,emulatorOptions:i._getEmulatorOptions()},u=`${t}:${e}`;s&&(Zy(`https://${u}`),Jy("Firestore",!0)),o.host!==g1&&o.host!==u&&go("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:s,emulatorOptions:n};if(!uo(h,l)&&(i._setSettings(h),n.mockUserToken)){let f,m;if(typeof n.mockUserToken=="string")f=n.mockUserToken,m=Nn.MOCK_USER;else{f=oS(n.mockUserToken,i._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new pt(rt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Nn(v)}i._authCredentials=new yM(new JS(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ba(this.firestore,t,this._query)}}class Pe{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ur(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Pe(this.firestore,t,this._key)}toJSON(){return{type:Pe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(nh(e,Pe._jsonSchema))return new Pe(t,n||null,new wt(_e.fromString(e.referencePath)))}}Pe._jsonSchemaVersion="firestore/documentReference/1.0",Pe._jsonSchema={type:Je("string",Pe._jsonSchemaVersion),referencePath:Je("string")};class ur extends ba{constructor(t,e,n){super(t,e,_v(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Pe(this.firestore,null,new wt(t))}withConverter(t){return new ur(this.firestore,t,this._path)}}function ie(i,t,...e){if(i=Fe(i),eT("collection","path",t),i instanceof hp){const n=_e.fromString(t,...e);return vw(n),new ur(i,null,n)}{if(!(i instanceof Pe||i instanceof ur))throw new pt(rt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(_e.fromString(t,...e));return vw(n),new ur(i.firestore,null,n)}}function Te(i,t,...e){if(i=Fe(i),arguments.length===1&&(t=Qf.newId()),eT("doc","path",t),i instanceof hp){const n=_e.fromString(t,...e);return yw(n),new Pe(i,null,new wt(n))}{if(!(i instanceof Pe||i instanceof ur))throw new pt(rt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(_e.fromString(t,...e));return yw(n),new Pe(i.firestore,i instanceof ur?i.converter:null,new wt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0="AsyncQueue";class o0{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new KT(this,"async_queue_retry"),this._c=()=>{const n=Hg();n&&mt(a0,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const e=Hg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=Hg();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new cr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Xl(t))throw t;mt(a0,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((n=>{throw this.nc=n,this.rc=!1,pr("INTERNAL UNHANDLED ERROR: ",l0(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=e,e}enqueueAfterDelay(t,e,n){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=Dv.createAndSchedule(this,t,e,n,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&Dt(47125,{Pc:l0(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,n)=>e.targetTimeMs-n.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function l0(i){let t=i.message||"";return i.stack&&(t=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),t}class gr extends hp{constructor(t,e,n,s){super(t,e,n,s),this.type="firestore",this._queue=new o0,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new o0(t),this._firestoreClient=void 0,await t}}}function v1(i,t){const e=typeof i=="object"?i:nv(),n=typeof i=="string"?i:If,s=Kf(e,"firestore").getImmediate({identifier:n});if(!s._initialized){const o=iS("firestore");o&&y1(s,...o)}return s}function oh(i){if(i._terminated)throw new pt(rt.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||hL(i),i._firestoreClient}function hL(i){const t=i._freezeSettings(),e=(function(s,o,l,u){return new OM(s,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,m1(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,t);i._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),i._firestoreClient=new aL(i._authCredentials,i._appCheckCredentials,i._queue,e,i._componentsProvider&&(function(s){const o=s?._online.build();return{_offline:s?._offline.build(o),_online:o}})(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(t){this._byteString=t}static fromBase64String(t){try{return new hs(mn.fromBase64String(t))}catch(e){throw new pt(rt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new hs(mn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:hs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(nh(t,hs._jsonSchema))return hs.fromBase64String(t.bytes)}}hs._jsonSchemaVersion="firestore/bytes/1.0",hs._jsonSchema={type:Je("string",hs._jsonSchemaVersion),bytes:Je("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new pt(rt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new pt(rt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new pt(rt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Wt(this._lat,t._lat)||Wt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qs._jsonSchemaVersion}}static fromJSON(t){if(nh(t,qs._jsonSchema))return new qs(t.latitude,t.longitude)}}qs._jsonSchemaVersion="firestore/geoPoint/1.0",qs._jsonSchema={type:Je("string",qs._jsonSchemaVersion),latitude:Je("number"),longitude:Je("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(n,s){if(n.length!==s.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==s[o])return!1;return!0})(this._values,t._values)}toJSON(){return{type:$s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(nh(t,$s._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new $s(t.vectorValues);throw new pt(rt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$s._jsonSchemaVersion="firestore/vectorValue/1.0",$s._jsonSchema={type:Je("string",$s._jsonSchemaVersion),vectorValues:Je("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL=/^__.*__$/;class fL{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new _a(t,this.data,this.fieldMask,e,this.fieldTransforms):new sh(t,this.data,e,this.fieldTransforms)}}class _1{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new _a(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function b1(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt(40011,{Ac:i})}}class jv{constructor(t,e,n,s,o,l){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new jv({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.gc(t),n}yc(t){const e=this.path?.child(t),n=this.Vc({path:e,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return jf(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(b1(this.Ac)&&dL.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class pL{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||lp(t)}Cc(t,e,n,s=!1){return new jv({Ac:t,methodName:e,Dc:n,path:pn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ch(i){const t=i._freezeSettings(),e=lp(i._databaseId);return new pL(i._databaseId,!!t.ignoreUndefinedProperties,e)}function Vv(i,t,e,n,s,o={}){const l=i.Cc(o.merge||o.mergeFields?2:0,t,e,s);Fv("Data must be an object, but it was:",l,n);const u=w1(n,l);let h,f;if(o.merge)h=new ds(l.fieldMask),f=l.fieldTransforms;else if(o.mergeFields){const m=[];for(const v of o.mergeFields){const b=ky(t,v,e);if(!l.contains(b))throw new pt(rt.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);T1(m,b)||m.push(b)}h=new ds(m),f=l.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,f=l.fieldTransforms;return new fL(new Jn(u),h,f)}class dp extends lh{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof dp}}class Uv extends lh{_toFieldTransform(t){return new lP(t.path,new zu)}isEqual(t){return t instanceof Uv}}function A1(i,t,e,n){const s=i.Cc(1,t,e);Fv("Data must be an object, but it was:",s,n);const o=[],l=Jn.empty();va(n,((h,f)=>{const m=Bv(t,h,e);f=Fe(f);const v=s.yc(m);if(f instanceof dp)o.push(m);else{const b=uh(f,v);b!=null&&(o.push(m),l.set(m,b))}}));const u=new ds(o);return new _1(l,u,s.fieldTransforms)}function E1(i,t,e,n,s,o){const l=i.Cc(1,t,e),u=[ky(t,n,e)],h=[s];if(o.length%2!=0)throw new pt(rt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)u.push(ky(t,o[b])),h.push(o[b+1]);const f=[],m=Jn.empty();for(let b=u.length-1;b>=0;--b)if(!T1(f,u[b])){const A=u[b];let w=h[b];w=Fe(w);const S=l.yc(A);if(w instanceof dp)f.push(A);else{const N=uh(w,S);N!=null&&(f.push(A),m.set(A,N))}}const v=new ds(f);return new _1(m,v,l.fieldTransforms)}function mL(i,t,e,n=!1){return uh(e,i.Cc(n?4:3,t))}function uh(i,t){if(S1(i=Fe(i)))return Fv("Unsupported field value:",t,i),w1(i,t);if(i instanceof lh)return(function(n,s){if(!b1(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(i,t),null;if(i===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),i instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(n,s){const o=[];let l=0;for(const u of n){let h=uh(u,s.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(i,t)}return(function(n,s){if((n=Fe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return rP(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=be.fromDate(n);return{timestampValue:Mf(s.serializer,o)}}if(n instanceof be){const o=new be(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Mf(s.serializer,o)}}if(n instanceof qs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof hs)return{bytesValue:OT(s.serializer,n._byteString)};if(n instanceof Pe){const o=s.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:wv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof $s)return(function(l,u){return{mapValue:{fields:{[hT]:{stringValue:dT},[Nf]:{arrayValue:{values:l.toArray().map((f=>{if(typeof f!="number")throw u.Sc("VectorValues must only contain numeric values.");return bv(u.serializer,f)}))}}}}}})(n,s);throw s.Sc(`Unsupported field value: ${Zf(n)}`)})(i,t)}function w1(i,t){const e={};return rT(i)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):va(i,((n,s)=>{const o=uh(s,t.mc(n));o!=null&&(e[n]=o)})),{mapValue:{fields:e}}}function S1(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof be||i instanceof qs||i instanceof hs||i instanceof Pe||i instanceof lh||i instanceof $s)}function Fv(i,t,e){if(!S1(e)||!sT(e)){const n=Zf(e);throw n==="an object"?t.Sc(i+" a custom object"):t.Sc(i+" "+n)}}function ky(i,t,e){if((t=Fe(t))instanceof Jl)return t._internalPath;if(typeof t=="string")return Bv(i,t);throw jf("Field path arguments must be of type string or ",i,!1,void 0,e)}const gL=new RegExp("[~\\*/\\[\\]]");function Bv(i,t,e){if(t.search(gL)>=0)throw jf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,e);try{return new Jl(...t.split("."))._internalPath}catch{throw jf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,e)}}function jf(i,t,e,n,s){const o=n&&!n.isEmpty(),l=s!==void 0;let u=`Function ${t}() called with invalid data`;e&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${n}`),l&&(h+=` in document ${s}`),h+=")"),new pt(rt.INVALID_ARGUMENT,u+i+h)}function T1(i,t){return i.some((e=>e.isEqual(t)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(t,e,n,s,o){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new yL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(fp("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class yL extends x1{data(){return super.data()}}function fp(i,t){return typeof t=="string"?Bv(i,t):t instanceof Jl?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new pt(rt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zv{}class Hv extends zv{}function Ke(i,t,...e){let n=[];t instanceof zv&&n.push(t),n=n.concat(e),(function(o){const l=o.filter((h=>h instanceof pp)).length,u=o.filter((h=>h instanceof hh)).length;if(l>1||l>0&&u>0)throw new pt(rt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const s of n)i=s._apply(i);return i}class hh extends Hv{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new hh(t,e,n)}_apply(t){const e=this._parse(t);return C1(t._query,e),new ba(t.firestore,t.converter,by(t._query,e))}_parse(t){const e=ch(t.firestore);return(function(o,l,u,h,f,m,v){let b;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new pt(rt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){u0(v,m);const w=[];for(const S of v)w.push(c0(h,o,S));b={arrayValue:{values:w}}}else b=c0(h,o,v)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||u0(v,m),b=mL(u,l,v,m==="in"||m==="not-in");return Qe.create(f,m,b)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function Me(i,t,e){const n=t,s=fp("where",i);return hh._create(s,n,e)}class pp extends zv{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new pp(t,e)}_parse(t){const e=this._queryConstraints.map((n=>n._parse(t))).filter((n=>n.getFilters().length>0));return e.length===1?e[0]:Ks.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(s,o){let l=s;const u=o.getFlattenedFilters();for(const h of u)C1(l,h),l=by(l,h)})(t._query,e),new ba(t.firestore,t.converter,by(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mp extends Hv{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new mp(t,e)}_apply(t){const e=(function(s,o,l){if(s.startAt!==null)throw new pt(rt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new pt(rt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Bu(o,l)})(t._query,this._field,this._direction);return new ba(t.firestore,t.converter,(function(s,o){const l=s.explicitOrderBy.concat([o]);return new Ql(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(t._query,e))}}function mf(i,t="asc"){const e=t,n=fp("orderBy",i);return mp._create(n,e)}function c0(i,t,e){if(typeof(e=Fe(e))=="string"){if(e==="")throw new pt(rt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bT(t)&&e.indexOf("/")!==-1)throw new pt(rt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const n=t.path.child(_e.fromString(e));if(!wt.isDocumentKey(n))throw new pt(rt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return xw(i,new wt(n))}if(e instanceof Pe)return xw(i,e._key);throw new pt(rt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zf(e)}.`)}function u0(i,t){if(!Array.isArray(i)||i.length===0)throw new pt(rt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function C1(i,t){const e=(function(s,o){for(const l of s)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(i.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new pt(rt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new pt(rt.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class R1{convertValue(t,e="none"){switch(ca(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ue(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(la(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Dt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return va(t,((s,o)=>{n[s]=this.convertValue(o,e)})),n}convertVectorValue(t){const e=t.fields?.[Nf].arrayValue?.values?.map((n=>Ue(n.doubleValue)));return new $s(e)}convertGeoPoint(t){return new qs(Ue(t.latitude),Ue(t.longitude))}convertArray(t,e){return(t.values||[]).map((n=>this.convertValue(n,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=ep(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Uu(t));default:return null}}convertTimestamp(t){const e=oa(t);return new be(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=_e.fromString(t);ae(zT(n),9688,{name:t});const s=new Ul(n.get(1),n.get(3)),o=new wt(n.popFirst(5));return s.isEqual(e)||pr(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(i,t,e){let n;return n=i?e&&(e.merge||e.mergeFields)?i.toFirestore(t,e):i.toFirestore(t):t,n}class Rl{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class ia extends x1{constructor(t,e,n,s,o,l){super(t,e,n,s,l),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Du(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(fp("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(rt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=ia._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}ia._jsonSchemaVersion="firestore/documentSnapshot/1.0",ia._jsonSchema={type:Je("string",ia._jsonSchemaVersion),bundleSource:Je("string","DocumentSnapshot"),bundleName:Je("string"),bundle:Je("string")};class Du extends ia{data(t={}){return super.data(t)}}class co{constructor(t,e,n,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new Rl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Du(this._firestore,this._userDataWriter,n.key,n,new Rl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new pt(rt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((u=>{const h=new Du(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Rl(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new Du(s._firestore,s._userDataWriter,u.doc.key,u.doc,new Rl(s._snapshot.mutatedKeys.has(u.doc.key),s._snapshot.fromCache),s.query.converter);let f=-1,m=-1;return u.type!==0&&(f=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:_L(u.type),doc:h,oldIndex:f,newIndex:m}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(rt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=co._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Qf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(e.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function _L(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt(61501,{type:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(i){i=fs(i,Pe);const t=fs(i.firestore,gr);return cL(oh(t),i._key).then((e=>bL(t,i,e)))}co._jsonSchemaVersion="firestore/querySnapshot/1.0",co._jsonSchema={type:Je("string",co._jsonSchemaVersion),bundleSource:Je("string","QuerySnapshot"),bundleName:Je("string"),bundle:Je("string")};class I1 extends R1{constructor(t){super(),this.firestore=t}convertBytes(t){return new hs(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Pe(this.firestore,null,e)}}function ve(i){i=fs(i,ba);const t=fs(i.firestore,gr),e=oh(t),n=new I1(t);return vL(i._query),uL(e,i._query).then((s=>new co(t,n,i,s)))}function N1(i,t,e){i=fs(i,Pe);const n=fs(i.firestore,gr),s=Gv(i.converter,t,e);return tc(n,[Vv(ch(n),"setDoc",i._key,s,i.converter!==null,e).toMutation(i._key,zn.none())])}function tr(i,t,e,...n){i=fs(i,Pe);const s=fs(i.firestore,gr),o=ch(s);let l;return l=typeof(t=Fe(t))=="string"||t instanceof Jl?E1(o,"updateDoc",i._key,t,e,n):A1(o,"updateDoc",i._key,t),tc(s,[l.toMutation(i._key,zn.exists(!0))])}function no(i){return tc(fs(i.firestore,gr),[new ap(i._key,zn.none())])}function Wr(i,t){const e=fs(i.firestore,gr),n=Te(i),s=Gv(i.converter,t);return tc(e,[Vv(ch(i.firestore),"addDoc",n._key,s,i.converter!==null,{}).toMutation(n._key,zn.exists(!1))]).then((()=>n))}function tc(i,t){return(function(n,s){const o=new cr;return n.asyncQueue.enqueueAndForget((async()=>Q2(await lL(n),s,o))),o.promise})(oh(i),t)}function bL(i,t,e){const n=e.docs.get(t._key),s=new I1(i);return new ia(i,s,t._key,n,new Rl(e.hasPendingWrites,e.fromCache),t.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=ch(t)}set(t,e,n){this._verifyNotCommitted();const s=qg(t,this._firestore),o=Gv(s.converter,e,n),l=Vv(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,n);return this._mutations.push(l.toMutation(s._key,zn.none())),this}update(t,e,n,...s){this._verifyNotCommitted();const o=qg(t,this._firestore);let l;return l=typeof(e=Fe(e))=="string"||e instanceof Jl?E1(this._dataReader,"WriteBatch.update",o._key,e,n,s):A1(this._dataReader,"WriteBatch.update",o._key,e),this._mutations.push(l.toMutation(o._key,zn.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=qg(t,this._firestore);return this._mutations=this._mutations.concat(new ap(e._key,zn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pt(rt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qg(i,t){if((i=Fe(i)).firestore!==t)throw new pt(rt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}function Rs(){return new Uv("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(i){return oh(i=fs(i,gr)),new k1(i,(t=>tc(i,t)))}(function(t,e=!0){(function(s){Wl=s})(Eo),ho(new ra("firestore",((n,{instanceIdentifier:s,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new gr(new vM(n.getProvider("auth-internal")),new AM(l,n.getProvider("app-check-internal")),(function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new pt(rt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ul(f.options.projectId,m)})(l,s),l);return o={useFetchStreams:e,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),_i(fw,pw,t),_i(fw,pw,"esm2020")})();const AL=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:R1,Bytes:hs,CollectionReference:ur,DocumentReference:Pe,DocumentSnapshot:ia,FieldPath:Jl,FieldValue:lh,Firestore:gr,FirestoreError:pt,GeoPoint:qs,Query:ba,QueryCompositeFilterConstraint:pp,QueryConstraint:Hv,QueryDocumentSnapshot:Du,QueryFieldFilterConstraint:hh,QueryOrderByConstraint:mp,QuerySnapshot:co,SnapshotMetadata:Rl,Timestamp:be,VectorValue:$s,WriteBatch:k1,_AutoId:Qf,_ByteString:mn,_DatabaseId:Ul,_DocumentKey:wt,_EmptyAuthCredentialsProvider:tT,_FieldPath:pn,_cast:fs,_logWarn:go,_validateIsNotUsedTogether:nT,addDoc:Wr,collection:ie,connectFirestoreEmulator:y1,deleteDoc:no,doc:Te,ensureFirestoreConfigured:oh,executeWrite:tc,getDoc:qv,getDocs:ve,getFirestore:v1,orderBy:mf,query:Ke,serverTimestamp:Rs,setDoc:N1,updateDoc:tr,where:Me,writeBatch:Eu},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="firebasestorage.googleapis.com",EL="storageBucket",wL=120*1e3,SL=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends xi{constructor(t,e,n=0){super($g(t),`Firebase Storage: ${e} (${$g(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ci.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return $g(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Si;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Si||(Si={}));function $g(i){return"storage/"+i}function TL(){const i="An unknown error occurred, please check the error payload for server response.";return new Ci(Si.UNKNOWN,i)}function xL(){return new Ci(Si.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function CL(){return new Ci(Si.CANCELED,"User canceled the upload/download.")}function RL(i){return new Ci(Si.INVALID_URL,"Invalid URL '"+i+"'.")}function IL(i){return new Ci(Si.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function h0(i){return new Ci(Si.INVALID_ARGUMENT,i)}function M1(){return new Ci(Si.APP_DELETED,"The Firebase app was deleted.")}function NL(i){return new Ci(Si.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=Hs.makeFromUrl(t,e)}catch{return new Hs(t,"")}if(n.path==="")return n;throw IL(t)}static makeFromUrl(t,e){let n=null;const s="([A-Za-z0-9.\\-_]+)";function o(B){B.path.charAt(B.path.length-1)==="/"&&(B.path_=B.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+s+l,"i"),h={bucket:1,path:3};function f(B){B.path_=decodeURIComponent(B.path)}const m="v[A-Za-z0-9_]+",v=e.replace(/[.]/g,"\\."),b="(/([^?#]*).*)?$",A=new RegExp(`^https?://${v}/${m}/b/${s}/o${b}`,"i"),w={bucket:1,path:3},S=e===D1?"(?:storage.googleapis.com|storage.cloud.google.com)":e,N="([^?#]*)",R=new RegExp(`^https?://${S}/${s}/${N}`,"i"),M=[{regex:u,indices:h,postModify:o},{regex:A,indices:w,postModify:f},{regex:R,indices:{bucket:1,path:2},postModify:f}];for(let B=0;B<M.length;B++){const L=M[B],F=L.regex.exec(t);if(F){const C=F[L.indices.bucket];let I=F[L.indices.path];I||(I=""),n=new Hs(C,I),L.postModify(n);break}}if(n==null)throw RL(t);return n}}class kL{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(i,t,e){let n=1,s=null,o=null,l=!1,u=0;function h(){return u===2}let f=!1;function m(...N){f||(f=!0,t.apply(null,N))}function v(N){s=setTimeout(()=>{s=null,i(A,h())},N)}function b(){o&&clearTimeout(o)}function A(N,...R){if(f){b();return}if(N){b(),m.call(null,N,...R);return}if(h()||l){b(),m.call(null,N,...R);return}n<64&&(n*=2);let M;u===1?(u=2,M=0):M=(n+Math.random())*1e3,v(M)}let w=!1;function S(N){w||(w=!0,b(),!f&&(s!==null?(N||(u=2),clearTimeout(s),v(0)):N||(u=1)))}return v(0),o=setTimeout(()=>{l=!0,S(!0)},e),S}function ML(i){i(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(i){return i!==void 0}function d0(i,t,e,n){if(n<t)throw h0(`Invalid value for '${i}'. Expected ${t} or greater.`);if(n>e)throw h0(`Invalid value for '${i}'. Expected ${e} or less.`)}function LL(i){const t=encodeURIComponent;let e="?";for(const n in i)if(i.hasOwnProperty(n)){const s=t(n)+"="+t(i[n]);e=e+s+"&"}return e=e.slice(0,-1),e}var Vf;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(Vf||(Vf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(i,t){const e=i>=500&&i<600,s=[408,429].indexOf(i)!==-1,o=t.indexOf(i)!==-1;return e||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(t,e,n,s,o,l,u,h,f,m,v,b=!0,A=!1){this.url_=t,this.method_=e,this.headers_=n,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=f,this.progressCallback_=m,this.connectionFactory_=v,this.retry=b,this.isUsingEmulator=A,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,S)=>{this.resolve_=w,this.reject_=S,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Wd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const h=u.loaded,f=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,f)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===Vf.NO_ERROR,h=o.getStatus();if(!u||OL(h,this.additionalRetryCodes_)&&this.retry){const m=o.getErrorCode()===Vf.ABORT;n(!1,new Wd(!1,null,m));return}const f=this.successCodes_.indexOf(h)!==-1;n(!0,new Wd(f,o))})},e=(n,s)=>{const o=this.resolve_,l=this.reject_,u=s.connection;if(s.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());PL(h)?o(h):o()}catch(h){l(h)}else if(u!==null){const h=TL();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(s.canceled){const h=this.appDelete_?M1():CL();l(h)}else{const h=xL();l(h)}};this.canceled_?e(!1,new Wd(!1,null,!0)):this.backoffId_=DL(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&ML(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wd{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function VL(i,t){t!==null&&t.length>0&&(i.Authorization="Firebase "+t)}function UL(i,t){i["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function FL(i,t){t&&(i["X-Firebase-GMPID"]=t)}function BL(i,t){t!==null&&(i["X-Firebase-AppCheck"]=t)}function zL(i,t,e,n,s,o,l=!0,u=!1){const h=LL(i.urlParams),f=i.url+h,m=Object.assign({},i.headers);return FL(m,t),VL(m,e),UL(m,o),BL(m,n),new jL(f,i.method,m,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,s,l,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(i){if(i.length===0)return null;const t=i.lastIndexOf("/");return t===-1?"":i.slice(0,t)}function GL(i){const t=i.lastIndexOf("/",i.length-2);return t===-1?i:i.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(t,e){this._service=t,e instanceof Hs?this._location=e:this._location=Hs.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Uf(t,e)}get root(){const t=new Hs(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return GL(this._location.path)}get storage(){return this._service}get parent(){const t=HL(this._location.path);if(t===null)return null;const e=new Hs(this._location.bucket,t);return new Uf(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw NL(t)}}function f0(i,t){const e=t?.[EL];return e==null?null:Hs.makeFromBucketSpec(e,i)}function qL(i,t,e,n={}){i.host=`${t}:${e}`;const s=Ao(t);s&&(Zy(`https://${i.host}/b`),Jy("Storage",!0)),i._isUsingEmulator=!0,i._protocol=s?"https":"http";const{mockUserToken:o}=n;o&&(i._overrideAuthToken=typeof o=="string"?o:oS(o,i.app.options.projectId))}class $L{constructor(t,e,n,s,o,l=!1){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=D1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wL,this._maxUploadRetryTime=SL,this._requests=new Set,s!=null?this._bucket=Hs.makeFromBucketSpec(s,this._host):this._bucket=f0(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Hs.makeFromBucketSpec(this._url,t):this._bucket=f0(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){d0("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){d0("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(Zn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Uf(this,t)}_makeRequest(t,e,n,s,o=!0){if(this._deleted)return new kL(M1());{const l=zL(t,this._appId,n,s,e,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,e){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n,s).getPromise()}}const p0="@firebase/storage",m0="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1="storage";function KL(i=nv(),t){i=Fe(i);const n=Kf(i,P1).getImmediate({identifier:t}),s=iS("storage");return s&&WL(n,...s),n}function WL(i,t,e,n={}){qL(i,t,e,n)}function YL(i,{instanceIdentifier:t}){const e=i.getProvider("app").getImmediate(),n=i.getProvider("auth-internal"),s=i.getProvider("app-check-internal");return new $L(e,n,s,t,Eo)}function XL(){ho(new ra(P1,YL,"PUBLIC").setMultipleInstances(!0)),_i(p0,m0,""),_i(p0,m0,"esm2020")}XL();const QL={apiKey:"AIzaSyBRaHhg2CmvUBtg_UC3OHB6G2Bm4fDUifQ",authDomain:"kelazgraphicdesigner.firebaseapp.com",projectId:"kelazgraphicdesigner",storageBucket:"kelazgraphicdesigner.firebasestorage.app",messagingSenderId:"568241737996",appId:"1:568241737996:web:efa6fef6c268aa29b03929"},$v=uS(QL),wl=fM($v),ZL=new ir,Et=v1($v);KL($v);const hu={getUserRole(i){return"student"},async registerWithEmail(i,t,e,n){try{const o=(await Qk(wl,i,t)).user,l=n||this.getUserRole(i),u=l==="teacher"?"approved":"pending";return await this.saveUserToFirestore(o.uid,{name:e,email:o.email||i,role:l,status:u,createdAt:Rs()}),o}catch(s){throw console.error("Registration error:",s),s}},async loginWithEmail(i,t){try{const n=(await Zk(wl,i,t)).user;return await this.getUserFromFirestore(n.uid),n}catch(e){throw console.error("Login error:",e),e}},async loginWithGoogle(){try{const t=(await ED(wl,ZL)).user;if(!await this.getUserFromFirestore(t.uid)){const n=this.getUserRole(t.email||""),s=n==="teacher"?"approved":"pending";await this.saveUserToFirestore(t.uid,{name:t.displayName||"Unknown",email:t.email||"",role:n,status:s,createdAt:Rs()})}return t}catch(i){throw console.error("Google login error:",i),i}},async logout(){try{await nD(wl)}catch(i){throw console.error("Logout error:",i),i}},async saveUserToFirestore(i,t){try{await N1(Te(Et,"users",i),t)}catch(e){throw console.error("Error saving user to Firestore:",e),e}},async getUserFromFirestore(i){try{const t=await qv(Te(Et,"users",i));return t.exists()?t.data():null}catch(t){throw console.error("Error getting user from Firestore:",t),t}},async updateUserRole(i,t){try{const e=await this.getUserFromFirestore(i);if(e){const n={...e,role:t};await this.saveUserToFirestore(i,n)}}catch(e){throw console.error("Error updating user role:",e),e}},getCurrentUser(){return wl.currentUser}},yr=()=>{const[i,t]=z.useState({user:null,userDoc:null,loading:!0,error:null});return z.useEffect(()=>{const l=eD(wl,async u=>{t(h=>({...h,loading:!0,error:null}));try{if(u){const h=await hu.getUserFromFirestore(u.uid);t({user:u,userDoc:h,loading:!1,error:null})}else t({user:null,userDoc:null,loading:!1,error:null})}catch(h){t(f=>({...f,loading:!1,error:h instanceof Error?h.message:"Unknown error occurred"}))}});return()=>l()},[]),{...i,login:async(l,u)=>{t(h=>({...h,loading:!0,error:null}));try{await hu.loginWithEmail(l,u)}catch(h){throw t(f=>({...f,loading:!1,error:h instanceof Error?h.message:"Login failed"})),h}},loginWithGoogle:async()=>{t(l=>({...l,loading:!0,error:null}));try{await hu.loginWithGoogle()}catch(l){throw t(u=>({...u,loading:!1,error:l instanceof Error?l.message:"Google login failed"})),l}},register:async(l,u,h)=>{t(f=>({...f,loading:!0,error:null}));try{await hu.registerWithEmail(l,u,h)}catch(f){throw t(m=>({...m,loading:!1,error:f instanceof Error?f.message:"Registration failed"})),f}},logout:async()=>{t(l=>({...l,loading:!0,error:null}));try{await hu.logout()}catch(l){throw t(u=>({...u,loading:!1,error:l instanceof Error?l.message:"Logout failed"})),l}},isAuthenticated:!!i.user,isTeacher:i.userDoc?.role==="teacher",isStudent:i.userDoc?.role==="student"}};function Kg(i){z.useEffect(()=>{const t=i.current;if(!t)return;const e=()=>t?.classList?.add("mv-error");return t?.addEventListener?.("error",e),()=>t?.removeEventListener?.("error",e)},[i])}const Wg=i=>zC.createElement("model-viewer",i),JL=()=>{const i=z.useRef(null),t=z.useRef(null),e=z.useRef(null);Kg(i),Kg(t),Kg(e);const n={lantern:"https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/Lantern/glTF-Binary/Lantern.glb",avocado:"https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/Avocado/glTF-Binary/Avocado.glb",duck:"https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/Duck/glTF-Binary/Duck.glb"};return y.jsxs("div",{className:"hero-visual","aria-hidden":!0,children:[y.jsxs("div",{className:"mv-grid",children:[y.jsx("div",{className:"mv-tile mv-a",children:y.jsx(Wg,{ref:i,src:n.lantern,alt:"Creative light","camera-controls":!0,"auto-rotate":!0,"rotation-per-second":"16deg","shadow-intensity":"0.2",exposure:"1.05","interaction-prompt":"none",loading:"lazy",reveal:"auto","disable-zoom":!0,style:{width:"100%",height:"100%"}})}),y.jsx("div",{className:"mv-tile mv-b",children:y.jsx(Wg,{ref:t,src:n.avocado,alt:"Fresh ideas","camera-controls":!0,"auto-rotate":!0,"rotation-per-second":"12deg","shadow-intensity":"0.2",exposure:"1.05","interaction-prompt":"none",loading:"lazy",reveal:"auto","disable-zoom":!0,style:{width:"100%",height:"100%"}})}),y.jsx("div",{className:"mv-tile mv-c",children:y.jsx(Wg,{ref:e,src:n.duck,alt:"Playful learning","camera-controls":!0,"auto-rotate":!0,"rotation-per-second":"10deg","shadow-intensity":"0.2",exposure:"1.05","interaction-prompt":"none",loading:"lazy",reveal:"auto","disable-zoom":!0,style:{width:"100%",height:"100%"}})})]}),y.jsx("div",{className:"hero-glow"})]})},g0=({onLoginClick:i})=>{const[t,e]=z.useState("home"),[n,s]=z.useState(null);return z.useEffect(()=>{const o=window.location.hash||"",l=o.indexOf("?");l>=0&&(new URLSearchParams(o.substring(l+1)).get("msg")||"")==="rejected"&&s("Maaf, pendaftaran Anda ditolak oleh guru. Silakan hubungi guru untuk informasi lebih lanjut.")},[]),y.jsxs("div",{className:"home-page",children:[y.jsx("header",{className:"header",children:y.jsxs("div",{className:"container",children:[y.jsxs("div",{className:"logo",children:[y.jsx("h2",{children:"Kelaz"}),y.jsx("span",{children:"Kelas Desain Grafis Online"})]}),y.jsx("nav",{className:"nav",children:y.jsxs("ul",{children:[y.jsx("li",{children:y.jsx("a",{href:"#home",className:t==="home"?"active":"",onClick:()=>e("home"),children:"Beranda"})}),y.jsx("li",{children:y.jsx("button",{className:"btn-login",onClick:i,children:"Masuk"})})]})})]})}),n&&y.jsx("div",{className:"container",style:{marginTop:12},children:y.jsx("div",{className:"error-message",style:{background:"#fef2f2",borderColor:"#fecaca"},children:n})}),y.jsx("section",{className:"hero",children:y.jsxs("div",{className:"container",children:[y.jsxs("div",{className:"hero-content",children:[y.jsx("h1",{children:"Belajar Desain Grafis Secara Online"}),y.jsx("p",{children:"Bergabunglah dengan kelas desain grafis online gratis kami. Kuasai dasar-dasar desain melalui materi interaktif, kuis, dan proyek langsung."}),y.jsxs("div",{className:"hero-stats",children:[y.jsxs("div",{className:"stat",children:[y.jsx("h3",{children:"Gratis"}),y.jsx("p",{children:"Kursus 100% Gratis"})]}),y.jsxs("div",{className:"stat",children:[y.jsx("h3",{children:"Online"}),y.jsx("p",{children:"Belajar di Mana Saja"})]})]}),y.jsxs("div",{className:"hero-buttons",children:[y.jsx("button",{className:"hero-btn hero-btn--primary",onClick:i,children:"Mulai Belajar"}),y.jsxs("button",{className:"hero-btn hero-btn--ghost hero-btn--icon",onClick:()=>{document.getElementById("modules")?.scrollIntoView({behavior:"smooth",block:"start"})},children:[y.jsx("span",{children:"Lihat Kurikulum"}),y.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:y.jsx("path",{d:"M5 12h14M13 5l7 7-7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})]}),y.jsx("div",{className:"hero-image",children:y.jsx(JL,{})})]})}),y.jsx("section",{className:"features",children:y.jsxs("div",{className:"container",children:[y.jsx("h2",{children:"Mengapa Memilih Kelas Ini?"}),y.jsxs("div",{className:"features-grid",children:[y.jsxs("div",{className:"feature-card",children:[y.jsx("div",{className:"feature-icon",children:""}),y.jsx("h3",{children:"Pelajaran Interaktif"}),y.jsx("p",{children:"Belajar melalui konten menarik dengan teks, gambar, dan materi video."})]}),y.jsxs("div",{className:"feature-card",children:[y.jsx("div",{className:"feature-icon",children:""}),y.jsx("h3",{children:"Kuis & Penilaian"}),y.jsx("p",{children:"Uji pemahaman dengan kuis pilihan ganda dan pantau progres belajar."})]}),y.jsxs("div",{className:"feature-card",children:[y.jsx("div",{className:"feature-icon",children:""}),y.jsx("h3",{children:"Belajar Kelompok Kecil"}),y.jsx("p",{children:"Perhatian lebih personal: maksimal 3 siswa per kelas untuk bimbingan optimal."})]}),y.jsxs("div",{className:"feature-card",children:[y.jsx("div",{className:"feature-icon",children:""}),y.jsx("h3",{children:"Pelacakan Progres"}),y.jsx("p",{children:"Monitor perjalanan belajar Anda dan lihat peningkatan dari waktu ke waktu."})]})]})]})}),y.jsx("section",{className:"modules",id:"modules",children:y.jsxs("div",{className:"container",children:[y.jsx("h2",{children:"Tingkat Pembelajaran"}),y.jsxs("div",{className:"modules-list",children:[y.jsxs("div",{className:"module-card",children:[y.jsx("div",{className:"module-number",children:"01"}),y.jsxs("div",{className:"module-content",children:[y.jsx("h3",{children:"Basic"}),y.jsx("p",{children:"Pelajari prinsip dasar desain termasuk teori warna, tipografi, dan komposisi."}),y.jsxs("div",{className:"module-meta",children:[y.jsx("span",{children:"5 Materi"}),y.jsx("span",{children:"2 Kuis"})]})]})]}),y.jsxs("div",{className:"module-card",children:[y.jsx("div",{className:"module-number",children:"02"}),y.jsxs("div",{className:"module-content",children:[y.jsx("h3",{children:"Intermediate"}),y.jsx("p",{children:"Membuat karya yang lebih kuat dan memahami pengembangan identitas visual."}),y.jsxs("div",{className:"module-meta",children:[y.jsx("span",{children:"6 Materi"}),y.jsx("span",{children:"3 Kuis"})]})]})]}),y.jsxs("div",{className:"module-card",children:[y.jsx("div",{className:"module-number",children:"03"}),y.jsxs("div",{className:"module-content",children:[y.jsx("h3",{children:"Advanced"}),y.jsx("p",{children:"Kuasai tools desain populer dan teknik lanjutan untuk hasil profesional."}),y.jsxs("div",{className:"module-meta",children:[y.jsx("span",{children:"8 Materi"}),y.jsx("span",{children:"4 Kuis"})]})]})]})]})]})}),y.jsx("section",{className:"cta",children:y.jsxs("div",{className:"container",children:[y.jsx("h2",{children:"Siap Memulai Perjalanan Desain Anda?"}),y.jsx("p",{children:"Bergabung sekarang dan buka potensi kreatif Anda melalui kelas desain grafis gratis."}),y.jsx("button",{className:"hero-btn hero-btn--primary",onClick:i,children:"Mulai Sekarang"})]})}),y.jsx("footer",{className:"footer",children:y.jsxs("div",{className:"container",children:[y.jsxs("div",{className:"footer-content",children:[y.jsxs("div",{className:"footer-section",children:[y.jsx("h3",{children:"Kelaz Desain Grafis"}),y.jsx("p",{children:"Pembelajaran desain grafis gratis untuk semua."})]}),y.jsxs("div",{className:"footer-section",children:[y.jsx("h4",{children:"Akses"}),y.jsx("ul",{children:y.jsx("li",{children:y.jsx("button",{onClick:i,className:"footer-link",children:"Masuk"})})})]})]}),y.jsx("div",{className:"footer-bottom",children:y.jsx("p",{children:" 2025 Kelaz Graphic Design Online Class. Free for everyone."})})]})})]})},tO=()=>{const[i,t]=z.useState(!0),[e,n]=z.useState({email:"",password:"",name:"",confirmPassword:""}),[s,o]=z.useState(""),{login:l,register:u,loginWithGoogle:h,loading:f,isAuthenticated:m}=yr(),v=R=>{const{name:V,value:M}=R.target;n(B=>({...B,[V]:M})),s&&o("")},b=()=>{if(!e.email||!e.password)return o("Email dan kata sandi wajib diisi"),!1;if(!i){if(!e.name)return o("Nama wajib diisi"),!1;if(e.password.length<6)return o("Kata sandi minimal 6 karakter"),!1;if(e.password!==e.confirmPassword)return o("Kata sandi tidak cocok"),!1}return!0},A=async R=>{if(R.preventDefault(),o(""),!!b())try{i?await l(e.email,e.password):await u(e.email,e.password,e.name)}catch(V){o(V instanceof Error?V.message:"Terjadi kesalahan")}},w=async()=>{o("");try{await h()}catch(R){o(R instanceof Error?R.message:"Masuk dengan Google gagal")}},S=()=>{t(!i),n({email:"",password:"",name:"",confirmPassword:""}),o("")},N=()=>{m?window.location.hash="#/dashboard":window.location.hash="#/"};return y.jsx("div",{className:"auth-page",children:y.jsxs("div",{className:"auth-container",children:[y.jsxs("div",{className:"auth-header",children:[y.jsx("h1",{children:"Kelaz Desain Grafis"}),y.jsx("p",{children:"Platform Pembelajaran Online"})]}),y.jsxs("div",{className:"auth-card",children:[y.jsxs("div",{className:"auth-tabs",children:[y.jsx("button",{className:`tab ${i?"active":""}`,onClick:()=>t(!0),type:"button",children:"Masuk"}),y.jsx("button",{className:`tab ${i?"":"active"}`,onClick:()=>t(!1),type:"button",children:"Daftar"})]}),y.jsxs("form",{onSubmit:A,className:"auth-form",children:[!i&&y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"name",children:"Nama Lengkap"}),y.jsx("input",{type:"text",id:"name",name:"name",value:e.name,onChange:v,placeholder:"Masukkan nama lengkap",required:!i})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"email",children:"Alamat Email"}),y.jsx("input",{type:"email",id:"email",name:"email",value:e.email,onChange:v,placeholder:"Masukkan email",required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"password",children:"Kata Sandi"}),y.jsx("input",{type:"password",id:"password",name:"password",value:e.password,onChange:v,placeholder:"Masukkan kata sandi",required:!0})]}),!i&&y.jsxs("div",{className:"form-group",children:[y.jsx("label",{htmlFor:"confirmPassword",children:"Konfirmasi Kata Sandi"}),y.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:v,placeholder:"Konfirmasi kata sandi",required:!i})]}),s&&y.jsx("div",{className:"error-message",children:s}),y.jsx("button",{type:"submit",className:"btn-primary btn-full",disabled:f,children:f?"Mohon tunggu...":i?"Masuk":"Buat Akun"})]}),y.jsx("div",{className:"auth-divider",children:y.jsx("span",{children:"atau"})}),y.jsxs("button",{type:"button",onClick:w,className:"btn-google",disabled:f,children:[y.jsx("span",{className:"google-icon","aria-hidden":"true",children:y.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",focusable:"false",role:"img",children:[y.jsx("path",{fill:"#FFC107",d:"M43.6 20.5H42V20H24v8h11.3c-1.6 4.6-6 8-11.3 8-6.6 0-12-5.4-12-12S17.4 12 24 12c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.6 6.1 29.6 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20 20-8.9 20-20c0-1.2-.1-2.3-.4-3.5z"}),y.jsx("path",{fill:"#FF3D00",d:"M6.3 14.7l6.6 4.8C14.8 16 18.9 12 24 12c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.6 6.1 29.6 4 24 4c-7.7 0-14.3 4.3-17.7 10.7z"}),y.jsx("path",{fill:"#4CAF50",d:"M24 44c5.3 0 10.2-2 13.9-5.3l-6.4-5.4C29.4 34.5 26.9 36 24 36c-5.2 0-9.6-3.3-11.2-7.9l-6.5 5C9.7 39.6 16.3 44 24 44z"}),y.jsx("path",{fill:"#1976D2",d:"M43.6 20.5H42V20H24v8h11.3c-1 2.8-3 5.2-5.6 6.8l.1-.1 6.4 5.4C34.9 42 40 38 42.9 32.3c1.1-2.1 1.7-4.6 1.7-7.3 0-1.2-.1-2.3-.4-3.5z"})]})}),"Lanjutkan dengan Google"]}),y.jsxs("div",{className:"auth-footer",children:[y.jsxs("p",{children:[i?"Belum punya akun? ":"Sudah punya akun? ",y.jsx("button",{type:"button",onClick:S,className:"link-button",children:i?"Daftar":"Masuk"})]}),y.jsx("p",{className:"back-row",children:y.jsx("button",{type:"button",onClick:N,className:"link-button",children:" Kembali ke Dashboard"})}),y.jsxs("div",{className:"role-info",children:[y.jsx("p",{children:" Bergabung dengan kelas desain grafis online gratis"}),y.jsx("p",{children:" Mulai belajar dengan materi interaktif dan kuis"})]})]})]})]})})},eO="modulepreload",nO=function(i){return"/kelazgraphicdesigner/"+i},y0={},sO=function(t,e,n){let s=Promise.resolve();if(e&&e.length>0){let h=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");s=h(e.map(f=>{if(f=nO(f),f in y0)return;y0[f]=!0;const m=f.endsWith(".css"),v=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":eO,m||(b.as="script"),b.crossOrigin="",b.href=f,u&&b.setAttribute("nonce",u),document.head.appendChild(b),m)return new Promise((A,w)=>{b.addEventListener("load",A),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return s.then(l=>{for(const u of l||[])u.status==="rejected"&&o(u.reason);return t().catch(o)})},vt={async getModules(){try{const i=ie(Et,"modules"),t=Ke(i,mf("createdAt","desc"));let n=(await ve(t)).docs.map(s=>({id:s.id,...s.data()}));return n.sort((s,o)=>(s.order||999)-(o.order||999)),n}catch(i){throw console.error("Error getting modules:",i),i}},async createModule(i){try{return(await Wr(ie(Et,"modules"),{...i,createdAt:Rs()})).id}catch(t){throw console.error("Error creating module:",t),t}},async updateModule(i,t){try{await tr(Te(Et,"modules",i),t)}catch(e){throw console.error("Error updating module:",e),e}},async deleteModule(i){try{const t=await ve(ie(Et,"modules",i,"lessons"));if(!t.empty){const e=Eu(Et);t.forEach(n=>{e.delete(Te(Et,"modules",i,"lessons",n.id))}),await e.commit()}await no(Te(Et,"modules",i))}catch(t){throw console.error("Error deleting module:",t),t}},async getModuleWithLessons(i){try{const t=await qv(Te(Et,"modules",i));if(!t.exists())return null;const e={id:t.id,...t.data()},n=await this.getLessons(i);return{...e,lessons:n}}catch(t){throw console.error("Error getting module with lessons:",t),t}},async getLessons(i){try{const t=ie(Et,"modules",i,"lessons"),e=Ke(t,mf("createdAt","desc"));let s=(await ve(e)).docs.map(o=>({id:o.id,...o.data()}));return s.sort((o,l)=>(o.order||999)-(l.order||999)),s}catch(t){throw console.error("Error getting lessons:",t),t}},async getAllLessons(){try{const i=await this.getModules(),t=[];for(const e of i){const n=await this.getLessons(e.id);t.push(...n)}return t}catch(i){return console.error("Error getting all lessons:",i),[]}},async getAllLessonsCount(){try{const i=await this.getModules();let t=0;for(const e of i){const n=await this.getLessons(e.id);t+=n.length}return t}catch(i){return console.error("Error getting lessons count:",i),0}},async createLesson(i,t){try{const e=ie(Et,"modules",i,"lessons");return(await Wr(e,{...t,createdAt:Rs()})).id}catch(e){throw console.error("Error creating lesson:",e),e}},async updateLesson(i,t,e){try{await tr(Te(Et,"modules",i,"lessons",t),e)}catch(n){throw console.error("Error updating lesson:",n),n}},async deleteLesson(i,t){try{await no(Te(Et,"modules",i,"lessons",t))}catch(e){throw console.error("Error deleting lesson:",e),e}},async getQuizzes(i){try{const t=ie(Et,"quizzes"),e=Ke(t,mf("createdAt","desc"));let s=(await ve(e)).docs.map(o=>({id:o.id,...o.data()}));return i&&(s=s.filter(o=>o.moduleId===i)),s}catch(t){return console.error("Error getting quizzes:",t),[]}},async createQuiz(i){try{return(await Wr(ie(Et,"quizzes"),{...i,createdAt:Rs()})).id}catch(t){throw console.error("Error creating quiz:",t),t}},async addQuestionToQuiz(i,t){try{const e=ie(Et,"quizzes",i,"questions");return(await Wr(e,{...t,order:1})).id}catch(e){throw console.error("Error adding question to quiz:",e),e}},async updateQuiz(i,t){try{await tr(Te(Et,"quizzes",i),t)}catch(e){throw console.error("Error updating quiz:",e),e}},async deleteQuiz(i){try{const t=await ve(ie(Et,"quizzes",i,"questions"));if(!t.empty){const s=Eu(Et);t.forEach(o=>{s.delete(Te(Et,"quizzes",i,"questions",o.id))}),await s.commit()}const e=ie(Et,"answers"),n=await ve(Ke(e,Me("quizId","==",i)));if(!n.empty){const s=Eu(Et);n.forEach(o=>s.delete(Te(Et,"answers",o.id))),await s.commit()}await no(Te(Et,"quizzes",i))}catch(t){throw console.error("Error deleting quiz:",t),t}},async getQuestions(i){try{const t=ie(Et,"quizzes",i,"questions"),n=(await ve(t)).docs.map(s=>({id:s.id,...s.data()}));return n.sort((s,o)=>(s.order??999)-(o.order??999)),n}catch(t){return console.error("Error getting questions:",t),[]}},async markLessonRead(i,t,e){try{const n=`${i}_${t}_${e}`;await(await sO(async()=>{const{setDoc:s}=await Promise.resolve().then(()=>AL);return{setDoc:s}},[])).setDoc(Te(Et,"lessonReads",n),{userId:i,moduleId:t,lessonId:e,readAt:Rs()},{merge:!0})}catch(n){console.error("Error marking lesson read:",n)}},async getLessonReadsByUser(i){try{const t=ie(Et,"lessonReads");return(await ve(Ke(t,Me("userId","==",i)))).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error getting lesson reads:",t),[]}},async replaceAnswers(i,t,e){try{const n=ie(Et,"answers"),s=await ve(Ke(n,Me("userId","==",i),Me("quizId","==",t)));if(!s.empty){const o=Eu(Et);s.forEach(l=>o.delete(Te(Et,"answers",l.id))),await o.commit()}for(const o of e)await Wr(n,{userId:i,quizId:t,questionId:o.questionId,selectedIndex:o.selectedIndex,isCorrect:o.isCorrect,answeredAt:Rs()})}catch(n){throw console.error("Error replacing answers:",n),n}},async getAnswersByUser(i,t){try{const e=ie(Et,"answers"),n=Ke(e,Me("userId","==",i));let o=(await ve(n)).docs.map(l=>({id:l.id,...l.data()}));return t&&(o=o.filter(l=>l.quizId===t)),o.sort((l,u)=>{const h=l.answeredAt?.toMillis?.()??0;return(u.answeredAt?.toMillis?.()??0)-h}),o}catch(e){return console.error("Error getting answers:",e),[]}},async getRetakeGrant(i,t){try{const e=ie(Et,"retakeGrants"),n=await ve(Ke(e,Me("userId","==",i),Me("quizId","==",t)));if(n.empty)return null;const s=n.docs[0];return{id:s.id,...s.data()}}catch(e){return console.error("Error getting retake grant:",e),null}},async grantRetake(i,t,e,n){try{const s=ie(Et,"retakeGrants"),o=await ve(Ke(s,Me("userId","==",i),Me("quizId","==",t)));if(!o.empty){const u=o.docs[0],h=u.data().allowed||0;return await tr(Te(Et,"retakeGrants",u.id),{allowed:Math.max(0,h+e),grantedBy:n,grantedAt:Rs()}),u.id}return(await Wr(s,{userId:i,quizId:t,allowed:Math.max(0,e),grantedBy:n,grantedAt:Rs()})).id}catch(s){throw console.error("Error granting retake:",s),s}},async consumeRetake(i,t){try{const e=await this.getRetakeGrant(i,t);return!e||e.allowed<=0?!1:(await tr(Te(Et,"retakeGrants",e.id),{allowed:Math.max(0,(e.allowed||0)-1)}),!0)}catch(e){return console.error("Error consuming retake:",e),!1}},async revokeRetake(i,t){try{const e=ie(Et,"retakeGrants"),n=await ve(Ke(e,Me("userId","==",i),Me("quizId","==",t)));n.empty||await no(Te(Et,"retakeGrants",n.docs[0].id))}catch(e){console.error("Error revoking retake:",e)}},async getUserProgress(i,t){try{const e=ie(Et,"progress");let n;return t?n=Ke(e,Me("userId","==",i),Me("moduleId","==",t)):n=Ke(e,Me("userId","==",i)),(await ve(n)).docs.map(o=>({id:o.id,...o.data()}))}catch(e){return console.error("Error getting user progress:",e),[]}},async getEnrollmentsByUser(i){try{const t=ie(Et,"enrollments");return(await ve(Ke(t,Me("userId","==",i)))).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error getting enrollments:",t),[]}},async enrollUserToModule(i,t){try{return(await Wr(ie(Et,"enrollments"),{userId:i,moduleId:t,enrolledAt:Rs()})).id}catch(e){throw console.error("Error creating enrollment:",e),e}},async unenrollUser(i){try{await no(Te(Et,"enrollments",i))}catch(t){throw console.error("Error deleting enrollment:",t),t}},async getStudentCount(){try{const i=ie(Et,"users"),t=Ke(i,Me("role","==","student"));return(await ve(t)).size}catch(i){return console.error("Error getting student count:",i),0}},async updateUser(i,t){try{await tr(Te(Et,"users",i),t)}catch(e){throw console.error("Error updating user:",e),e}},async deleteUser(i){try{await no(Te(Et,"users",i))}catch(t){throw console.error("Error deleting user:",t),t}},async getStudents(){try{const i=ie(Et,"users"),t=Ke(i,Me("role","==","student"));return(await ve(t)).docs.map(n=>({id:n.id,...n.data()}))}catch(i){return console.error("Error getting students:",i),[]}},async getPendingStudents(){try{const i=ie(Et,"users"),t=Ke(i,Me("role","==","student"));return(await ve(t)).docs.map(s=>({id:s.id,...s.data()})).filter(s=>(s.status??"approved")!=="approved")}catch(i){return console.error("Error getting pending students:",i),[]}},async approveUser(i){try{await tr(Te(Et,"users",i),{status:"approved",approvedAt:Rs()})}catch(t){throw console.error("Error approving user:",t),t}},async rejectUser(i){try{await tr(Te(Et,"users",i),{status:"rejected"})}catch(t){throw console.error("Error rejecting user:",t),t}},async getAnalytics(){try{const[i,t,e,n]=await Promise.all([this.getStudentCount(),this.getTotalQuizzes(),this.getCompletedQuizzes(),this.getAverageQuizScore()]),s=await this.getTotalSubmissions(),o=i>0?e/i*100:0;return{totalStudents:i,totalQuizzes:t,totalSubmissions:s,completedQuizzes:e,avgScore:n,completionRate:o}}catch(i){return console.error("Error getting analytics:",i),{totalStudents:0,totalQuizzes:0,totalSubmissions:0,completedQuizzes:0,avgScore:0,completionRate:0}}},async getTotalQuizzes(){try{const i=ie(Et,"quizzes");return(await ve(i)).size}catch(i){return console.error("Error getting total quizzes:",i),0}},async getTotalSubmissions(){try{const i=ie(Et,"answers");return(await ve(i)).size}catch(i){return console.error("Error getting total submissions:",i),0}},async getCompletedQuizzes(){try{const i=ie(Et,"answers"),t=await ve(i),e=new Set;return t.forEach(n=>{const s=n.data();e.add(`${s.userId}-${s.quizId}`)}),e.size}catch(i){return console.error("Error getting completed quizzes count:",i),0}},async getAverageQuizScore(){try{const i=ie(Et,"answers"),t=await ve(i);if(t.empty)return 0;const e={};t.forEach(s=>{const o=s.data(),l=`${o.userId}-${o.quizId}`;e[l]||(e[l]={correct:0,total:0}),e[l].total++,o.isCorrect&&e[l].correct++});const n=Object.values(e).map(s=>s.total>0?s.correct/s.total*100:0);return n.length>0?n.reduce((s,o)=>s+o,0)/n.length:0}catch(i){return console.error("Error getting average quiz score:",i),0}},async getCompletionsByQuiz(i){try{const t=ie(Et,"answers"),e=await ve(Ke(t,Me("quizId","==",i))),n={};return e.forEach(s=>{const o=s.data(),l=o.answeredAt?.toMillis?.()??0,u=n[o.userId]?.lastAnsweredAt??0;l>u&&(n[o.userId]={lastAnsweredAt:l})}),n}catch(t){return console.error("Error getting completions by quiz:",t),{}}},async getRetakeGrantsByQuiz(i){try{const t=ie(Et,"retakeGrants");return(await ve(Ke(t,Me("quizId","==",i)))).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error getting retake grants by quiz:",t),[]}},async getRetakeGrantsByUser(i){try{const t=ie(Et,"retakeGrants");return(await ve(Ke(t,Me("userId","==",i)))).docs.map(n=>({id:n.id,...n.data()}))}catch(t){return console.error("Error getting retake grants by user:",t),[]}},async createSampleData(i){try{console.log("Creating sample data...");const t=await this.createModule({title:"Dasar-dasar Desain",description:"Pelajari prinsip-prinsip dasar desain grafis termasuk teori warna, tipografi, dan komposisi.",createdBy:i,order:1}),e=await this.createModule({title:"Tipografi & Tata Letak",description:"Kuasai seni tipografi dan buat tata letak menakjub untuk berbagai media.",createdBy:i,order:2}),n=await this.createModule({title:"Tools Desain Digital",description:"Kuasai software desain populer dan teknik desain digital.",createdBy:i,order:3});await this.createLesson(t,{title:"Pengenalan Prinsip Desain",content:"Selamat datang di dunia desain grafis! Dalam materi ini, kita akan menjelajahi prinsip-prinsip dasar yang memandu semua desain yang baik.",order:1}),await this.createLesson(t,{title:"Dasar-dasar Teori Warna",content:"Memahami hubungan warna, roda warna, dan cara membuat palet warna yang efektif untuk desain Anda.",order:2}),await this.createLesson(e,{title:"Dasar Tipografi",content:"Pelajari tentang berbagai jenis font, spasi, hierarki, dan bagaimana tipografi mempengaruhi keterbacaan dan suasana.",order:1}),await this.createLesson(e,{title:"Tata Letak dan Komposisi",content:"Kuasai sistem grid, ruang kosong, dan keseimbangan visual untuk menciptakan tata letak yang menarik.",order:2}),await this.createLesson(n,{title:"Tinjauan Tools Desain Digital",content:"Pelajari tentang software desain paling populer dan cara memilih tools yang tepat untuk proyek Anda.",order:1});const s=await this.createQuiz({moduleId:t,title:"Kuis Prinsip Desain",createdBy:i,timeLimitSec:600}),o=await this.createQuiz({moduleId:t,title:"Kuis Teori Warna",createdBy:i,timeLimitSec:480});console.log("Sample data created successfully!"),console.log("Created modules:",t,e,n),console.log("Created quizzes:",s,o)}catch(t){throw console.error("Error creating sample data:",t),t}}},iO=()=>{const[i,t]=z.useState({students:[],modules:[],totalLessons:0,analytics:{totalStudents:0,totalQuizzes:0,totalSubmissions:0,completionRate:0,avgScore:0},loading:!0,error:null}),e=async()=>{t(s=>({...s,loading:!0,error:null}));try{const[s,o,l,u]=await Promise.all([vt.getStudents(),vt.getModules(),vt.getAllLessonsCount(),vt.getAnalytics()]);t({students:s,modules:o,totalLessons:l,analytics:u,loading:!1,error:null})}catch(s){t(o=>({...o,loading:!1,error:s instanceof Error?s.message:"Failed to load dashboard data"}))}},n=async s=>{try{await vt.createSampleData(s),await e()}catch(o){throw console.error("Error creating sample data:",o),o}};return z.useEffect(()=>{e()},[]),{...i,refreshData:e,createSampleData:n}},rO=i=>{const[t,e]=z.useState(!0),[n,s]=z.useState(null),[o,l]=z.useState([]),[u,h]=z.useState([]),[f,m]=z.useState([]),[v,b]=z.useState([]),[A,w]=z.useState({});z.useEffect(()=>{(async()=>{if(i){e(!0),s(null);try{const[L,F,C,I]=await Promise.all([vt.getQuizzes(),vt.getAnswersByUser(i),vt.getModules(),vt.getLessonReadsByUser(i)]);l(L),h(F),m(C),b(I);const k=C.filter(H=>H.visible??!0),O=await Promise.all(k.map(async H=>[H.id,(await vt.getLessons(H.id)).length])),U={};O.forEach(([H,j])=>{U[H]=j}),w(U)}catch(L){s(L?.message||"Gagal memuat data siswa")}finally{e(!1)}}})()},[i]);const{totalQuizzes:S,completedQuizzes:N,averageScore:R,progressPercent:V,moduleProgress:M}=z.useMemo(()=>{const B=f.filter(X=>X.visible??!0),L=new Set(B.map(X=>X.id)),F=o.filter(X=>!X.moduleId||L.has(X.moduleId)),C=F.length,I=new Map;u.forEach(X=>{const ut=I.get(X.quizId)||{correct:0,total:0};ut.total+=1,X.isCorrect&&(ut.correct+=1),I.set(X.quizId,ut)});const k=I.size;let O=0;const U=Array.from(I.values()).map(X=>X.total>0?X.correct/X.total*100:0);U.length>0&&(O=U.reduce((X,ut)=>X+ut,0)/U.length);const H=B.reduce((X,ut)=>X+(A[ut.id]||0),0);let j=0;if(H>0){const X=v.filter(ut=>L.has(ut.moduleId)).length;j=Math.min(100,Math.round(X/H*100))}const _t=H>0?j:C>0?Math.round(k/C*100):0,Pt=new Map;F.forEach(X=>{if(!X.moduleId)return;const ut=Pt.get(X.moduleId)||{total:0,done:0};ut.total+=1,I.has(X.id)&&(ut.done+=1),Pt.set(X.moduleId,ut)});const W=B.map(X=>{const ut=A[X.id]||0;let xt=0;if(ut>0){const q=v.filter(st=>st.moduleId===X.id).length;xt=Math.round(q/ut*100)}else{const q=Pt.get(X.id)||{total:0,done:0};xt=q.total>0?Math.round(q.done/q.total*100):0}return{moduleId:X.id,title:X.title,percent:xt}});return{totalQuizzes:C,completedQuizzes:k,averageScore:Math.round(O),progressPercent:_t,moduleProgress:W}},[o,u,f,v,A]);return{loading:t,error:n,totalQuizzes:S,completedQuizzes:N,averageScore:R,progressPercent:V,moduleProgress:M}},aO=({onClose:i})=>{const[t,e]=z.useState([]),[n,s]=z.useState([]),[o,l]=z.useState("modules"),[u,h]=z.useState(!0),[f,m]=z.useState(!1),[v,b]=z.useState(!1),[A,w]=z.useState(""),[S,N]=z.useState(""),[R,V]=z.useState(""),[M,B]=z.useState(null),[L,F]=z.useState({title:"",description:"",order:1,visible:!0}),[C,I]=z.useState({title:"",content:"",order:1,assetUrl:"",visible:!0}),[k,O]=z.useState({title:"",description:"",order:1,visible:!0}),[U,H]=z.useState({title:"",content:"",order:1,assetUrl:"",visible:!0});z.useEffect(()=>{j()},[]);const j=async()=>{try{h(!0);const K=await vt.getModules();if(e(K),A){const ht=await vt.getLessons(A);s(ht)}else s([])}catch(K){console.error("Error loading data:",K)}finally{h(!1)}};z.useEffect(()=>{u||(async()=>{if(A){const K=await vt.getLessons(A);s(K)}else s([])})()},[A]);const _t=async K=>{K.preventDefault();try{await vt.createModule({title:L.title,description:L.description,createdBy:"current-user",order:L.order,visible:L.visible}),F({title:"",description:"",order:1,visible:!0}),m(!1),j()}catch(ht){console.error("Error creating module:",ht)}},Pt=async K=>{if(K.preventDefault(),!A){alert("Pilih bab terlebih dahulu");return}try{await vt.createLesson(A,{title:C.title,content:C.content,order:C.order,assets:C.assetUrl?[C.assetUrl.trim()]:void 0,visible:C.visible}),I({title:"",content:"",order:1,assetUrl:"",visible:!0}),b(!1),j()}catch(ht){console.error("Error creating lesson:",ht)}},W=K=>{N(K.id),O({title:K.title,description:K.description??"",order:K.order||1,visible:K.visible??!0})},X=async()=>{try{await vt.updateModule(S,{title:k.title,description:k.description,order:k.order,visible:k.visible}),N(""),await j()}catch(K){console.error("Error updating module:",K)}},ut=K=>B({type:"module",id:K}),xt=K=>B({type:"lesson",id:K}),q=async()=>{if(M)try{M.type==="module"?(await vt.deleteModule(M.id),A===M.id&&w("")):M.type==="lesson"&&A&&await vt.deleteLesson(A,M.id),B(null),await j()}catch(K){console.error("Error deleting:",K)}},st=K=>{V(K.id),H({title:K.title,content:K.content??"",order:K.order||1,assetUrl:K.assets&&K.assets[0]||"",visible:K.visible??!0})},ct=async()=>{if(A)try{await vt.updateLesson(A,R,{title:U.title,content:U.content,order:U.order,assets:U.assetUrl?[U.assetUrl.trim()]:[],visible:U.visible}),V(""),await j()}catch(K){console.error("Error updating lesson:",K)}};return u?y.jsx("div",{className:"modal-overlay",children:y.jsx("div",{className:"modal-container",children:y.jsxs("div",{className:"loading-spinner",children:[y.jsx("div",{className:"spinner"}),y.jsx("p",{children:"Loading content..."})]})})}):y.jsx("div",{className:"modal-overlay",children:y.jsxs("div",{className:"modal-container large",children:[y.jsxs("div",{className:"modal-header",children:[y.jsxs("h2",{children:[y.jsx("i",{className:"fas fa-cogs"}),"Manage Content"]}),y.jsx("button",{className:"close-btn",onClick:i,title:"Tutup","aria-label":"Tutup",children:y.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:y.jsx("path",{d:"M6 6l12 12M18 6l-12 12"})})})]}),y.jsx("div",{className:"tabs-container",children:y.jsxs("div",{className:"tabs",children:[y.jsxs("button",{className:`tab ${o==="modules"?"active":""}`,onClick:()=>l("modules"),children:[y.jsx("i",{className:"fas fa-th-large"}),"Bab (",t.length,")"]}),y.jsxs("button",{className:`tab ${o==="lessons"?"active":""}`,onClick:()=>l("lessons"),children:[y.jsx("i",{className:"fas fa-book-open"}),"Materi ",A?"(Bab terpilih)":""]})]})}),y.jsxs("div",{className:"modal-content",children:[o==="modules"&&y.jsxs("div",{className:"tab-content",children:[y.jsxs("div",{className:"content-header",children:[y.jsx("h3",{children:"Bab Pembelajaran"}),y.jsxs("button",{className:"btn-primary",onClick:()=>m(!0),children:[y.jsx("i",{className:"fas fa-plus"}),"Tambah Bab"]})]}),f&&y.jsx("div",{className:"form-card",children:y.jsxs("form",{onSubmit:_t,children:[y.jsxs("h4",{children:[y.jsx("i",{className:"fas fa-plus-circle"}),"Buat Bab Baru"]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Judul Bab *"}),y.jsx("input",{type:"text",value:L.title,onChange:K=>F({...L,title:K.target.value}),placeholder:"Contoh: Design Fundamental",required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Urutan"}),y.jsx("input",{type:"number",value:L.order,onChange:K=>F({...L,order:parseInt(K.target.value)}),min:"1",required:!0})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Deskripsi Bab *"}),y.jsx("textarea",{value:L.description,onChange:K=>F({...L,description:K.target.value}),placeholder:"Jelaskan apa yang akan dipelajari siswa dalam bab ini",rows:3,required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Tampilkan ke siswa"}),y.jsxs("select",{value:L.visible?"1":"0",onChange:K=>F({...L,visible:K.target.value==="1"}),children:[y.jsx("option",{value:"1",children:"Ya"}),y.jsx("option",{value:"0",children:"Tidak"})]})]}),y.jsxs("div",{className:"form-actions",children:[y.jsxs("button",{type:"submit",className:"btn-primary",children:[y.jsx("i",{className:"fas fa-save"}),"Buat Bab"]}),y.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>m(!1),children:"Batal"})]})]})}),y.jsx("div",{className:"content-grid",children:t.length===0?y.jsxs("div",{className:"empty-state",children:[y.jsx("i",{className:"fas fa-th-large"}),y.jsx("h4",{children:"Belum ada bab yang dibuat"}),y.jsx("p",{children:"Buat bab pertama untuk mulai mengorganisir konten pembelajaran."})]}):t.map(K=>y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsxs("div",{className:"module-order",children:["Bab #",K.order]}),y.jsxs("div",{className:"card-actions",children:[y.jsxs("button",{className:`btn-action ${A===K.id?"secondary":"primary"}`,title:A===K.id?"Bab terpilih":"Pilih bab untuk dikelola",onClick:()=>w(K.id),children:[y.jsx("i",{className:"fas fa-check"}),y.jsx("span",{children:A===K.id?"Dipilih":"Pilih Bab"})]}),y.jsxs("button",{className:"btn-action edit",onClick:()=>W(K),title:"Edit bab",children:[y.jsx("i",{className:"fas fa-edit"}),y.jsx("span",{children:"Edit"})]}),y.jsxs("button",{className:"btn-action delete",onClick:()=>ut(K.id),title:"Hapus bab",children:[y.jsx("i",{className:"fas fa-trash"}),y.jsx("span",{children:"Hapus"})]})]})]}),y.jsxs("div",{className:"card-content",children:[S===K.id?y.jsxs("div",{className:"form-inline",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Judul"}),y.jsx("input",{value:k.title,onChange:ht=>O({...k,title:ht.target.value})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Deskripsi"}),y.jsx("textarea",{rows:2,value:k.description,onChange:ht=>O({...k,description:ht.target.value})})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Urutan"}),y.jsx("input",{type:"number",min:1,value:k.order,onChange:ht=>O({...k,order:parseInt(ht.target.value)})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Tampilkan ke siswa"}),y.jsxs("select",{value:k.visible?"1":"0",onChange:ht=>O({...k,visible:ht.target.value==="1"}),children:[y.jsx("option",{value:"1",children:"Ya"}),y.jsx("option",{value:"0",children:"Tidak"})]})]}),y.jsxs("div",{className:"form-actions small",children:[y.jsx("button",{className:"btn-primary",onClick:X,children:"Simpan"}),y.jsx("button",{className:"btn-secondary",onClick:()=>N(""),children:"Batal"})]})]})]}):y.jsxs(y.Fragment,{children:[y.jsx("h4",{children:K.title}),y.jsx("p",{children:K.description}),A===K.id&&y.jsx("div",{className:"selected-badge",children:"Dipilih untuk dikelola"})]}),y.jsx("div",{className:"card-meta",children:y.jsxs("span",{children:[y.jsx("i",{className:"fas fa-calendar"})," Dibuat: ",new Date().toLocaleDateString("id-ID")]})})]})]},K.id))})]}),o==="lessons"&&y.jsxs("div",{className:"tab-content",children:[y.jsxs("div",{className:"content-header",children:[y.jsx("h3",{children:"Materi Pembelajaran"}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pilih Bab untuk dikelola"}),y.jsxs("select",{value:A,onChange:K=>w(K.target.value),children:[y.jsx("option",{value:"",children:"-- Pilih Bab --"}),t.map(K=>y.jsxs("option",{value:K.id,children:["Bab ",K.order,": ",K.title]},K.id))]})]}),y.jsxs("button",{className:"btn-primary",onClick:()=>b(!0),disabled:!A,title:A?"Tambah materi":"Pilih bab dahulu",children:[y.jsx("i",{className:"fas fa-plus"}),"Tambah Materi"]})]})]}),!A&&y.jsxs("div",{className:"empty-state",children:[y.jsx("i",{className:"fas fa-layer-group"}),y.jsx("h4",{children:"Pilih Bab"}),y.jsx("p",{children:"Silakan pilih bab terlebih dahulu untuk melihat dan mengelola materi."})]}),v&&y.jsx("div",{className:"form-card",children:y.jsxs("form",{onSubmit:Pt,children:[y.jsxs("h4",{children:[y.jsx("i",{className:"fas fa-plus-circle"}),"Buat Materi Baru"]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Bab *"}),y.jsx("input",{value:t.find(K=>K.id===A)?.title||"",disabled:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Urutan"}),y.jsx("input",{type:"number",value:C.order,onChange:K=>I({...C,order:parseInt(K.target.value)}),min:"1",required:!0})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Judul Materi *"}),y.jsx("input",{type:"text",value:C.title,onChange:K=>I({...C,title:K.target.value}),placeholder:"Contoh: Pengertian Desain Grafis",required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Konten Materi *"}),y.jsx("textarea",{value:C.content,onChange:K=>I({...C,content:K.target.value}),placeholder:"Tulis konten pembelajaran untuk materi ini",rows:4,required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Lampiran PDF / Google Drive (opsional)"}),y.jsx("input",{type:"url",value:C.assetUrl,onChange:K=>I({...C,assetUrl:K.target.value}),placeholder:"Tempel URL PDF atau tautan Google Drive"}),y.jsx("small",{style:{color:"#64748b"},children:'Tips: Untuk Google Drive, gunakan link "preview" atau tempel link biasasistem akan menormalkan untuk ditampilkan.'})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Tampilkan ke siswa"}),y.jsxs("select",{value:C.visible?"1":"0",onChange:K=>I({...C,visible:K.target.value==="1"}),children:[y.jsx("option",{value:"1",children:"Ya"}),y.jsx("option",{value:"0",children:"Tidak"})]})]}),y.jsxs("div",{className:"form-actions",children:[y.jsxs("button",{type:"submit",className:"btn-primary",children:[y.jsx("i",{className:"fas fa-save"}),"Buat Materi"]}),y.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>b(!1),children:"Batal"})]})]})}),y.jsx("div",{className:"content-grid",children:A&&n.length===0?y.jsxs("div",{className:"empty-state",children:[y.jsx("i",{className:"fas fa-book-open"}),y.jsx("h4",{children:"Belum ada materi yang dibuat"}),y.jsx("p",{children:"Buat materi pertama untuk mulai menambahkan konten pembelajaran."})]}):n.map(K=>y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsxs("div",{className:"lesson-order",children:["Materi #",K.order]}),y.jsxs("div",{className:"card-actions",children:[y.jsxs("button",{className:"btn-action edit",onClick:()=>st(K),title:"Edit materi",children:[y.jsx("i",{className:"fas fa-edit"}),y.jsx("span",{children:"Edit"})]}),y.jsxs("button",{className:"btn-action delete",onClick:()=>xt(K.id),title:"Hapus materi",children:[y.jsx("i",{className:"fas fa-trash"}),y.jsx("span",{children:"Hapus"})]})]})]}),y.jsxs("div",{className:"card-content",children:[R===K.id?y.jsxs("div",{className:"form-inline",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Judul Materi"}),y.jsx("input",{value:U.title,onChange:ht=>H({...U,title:ht.target.value})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Konten"}),y.jsx("textarea",{rows:3,value:U.content,onChange:ht=>H({...U,content:ht.target.value})})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Lampiran PDF / Google Drive (opsional)"}),y.jsx("input",{type:"url",value:U.assetUrl,onChange:ht=>H({...U,assetUrl:ht.target.value})}),y.jsx("small",{style:{color:"#64748b"},children:"Tempel URL PDF atau tautan Google Drive yang berisi materi."})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Tampilkan ke siswa"}),y.jsxs("select",{value:U.visible?"1":"0",onChange:ht=>H({...U,visible:ht.target.value==="1"}),children:[y.jsx("option",{value:"1",children:"Ya"}),y.jsx("option",{value:"0",children:"Tidak"})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Urutan"}),y.jsx("input",{type:"number",min:1,value:U.order,onChange:ht=>H({...U,order:parseInt(ht.target.value)})})]}),y.jsxs("div",{className:"form-actions small",children:[y.jsx("button",{className:"btn-primary",onClick:ct,children:"Simpan"}),y.jsx("button",{className:"btn-secondary",onClick:()=>V(""),children:"Batal"})]})]})]}):y.jsxs(y.Fragment,{children:[y.jsx("h4",{children:K.title}),y.jsx("p",{children:K.content?K.content.substring(0,100)+"...":"Belum ada konten"})]}),y.jsx("div",{className:"card-meta",children:y.jsxs("span",{children:[y.jsx("i",{className:"fas fa-clock"})," Durasi: 30 menit"]})})]})]},K.id))})]})]}),M&&y.jsx("div",{className:"modal-overlay confirm",children:y.jsxs("div",{className:"modal-container small",children:[y.jsxs("div",{className:"modal-header",children:[y.jsxs("h2",{children:[y.jsx("i",{className:"fas fa-exclamation-triangle"}),"Konfirmasi Hapus"]}),y.jsx("button",{className:"close-btn",onClick:()=>B(null),children:y.jsx("i",{className:"fas fa-times"})})]}),y.jsxs("div",{className:"modal-content",children:[y.jsx("p",{children:M.type==="module"?"Menghapus bab juga akan menghapus semua materi di dalamnya. Lanjutkan?":"Anda yakin ingin menghapus materi ini?"}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{className:"btn-secondary",onClick:()=>B(null),children:"Batal"}),y.jsx("button",{className:"btn-danger",onClick:q,children:"Hapus"})]})]})]})})]})})},oO=({onClose:i})=>{const[t,e]=z.useState([]),[n,s]=z.useState([]),[o,l]=z.useState(!0),[u,h]=z.useState("quiz-info"),[f,m]=z.useState({moduleId:"",lessonId:"",title:"",timeLimitSec:600}),[v,b]=z.useState([]),[A,w]=z.useState({type:"multiple_choice",text:"",options:["","",""],correctIndex:0,correctIndexes:[]});z.useEffect(()=>{(async()=>{try{l(!0);const C=await vt.getModules();e(C)}catch(C){console.error("Error loading modules:",C)}finally{l(!1)}})()},[]),z.useEffect(()=>{(async()=>{if(!f.moduleId){s([]),m(C=>({...C,lessonId:""}));return}try{l(!0);const C=await vt.getLessons(f.moduleId);s(C),C.find(I=>I.id===f.lessonId)||m(I=>({...I,lessonId:""}))}catch(C){console.error("Error loading lessons:",C)}finally{l(!1)}})()},[f.moduleId]);const S=F=>{if(F.preventDefault(),!f.moduleId||!f.lessonId||!f.title){alert("Mohon lengkapi semua kolom yang diperlukan");return}h("questions")},N=(F,C)=>{const I=A.options?[...A.options]:[];I[F]=C,w({...A,options:I})},R=()=>{const F=A.options?[...A.options]:[];F.push(""),w({...A,options:F})},V=F=>{const C=(A.options||[]).filter((k,O)=>O!==F),I={...A,options:C};A.type!=="checkboxes"?(A.correctIndex??0)>=C.length&&(I.correctIndex=0):I.correctIndexes=(A.correctIndexes||[]).filter(k=>k!==F).map(k=>k>F?k-1:k),w(I)},M=()=>{if(!A.text.trim()){alert("Mohon isi teks pertanyaan");return}if(["multiple_choice","checkboxes","dropdown"].includes(A.type)){const F=A.options||[];if(F.length<2||F.some(C=>!C.trim())){alert("Minimal 2 pilihan dan tidak boleh kosong");return}if(A.type!=="checkboxes"&&(A.correctIndex??-1)<0){alert("Pilih jawaban benar");return}if(A.type==="checkboxes"&&(!A.correctIndexes||A.correctIndexes.length===0)){alert("Pilih minimal satu jawaban benar");return}}b([...v,{...A}]),w({type:"multiple_choice",text:"",options:["","",""],correctIndex:0,correctIndexes:[]})},B=F=>{b(v.filter((C,I)=>I!==F))},L=async()=>{if(v.length===0){alert("Mohon tambahkan minimal satu pertanyaan");return}try{l(!0);const F=await vt.createQuiz({moduleId:f.moduleId,lessonId:f.lessonId,title:f.title,createdBy:"current-user",timeLimitSec:f.timeLimitSec});for(const C of v)await vt.addQuestionToQuiz(F,C);alert("Kuis berhasil dibuat!"),i()}catch(F){console.error("Error creating quiz:",F),alert("Gagal membuat kuis. Silakan coba lagi.")}finally{l(!1)}};return o?y.jsx("div",{className:"modal-overlay",children:y.jsx("div",{className:"modal",children:y.jsx("div",{className:"modal-content",children:"Memuat..."})})}):y.jsx("div",{className:"modal-overlay",children:y.jsxs("div",{className:"modal-container large",children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Buat Kuis"}),y.jsx("button",{className:"close-btn",onClick:i,"aria-label":"Tutup",children:""})]}),y.jsxs("div",{className:"modal-content",children:[y.jsxs("div",{className:"tabs",children:[y.jsx("button",{className:`tab ${u==="quiz-info"?"active":""}`,onClick:()=>h("quiz-info"),children:"Info Kuis"}),y.jsx("button",{className:`tab ${u==="questions"?"active":""}`,onClick:()=>h("questions"),disabled:!f.moduleId||!f.lessonId||!f.title,children:"Pertanyaan"})]}),u==="quiz-info"&&y.jsxs("form",{onSubmit:S,children:[y.jsxs("div",{className:"form-card",children:[y.jsx("h4",{children:"Informasi Kuis"}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pilih Bab *"}),y.jsxs("select",{value:f.moduleId,onChange:F=>m({...f,moduleId:F.target.value}),children:[y.jsx("option",{value:"",children:"-- Pilih Bab --"}),t.map(F=>y.jsx("option",{value:F.id,children:F.title},F.id))]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pilih Materi *"}),y.jsxs("select",{value:f.lessonId,onChange:F=>m({...f,lessonId:F.target.value}),disabled:!f.moduleId,children:[y.jsx("option",{value:"",children:"-- Pilih Materi --"}),n.map(F=>y.jsx("option",{value:F.id,children:F.title},F.id))]})]})]}),y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",style:{flex:2},children:[y.jsx("label",{children:"Judul Kuis *"}),y.jsx("input",{type:"text",value:f.title,onChange:F=>m({...f,title:F.target.value}),placeholder:"Contoh: Kuis Bab 1 - Desain Dasar"})]}),y.jsxs("div",{className:"form-group",style:{maxWidth:"220px"},children:[y.jsx("label",{children:"Batas Waktu (menit)"}),y.jsx("input",{type:"number",min:1,value:Math.max(1,Math.round(f.timeLimitSec/60)),onChange:F=>{const C=Math.max(1,parseInt(F.target.value||"1",10));m({...f,timeLimitSec:C*60})}})]})]})]}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{type:"button",className:"btn-secondary",onClick:i,children:"Batal"}),y.jsx("button",{type:"submit",className:"btn-primary",children:"Lanjut ke Pertanyaan"})]})]}),u==="questions"&&y.jsxs("div",{children:[y.jsxs("div",{className:"form-card",children:[y.jsx("h4",{children:"Ringkasan"}),y.jsxs("div",{className:"card-meta",style:{gap:"24px"},children:[y.jsxs("span",{children:["Bab: ",t.find(F=>F.id===f.moduleId)?.title]}),y.jsxs("span",{children:["Materi: ",n.find(F=>F.id===f.lessonId)?.title||"-"]}),y.jsxs("span",{children:["Batas Waktu: ",Math.floor(f.timeLimitSec/60)," menit"]})]})]}),y.jsxs("div",{className:"form-card",children:[y.jsx("h4",{children:"Tambah Pertanyaan Baru"}),y.jsx("div",{className:"form-row",children:y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Tipe Pertanyaan"}),y.jsxs("select",{value:A.type,onChange:F=>w({...A,type:F.target.value}),children:[y.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),y.jsx("option",{value:"checkboxes",children:"Checkboxes"}),y.jsx("option",{value:"dropdown",children:"Dropdown"}),y.jsx("option",{value:"short_answer",children:"Short Answer"}),y.jsx("option",{value:"paragraph",children:"Paragraph"})]})]})}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pertanyaan *"}),y.jsx("textarea",{value:A.text,onChange:F=>w({...A,text:F.target.value}),rows:3,placeholder:"Masukkan pertanyaan Anda"})]}),["multiple_choice","checkboxes","dropdown"].includes(A.type)&&y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pilihan"}),(A.options||[]).map((F,C)=>y.jsxs("div",{className:"option-row",children:[A.type==="checkboxes"?y.jsx("input",{type:"checkbox",checked:(A.correctIndexes||[]).includes(C),onChange:I=>{const k=new Set(A.correctIndexes||[]);I.target.checked?k.add(C):k.delete(C),w({...A,correctIndexes:Array.from(k).sort((O,U)=>O-U)})}}):y.jsx("input",{type:"radio",name:"correct",checked:(A.correctIndex??0)===C,onChange:()=>w({...A,correctIndex:C})}),y.jsx("input",{type:"text",value:F,onChange:I=>N(C,I.target.value),placeholder:`Pilihan ${C+1}`,className:"option-input"}),y.jsx("button",{type:"button",className:"btn-delete",onClick:()=>V(C),title:"Hapus pilihan",children:y.jsx("span",{children:"Hapus"})})]},C)),y.jsx("div",{className:"form-actions",style:{marginTop:"8px"},children:y.jsx("button",{type:"button",className:"btn-secondary",onClick:R,children:"+ Tambah Pilihan"})})]}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>h("quiz-info"),children:"Kembali"}),y.jsx("button",{type:"button",className:"btn-primary",onClick:M,children:"Tambahkan ke Daftar"})]})]}),y.jsxs("div",{className:"form-card",children:[y.jsxs("h4",{children:["Pertanyaan (",v.length,")"]}),v.length===0?y.jsx("div",{className:"empty-state",style:{padding:"20px"},children:"Belum ada pertanyaan ditambahkan"}):y.jsx("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:v.map((F,C)=>y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsxs("div",{className:"lesson-order",children:["P",C+1]}),y.jsx("div",{className:"card-actions",children:y.jsx("button",{className:"btn-action delete",onClick:()=>B(C),children:y.jsx("span",{children:"Hapus"})})})]}),y.jsxs("div",{className:"card-content",children:[y.jsx("h4",{children:F.type==="multiple_choice"?"Multiple Choice":F.type==="checkboxes"?"Checkboxes":F.type==="dropdown"?"Dropdown":F.type==="short_answer"?"Short Answer":"Paragraph"}),y.jsx("p",{children:F.text}),["multiple_choice","checkboxes","dropdown"].includes(F.type)&&y.jsx("div",{className:"card-meta",style:{display:"block",color:"#475569"},children:(F.options||[]).map((I,k)=>{const O=F.type==="checkboxes"?(F.correctIndexes||[]).includes(k):(F.correctIndex??-1)===k;return y.jsxs("div",{style:{marginBottom:"4px"},children:[O?"":""," ",I]},k)})})]})]},C))}),y.jsx("div",{className:"form-actions",children:y.jsx("button",{className:"btn-primary",onClick:L,disabled:v.length===0,children:"Buat Kuis"})})]})]})]})]})})},lO=({onClose:i})=>{const{user:t}=yr(),[e,n]=z.useState([]),[s,o]=z.useState(!0),[l,u]=z.useState(null),[h,f]=z.useState(null),[m,v]=z.useState({title:"",timeLimitMin:10}),[b,A]=z.useState(null),[w,S]=z.useState([]),[N,R]=z.useState([]),[V,M]=z.useState(null),[B,L]=z.useState({}),[F,C]=z.useState(null),[I,k]=z.useState(null),[O,U]=z.useState([]),[H,j]=z.useState(null),[_t,Pt]=z.useState(!1),[W,X]=z.useState(!1),[ut,xt]=z.useState(1),[q,st]=z.useState(""),ct=async()=>{try{o(!0);const[ft,Bt,me,Ps]=await Promise.all([vt.getQuizzes(),vt.getModules(),vt.getAllLessons(),vt.getStudents()]);n(ft),S(Bt),R(me),U(Ps),u(null)}catch{u("Gagal memuat daftar kuis")}finally{o(!1)}};z.useEffect(()=>{ct()},[]);const K=ft=>{f(ft.id),v({title:ft.title,timeLimitMin:Math.max(1,Math.round((ft.timeLimitSec??600)/60))})},ht=async()=>{if(h)try{await vt.updateQuiz(h,{title:m.title.trim(),timeLimitSec:Math.max(60,m.timeLimitMin*60)}),f(null),await ct()}catch{alert("Gagal menyimpan perubahan kuis")}},Nt=async()=>{if(b)try{await vt.deleteQuiz(b.id),A(null),await ct()}catch{alert("Gagal menghapus kuis")}},bt=ft=>w.find(Bt=>Bt.id===ft)?.title||"-",Ut=ft=>N.find(Bt=>Bt.id===ft)?.title||"-",Qt=async ft=>{if(M(Bt=>Bt===ft?null:ft),!B[ft])try{C(ft);const Bt=await vt.getQuestions(ft);L(me=>({...me,[ft]:Bt}))}finally{C(null)}},Hn=async ft=>{k(ft),Pt(!0);try{const[Bt,me]=await Promise.all([vt.getCompletionsByQuiz(ft),vt.getRetakeGrantsByQuiz(ft)]);j({completions:Bt,grants:me})}finally{Pt(!1)}},ps=async()=>{if(!(!I||!q||ut<1))try{X(!0),await vt.grantRetake(q,I,ut,t?.uid||"-");const[ft,Bt]=await Promise.all([vt.getCompletionsByQuiz(I),vt.getRetakeGrantsByQuiz(I)]);j({completions:ft,grants:Bt}),xt(1)}catch{alert("Gagal memberikan akses ulang")}finally{X(!1)}},Mn=async ft=>{if(I)try{await vt.revokeRetake(ft,I);const[Bt,me]=await Promise.all([vt.getCompletionsByQuiz(I),vt.getRetakeGrantsByQuiz(I)]);j({completions:Bt,grants:me})}catch{alert("Gagal mencabut akses ulang")}};return y.jsxs("div",{className:"modal-overlay",children:[y.jsxs("div",{className:"modal-container large",children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Kelola Kuis"}),y.jsx("button",{className:"close-btn",onClick:i,"aria-label":"Tutup",children:""})]}),y.jsxs("div",{className:"modal-content",children:[l&&y.jsx("div",{className:"error-message",children:l}),s?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat kuis..."})]}):y.jsxs("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:[e.length===0&&y.jsx("div",{className:"empty-state",children:"Belum ada kuis dibuat"}),e.map(ft=>y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("div",{className:"lesson-order",children:"KZ"}),y.jsx("div",{className:"card-actions",children:h===ft.id?y.jsxs(y.Fragment,{children:[y.jsx("button",{className:"btn-action secondary",onClick:()=>f(null),children:"Batal"}),y.jsx("button",{className:"btn-action primary",onClick:ht,children:"Simpan"})]}):y.jsxs(y.Fragment,{children:[y.jsx("button",{className:"btn-action",onClick:()=>Qt(ft.id),children:V===ft.id?"Tutup":"Lihat"}),y.jsx("button",{className:"btn-action edit",onClick:()=>K(ft),children:"Edit"}),y.jsx("button",{className:"btn-action",onClick:()=>Hn(ft.id),children:"Kelola Akses Ulang"}),y.jsx("button",{className:"btn-action delete",onClick:()=>A({id:ft.id,title:ft.title}),children:"Hapus"})]})})]}),y.jsx("div",{className:"card-content",children:h===ft.id?y.jsxs("div",{className:"form-row",children:[y.jsxs("div",{className:"form-group",style:{flex:2},children:[y.jsx("label",{children:"Judul Kuis"}),y.jsx("input",{value:m.title,onChange:Bt=>v(me=>({...me,title:Bt.target.value}))})]}),y.jsxs("div",{className:"form-group",style:{maxWidth:220},children:[y.jsx("label",{children:"Batas Waktu (menit)"}),y.jsx("input",{type:"number",min:1,value:m.timeLimitMin,onChange:Bt=>v(me=>({...me,timeLimitMin:Math.max(1,parseInt(Bt.target.value||"1",10))}))})]})]}):y.jsxs(y.Fragment,{children:[y.jsx("h4",{children:ft.title}),y.jsxs("p",{children:["Bab: ",bt(ft.moduleId)]}),ft.lessonId&&y.jsxs("p",{children:["Materi: ",Ut(ft.lessonId)]}),y.jsx("div",{className:"card-meta",children:y.jsxs("span",{children:["Waktu: ",Math.floor((ft.timeLimitSec??600)/60)," menit"]})}),V===ft.id&&y.jsxs("div",{style:{marginTop:12},children:[y.jsx("h5",{style:{margin:"8px 0"},children:"Pertanyaan"}),F===ft.id&&y.jsx("div",{style:{color:"#64748b"},children:"Memuat pertanyaan..."}),B[ft.id]&&B[ft.id].length===0&&y.jsx("div",{className:"empty-state",children:"Belum ada pertanyaan"}),B[ft.id]&&B[ft.id].length>0&&y.jsx("ul",{style:{paddingLeft:16,margin:0},children:B[ft.id].map((Bt,me)=>y.jsxs("li",{style:{marginBottom:8},children:[y.jsxs("div",{style:{fontWeight:600},children:[me+1,". ",Bt.text]}),["multiple_choice","checkboxes","dropdown"].includes(Bt.type)&&y.jsx("div",{style:{marginTop:4,color:"#475569"},children:(Bt.options||[]).map((Ps,vr)=>{const Gn=Bt.type==="checkboxes"?(Bt.correctIndexes||[]).includes(vr):(Bt.correctIndex??-1)===vr;return y.jsxs("div",{children:[Gn?"":""," ",Ps]},vr)})})]},Bt.id))})]})]})})]},ft.id))]})]})]}),b&&y.jsx("div",{className:"modal-overlay",children:y.jsxs("div",{className:"modal-container",style:{maxWidth:520},children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Konfirmasi Hapus"}),y.jsx("button",{className:"close-btn",onClick:()=>A(null),"aria-label":"Tutup",children:""})]}),y.jsxs("div",{className:"modal-content",children:[y.jsxs("p",{children:['Hapus kuis "',b.title,'"? Tindakan ini juga akan menghapus pertanyaan dan jawaban terkait.']}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{className:"btn-secondary",onClick:()=>A(null),children:"Batal"}),y.jsx("button",{className:"btn-primary",onClick:Nt,children:"Hapus"})]})]})]})}),I&&y.jsx("div",{className:"modal-overlay",children:y.jsxs("div",{className:"modal-container",style:{maxWidth:720},children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Kelola Akses Ulang Kuis"}),y.jsx("button",{className:"close-btn",onClick:()=>{k(null),j(null)},"aria-label":"Tutup",children:""})]}),y.jsx("div",{className:"modal-content",children:_t||!H?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat data..."})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"2fr 1fr 1fr auto"},children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Pilih Siswa"}),y.jsxs("select",{value:q,onChange:ft=>st(ft.target.value),children:[y.jsx("option",{value:"",children:"-- pilih siswa --"}),O.map(ft=>y.jsx("option",{value:ft.id,children:ft.name||ft.email},ft.id))]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Jumlah Kesempatan"}),y.jsx("input",{type:"number",min:1,value:ut,onChange:ft=>xt(Math.max(1,parseInt(ft.target.value||"1",10)))})]}),y.jsx("div",{className:"form-group",style:{alignSelf:"end"},children:y.jsx("button",{className:"btn-primary",disabled:!q||W,onClick:ps,children:W?"Menyimpan...":"Beri Akses Ulang"})})]}),y.jsx("h5",{style:{marginTop:8},children:"Status Siswa"}),y.jsx("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:O.map(ft=>{const Bt=!!H.completions[ft.id],me=H.grants.find(Ps=>Ps.userId===ft.id);return y.jsx("div",{className:"content-card",children:y.jsxs("div",{className:"card-content",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[y.jsxs("div",{children:[y.jsx("div",{style:{fontWeight:600},children:ft.name||ft.email}),y.jsxs("div",{className:"card-meta",children:[y.jsx("span",{children:Bt?"Sudah pernah mengerjakan":"Belum mengerjakan"}),me&&y.jsxs("span",{children:["Akses ulang tersisa: ",me.allowed]})]})]}),y.jsx("div",{className:"card-actions",children:me?y.jsx("button",{className:"btn-action delete",onClick:()=>Mn(ft.id),children:"Cabut"}):y.jsx("button",{className:"btn-action",onClick:()=>{st(ft.id),xt(1)},children:"Beri 1x"})})]})},ft.id)})})]})})]})})]})},cO=({onClose:i})=>{const[t,e]=z.useState([]),[n,s]=z.useState(!0),[o,l]=z.useState(!0),[u,h]=z.useState(null),[f,m]=z.useState(null),[v,b]=z.useState({name:"",role:"student"}),[A,w]=z.useState(null),S=async()=>{try{l(!0);const M=await vt.getStudents();e(M),h(null)}catch{h("Gagal memuat daftar siswa")}finally{l(!1)}};z.useEffect(()=>{S()},[]);const N=M=>{m(M.id),b({name:M.name,role:M.role})},R=async()=>{if(f)try{const M={name:v.name.trim(),role:v.role};await vt.updateUser(f,M),m(null),await S()}catch{alert("Gagal menyimpan perubahan siswa")}},V=async()=>{if(A)try{await vt.deleteUser(A.id),w(null),await S()}catch{alert("Gagal menghapus siswa")}};return y.jsxs("div",{className:"modal-overlay",children:[y.jsxs("div",{className:"modal-container large",children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Kelola Siswa"}),y.jsx("button",{className:"close-btn",onClick:i,"aria-label":"Tutup",children:""})]}),y.jsxs("div",{className:"modal-content",children:[u&&y.jsx("div",{className:"error-message",children:u}),o?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat siswa..."})]}):y.jsxs("div",{children:[y.jsxs("div",{className:"form-actions",style:{justifyContent:"space-between"},children:[y.jsx("div",{}),y.jsxs("label",{className:"btn-action",style:{cursor:"pointer"},children:[y.jsx("input",{type:"checkbox",checked:n,onChange:M=>s(M.target.checked)})," Tampilkan hanya yang perlu persetujuan"]})]}),y.jsxs("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:[t.length===0&&y.jsx("div",{className:"empty-state",children:"Belum ada siswa terdaftar"}),t.filter(M=>!n||(M.status??"approved")!=="approved").map(M=>y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("div",{className:"module-order",children:"S"}),y.jsx("div",{className:"card-actions",children:f===M.id?y.jsxs(y.Fragment,{children:[y.jsx("button",{className:"btn-action secondary",onClick:()=>m(null),children:"Batal"}),y.jsx("button",{className:"btn-action primary",onClick:R,children:"Simpan"})]}):y.jsxs(y.Fragment,{children:[(M.status??"approved")!=="approved"&&y.jsxs(y.Fragment,{children:[y.jsx("button",{className:"btn-action primary",onClick:async()=>{await vt.approveUser(M.id),await S()},children:"Setujui"}),y.jsx("button",{className:"btn-action delete",onClick:async()=>{await vt.rejectUser(M.id),await S()},children:"Tolak"})]}),y.jsx("button",{className:"btn-action edit",onClick:()=>N(M),children:"Edit"}),y.jsx("button",{className:"btn-action delete",onClick:()=>w({id:M.id,name:M.name}),children:"Hapus"})]})})]}),y.jsx("div",{className:"card-content",children:f===M.id?y.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"2fr 1fr"},children:[y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Nama"}),y.jsx("input",{value:v.name,onChange:B=>b(L=>({...L,name:B.target.value}))})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{children:"Role"}),y.jsxs("select",{value:v.role,onChange:B=>b(L=>({...L,role:B.target.value})),children:[y.jsx("option",{value:"student",children:"Siswa"}),y.jsx("option",{value:"teacher",children:"Guru"})]})]})]}):y.jsxs(y.Fragment,{children:[y.jsx("h4",{children:M.name}),y.jsxs("p",{children:["Email: ",M.email||"-"]}),y.jsxs("div",{className:"card-meta",children:[y.jsxs("span",{children:["Role: ",M.role==="teacher"?"Guru":"Siswa"]}),y.jsxs("span",{children:["Status: ",(M.status??"approved")==="approved"?"Disetujui":(M.status??"pending")==="pending"?"Menunggu":"Ditolak"]}),y.jsx("span",{children:"Dibuat: "})]})]})})]},M.id))]})]})]})]}),A&&y.jsx("div",{className:"modal-overlay",children:y.jsxs("div",{className:"modal-container",style:{maxWidth:520},children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Konfirmasi Hapus"}),y.jsx("button",{className:"close-btn",onClick:()=>w(null),"aria-label":"Tutup",children:""})]}),y.jsxs("div",{className:"modal-content",children:[y.jsxs("p",{children:['Hapus siswa "',A.name,'"? Ini hanya menghapus data di aplikasi, bukan akun login.']}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{className:"btn-secondary",onClick:()=>w(null),children:"Batal"}),y.jsx("button",{className:"btn-primary",onClick:V,children:"Hapus"})]})]})]})})]})},uO=()=>{const{userDoc:i,logout:t,isTeacher:e,isStudent:n,user:s}=yr(),{students:o,modules:l,totalLessons:u,analytics:h,loading:f,error:m,refreshData:v,createSampleData:b}=iO(),A=rO(s?.uid),[w,S]=z.useState(!1),[N,R]=z.useState(!1),[V,M]=z.useState(!1),[B,L]=z.useState(!1),F=async()=>{try{await t()}catch(j){console.error("Logout error:",j)}},C=async()=>{if(s&&e)try{await b(s.uid),alert("Data contoh berhasil dibuat!")}catch(j){console.error("Error creating sample data:",j),alert("Gagal membuat data contoh. Silakan coba lagi.")}},I=()=>{S(!0)},k=()=>{R(!0)},O=()=>{M(!0)},U=()=>{alert(`Dashboard Analitik:

 Progres Siswa: ${h.completionRate}% rata-rata penyelesaian
 Performa Kuis: ${h.avgScore}% rata-rata nilai
 Siswa Aktif: ${o.length}
 Total Konten: ${l.length} bab, ${u} materi`)},H=()=>{L(!0)};return i?y.jsxs("div",{className:"dashboard",children:[y.jsx("header",{className:"dashboard-header",children:y.jsxs("div",{className:"container",children:[y.jsxs("div",{className:"logo",children:[y.jsx("h2",{children:"Kelaz"}),y.jsx("span",{children:"Kelas Online Desain Grafis"})]}),y.jsxs("div",{className:"user-menu",children:[y.jsxs("span",{className:"user-name",children:["Selamat datang, ",i.name]}),y.jsx("span",{className:`user-role ${i.role}`,children:i.role==="teacher"?" Guru":" Siswa"}),y.jsx("button",{onClick:F,className:"btn-logout",children:"Keluar"})]})]})}),y.jsx("main",{className:"dashboard-main",children:y.jsxs("div",{className:"container",children:[n&&y.jsxs("div",{className:"student-dashboard",children:[y.jsx("h1",{children:"Dashboard Siswa"}),y.jsxs("div",{className:"dashboard-grid",children:[y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Kelas Saya"}),y.jsx("p",{children:"Akses kelas yang Anda ikuti dan pantau progres pembelajaran"}),y.jsxs("div",{className:"course-progress",children:[y.jsx("div",{className:"progress-bar",children:y.jsx("div",{className:"progress-fill",style:{width:`${A.progressPercent}%`}})}),y.jsxs("span",{children:[A.progressPercent,"% Selesai"]})]}),y.jsx("button",{className:"btn-primary",onClick:()=>{window.location.hash="#/belajar"},children:"Lanjutkan Belajar"})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Kuis"}),y.jsx("p",{children:"Uji pengetahuan Anda dengan kuis interaktif"}),y.jsxs("div",{className:"quiz-stats",children:[y.jsxs("div",{className:"stat",children:[y.jsx("strong",{children:A.completedQuizzes}),y.jsx("span",{children:"Selesai"})]}),y.jsxs("div",{className:"stat",children:[y.jsxs("strong",{children:[A.averageScore,"%"]}),y.jsx("span",{children:"Rata-rata Nilai"})]})]}),y.jsx("button",{className:"btn-secondary",onClick:()=>{window.location.hash="#/kuis"},children:"Ikuti Kuis"})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Progres"}),y.jsx("p",{children:"Pantau perjalanan belajar Anda"}),y.jsxs("div",{className:"progress-stats",children:[A.moduleProgress.slice(0,3).map(j=>y.jsxs("div",{className:"progress-item",children:[y.jsx("span",{children:j.title}),y.jsx("div",{className:"progress-bar small",children:y.jsx("div",{className:"progress-fill",style:{width:`${j.percent}%`}})})]},j.moduleId)),A.moduleProgress.length===0&&y.jsx("div",{className:"empty-state",children:"Belum ada progres untuk ditampilkan"})]})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Pencapaian"}),y.jsx("p",{children:"Milestone pembelajaran Anda"}),y.jsxs("div",{className:"achievements",children:[y.jsx("div",{className:`achievement ${A.completedQuizzes>=1?"earned":""}`,children:" Kuis Pertama Selesai"}),y.jsx("div",{className:`achievement ${A.averageScore>=90?"earned":""}`,children:" Rata-rata Nilai  90%"})]})]})]})]}),e&&y.jsxs("div",{className:"teacher-dashboard",children:[y.jsxs("div",{className:"dashboard-header-controls",children:[y.jsx("h1",{children:"Dashboard Guru"}),y.jsx("button",{onClick:v,className:"btn-refresh",disabled:f,children:" Refresh Data"}),l.length===0&&y.jsx("button",{onClick:C,className:"btn-sample-data",children:" Buat Data Contoh"})]}),m&&y.jsxs("div",{className:"error-message",children:["Error memuat dashboard: ",m]}),f?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat data dashboard..."})]}):y.jsxs("div",{className:"dashboard-grid",children:[y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Siswa"}),y.jsx("p",{children:"Kelola dan pantau progres siswa"}),y.jsxs("div",{className:"student-count",children:[y.jsx("strong",{children:h.totalStudents})," Siswa Aktif"]}),y.jsxs("div",{className:"student-list",children:[o.slice(0,3).map(j=>y.jsxs("div",{className:"student-item",children:[" ",j.name]},j.id)),o.length>3&&y.jsxs("div",{className:"student-more",children:["+",o.length-3," siswa lainnya"]})]}),y.jsx("button",{className:"btn-primary",onClick:H,children:"Lihat Semua Siswa"})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Konten Kelas"}),y.jsx("p",{children:"Buat dan kelola materi, bab, dan konten pembelajaran"}),y.jsxs("div",{className:"content-stats",children:[y.jsxs("div",{className:"stat",children:[y.jsx("strong",{children:l.length}),y.jsx("span",{children:"Bab"})]}),y.jsxs("div",{className:"stat",children:[y.jsx("strong",{children:u}),y.jsx("span",{children:"Materi"})]})]}),y.jsxs("div",{className:"module-list",children:[l.slice(0,2).map(j=>y.jsxs("div",{className:"module-item",children:[" ",j.title]},j.id)),l.length>2&&y.jsxs("div",{className:"module-more",children:["+",l.length-2," bab lainnya"]})]}),y.jsx("button",{className:"btn-primary",onClick:I,children:"Kelola Konten"})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Kuis"}),y.jsx("p",{children:"Buat dan kelola kuis serta penilaian"}),y.jsxs("div",{className:"quiz-stats",children:[y.jsxs("div",{className:"stat",children:[y.jsx("strong",{children:h.totalQuizzes}),y.jsx("span",{children:"Total Kuis"})]}),y.jsxs("div",{className:"stat",children:[y.jsx("strong",{children:h.totalSubmissions}),y.jsx("span",{children:"Pengumpulan"})]})]}),y.jsxs("div",{className:"form-actions",style:{justifyContent:"flex-start",gap:"8px"},children:[y.jsx("button",{className:"btn-secondary",onClick:k,children:"Buat Kuis"}),y.jsx("button",{className:"btn-primary",onClick:O,children:"Kelola Kuis"})]})]}),y.jsxs("div",{className:"card",children:[y.jsx("h3",{children:" Analitik"}),y.jsx("p",{children:"Lihat analitik dan wawasan detail"}),y.jsxs("div",{className:"analytics-preview",children:[y.jsxs("div",{className:"metric",children:[y.jsx("span",{children:"Tingkat Penyelesaian"}),y.jsxs("strong",{children:[h.completionRate,"%"]})]}),y.jsxs("div",{className:"metric",children:[y.jsx("span",{children:"Rata-rata Nilai Kuis"}),y.jsxs("strong",{children:[h.avgScore,"%"]})]})]}),y.jsx("button",{className:"btn-secondary",onClick:U,children:"Lihat Analitik"})]})]})]})]})}),w&&y.jsx(aO,{onClose:()=>S(!1)}),N&&y.jsx(oO,{onClose:()=>R(!1)}),V&&y.jsx(lO,{onClose:()=>M(!1)}),B&&y.jsx(cO,{onClose:()=>L(!1)})]}):y.jsx("div",{className:"dashboard-loading",children:y.jsx("p",{children:"Memuat data pengguna..."})})},hO=()=>{const{user:i}=yr(),[t,e]=z.useState(!0),[n,s]=z.useState(null),[o,l]=z.useState([]),[u,h]=z.useState([]),[f,m]=z.useState([]),[v,b]=z.useState(new Set),[A,w]=z.useState(null);z.useEffect(()=>{(async()=>{if(i){e(!0),s(null);try{const M=(await vt.getModules()).filter(I=>I.visible??!0),B=[];for(const I of M){const[k,O]=await Promise.all([vt.getLessons(I.id),vt.getQuizzes(I.id)]),U=k.filter(H=>H.visible??!0);B.push({module:I,lessons:U,quizzes:O})}l(B);const[L,F,C]=await Promise.all([vt.getAnswersByUser(i.uid),vt.getLessonReadsByUser(i.uid),vt.getRetakeGrantsByUser(i.uid)]);h(L),m(F),b(new Set((C||[]).filter(I=>(I.allowed??0)>0).map(I=>I.quizId)))}catch(V){s(V?.message||"Gagal memuat data belajar")}finally{e(!1)}}})()},[i]);const S=z.useMemo(()=>new Set(u.map(R=>R.quizId)),[u]),N=z.useMemo(()=>new Set(f.map(R=>`${R.moduleId}:${R.lessonId}`)),[f]);return i?y.jsxs("div",{className:"dashboard-main",children:[y.jsxs("div",{className:"container",children:[y.jsx("div",{style:{marginTop:0,marginBottom:12},children:y.jsx(Ns,{className:"btn-secondary",to:"/dashboard",children:" Kembali ke Dashboard"})}),y.jsx("h1",{style:{marginTop:0},children:"Belajar"}),n&&y.jsx("div",{className:"error-message",children:n}),t?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat konten belajar..."})]}):y.jsx("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:o.map(R=>{const V=R.quizzes.filter(F=>S.has(F.id)).length,M=R.lessons.filter(F=>N.has(`${R.module.id}:${F.id}`)).length,B=R.lessons.length>0?Math.round(M/R.lessons.length*100):0,L=R.quizzes.length>0?Math.round(V/R.quizzes.length*100):0;return y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("div",{className:"module-order",children:"BAB"}),y.jsx("div",{className:"card-actions"})]}),y.jsxs("div",{className:"card-content",children:[y.jsx("h4",{children:R.module.title}),R.module.description&&y.jsx("p",{children:R.module.description}),y.jsxs("div",{className:"card-meta",children:[y.jsxs("span",{children:[R.lessons.length," materi"]}),y.jsxs("span",{children:[R.quizzes.length," kuis"]}),y.jsxs("span",{children:[V,"/",R.quizzes.length," kuis selesai"]})]}),y.jsxs("div",{className:"course-progress",style:{marginTop:12},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[y.jsx("span",{style:{color:"#374151",fontWeight:600,fontSize:13},children:"Progress Materi"}),y.jsxs("span",{style:{color:"#64748b",fontSize:12},children:[M,"/",R.lessons.length]})]}),y.jsx("div",{className:"progress-bar small",children:y.jsx("div",{className:"progress-fill",style:{width:`${B}%`}})})]}),y.jsxs("div",{className:"course-progress",style:{marginTop:6},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[y.jsx("span",{style:{color:"#374151",fontWeight:600,fontSize:13},children:"Progress Kuis"}),y.jsxs("span",{style:{color:"#64748b",fontSize:12},children:[V,"/",R.quizzes.length]})]}),y.jsx("div",{className:"progress-bar small",children:y.jsx("div",{className:"progress-fill",style:{width:`${L}%`}})})]}),y.jsxs("div",{style:{marginTop:12},children:[y.jsx("h5",{style:{margin:"8px 0"},children:"Materi"}),R.lessons.length===0?y.jsx("div",{className:"empty-state",children:"Belum ada materi"}):y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:R.lessons.map(F=>{const C=N.has(`${R.module.id}:${F.id}`);return y.jsxs(Ns,{to:`/belajar/m/${R.module.id}/lesson/${F.id}`,className:"btn-action secondary",style:{textAlign:"left"},children:[y.jsx("i",{children:""}),y.jsx("span",{style:{flex:1},children:F.title}),C&&y.jsx("span",{style:{color:"#059669",fontWeight:700},children:""})]},F.id)})})]}),y.jsxs("div",{style:{marginTop:12},children:[y.jsx("h5",{style:{margin:"8px 0"},children:"Kuis"}),R.quizzes.length===0?y.jsx("div",{className:"empty-state",children:"Belum ada kuis"}):y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:R.quizzes.map(F=>{const C=F.lessonId?R.lessons.find(H=>H.id===F.lessonId):void 0,I=S.has(F.id),k=v.has(F.id),O=(!F.lessonId||N.has(`${R.module.id}:${F.lessonId}`))&&(!I||k),U=I&&!k?" Selesai":I&&k?"(Akses ulang tersedia)":"";return y.jsxs("button",{type:"button",className:"btn-action primary",onClick:()=>O&&w(F.id),disabled:!O,title:O?"Mulai kuis":"Baca materi terlebih dahulu",style:{opacity:O?1:.6,cursor:O?"pointer":"not-allowed",textAlign:"left"},children:[y.jsx("i",{children:""}),y.jsx("span",{style:{flex:1},children:F.title}),U&&y.jsx("span",{style:{color:I?"#059669":"#0ea5e9",fontWeight:700},children:U}),C&&y.jsxs("span",{style:{marginLeft:8,color:"#64748b",fontStyle:"italic"},children:["(Materi: ",C.title,")"]}),!O&&C&&y.jsxs("span",{style:{marginLeft:8,color:"#ef4444"},children:[' Baca "',C.title,'" dulu']})]},F.id)})})]})]})]},R.module.id)})})]}),A&&y.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",children:y.jsxs("div",{className:"modal-container",style:{maxWidth:520},children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Konfirmasi Mulai Kuis"}),y.jsx("button",{className:"close-btn",onClick:()=>w(null),"aria-label":"Tutup",children:""})]}),y.jsx("div",{className:"modal-content",children:(()=>{const R=o.find(B=>B.quizzes.some(L=>L.id===A)),V=R?.quizzes.find(B=>B.id===A),M=V?.lessonId?R?.lessons.find(B=>B.id===V.lessonId):void 0;return y.jsxs(y.Fragment,{children:[y.jsxs("p",{children:["Anda akan mengerjakan kuis: ",y.jsx("strong",{children:V?.title})]}),M&&y.jsxs("p",{children:["Kuis ini terkait materi: ",y.jsx("em",{children:M.title})]}),V?.timeLimitSec&&y.jsxs("p",{children:["Batas waktu: ",Math.round(V.timeLimitSec/60)," menit"]})]})})()}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{className:"btn-secondary",onClick:()=>w(null),children:"Tidak"}),y.jsx("button",{className:"btn-primary",onClick:()=>{const R=A;w(null),window.location.hash=`#/kuis/${R}`},children:"Siap, Lanjut"})]})]})})]}):null},dO=()=>{const{user:i}=yr(),[t,e]=z.useState(!0),[n,s]=z.useState(null),[o,l]=z.useState([]),[u,h]=z.useState([]),[f,m]=z.useState({}),[v,b]=z.useState([]),[A,w]=z.useState([]),[S,N]=z.useState(new Set),[R,V]=z.useState(null);z.useEffect(()=>{(async()=>{if(i){e(!0),s(null);try{const C=(await vt.getModules()).filter(j=>j.visible??!0);h(C);const I={};for(const j of C)I[j.id]=await vt.getLessons(j.id);m(I);const[k,O,U,H]=await Promise.all([vt.getQuizzes(),vt.getAnswersByUser(i.uid),vt.getLessonReadsByUser(i.uid),vt.getRetakeGrantsByUser(i.uid)]);l(k),b(O),w(U),N(new Set((H||[]).filter(j=>(j.allowed??0)>0).map(j=>j.quizId)))}catch(F){s(F?.message||"Gagal memuat daftar kuis")}finally{e(!1)}}})()},[i]);const M=z.useMemo(()=>new Set(v.map(L=>L.quizId)),[v]),B=z.useMemo(()=>new Set(A.map(L=>`${L.moduleId}:${L.lessonId}`)),[A]);return i?y.jsxs("div",{className:"dashboard-main",children:[y.jsxs("div",{className:"container",children:[y.jsx("div",{style:{marginTop:0,marginBottom:12},children:y.jsx(Ns,{className:"btn-secondary",to:"/dashboard",children:" Kembali ke Dashboard"})}),y.jsx("h1",{style:{marginTop:0},children:"Kuis"}),n&&y.jsx("div",{className:"error-message",children:n}),t?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat kuis..."})]}):y.jsx("div",{className:"content-grid",style:{gridTemplateColumns:"1fr"},children:o.length===0?y.jsx("div",{className:"empty-state",children:"Belum ada kuis tersedia."}):o.map(L=>{const F=u.find(H=>H.id===L.moduleId)?.title||"Umum",C=L.lessonId&&L.moduleId?f[L.moduleId]?.find(H=>H.id===L.lessonId):void 0,I=M.has(L.id),k=S.has(L.id),O=(!L.lessonId||L.moduleId&&B.has(`${L.moduleId}:${L.lessonId}`))&&(!I||k),U=I&&!k?" Selesai":I&&k?"(Akses ulang tersedia)":"";return y.jsxs("div",{className:"content-card",children:[y.jsxs("div",{className:"card-header",children:[y.jsx("div",{className:"lesson-order",children:"KUIS"}),y.jsx("div",{className:"card-actions"})]}),y.jsxs("div",{className:"card-content",children:[y.jsx("h4",{children:L.title}),y.jsxs("p",{style:{marginBottom:8},children:["Bab: ",y.jsx("strong",{children:F})]}),L.timeLimitSec&&y.jsxs("p",{style:{color:"#64748b"},children:["Batas waktu: ",Math.round(L.timeLimitSec/60)," menit"]}),C&&y.jsxs("p",{style:{marginTop:4,fontStyle:"italic",color:"#64748b"},children:["Materi terkait: ",C.title]}),!O&&C&&y.jsxs("p",{style:{color:"#ef4444"},children:['Baca materi "',C.title,'" terlebih dahulu agar bisa mulai.']}),y.jsxs("div",{className:"form-actions",style:{justifyContent:"space-between"},children:[y.jsx("button",{className:"btn-action primary",onClick:()=>O&&V(L.id),disabled:!O,style:{opacity:O?1:.6,cursor:O?"pointer":"not-allowed"},children:" Mulai Kuis"}),y.jsx("span",{style:{alignSelf:"center",color:I?"#059669":"#94a3b8",fontWeight:600},children:U})]})]})]},L.id)})})]}),R&&y.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",children:y.jsxs("div",{className:"modal-container",style:{maxWidth:520},children:[y.jsxs("div",{className:"modal-header",children:[y.jsx("h2",{children:"Konfirmasi Mulai Kuis"}),y.jsx("button",{className:"close-btn",onClick:()=>V(null),"aria-label":"Tutup",children:""})]}),y.jsx("div",{className:"modal-content",children:(()=>{const L=o.find(I=>I.id===R),F=u.find(I=>I.id===L?.moduleId)?.title||"Umum",C=L?.lessonId&&L?.moduleId?f[L.moduleId]?.find(I=>I.id===L.lessonId):void 0;return y.jsxs(y.Fragment,{children:[y.jsxs("p",{children:["Anda akan mengerjakan kuis: ",y.jsx("strong",{children:L?.title})]}),y.jsxs("p",{children:["Bab: ",y.jsx("strong",{children:F})]}),C&&y.jsxs("p",{children:["Kuis ini terkait materi: ",y.jsx("em",{children:C.title})]}),L?.timeLimitSec&&y.jsxs("p",{children:["Batas waktu: ",Math.round(L.timeLimitSec/60)," menit"]})]})})()}),y.jsxs("div",{className:"form-actions",children:[y.jsx("button",{className:"btn-secondary",onClick:()=>V(null),children:"Tidak"}),y.jsx("button",{className:"btn-primary",onClick:()=>{const L=R;V(null),window.location.hash=`#/kuis/${L}`},children:"Siap, Lanjut"})]})]})})]}):null},Un=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Dy=[.001,0,0,.001,0,0],Yg=1.35,cs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Zr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},L1="pdfjs_internal_editor_",Ot={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101,COMMENT:102},Xt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},fO={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},In={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},gf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},We={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Sl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},gp={ERRORS:0,WARNINGS:1,INFOS:5},Ff={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Yd={moveTo:0,lineTo:1,curveTo:2,closePath:3},pO={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let yp=gp.WARNINGS;function mO(i){Number.isInteger(i)&&(yp=i)}function gO(){return yp}function vp(i){yp>=gp.INFOS&&console.log(`Info: ${i}`)}function jt(i){yp>=gp.WARNINGS&&console.log(`Warning: ${i}`)}function pe(i){throw new Error(i)}function Ze(i,t){i||pe(t)}function yO(i){switch(i?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function O1(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"&&(e.addDefaultProtocol&&i.startsWith("www.")&&i.match(/\./g)?.length>=2&&(i=`http://${i}`),e.tryConvertEncoding))try{i=EO(i)}catch{}const n=t?URL.parse(i,t):URL.parse(i);return yO(n)?n:null}function j1(i,t,e=!1){const n=URL.parse(i);return n?(n.hash=t,n.href):e&&O1(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Gt(i,t,e,n=!1){return Object.defineProperty(i,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const To=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class v0 extends To{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Xg extends To{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class My extends To{constructor(t){super(t,"InvalidPDFException")}}class Bf extends To{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class vO extends To{constructor(t){super(t,"FormatError")}}class da extends To{constructor(t){super(t,"AbortException")}}function V1(i){(typeof i!="object"||i?.length===void 0)&&pe("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const n=[];for(let s=0;s<t;s+=e){const o=Math.min(s+e,t),l=i.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function dh(i){typeof i!="string"&&pe("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=i.charCodeAt(n)&255;return e}function _O(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function bO(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function AO(){try{return new Function(""),!0}catch{return!1}}class Sn{static get isLittleEndian(){return Gt(this,"isLittleEndian",bO())}static get isEvalSupported(){return Gt(this,"isEvalSupported",AO())}static get isOffscreenCanvasSupported(){return Gt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Gt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Gt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Gt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Qg=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));class St{static makeHexColor(t,e,n){return`#${Qg[t]}${Qg[e]}${Qg[n]}`}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,n=0){const s=t[n],o=t[n+1];t[n]=s*e[0]+o*e[2]+e[4],t[n+1]=s*e[1]+o*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const s=e[0],o=e[1],l=e[2],u=e[3],h=e[4],f=e[5];for(let m=0;m<6;m+=2){const v=t[n+m],b=t[n+m+1];t[n+m]=v*s+b*l+h,t[n+m+1]=v*o+b*u+f}}static applyInverseTransform(t,e){const n=t[0],s=t[1],o=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/o,t[1]=(-n*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/o}static axialAlignedBoundingBox(t,e,n){const s=e[0],o=e[1],l=e[2],u=e[3],h=e[4],f=e[5],m=t[0],v=t[1],b=t[2],A=t[3];let w=s*m+h,S=w,N=s*b+h,R=N,V=u*v+f,M=V,B=u*A+f,L=B;if(o!==0||l!==0){const F=o*m,C=o*b,I=l*v,k=l*A;w+=I,R+=I,N+=k,S+=k,V+=F,L+=F,B+=C,M+=C}n[0]=Math.min(n[0],w,N,S,R),n[1]=Math.min(n[1],V,B,M,L),n[2]=Math.max(n[2],w,N,S,R),n[3]=Math.max(n[3],V,B,M,L)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],s=t[1],o=t[2],l=t[3],u=n**2+s**2,h=n*o+s*l,f=o**2+l**2,m=(u+f)/2,v=Math.sqrt(m**2-(u*f-h**2));e[0]=Math.sqrt(m+v||1),e[1]=Math.sqrt(m-v||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>s)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>l?null:[n,o,s,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,s,o){o[0]=Math.min(o[0],t,n),o[1]=Math.min(o[1],e,s),o[2]=Math.max(o[2],t,n),o[3]=Math.max(o[3],e,s)}static#t(t,e,n,s,o,l,u,h,f,m){if(f<=0||f>=1)return;const v=1-f,b=f*f,A=b*f,w=v*(v*(v*t+3*f*e)+3*b*n)+A*s,S=v*(v*(v*o+3*f*l)+3*b*u)+A*h;m[0]=Math.min(m[0],w),m[1]=Math.min(m[1],S),m[2]=Math.max(m[2],w),m[3]=Math.max(m[3],S)}static#e(t,e,n,s,o,l,u,h,f,m,v,b){if(Math.abs(f)<1e-12){Math.abs(m)>=1e-12&&this.#t(t,e,n,s,o,l,u,h,-v/m,b);return}const A=m**2-4*v*f;if(A<0)return;const w=Math.sqrt(A),S=2*f;this.#t(t,e,n,s,o,l,u,h,(-m+w)/S,b),this.#t(t,e,n,s,o,l,u,h,(-m-w)/S,b)}static bezierBoundingBox(t,e,n,s,o,l,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,h),this.#e(t,n,o,u,e,s,l,h,3*(-t+3*(n-o)+u),6*(t-2*n+o),3*(n-t),f),this.#e(t,n,o,u,e,s,l,h,3*(-e+3*(s-l)+h),6*(e-2*s+l),3*(s-e),f)}}function EO(i){return decodeURIComponent(escape(i))}let Zg=null,_0=null;function wO(i){return Zg||(Zg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_0=new Map([["","t"]])),i.replaceAll(Zg,(t,e,n)=>e?e.normalize("NFKC"):_0.get(n))}function U1(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),V1(i)}const Kv="pdfjs_internal_id_";function SO(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,s,...o]=e;if(!i(n)&&!Number.isInteger(n)||!t(s))return!1;const l=o.length;let u=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Fn(i,t,e){return Math.min(Math.max(i,t),e)}function F1(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(V1(i))}function TO(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):dh(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});const er="http://www.w3.org/2000/svg";class Gl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function fh(i,t="text"){if(wu(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class ph{constructor({viewBox:t,userUnit:e,scale:n,rotation:s,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let m,v,b,A;switch(s%=360,s<0&&(s+=360),s){case 180:m=-1,v=0,b=0,A=1;break;case 90:m=0,v=1,b=1,A=0;break;case 270:m=0,v=-1,b=-1,A=0;break;case 0:m=1,v=0,b=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(b=-b,A=-A);let w,S,N,R;m===0?(w=Math.abs(f-t[1])*n+o,S=Math.abs(h-t[0])*n+l,N=(t[3]-t[1])*n,R=(t[2]-t[0])*n):(w=Math.abs(h-t[0])*n+o,S=Math.abs(f-t[1])*n+l,N=(t[2]-t[0])*n,R=(t[3]-t[1])*n),this.transform=[m*n,v*n,b*n,A*n,w-m*n*h-b*n*f,S-v*n*h-A*n*f],this.width=N,this.height=R}get rawDims(){const t=this.viewBox;return Gt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new ph({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(t,e){const n=[t,e];return St.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];St.applyTransform(e,this.transform);const n=[t[2],t[3]];return St.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return St.applyInverseTransform(n,this.transform),n}}class Wv extends To{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function _p(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function Yv(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function xO(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function CO(i,t="document.pdf"){if(typeof i!="string")return t;if(_p(i))return jt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(i);if(!n)return t;const s=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return s(l);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const f of u)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return t}class b0{started=Object.create(null);times=[];time(t){t in this.started&&jt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||jt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:s,end:o}of this.times)t.push(`${n.padEnd(e)} ${o-s}ms
`);return t.join("")}}function wu(i,t){const e=t?URL.parse(i,t):URL.parse(i);return e?.protocol==="http:"||e?.protocol==="https:"}function Ms(i){i.preventDefault()}function Xe(i){i.preventDefault(),i.stopPropagation()}function RO(i){console.log("Deprecated API usage: "+i)}class Py{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let m=parseInt(e[8],10);m=m>=0&&m<=23?m:0;let v=parseInt(e[9],10)||0;return v=v>=0&&v<=59?v:0,f==="-"?(l+=m,u+=v):f==="+"&&(l-=m,u-=v),new Date(Date.UTC(n,s,o,l,u,h))}}function IO(i,{scale:t=1,rotation:e=0}){const{width:n,height:s}=i.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new ph({viewBox:o,userUnit:1,scale:t,rotation:e})}function bp(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(jt(`Not a valid color format: "${i}"`),[0,0,0])}function NO(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;i.set(e,bp(n))}t.remove()}function Re(i){const{a:t,b:e,c:n,d:s,e:o,f:l}=i.getTransform();return[t,e,n,s,o,l]}function pi(i){const{a:t,b:e,c:n,d:s,e:o,f:l}=i.getTransform().invertSelf();return[t,e,n,s,o,l]}function vo(i,t,e=!1,n=!0){if(t instanceof ph){const{pageWidth:s,pageHeight:o}=t.rawDims,{style:l}=i,u=Sn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,m=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,v=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=m,l.height=v):(l.width=v,l.height=m)}n&&i.setAttribute("data-main-rotation",t.rotation)}class Ti{constructor(){const{pixelRatio:t}=Ti;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,s,o=-1){let l=1/0,u=1/0,h=1/0;n=Ti.capPixels(n,o),n>0&&(l=Math.sqrt(n/(t*e))),s!==-1&&(u=s/t,h=s/e);const f=Math.min(l,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const Ly=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Mu{#t=null;#e=null;#n;#s=null;#r=null;#i=null;#a=null;static#o=null;constructor(t){this.#n=t,Mu.#o||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",Ms,{signal:e}),t.addEventListener("pointerdown",Mu.#u,{signal:e});const n=this.#s=document.createElement("div");n.className="buttons",t.append(n);const s=this.#n.toolbarPosition;if(s){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#u(t){t.stopPropagation()}#c(t){this.#n._focusEventsAllowed=!1,Xe(t)}#d(t){this.#n._focusEventsAllowed=!0,Xe(t)}#l(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ms,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#i?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Mu.#o[t]),this.#l(n),n.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#s.append(n)}get#p(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#l(e),this.#s.append(e,this.#p),this.#r=t}addComment(t){if(this.#i)return;const e=t.render();e&&(this.#l(e),this.#s.prepend(e,this.#p),this.#i=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#l(e),this.#s.append(e,this.#p)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#n);this.#l(e),this.#s.append(e,this.#p)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class kO{#t=null;#e=null;#n;constructor(t){this.#n=t}#s(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ms,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#i(),t}#r(t,e){let n=0,s=0;for(const o of t){const l=o.y+o.height;if(l<n)continue;const u=o.x+(e?o.width:0);if(l>n){s=u,n=l;continue}e?u>s&&(s=u):u<s&&(s=u)}return[e?1-s:s,n]}show(t,e,n){const[s,o]=this.#r(e,n),{style:l}=this.#e||=this.#s();t.append(this.#e),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#i(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#n._signal;t.addEventListener("contextmenu",Ms,{signal:n}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#t.append(t)}}function B1(i,t,e){for(const n of e)t.addEventListener(n,i[n].bind(i))}class DO{#t=0;get id(){return`${L1}${this.#t++}`}}class Xv{#t=U1();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Gt(this,"_isSVGFittingCanvas",o)}async#s(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(n.url=e,s=await fh(e,"blob")):e instanceof File?s=n.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const o=Xv._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((f,m)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,f()},l.onload=async()=>{const v=n.svgUrl=l.result;u.src=await o?`${v}#svgView(preserveAspectRatio(none))`:v},u.onerror=l.onerror=m});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){jt(s),n=null}return this.#n.set(t,n),n&&this.#n.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:s,type:o}=t;return this.#s(`${e}_${n}_${s}_${o}`,t)}async getFromUrl(t){return this.#s(t,t)}async getFromBlob(t,e){const n=await e;return this.#s(t,n)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,n),this.#n.set(n.id,n),n}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class MO{#t=[];#e=!1;#n;#s=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(s&&t(),this.#e)return;const h={cmd:t,undo:e,post:n,type:o};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(h);return}if(l&&this.#t[this.#s].type===o){u&&(h.undo=this.#t[this.#s].undo),this.#t[this.#s]=h;return}const f=this.#s+1;f===this.#n?this.#t.splice(0,1):(this.#s=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#s===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1,this.#s-=1}redo(){if(this.#s<this.#t.length-1){this.#s+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#s];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}cleanType(t){if(this.#s!==-1){for(let e=this.#s;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#s-e),this.#s=e;return}this.#t.length=0,this.#s=-1}}destroy(){this.#t=null}}class mh{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Sn.platform;for(const[n,s,o={}]of t)for(const l of n){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:u=null}}=n;u&&!u(t,e)||(s.bind(t,...l,e)(),o||Xe(e))}}class Qv{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return NO(t),Gt(this,"_colors",t)}convert(t){const e=bp(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,s]of this._colors)if(s.every((o,l)=>o===e[l]))return Qv._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?St.makeHexColor(...e):t}}class fa{#t=new AbortController;#e=null;#n=new Map;#s=new Map;#r=null;#i=null;#a=null;#o=new MO;#u=null;#c=null;#d=null;#l=0;#p=new Set;#g=null;#f=null;#h=new Set;_editorUndoBar=null;#m=!1;#_=!1;#y=!1;#A=null;#E=null;#v=null;#S=null;#I=!1;#w=null;#N=new DO;#R=!1;#C=!1;#x=null;#D=null;#j=null;#M=null;#B=null;#T=Ot.NONE;#b=new Set;#V=null;#U=null;#z=null;#q=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#L=null;#G=null;#X=null;#O=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=fa.prototype,e=l=>l.#L.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new mh([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#L.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#L.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,n,s,o,l,u,h,f,m,v,b,A,w,S,N){const R=this._signal=this.#t.signal;this.#L=t,this.#G=e,this.#X=n,this.#r=s,this.#u=o,this.#U=l,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:R}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:R}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:R}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:R}),u._on("setpreference",this.onSetPreference.bind(this),{signal:R}),u._on("switchannotationeditorparams",V=>this.updateParams(V.type,V.value),{signal:R}),this.#rt(),this.#ct(),this.#Z(),this.#i=h.annotationStorage,this.#A=h.filterFactory,this.#z=f,this.#S=m||null,this.#m=v,this.#_=b,this.#y=A,this.#B=w||null,this.viewParameters={realScale:Gl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=N!==!1}destroy(){this.#O?.resolve(),this.#O=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#h.clear(),this.#M?.clear(),this.#e=null,this.#b.clear(),this.#o.destroy(),this.#r?.destroy(),this.#u?.destroy(),this.#U?.destroy(),this.#w?.hide(),this.#w=null,this.#j?.destroy(),this.#j=null,this.#E&&(clearTimeout(this.#E),this.#E=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#B}get useNewAltTextFlow(){return this.#_}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Gt(this,"hcmFilter",this.#z?this.#A.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Gt(this,"direction",getComputedStyle(this.#L).direction)}get _highlightColors(){return Gt(this,"_highlightColors",this.#S?new Map(this.#S.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Gt(this,"highlightColors",null);const e=new Map,n=!!this.#z;for(const[s,o]of t){const l=s.endsWith("_HCM");if(n&&l){e.set(s.replace("_HCM",""),o);continue}!n&&!l&&e.set(s,o)}return Gt(this,"highlightColors",e)}get highlightColorNames(){return Gt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#d=t}setMainHighlightColorPicker(t){this.#j=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#u}editComment(t,e){this.#u?.open(this,t,e)}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=e;break}}onPageChanging({pageNumber:t}){this.#l=t-1}focusMainContainer(){this.#L.focus()}findParent(t,e){for(const n of this.#s.values()){const{x:s,y:o,width:l,height:u}=n.div.getBoundingClientRect();if(t>=s&&t<=s+l&&e>=o&&e<=o+u)return n}return null}disableUserSelect(t=!1){this.#G.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#h.add(t)}removeShouldRescale(t){this.#h.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Gl.PDF_TO_CSS_UNITS;for(const e of this.#h)e.onScaleChanging();this.#d?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#Q(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#s.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:l}=e,u=e.toString(),f=this.#W(e).closest(".textLayer"),m=this.getSelectionBoxes(f);if(!m)return;e.empty();const v=this.#Q(f),b=this.#T===Ot.NONE,A=()=>{v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:n,anchorOffset:s,focusNode:o,focusOffset:l,text:u}),b&&this.showAllEditors("highlight",!0,!0)};if(b){this.switchToMode(Ot.HIGHLIGHT,A);return}A()}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#W(t).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#w||=new kO(this),this.#w.show(n,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#i&&!this.#i.has(t.id)&&this.#i.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#X;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#it(){const t=document.getSelection();if(!t||t.isCollapsed){this.#V&&(this.#w?.hide(),this.#V=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#V)return;const s=this.#W(t).closest(".textLayer");if(!s){this.#V&&(this.#w?.hide(),this.#V=null,this.#k({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#V=e,this.#k({hasSelectedText:!0}),!(this.#T!==Ot.HIGHLIGHT&&this.#T!==Ot.NONE)&&(this.#T===Ot.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#I=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===Ot.HIGHLIGHT?this.#Q(s):null;o?.toggleDrawing();const l=new AbortController,u=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}}#Y(t=""){this.#T===Ot.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#it.bind(this),{signal:this._signal})}#at(){if(this.#v)return;this.#v=new AbortController;const t=this.combinedSignal(this.#v);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ot(){this.#v?.abort(),this.#v=null}blur(){if(this.isShiftKeyDown=!1,this.#I&&(this.#I=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#D=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#D)return;const[t,e]=this.#D;this.#D=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#Z(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#lt(){this.#x?.abort(),this.#x=null}#J(){if(this.#c)return;this.#c=new AbortController;const t=this.combinedSignal(this.#c);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#tt(){this.#c?.abort(),this.#c=null}#ct(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#Z(),this.#J()}removeEditListeners(){this.#lt(),this.#tt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#f)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#f)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#b){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const l of this.#f)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){jt(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)this.#et(h);this.#nt(o)},u=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){jt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==Ot.NONE&&!this.isEditorHandlingKeyboard&&fa._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#I&&(this.#I=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#k(t){Object.entries(t).some(([n,s])=>this.#$[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#T===Ot.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#F([[Xt.HIGHLIGHT_FREE,!0]]))}#F(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#at(),this.#J(),this.#k({isEditing:this.#T!==Ot.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ot(),this.#tt(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#f){this.#f=t;for(const e of this.#f)this.#F(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#s.get(this.#l)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#l}addLayer(t){this.#s.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,s=!1,o=!1){if(this.#T!==t&&!(this.#O&&(await this.#O.promise,!this.#O))){if(this.#O=Promise.withResolvers(),this.#d?.commitOrRemove(),this.#T=t,t===Ot.NONE){this.setEditingState(!1),this.#ht(),this._editorUndoBar?.hide(),this.#O.resolve();return}t===Ot.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ut(),this.unselectAll();for(const l of this.#s.values())l.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),this.#O.resolve();return}for(const l of this.#n.values())l.annotationElementId===e||l.id===e?(this.setSelected(l),o?l.editComment():s&&l.enterInEditMode()):l.unselect();this.#O.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#f){switch(t){case Xt.CREATE:this.currentLayer.addNewEditor(e);return;case Xt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#b)n.updateParams(t,e);else for(const n of this.#f)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const o of this.#n.values())o.editorType===t&&o.show(e);(this.#q?.get(Xt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#F([[Xt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#C!==t){this.#C=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ut(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ht(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#n.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#E&&clearTimeout(this.#E),this.#E=setTimeout(()=>{this.focusMainContainer(),this.#E=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#M?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#p.has(t.annotationElementId))&&this.#i?.remove(t.id)}addDeletedAnnotationElement(t){this.#p.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#p.has(t)}removeDeletedAnnotationElement(t){this.#p.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#et(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#F(t.propertiesToUpdate))}get#dt(){let t=null;for(t of this.#b);return t}updateUI(t){this.#dt===t&&this.#F(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#F(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#F(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#d?.commitOrRemove();for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#F(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#k({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#o.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#o.cleanType(t)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#b],n=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},s=()=>{for(const o of e)this.#et(o)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#nt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==Ot.NONE))&&!this.#d?.commitOrRemove()&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[s,o]=this.#H,l=[...this.#b],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},u);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#b)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:s,y:o,pageIndex:l},u]of t)u.newX=s,u.newY=o,u.newPageIndex=l,e||=s!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!e)return!1;const n=(s,o,l,u)=>{if(this.#n.has(s.id)){const h=this.#s.get(u);h?s._setParentAndPosition(h,o,l):(s.pageIndex=u,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:u}]of t)n(s,o,l,u)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:u}]of t)n(s,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const n of this.#g.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}get imageManager(){return Gt(this,"imageManager",new Xv)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,m=e.rangeCount;f<m;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,m,v,b)=>({x:(m-s)/l,y:1-(f+v-n)/o,width:b/l,height:v/o});break;case"180":u=(f,m,v,b)=>({x:1-(f+v-n)/o,y:1-(m+b-s)/l,width:v/o,height:b/l});break;case"270":u=(f,m,v,b)=>({x:1-(m+b-s)/l,y:(f-n)/o,width:b/l,height:v/o});break;default:u=(f,m,v,b)=>({x:(f-n)/o,y:(m-s)/l,width:v/o,height:b/l});break}const h=[];for(let f=0,m=e.rangeCount;f<m;f++){const v=e.getRangeAt(f);if(!v.collapsed)for(const{x:b,y:A,width:w,height:S}of v.getClientRects())w===0||S===0||h.push(u(b,A,w,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#a||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#a?.delete(t)}renderAnnotationElement(t){const e=this.#a?.get(t.data.id);if(!e)return;const n=this.#i.getRawValue(e);n&&(this.#T===Ot.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const s=this.#M?.get(t);s&&(s.setCanvas(e,n),this.#M.delete(t))}addMissingCanvas(t,e){(this.#M||=new Map).set(t,e)}}class vi{#t=null;#e=!1;#n=null;#s=null;#r=null;#i=null;#a=!1;#o=null;#u=null;#c=null;#d=null;#l=!1;static#p=null;static _l10n=null;constructor(t){this.#u=t,this.#l=t._uiManager.useNewAltTextFlow,vi.#p||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){vi._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#s=document.createElement("span");t.append(e),this.#l?(t.classList.add("new"),t.setAttribute("data-l10n-id",vi.#p.missing),e.setAttribute("data-l10n-id",vi.#p["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#u._uiManager._signal;t.addEventListener("contextmenu",Ms,{signal:n}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#l&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#a=!0,s(o))},{signal:n}),await this.#f(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#l?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#l?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await vi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#f())}toggleAltTextBadge(t=!1){if(!this.#l||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#u.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(this.#c=n,this.#d=s),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#f())}toggle(t=!1){this.#n&&(!t&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#s=null,this.#r=null,this.#o?.remove(),this.#o=null}async#f(){const t=this.#n;if(!t)return;if(this.#l){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",vi.#p[this.#g]),this.#s?.setAttribute("data-l10n-id",vi.#p[`${this.#g}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#u.id}`;const s=100,o=this.#u._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#r.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#u.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Xd{#t=null;#e=!1;#n=null;#s=null;#r=null;#i=null;#a=!1;constructor(t){this.#n=t,this.toolbar=null}render(){if(!this.#n._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",Ms,{signal:e}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:e});const n=s=>{s.preventDefault(),this.edit()};return t.addEventListener("click",n,{capture:!0,signal:e}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#e=!0,n(s))},{signal:e}),t}edit(){const{bottom:t,left:e,right:n}=this.#n.getClientDimensions(),s={top:t};this.#n._uiManager.direction==="ltr"?s.right=n:s.left=e,this.#n._uiManager.editComment(this.#n,s)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#a||this.#r===""}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#s}serialize(){return this.data}get data(){return{text:this.#r,date:this.#i,deleted:this.#a}}set data(t){if(t===null){this.#r="",this.#a=!0;return}this.#r=t,this.#i=new Date,this.#a=!1}setInitialText(t){this.#s=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#r="",this.#i=null,this.#n=null,this.#e=!1,this.#a=!1}}class Ap{#t;#e=!1;#n=null;#s;#r;#i;#a;#o=null;#u;#c=null;#d;#l=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=n,this.#s=e,this.#r=s,this.#i=o,this.#a=l,this.#d=new AbortController,this.#u=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#p.bind(this),{passive:!1,signal:this.#u})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ti.pixelRatio}#p(t){if(this.#s?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,o=AbortSignal.any([this.#u,s.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Xe(f),h(f))},u),l.addEventListener("pointerup",h,u),l.addEventListener("pointercancel",h,u);return}if(!this.#l){this.#l=new AbortController;const s=AbortSignal.any([this.#u,this.#l.signal]),o=this.#t,l={signal:s,capture:!1,passive:!1};o.addEventListener("touchmove",this.#g.bind(this),l);const u=this.#f.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",Xe,l),o.addEventListener("pointermove",Xe,l),o.addEventListener("pointercancel",Xe,l),o.addEventListener("pointerup",Xe,l),this.#r?.()}if(Xe(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#c||t.touches.length!==2)return;Xe(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:s,screenY:o}=e,{screenX:l,screenY:u}=n,h=this.#c,{touch0X:f,touch0Y:m,touch1X:v,touch1Y:b}=h,A=v-f,w=b-m,S=l-s,N=u-o,R=Math.hypot(S,N)||1,V=Math.hypot(A,w)||1;if(!this.#e&&Math.abs(V-R)<=Ap.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=l,h.touch1Y=u,!this.#e){this.#e=!0;return}const M=[(s+l)/2,(o+u)/2];this.#i?.(M,V,R)}#f(t){t.touches.length>=2||(this.#l&&(this.#l.abort(),this.#l=null,this.#a?.()),this.#c&&(Xe(t),this.#c=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Tt{#t=null;#e=null;#n=null;#s=null;#r=!1;#i=null;#a="";#o=!1;#u=null;#c=null;#d=null;#l=null;#p="";#g=!1;#f=null;#h=!1;#m=!1;#_=!1;#y=null;#A=0;#E=0;#v=null;#S=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#I=!1;#w=Tt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Qv;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Tt.prototype._resizeWithKeyboard,e=fa.TRANSLATE_SMALL,n=fa.TRANSLATE_BIG;return Gt(this,"_resizerKeyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],Tt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Gt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new PO({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Tt._l10n??=t,Tt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Tt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Tt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){pe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#I}set _isDraggable(t){this.#I=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#G(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(t+n)/o,this.y=(e+s)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,s]=this.parentDimensions;this.setAt(t*n,e*s,this.width*n,this.height*s),this._onTranslated()}#N([t,e],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#N(this.parentDimensions,t,e)}translateInPage(t,e){this.#f||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#f||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,o]}=this;if(this.x+=t/s,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,f]=this.getBaseTranslation();l+=h,u+=f;const{style:m}=n;m.left=`${(100*l).toFixed(2)}%`,m.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#f&&(this.#f[0]!==this.x||this.#f[1]!==this.y)}get _hasBeenResized(){return!!this.#f&&(this.#f[2]!==this.width||this.#f[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=Tt,s=n/t,o=n/e;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,s]}=this;let{x:o,y:l,width:u,height:h}=this;if(u*=n,h*=s,o*=n,l*=s,this._mustFixPosition)switch(t){case 0:o=Fn(o,0,n-u),l=Fn(l,0,s-h);break;case 90:o=Fn(o,0,n-h),l=Fn(l,u,s);break;case 180:o=Fn(o,u,n),l=Fn(l,h,s);break;case 270:o=Fn(o,h,n),l=Fn(l,0,s-u);break}this.x=o/=n,this.y=l/=s;const[f,m]=this.getBaseTranslation();o+=f,l+=m,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Tt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Tt.#R(t,e,360-this.parentRotation)}#C(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,s]=this.parentDimensions,{style:o}=this.div;o.width=`${(100*t/n).toFixed(2)}%`,this.#o||(o.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,s=n.endsWith("%"),o=!this.#o&&e.endsWith("%");if(s&&o)return;const[l,u]=this.parentDimensions;s||(t.width=`${(100*parseFloat(n)/l).toFixed(2)}%`),!this.#o&&!o&&(t.height=`${(100*parseFloat(e)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#u)return;this.#u=document.createElement("div"),this.#u.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const s=document.createElement("div");this.#u.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#D.bind(this,n),{signal:e}),s.addEventListener("contextmenu",Ms,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#u)}#D(t,e){e.preventDefault();const{isMac:n}=Sn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Xe,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ms,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#M()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#j(t,e,n,s){this.width=n,this.height=s,this.x=t,this.y=e;const[o,l]=this.parentDimensions;this.setDims(o*n,l*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#M(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,h=this.height;o===t&&l===e&&u===n&&h===s||this.addCommands({cmd:this.#j.bind(this,o,l,u,h),undo:this.#j.bind(this,t,e,n,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,e){const[n,s]=this.parentDimensions,o=this.x,l=this.y,u=this.width,h=this.height,f=Tt.MIN_SIZE/n,m=Tt.MIN_SIZE/s,v=this.#C(this.rotation),b=(W,X)=>[v[0]*W+v[2]*X,v[1]*W+v[3]*X],A=this.#C(360-this.rotation),w=(W,X)=>[A[0]*W+A[2]*X,A[1]*W+A[3]*X];let S,N,R=!1,V=!1;switch(t){case"topLeft":R=!0,S=(W,X)=>[0,0],N=(W,X)=>[W,X];break;case"topMiddle":S=(W,X)=>[W/2,0],N=(W,X)=>[W/2,X];break;case"topRight":R=!0,S=(W,X)=>[W,0],N=(W,X)=>[0,X];break;case"middleRight":V=!0,S=(W,X)=>[W,X/2],N=(W,X)=>[0,X/2];break;case"bottomRight":R=!0,S=(W,X)=>[W,X],N=(W,X)=>[0,0];break;case"bottomMiddle":S=(W,X)=>[W/2,X],N=(W,X)=>[W/2,0];break;case"bottomLeft":R=!0,S=(W,X)=>[0,X],N=(W,X)=>[W,0];break;case"middleLeft":V=!0,S=(W,X)=>[0,X/2],N=(W,X)=>[W,X/2];break}const M=S(u,h),B=N(u,h);let L=b(...B);const F=Tt._round(o+L[0]),C=Tt._round(l+L[1]);let I=1,k=1,O,U;if(e.fromKeyboard)({deltaX:O,deltaY:U}=e);else{const{screenX:W,screenY:X}=e,[ut,xt]=this.#c;[O,U]=this.screenToPageTranslation(W-ut,X-xt),this.#c[0]=W,this.#c[1]=X}if([O,U]=w(O/n,U/s),R){const W=Math.hypot(u,h);I=k=Math.max(Math.min(Math.hypot(B[0]-M[0]-O,B[1]-M[1]-U)/W,1/u,1/h),f/u,m/h)}else V?I=Fn(Math.abs(B[0]-M[0]-O),f,1)/u:k=Fn(Math.abs(B[1]-M[1]-U),m,1)/h;const H=Tt._round(u*I),j=Tt._round(h*k);L=b(...N(H,j));const _t=F-L[0],Pt=C-L[1];this.#f||=[this.x,this.y,this.width,this.height],this.width=H,this.height=j,this.x=_t,this.y=Pt,this.setDims(n*H,s*j),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new Mu(this),this.div.append(this._editToolbar.render()),this._editToolbar.addButton("comment",this.addCommentButton());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(vi.initialize(Tt._l10n),this.#n=new vi(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}addCommentButton(){return this.#s?this.#s:this.#s=new Xd(this)}get commentColor(){return null}get comment(){const t=this.#s;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#s||(this.#s=new Xd(this)),this.#s.data=t}setCommentData(t){this.#s||(this.#s=new Xd(this)),this.#s.setInitialText(t)}get hasEditedComment(){return this.#s?.hasBeenEdited()}async editComment(){this.#s||(this.#s=new Xd(this)),this.#s.edit()}addComment(t){this.hasEditedComment&&(t.popup={contents:this.comment.text,deleted:this.comment.deleted})}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#q();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),B1(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#S||=new Ap({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#T.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#V.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#T(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(t,e,n){let o=.7*(n/e)+1-.7;if(o===1)return;const l=this.#C(this.rotation),u=(F,C)=>[l[0]*F+l[2]*C,l[1]*F+l[3]*C],[h,f]=this.parentDimensions,m=this.x,v=this.y,b=this.width,A=this.height,w=Tt.MIN_SIZE/h,S=Tt.MIN_SIZE/f;o=Math.max(Math.min(o,1/b,1/A),w/b,S/A);const N=Tt._round(b*o),R=Tt._round(A*o);if(N===b&&R===A)return;this.#f||=[m,v,b,A];const V=u(b/2,A/2),M=Tt._round(m+V[0]),B=Tt._round(v+V[1]),L=u(N/2,R/2);this.x=M-L[0],this.y=B-L[1],this.width=N,this.height=R,this.setDims(h*N,f*R),this.fixAndSetPosition(),this._onResizing()}#V(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#M()}pointerdown(t){const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#z(t);return}this.#U(t)}#U(t){const{isMac:e}=Sn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#z(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:o},u=f=>{s.abort(),this.#i=null,this.#g=!1,this._uiManager.endDragSession()||this.#U(f),n&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#E=t.clientY,this.#i=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._onStartDragging());const{clientX:m,clientY:v,pointerId:b}=f;if(b!==this.#i){Xe(f);return}const[A,w]=this.screenToPageTranslation(m-this.#A,v-this.#E);this.#A=m,this.#E=v,this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",Xe,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#a&&(this.#S||f.isPrimary)&&u(f),Xe(f)},l));const h=f=>{if(!this.#i||this.#i===f.pointerId){u(f);return}Xe(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/s,m=e/s,v=this.x*o,b=this.y*l,A=this.width*o,w=this.height*l;switch(n){case 0:return[v+f+u,l-b-m-w+h,v+f+A+u,l-b-m+h];case 90:return[v+m+u,l-b+f+h,v+m+w+u,l-b+f+A+h];case 180:return[v-f-A+u,l-b+m+h,v-f+u,l-b+m+w+h];case 270:return[v-m-w+u,l-b-f-A+h,v-m+u,l-b-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,s,o,l]=t,u=o-n,h=l-s;switch(this.rotation){case 0:return[n,e-l,u,h];case 90:return[n,e-s,h,u];case 180:return[o,e-s,u,h];case 270:return[o,e-l,h,u];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#_}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return e<l&&s>0&&t<o&&n>0}#q(){if(this.#l||!this.div)return;this.#l=new AbortController;const t=this._uiManager.combinedSignal(this.#l);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#q()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){pe("An editor must be serializable")}static async deserialize(t,e,n){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[o,l]=s.pageDimensions,[u,h,f,m]=s.getRectInCurrentCoords(t.rect,l);return s.x=u/o,s.y=h/l,s.width=f/o,s.height=m/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#l?.abort(),this.#l=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#G(),this.removeEditToolbar(),this.#v){for(const t of this.#v.values())clearTimeout(t);this.#v=null}this.parent=null,this.#S?.destroy(),this.#S=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#u.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#u.children;if(!this.#e){this.#e=Array.from(e);const l=this.#$.bind(this),u=this.#H.bind(this),h=this._uiManager._signal;for(const f of this.#e){const m=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#P.bind(this,m),{signal:h}),f.setAttribute("data-l10n-id",Tt._l10nResizer[m])}}const n=this.#e[0];let s=0;for(const l of e){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==s){if(o<s)for(let u=0;u<s-o;u++)this.#u.append(this.#u.firstChild);else if(o>s)for(let u=0;u<o-s;u++)this.#u.firstChild.before(this.#u.lastChild);let l=0;for(const u of e){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Tt._l10nResizer[f])}}this.#L(0),this.#_=!0,this.#u.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#$(t){Tt._resizerKeyboardManager.exec(this,t)}#H(t){this.#_&&t.relatedTarget?.parentNode!==this.#u&&this.#G()}#P(t){this.#p=this.#_?t:""}#L(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#_&&this.#B(this.#p,{deltaX:t,deltaY:e,fromKeyboard:!0})}#G(){this.#_=!1,this.#L(-1),this.#M()}_stopResizingWithKeyboard(){this.#G(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#u?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#o=!0;const n=t/e,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#v||=new Map;const{action:n}=t;let s=this.#v.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#v.delete(n),this.#v.size===0&&(this.#v=null)},Tt._telemetryTimeout),this.#v.set(n,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class PO extends Tt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const A0=3285377520,Cs=4294901760,mi=65535;class z1{constructor(t){this.h1=t?t&4294967295:A0,this.h2=t?t&4294967295:A0}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,N=t.length;S<N;S++){const R=t.charCodeAt(S);R<=255?e[n++]=R:(e[n++]=R>>>8,e[n++]=R&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(e.buffer,0,s);let u=0,h=0,f=this.h1,m=this.h2;const v=3432918353,b=461845907,A=v&mi,w=b&mi;for(let S=0;S<s;S++)S&1?(u=l[S],u=u*v&Cs|u*A&mi,u=u<<15|u>>>17,u=u*b&Cs|u*w&mi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[S],h=h*v&Cs|h*A&mi,h=h<<15|h>>>17,h=h*b&Cs|h*w&mi,m^=h,m=m<<13|m>>>19,m=m*5+3864292196);switch(u=0,o){case 3:u^=e[s*4+2]<<16;case 2:u^=e[s*4+1]<<8;case 1:u^=e[s*4],u=u*v&Cs|u*A&mi,u=u<<15|u>>>17,u=u*b&Cs|u*w&mi,s&1?f^=u:m^=u}this.h1=f,this.h2=m}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Cs|t*36045&mi,e=e*4283543511&Cs|((e<<16|t>>>16)*2950163797&Cs)>>>16,t^=e>>>1,t=t*444984403&Cs|t*60499&mi,e=e*3301882366&Cs|((e<<16|t>>>16)*3120437893&Cs)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Oy=Object.freeze({map:null,hash:"",transfer:void 0});class Zv{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Tt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(e))n[o]!==l&&(s=!0,n[o]=l);else s=!0,this.#n.set(t,e);s&&this.#s(),e instanceof Tt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new H1(this)}get serializable(){if(this.#n.size===0)return Oy;const t=new Map,e=new z1,n=[],s=Object.create(null);let o=!1;for(const[l,u]of this.#n){const h=u instanceof Tt?u.serialize(!1,s):u;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Oy}get editorStats(){let t=null;const e=new Map;for(const n of this.#n.values()){if(!(n instanceof Tt))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:o}=s;e.has(o)||e.set(o,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const l=t[o]||=new Map;for(const[u,h]of Object.entries(s)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const m=f.get(h)??0;f.set(h,m+1)}}for(const[n,s]of e)t[n]=s.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Tt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class H1 extends Zv{#t;constructor(t){super();const{map:e,hash:n,transfer:s}=t.serializable,o=structuredClone(e,s?{transfer:s}:null);this.#t={map:o,hash:n,transfer:s}}get print(){pe("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Gt(this,"modifiedIds",{ids:new Set,hash:""})}}class LO{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(Ze(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:l}=t,u=new FontFace(s,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(s),n?.(t)}catch{jt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}pe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw jt(`Failed to load font '${n.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Gt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Gt(this,"isSyncFontLoadingSupported",Un||Sn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ze(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:e,callback:t};return n.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Gt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(B,L){return B.charCodeAt(L)<<24|B.charCodeAt(L+1)<<16|B.charCodeAt(L+2)<<8|B.charCodeAt(L+3)&255}function s(B,L,F,C){const I=B.substring(0,L),k=B.substring(L+F);return I+C+k}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function m(B,L){if(++f>30){jt("Load test font never loaded."),L();return}if(h.font="30px "+B,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(m.bind(null,B,L))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=s(b,976,v.length,v);const w=16,S=1482184792;let N=n(b,w);for(o=0,l=v.length-3;o<l;o+=4)N=N-S+n(v,o)|0;o<v.length&&(N=N-S+n(v+"XXX",o)|0),b=s(b,w,4,_O(N));const R=`url(data:font/opentype;base64,${btoa(b)});`,V=`@font-face {font-family:"${v}";src:${R}}`;this.insertRule(V);const M=this._document.createElement("div");M.style.visibility="hidden",M.style.width=M.style.height="10px",M.style.position="absolute",M.style.top=M.style.left="0px";for(const B of[t.loadedName,v]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=B,M.append(L)}this._document.body.append(M),m(v,()=>{M.remove(),e.complete()})}}class OO{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${F1(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let s;try{s=t.get(n)}catch(l){jt(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=o}}function jO(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Un)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function VO(i){if(Un&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return dh(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i?.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Qd(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const jy=i=>typeof i=="object"&&Number.isInteger(i?.num)&&i.num>=0&&Number.isInteger(i?.gen)&&i.gen>=0,UO=i=>typeof i=="object"&&typeof i?.name=="string",FO=SO.bind(null,jy,UO);class BO{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,n)})}addEventListener(t,e,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){jt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);s=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Zd={DATA:1,ERROR:2},$e={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function E0(){}function Yn(i){if(i instanceof da||i instanceof My||i instanceof v0||i instanceof Bf||i instanceof Xg)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||pe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new da(i.message);case"InvalidPDFException":return new My(i.message);case"PasswordException":return new v0(i.message,i.code);case"ResponseException":return new Bf(i.message,i.status,i.missing);case"UnknownErrorException":return new Xg(i.message,i.details)}return new Xg(i.message,i.toString())}class Su{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#s(t);return}if(t.callback){const n=t.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===Zd.DATA)s.resolve(t.data);else if(t.callback===Zd.ERROR)s.reject(Yn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,s=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(l){o.postMessage({sourceName:n,targetName:s,callback:Zd.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:s,callback:Zd.ERROR,callbackId:t.callbackId,reason:Yn(l)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,e,n,s){const o=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const m=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:e,desiredSize:f.desiredSize},s),m.promise},pull:f=>{const m=Promise.withResolvers();return this.streamControllers[o].pullCall=m,h.postMessage({sourceName:l,targetName:u,stream:$e.PULL,streamId:o,desiredSize:f.desiredSize}),m.promise},cancel:f=>{Ze(f instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[o].cancelCall=m,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:$e.CANCEL,streamId:o,reason:Yn(f)}),m.promise}},n)}#n(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(f,m=1,v){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=m,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:$e.ENQUEUE,streamId:e,chunk:f},v)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:$e.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Ze(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:$e.ERROR,streamId:e,reason:Yn(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(u,t.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:$e.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:$e.START_COMPLETE,streamId:e,reason:Yn(f)})})}#s(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,o=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case $e.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Yn(t.reason));break;case $e.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Yn(t.reason));break;case $e.PULL:if(!u){o.postMessage({sourceName:n,targetName:s,stream:$e.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||E0).then(function(){o.postMessage({sourceName:n,targetName:s,stream:$e.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:$e.PULL_COMPLETE,streamId:e,reason:Yn(f)})});break;case $e.ENQUEUE:if(Ze(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case $e.CLOSE:if(Ze(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,e);break;case $e.ERROR:Ze(l,"error should have stream controller"),l.controller.error(Yn(t.reason)),this.#r(l,e);break;case $e.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Yn(t.reason)),this.#r(l,e);break;case $e.CANCEL:if(!u)break;const h=Yn(t.reason);Promise.try(u.onCancel||E0,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:$e.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:$e.CANCEL_COMPLETE,streamId:e,reason:Yn(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class G1{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){pe("Abstract method `_createCanvas` called.")}}class zO extends G1{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class q1{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){pe("Abstract method `_fetch` called.")}}class w0 extends q1{async _fetch(t){const e=await fh(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):dh(e)}}class $1{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,s,o){return"none"}destroy(t=!1){}}class HO extends $1{#t;#e;#n;#s;#r;#i;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#s=t,this.#r=e}get#o(){return this.#e||=new Map}get#u(){return this.#i||=new Map}get#c(){if(!this.#n){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#r.createElementNS(er,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#r.createElementNS(er,"defs"),t.append(n),n.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let v=0;v<256;v++)f[v]=h[v]/255;const m=f.join(",");return[m,m,m]}const[e,n,s]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let h=0;h<256;h++)o[h]=e[h]/255,l[h]=n[h]/255,u[h]=s[h]/255;return[o.join(","),l.join(","),u.join(",")]}#l(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(_p(e)?jt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=j1(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,s,o]=this.#d(t),l=t.length===1?n:`${n}${s}${o}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const u=`g_${this.#s}_transfer_map_${this.#a++}`,h=this.#l(u);this.#o.set(t,h),this.#o.set(l,h);const f=this.#f(u);return this.#m(n,s,o,f),h}addHCMFilter(t,e){const n=`${t}-${e}`,s="base";let o=this.#u.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#u.set(s,o)),!t||!e))return o.url;const l=this.#y(t);t=St.makeHexColor(...l);const u=this.#y(e);if(e=St.makeHexColor(...u),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const h=new Array(256);for(let A=0;A<=255;A++){const w=A/255;h[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const f=h.join(","),m=`g_${this.#s}_hcm_filter`,v=o.filter=this.#f(m);this.#m(f,f,f,v),this.#g(v);const b=(A,w)=>{const S=l[A]/255,N=u[A]/255,R=new Array(w+1);for(let V=0;V<=w;V++)R[V]=S+V/w*(N-S);return R.join(",")};return this.#m(b(0,5),b(1,5),b(2,5),v),o.url=this.#l(m),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),s=`alpha_${n}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const o=`g_${this.#s}_alpha_map_${this.#a++}`,l=this.#l(o);this.#o.set(t,l),this.#o.set(s,l);const u=this.#f(o);return this.#_(n,u),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,s;if(t?([n]=this.#d([t]),s=`luminosity_${n}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const o=`g_${this.#s}_luminosity_map_${this.#a++}`,l=this.#l(o);this.#o.set(t,l),this.#o.set(s,l);const u=this.#f(o);return this.#p(u),t&&this.#_(n,u),l}addHighlightHCMFilter(t,e,n,s,o){const l=`${e}-${n}-${s}-${o}`;let u=this.#u.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#u.set(t,u)),!e||!n))return u.url;const[h,f]=[e,n].map(this.#y.bind(this));let m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),v=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[b,A]=[s,o].map(this.#y.bind(this));v<m&&([m,v,b,A]=[v,m,A,b]),this.#c.style.color="";const w=(R,V,M)=>{const B=new Array(256),L=(v-m)/M,F=R/255,C=(V-R)/(255*M);let I=0;for(let k=0;k<=M;k++){const O=Math.round(m+k*L),U=F+k*C;for(let H=I;H<=O;H++)B[H]=U;I=O+1}for(let k=I;k<256;k++)B[k]=B[I-1];return B.join(",")},S=`g_${this.#s}_hcm_${t}_filter`,N=u.filter=this.#f(S);return this.#g(N),this.#m(w(b[0],A[0],5),w(b[1],A[1],5),w(b[2],A[2],5),N),u.url=this.#l(S),u.url}destroy(t=!1){t&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#i?.clear(),this.#i=null,this.#a=0)}#p(t){const e=this.#r.createElementNS(er,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#r.createElementNS(er,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#f(t){const e=this.#r.createElementNS(er,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#h(t,e,n){const s=this.#r.createElementNS(er,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)}#m(t,e,n,s){const o=this.#r.createElementNS(er,"feComponentTransfer");s.append(o),this.#h(o,"feFuncR",t),this.#h(o,"feFuncG",e),this.#h(o,"feFuncB",n)}#_(t,e){const n=this.#r.createElementNS(er,"feComponentTransfer");e.append(n),this.#h(n,"feFuncA",t)}#y(t){return this.#c.style.color=t,bp(getComputedStyle(this.#c).getPropertyValue("color"))}}class K1{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){pe("Abstract method `_fetch` called.")}}class S0 extends K1{async _fetch(t){const e=await fh(t,"arraybuffer");return new Uint8Array(e)}}class W1{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){pe("Abstract method `_fetch` called.")}}class T0 extends W1{async _fetch(t){const e=await fh(t,"arraybuffer");return new Uint8Array(e)}}Un&&jt("Please use the `legacy` build in Node.js environments.");async function Jv(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class GO extends $1{}class qO extends G1{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class $O extends q1{async _fetch(t){return Jv(t)}}class KO extends K1{async _fetch(t){return Jv(t)}}class WO extends W1{async _fetch(t){return Jv(t)}}const wn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Vy(i,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,n),i.clip(s)}class t_{isModifyingCurrentTransform(){return!1}getPattern(){pe("Abstract method `getPattern` called.")}}class YO extends t_{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,s){let o;if(s===wn.STROKE||s===wn.FILL){const l=e.current.getClippedPathBoundingBox(s,Re(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,h),m=f.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-l[0],-l[1]),n=St.transform(n,[1,0,0,1,l[0],l[1]]),m.transform(...e.baseTransform),this.matrix&&m.transform(...this.matrix),Vy(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),o=t.createPattern(f.canvas,"no-repeat");const v=new DOMMatrix(n);o.setTransform(v)}else Vy(t,this._bbox),o=this._createGradient(t);return o}}function Jg(i,t,e,n,s,o,l,u){const h=t.coords,f=t.colors,m=i.data,v=i.width*4;let b;h[e+1]>h[n+1]&&(b=e,e=n,n=b,b=o,o=l,l=b),h[n+1]>h[s+1]&&(b=n,n=s,s=b,b=l,l=u,u=b),h[e+1]>h[n+1]&&(b=e,e=n,n=b,b=o,o=l,l=b);const A=(h[e]+t.offsetX)*t.scaleX,w=(h[e+1]+t.offsetY)*t.scaleY,S=(h[n]+t.offsetX)*t.scaleX,N=(h[n+1]+t.offsetY)*t.scaleY,R=(h[s]+t.offsetX)*t.scaleX,V=(h[s+1]+t.offsetY)*t.scaleY;if(w>=V)return;const M=f[o],B=f[o+1],L=f[o+2],F=f[l],C=f[l+1],I=f[l+2],k=f[u],O=f[u+1],U=f[u+2],H=Math.round(w),j=Math.round(V);let _t,Pt,W,X,ut,xt,q,st;for(let ct=H;ct<=j;ct++){if(ct<N){const Ut=ct<w?0:(w-ct)/(w-N);_t=A-(A-S)*Ut,Pt=M-(M-F)*Ut,W=B-(B-C)*Ut,X=L-(L-I)*Ut}else{let Ut;ct>V?Ut=1:N===V?Ut=0:Ut=(N-ct)/(N-V),_t=S-(S-R)*Ut,Pt=F-(F-k)*Ut,W=C-(C-O)*Ut,X=I-(I-U)*Ut}let K;ct<w?K=0:ct>V?K=1:K=(w-ct)/(w-V),ut=A-(A-R)*K,xt=M-(M-k)*K,q=B-(B-O)*K,st=L-(L-U)*K;const ht=Math.round(Math.min(_t,ut)),Nt=Math.round(Math.max(_t,ut));let bt=v*ct+ht*4;for(let Ut=ht;Ut<=Nt;Ut++)K=(_t-Ut)/(_t-ut),K<0?K=0:K>1&&(K=1),m[bt++]=Pt-(Pt-xt)*K|0,m[bt++]=W-(W-q)*K|0,m[bt++]=X-(X-st)*K|0,m[bt++]=255}}function XO(i,t,e){const n=t.coords,s=t.colors;let o,l;switch(t.type){case"lattice":const u=t.verticesPerRow,h=Math.floor(n.length/u)-1,f=u-1;for(o=0;o<h;o++){let m=o*u;for(let v=0;v<f;v++,m++)Jg(i,e,n[m],n[m+1],n[m+u],s[m],s[m+1],s[m+u]),Jg(i,e,n[m+u+1],n[m+1],n[m+u],s[m+u+1],s[m+1],s[m+u])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)Jg(i,e,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class QO extends t_{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,m=Math.ceil(this._bounds[3])-h,v=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*t[1]*1.1)),3e3),A=f/v,w=m/b,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/w},N=v+4,R=b+4,V=n.getCanvas("mesh",N,R),M=V.context,B=M.createImageData(v,b);if(e){const F=B.data;for(let C=0,I=F.length;C<I;C+=4)F[C]=e[0],F[C+1]=e[1],F[C+2]=e[2],F[C+3]=255}for(const F of this._figures)XO(B,F,S);return M.putImageData(B,2,2),{canvas:V.canvas,offsetX:u-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,s){Vy(t,this._bbox);const o=new Float32Array(2);if(s===wn.SHADING)St.singularValueDecompose2dScale(Re(t),o);else if(this.matrix){St.singularValueDecompose2dScale(this.matrix,o);const[u,h]=o;St.singularValueDecompose2dScale(e.baseTransform,o),o[0]*=u,o[1]*=h}else St.singularValueDecompose2dScale(e.baseTransform,o);const l=this._createMeshCanvas(o,s===wn.SHADING?null:this._background,e.cachedCanvases);return s!==wn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class ZO extends t_{getPattern(){return"hotpink"}}function JO(i){switch(i[0]){case"RadialAxial":return new YO(i);case"Mesh":return new QO(i);case"Dummy":return new ZO}throw new Error(`Unknown IR type: ${i[0]}`)}const x0={COLORED:1,UNCOLORED:2};class e_{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:s,tilingType:o,color:l,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),vp("TilingType: "+o);const m=e[0],v=e[1],b=e[2],A=e[3],w=b-m,S=A-v,N=new Float32Array(2);St.singularValueDecompose2dScale(this.matrix,N);const[R,V]=N;St.singularValueDecompose2dScale(this.baseTransform,N);const M=R*N[0],B=V*N[1];let L=w,F=S,C=!1,I=!1;const k=Math.ceil(h*M),O=Math.ceil(f*B),U=Math.ceil(w*M),H=Math.ceil(S*B);k>=U?L=h:C=!0,O>=H?F=f:I=!0;const j=this.getSizeAndScale(L,this.ctx.canvas.width,M),_t=this.getSizeAndScale(F,this.ctx.canvas.height,B),Pt=t.cachedCanvases.getCanvas("pattern",j.size,_t.size),W=Pt.context,X=u.createCanvasGraphics(W);if(X.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(X,s,l),W.translate(-j.scale*m,-_t.scale*v),X.transform(j.scale,0,0,_t.scale,0,0),W.save(),this.clipBbox(X,m,v,b,A),X.baseTransform=Re(X.ctx),X.executeOperatorList(n),X.endDrawing(),W.restore(),C||I){const ut=Pt.canvas;C&&(L=h),I&&(F=f);const xt=this.getSizeAndScale(L,this.ctx.canvas.width,M),q=this.getSizeAndScale(F,this.ctx.canvas.height,B),st=xt.size,ct=q.size,K=t.cachedCanvases.getCanvas("pattern-workaround",st,ct),ht=K.context,Nt=C?Math.floor(w/h):0,bt=I?Math.floor(S/f):0;for(let Ut=0;Ut<=Nt;Ut++)for(let Qt=0;Qt<=bt;Qt++)ht.drawImage(ut,st*Ut,ct*Qt,st,ct,0,0,st,ct);return{canvas:K.canvas,scaleX:xt.scale,scaleY:q.scale,offsetX:m,offsetY:v}}return{canvas:Pt.canvas,scaleX:j.scale,scaleY:_t.scale,offsetX:m,offsetY:v}}getSizeAndScale(t,e,n){const s=Math.max(e_.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*n);return o>=s?o=s:n=o/t,{scale:n,size:o}}clipBbox(t,e,n,s,o){const l=s-e,u=o-n;t.ctx.rect(e,n,l,u),St.axialAlignedBoundingBox([e,n,s,o],Re(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const s=t.ctx,o=t.current;switch(e){case x0.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;s.fillStyle=o.fillColor=l,s.strokeStyle=o.strokeColor=u;break;case x0.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new vO(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,s){let o=n;s!==wn.SHADING&&(o=St.transform(o,e.baseTransform),this.matrix&&(o=St.transform(o,this.matrix)));const l=this.createPatternCanvas(e);let u=new DOMMatrix(o);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(u),h}}function tj({src:i,srcPos:t=0,dest:e,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=Sn.isLittleEndian?4278190080:255,[h,f]=l?[o,u]:[u,o],m=n>>3,v=n&7,b=i.length;e=new Uint32Array(e.buffer);let A=0;for(let w=0;w<s;w++){for(const N=t+m;t<N;t++){const R=t<b?i[t]:255;e[A++]=R&128?f:h,e[A++]=R&64?f:h,e[A++]=R&32?f:h,e[A++]=R&16?f:h,e[A++]=R&8?f:h,e[A++]=R&4?f:h,e[A++]=R&2?f:h,e[A++]=R&1?f:h}if(v===0)continue;const S=t<b?i[t++]:255;for(let N=0;N<v;N++)e[A++]=S&1<<7-N?f:h}return{srcPos:t,destPos:A}}const C0=16,R0=100,ej=15,I0=10,Xn=16,ty=new DOMMatrix,us=new Float32Array(2),Il=new Float32Array([1/0,1/0,-1/0,-1/0]);function nj(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},i.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},i.transform=function(e,n,s,o,l,u){t.transform(e,n,s,o,l,u),this.__originalTransform(e,n,s,o,l,u)},i.setTransform=function(e,n,s,o,l,u){t.setTransform(e,n,s,o,l,u),this.__originalSetTransform(e,n,s,o,l,u)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},i.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},i.bezierCurveTo=function(e,n,s,o,l,u){t.bezierCurveTo(e,n,s,o,l,u),this.__originalBezierCurveTo(e,n,s,o,l,u)},i.rect=function(e,n,s,o){t.rect(e,n,s,o),this.__originalRect(e,n,s,o)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class sj{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,n)):(s=this.canvasFactory.create(e,n),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Jd(i,t,e,n,s,o,l,u,h,f){const[m,v,b,A,w,S]=Re(i);if(v===0&&b===0){const V=l*m+w,M=Math.round(V),B=u*A+S,L=Math.round(B),F=(l+h)*m+w,C=Math.abs(Math.round(F)-M)||1,I=(u+f)*A+S,k=Math.abs(Math.round(I)-L)||1;return i.setTransform(Math.sign(m),0,0,Math.sign(A),M,L),i.drawImage(t,e,n,s,o,0,0,C,k),i.setTransform(m,v,b,A,w,S),[C,k]}if(m===0&&A===0){const V=u*b+w,M=Math.round(V),B=l*v+S,L=Math.round(B),F=(u+f)*b+w,C=Math.abs(Math.round(F)-M)||1,I=(l+h)*v+S,k=Math.abs(Math.round(I)-L)||1;return i.setTransform(0,Math.sign(v),Math.sign(b),0,M,L),i.drawImage(t,e,n,s,o,0,0,k,C),i.setTransform(m,v,b,A,w,S),[k,C]}i.drawImage(t,e,n,s,o,l,u,h,f);const N=Math.hypot(m,v),R=Math.hypot(b,A);return[N*h,R*f]}class N0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Dy;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=In.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e){this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Il.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=wn.FILL,e=null){const n=this.minMax.slice();if(t===wn.STROKE){e||pe("Stroke bounding box must include transform."),St.singularValueDecompose2dScale(e,us);const s=us[0]*this.lineWidth/2,o=us[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=St.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Il,0)}getClippedPathBoundingBox(t=wn.FILL,e=null){return St.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function k0(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,n=t.width,s=e%Xn,o=(e-s)/Xn,l=s===0?o:o+1,u=i.createImageData(n,Xn);let h=0,f;const m=t.data,v=u.data;let b,A,w,S;if(t.kind===gf.GRAYSCALE_1BPP){const N=m.byteLength,R=new Uint32Array(v.buffer,0,v.byteLength>>2),V=R.length,M=n+7>>3,B=4294967295,L=Sn.isLittleEndian?4278190080:255;for(b=0;b<l;b++){for(w=b<o?Xn:s,f=0,A=0;A<w;A++){const F=N-h;let C=0;const I=F>M?n:F*8-7,k=I&-8;let O=0,U=0;for(;C<k;C+=8)U=m[h++],R[f++]=U&128?B:L,R[f++]=U&64?B:L,R[f++]=U&32?B:L,R[f++]=U&16?B:L,R[f++]=U&8?B:L,R[f++]=U&4?B:L,R[f++]=U&2?B:L,R[f++]=U&1?B:L;for(;C<I;C++)O===0&&(U=m[h++],O=128),R[f++]=U&O?B:L,O>>=1}for(;f<V;)R[f++]=0;i.putImageData(u,0,b*Xn)}}else if(t.kind===gf.RGBA_32BPP){for(A=0,S=n*Xn*4,b=0;b<o;b++)v.set(m.subarray(h,h+S)),h+=S,i.putImageData(u,0,A),A+=Xn;b<l&&(S=n*s*4,v.set(m.subarray(h,h+S)),i.putImageData(u,0,A))}else if(t.kind===gf.RGB_24BPP)for(w=Xn,S=n*w,b=0;b<l;b++){for(b>=o&&(w=s,S=n*w),f=0,A=S;A--;)v[f++]=m[h++],v[f++]=m[h++],v[f++]=m[h++],v[f++]=255;i.putImageData(u,0,b*Xn)}else throw new Error(`bad image kind: ${t.kind}`)}function D0(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,s=e%Xn,o=(e-s)/Xn,l=s===0?o:o+1,u=i.createImageData(n,Xn);let h=0;const f=t.data,m=u.data;for(let v=0;v<l;v++){const b=v<o?Xn:s;({srcPos:h}=tj({src:f,srcPos:h,dest:m,width:n,height:b,nonBlackColor:0})),i.putImageData(u,0,v*Xn)}}function du(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)i[n]!==void 0&&(t[n]=i[n]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function tf(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function M0(i,t){if(t)return!0;St.singularValueDecompose2dScale(i,us);const e=Math.fround(Ti.pixelRatio*Gl.PDF_TO_CSS_UNITS);return us[0]<=e&&us[1]<=e}const ij=["butt","round","square"],rj=["miter","round","bevel"],aj={},P0={};class Ll{constructor(t,e,n,s,o,{optionalContentConfig:l,markedContentStack:u=null},h,f){this.ctx=t,this.current=new N0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new sj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Re(this.compositeCtx))}this.ctx.save(),tf(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Re(this.ctx)}executeOperatorList(t,e,n,s){const o=t.argsArray,l=t.fnArray;let u=e||0;const h=o.length;if(h===u)return u;const f=h-u>I0&&typeof n=="function",m=f?Date.now()+ej:0;let v=0;const b=this.commonObjs,A=this.objs;let w;for(;;){if(s!==void 0&&u===s.nextBreakPoint)return s.breakIt(u,n),u;if(w=l[u],w!==Ff.dependency)this[w].apply(this,o[u]);else for(const S of o[u]){const N=S.startsWith("g_")?b:A;if(!N.has(S))return N.get(S,n),u}if(u++,u===h)return u;if(f&&++v>I0){if(Date.now()>m)return n(),u;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,s=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=n,h=s,f="prescale1",m,v;for(;o>2&&u>1||l>2&&h>1;){let b=u,A=h;o>2&&u>1&&(b=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/b),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),m=this.cachedCanvases.getCanvas(f,b,A),v=m.context,v.clearRect(0,0,b,A),v.drawImage(t,0,0,u,h,0,0,b,A),t=m.canvas,u=b,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:n,height:s}=t,o=this.current.fillColor,l=this.current.patternFill,u=Re(e);let h,f,m,v;if((t.bitmap||t.data)&&t.count>1){const k=t.bitmap||t.data.buffer;f=JSON.stringify(l?u:[u.slice(0,4),o]),h=this._cachedBitmapsMap.get(k),h||(h=new Map,this._cachedBitmapsMap.set(k,h));const O=h.get(f);if(O&&!l){const U=Math.round(Math.min(u[0],u[2])+u[4]),H=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:O,offsetX:U,offsetY:H}}m=O}m||(v=this.cachedCanvases.getCanvas("maskCanvas",n,s),D0(v.context,t));let b=St.transform(u,[1/n,0,0,-1/s,0,0]);b=St.transform(b,[1,0,0,1,0,-s]);const A=Il.slice();St.axialAlignedBoundingBox([0,0,n,s],b,A);const[w,S,N,R]=A,V=Math.round(N-w)||1,M=Math.round(R-S)||1,B=this.cachedCanvases.getCanvas("fillCanvas",V,M),L=B.context,F=w,C=S;L.translate(-F,-C),L.transform(...b),m||(m=this._scaleImage(v.canvas,pi(L)),m=m.img,h&&l&&h.set(f,m)),L.imageSmoothingEnabled=M0(Re(L),t.interpolate),Jd(L,m,0,0,m.width,m.height,0,0,n,s),L.globalCompositeOperation="source-in";const I=St.transform(pi(L),[1,0,0,1,-F,-C]);return L.fillStyle=l?o.getPattern(e,this,I,wn.FILL):o,L.fillRect(0,0,n,s),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(f,B.canvas)),{canvas:B.canvas,offsetX:Math.round(F),offsetY:Math.round(C)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=ij[t]}setLineJoin(t){this.ctx.lineJoin=rj[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(t),n.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,n]of t)switch(e){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,t,e);this.suspendedCtx=this.ctx;const o=this.ctx=s.context;o.setTransform(this.suspendedCtx.getTransform()),du(this.suspendedCtx,o),nj(o,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),du(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,s){const o=s[0],l=s[1],u=s[2]-o,h=s[3]-l;u===0||h===0||(this.genericComposeSMask(e.context,n,u,h,e.subtype,e.backdrop,e.transferMap,o,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,s,o,l,u,h,f,m,v){let b=t.canvas,A=h-m,w=f-v;if(l)if(A<0||w<0||A+n>b.width||w+s>b.height){const N=this.cachedCanvases.getCanvas("maskExtension",n,s),R=N.context;R.drawImage(b,-A,-w),R.globalCompositeOperation="destination-atop",R.fillStyle=l,R.fillRect(0,0,n,s),R.globalCompositeOperation="source-over",b=N.canvas,A=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(A,w,n,s),t.clip(N),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(A,w,n,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,n,s),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(b,A,w,n,s,h,f,n,s),e.restore()}save(){this.inSMaskMode&&du(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&du(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,s,o,l){this.ctx.transform(t,e,n,s,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n){let[s]=e;if(!n){s||=e[0]=new Path2D,this[t](s);return}if(!(s instanceof Path2D)){const o=e[0]=new Path2D;for(let l=0,u=s.length;l<u;)switch(s[l++]){case Yd.moveTo:o.moveTo(s[l++],s[l++]);break;case Yd.lineTo:o.lineTo(s[l++],s[l++]);break;case Yd.curveTo:o.bezierCurveTo(s[l++],s[l++],s[l++],s[l++],s[l++],s[l++]);break;case Yd.closePath:o.closePath();break;default:jt(`Unrecognized drawing path operator: ${s[l-1]}`);break}s=o}St.axialAlignedBoundingBox(n,Re(this.ctx),this.current.minMax),this[t](s)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const n=this.ctx,s=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&s?.getPattern){const o=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=s.getPattern(n,this,pi(n),wn.STROKE),o){const l=new Path2D;l.addPath(t,n.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),n.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(wn.STROKE,Re(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;let l=!1;if(o){const h=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=s.getPattern(n,this,pi(n),wn.FILL),h){const f=new Path2D;f.addPath(t,n.getTransform().invertSelf().multiplySelf(h)),t=f}l=!0}const u=this.current.getClippedPathBoundingBox();this.contentVisible&&u!==null&&(this.pendingEOFill?(n.fill(t,"evenodd"),this.pendingEOFill=!1):n.fill(t)),l&&n.restore(),e&&this.consumePath(t,u)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=aj}eoClip(){this.pendingClip=P0}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const n=new Path2D,s=e.getTransform().invertSelf();for(const{transform:o,x:l,y:u,fontSize:h,path:f}of t)f&&n.addPath(f,new DOMMatrix(o).preMultiplySelf(s).translate(l,u).scale(h,-h));e.clip(n),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const n=this.commonObjs.get(t),s=this.current;if(!n)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=n.fontMatrix||Dy,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&jt("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=e,n.isType3Font)return;const o=n.loadedName||"sans-serif",l=n.systemFontInfo?.css||`"${o}", ${n.fallbackName}`;let u="normal";n.black?u="900":n.bold&&(u="bold");const h=n.italic?"italic":"normal";let f=e;e<C0?f=C0:e>R0&&(f=R0),this.current.fontSizeScale=e/f,this.ctx.font=`${h} ${u} ${f}px ${l}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,n){const s=new Path2D;return s.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),s}paintChar(t,e,n,s,o){const l=this.ctx,u=this.current,h=u.font,f=u.textRenderingMode,m=u.fontSize/u.fontSizeScale,v=f&In.FILL_STROKE_MASK,b=!!(f&In.ADD_TO_PATH_FLAG),A=u.patternFill&&!h.missingFile,w=u.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||b||A||w)&&!h.missingFile&&(S=h.getPathGenerator(this.commonObjs,t)),S&&(h.disableFontFace||A||w)){l.save(),l.translate(e,n),l.scale(m,-m);let N;if((v===In.FILL||v===In.FILL_STROKE)&&(s?(N=l.getTransform(),l.setTransform(...s),l.fill(this.#n(S,N,s))):l.fill(S)),v===In.STROKE||v===In.FILL_STROKE)if(o){N||=l.getTransform(),l.setTransform(...o);const{a:R,b:V,c:M,d:B}=N,L=St.inverseTransform(o),F=St.transform([R,V,M,B,0,0],L);St.singularValueDecompose2dScale(F,us),l.lineWidth*=Math.max(us[0],us[1])/m,l.stroke(this.#n(S,N,o))}else l.lineWidth/=m,l.stroke(S);l.restore()}else(v===In.FILL||v===In.FILL_STROKE)&&l.fillText(t,e,n),(v===In.STROKE||v===In.FILL_STROKE)&&l.strokeText(t,e,n);b&&(this.pendingTextPaths||=[]).push({transform:Re(l),x:e,y:n,fontSize:m,path:S})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){n=!0;break}return Gt(this,"isFontSubpixelAAEnabled",n)}showText(t){const e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(s===0)return;const o=this.ctx,l=e.fontSizeScale,u=e.charSpacing,h=e.wordSpacing,f=e.fontDirection,m=e.textHScale*f,v=t.length,b=n.vertical,A=b?1:-1,w=n.defaultVMetrics,S=s*e.fontMatrix[0],N=e.textRenderingMode===In.FILL&&!n.disableFontFace&&!e.patternFill;o.save(),e.textMatrix&&o.transform(...e.textMatrix),o.translate(e.x,e.y+e.textRise),f>0?o.scale(m,-1):o.scale(m,1);let R,V;if(e.patternFill){o.save();const C=e.fillColor.getPattern(o,this,pi(o),wn.FILL);R=Re(o),o.restore(),o.fillStyle=C}if(e.patternStroke){o.save();const C=e.strokeColor.getPattern(o,this,pi(o),wn.STROKE);V=Re(o),o.restore(),o.strokeStyle=C}let M=e.lineWidth;const B=e.textMatrixScale;if(B===0||M===0){const C=e.textRenderingMode&In.FILL_STROKE_MASK;(C===In.STROKE||C===In.FILL_STROKE)&&(M=this.getSinglePixelWidth())}else M/=B;if(l!==1&&(o.scale(l,l),M/=l),o.lineWidth=M,n.isInvalidPDFjsFont){const C=[];let I=0;for(const k of t)C.push(k.unicode),I+=k.width;o.fillText(C.join(""),0,0),e.x+=I*S*m,o.restore(),this.compose();return}let L=0,F;for(F=0;F<v;++F){const C=t[F];if(typeof C=="number"){L+=A*C*s/1e3;continue}let I=!1;const k=(C.isSpace?h:0)+u,O=C.fontChar,U=C.accent;let H,j,_t=C.width;if(b){const W=C.vmetric||w,X=-(C.vmetric?W[1]:_t*.5)*S,ut=W[2]*S;_t=W?-W[0]:_t,H=X/l,j=(L+ut)/l}else H=L/l,j=0;if(n.remeasure&&_t>0){const W=o.measureText(O).width*1e3/s*l;if(_t<W&&this.isFontSubpixelAAEnabled){const X=_t/W;I=!0,o.save(),o.scale(X,1),H/=X}else _t!==W&&(H+=(_t-W)/2e3*s/l)}if(this.contentVisible&&(C.isInFont||n.missingFile)){if(N&&!U)o.fillText(O,H,j);else if(this.paintChar(O,H,j,R,V),U){const W=H+s*U.offset.x/l,X=j-s*U.offset.y/l;this.paintChar(U.fontChar,W,X,R,V)}}const Pt=b?_t*S-k*f:_t*S+k*f;L+=Pt,I&&o.restore()}b?e.y-=L:e.x+=L*m,o.restore(),this.compose()}showType3Text(t){const e=this.ctx,n=this.current,s=n.font,o=n.fontSize,l=n.fontDirection,u=s.vertical?1:-1,h=n.charSpacing,f=n.wordSpacing,m=n.textHScale*l,v=n.fontMatrix||Dy,b=t.length,A=n.textRenderingMode===In.INVISIBLE;let w,S,N,R;if(!(A||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),n.textMatrix&&e.transform(...n.textMatrix),e.translate(n.x,n.y+n.textRise),e.scale(m,l),w=0;w<b;++w){if(S=t[w],typeof S=="number"){R=u*S*o/1e3,this.ctx.translate(R,0),n.x+=R*m;continue}const V=(S.isSpace?f:0)+h,M=s.charProcOperatorList[S.operatorListId];M?this.contentVisible&&(this.save(),e.scale(o,o),e.transform(...v),this.executeOperatorList(M),this.restore()):jt(`Type3 character "${S.operatorListId}" is not available.`);const B=[S.width,0];St.applyTransform(B,v),N=B[0]*o+V,e.translate(N,0),n.x+=N*m}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,n,s,o,l){const u=new Path2D;u.rect(n,s,o-n,l-s),this.ctx.clip(u),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const n=this.baseTransform||Re(this.ctx),s={createCanvasGraphics:o=>new Ll(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new e_(t,this.ctx,s,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let n;return this.cachedPatterns.has(t)?n=this.cachedPatterns.get(t):(n=JO(this.getObject(t)),this.cachedPatterns.set(t,n)),e&&(n.matrix=e),n}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const n=this._getPattern(t);e.fillStyle=n.getPattern(e,this,pi(e),wn.SHADING);const s=pi(e);if(s){const{width:o,height:l}=e.canvas,u=Il.slice();St.axialAlignedBoundingBox([0,0,o,l],s,u);const[h,f,m,v]=u;this.ctx.fillRect(h,f,m-h,v-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){pe("Should not call beginInlineImage")}beginImageData(){pe("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Re(this.ctx),e)){St.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[n,s,o,l]=e,u=new Path2D;u.rect(n,s,o-n,l-s),this.ctx.clip(u),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||vp("TODO: Support non-isolated groups."),t.knockout&&jt("Knockout groups not supported.");const n=Re(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=Il.slice();St.axialAlignedBoundingBox(t.bbox,Re(e),s);const o=[0,0,e.canvas.width,e.canvas.height];s=St.intersect(s,o)||[0,0,0,0];const l=Math.floor(s[0]),u=Math.floor(s[1]),h=Math.max(Math.ceil(s[2])-l,1),f=Math.max(Math.ceil(s[3])-u,1);this.current.startNewPathAndClipBox([0,0,h,f]);let m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,h,f),b=v.context;b.translate(-l,-u),b.transform(...n);let A=new Path2D;const[w,S,N,R]=t.bbox;if(A.rect(w,S,N-w,R-S),t.matrix){const V=new Path2D;V.addPath(A,new DOMMatrix(t.matrix)),A=V}b.clip(A),t.smask?this.smaskStack.push({canvas:v.canvas,context:b,offsetX:l,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,u),e.save()),du(e,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=Re(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const o=Il.slice();St.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s,o),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,n,s,o){if(this.#t(),tf(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const l=e[2]-e[0],u=e[3]-e[1];if(o&&this.annotationCanvasMap){n=n.slice(),n[4]-=e[0],n[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=l,e[3]=u,St.singularValueDecompose2dScale(Re(this.ctx),us);const{viewportScale:h}=this,f=Math.ceil(l*this.outputScaleX*h),m=Math.ceil(u*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(f,m);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(t,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(us[0],0,0,-us[1],0,u*us[1]),tf(this.ctx)}else{tf(this.ctx),this.endPath();const h=new Path2D;h.rect(e[0],e[1],l,u),this.ctx.clip(h)}}this.current=new N0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const n=this.ctx,s=this._createMaskCanvas(t),o=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(o,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n=0,s=0,o,l){if(!this.contentVisible)return;t=this.getObject(t.data,t);const u=this.ctx;u.save();const h=Re(u);u.transform(e,n,s,o,0,0);const f=this._createMaskCanvas(t);u.setTransform(1,0,0,1,f.offsetX-h[4],f.offsetY-h[5]);for(let m=0,v=l.length;m<v;m+=2){const b=St.transform(h,[e,n,s,o,l[m],l[m+1]]);u.drawImage(f.canvas,b[4],b[5])}u.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const o of t){const{data:l,width:u,height:h,transform:f}=o,m=this.cachedCanvases.getCanvas("maskCanvas",u,h),v=m.context;v.save();const b=this.getObject(l,o);D0(v,b),v.globalCompositeOperation="source-in",v.fillStyle=s?n.getPattern(v,this,pi(e),wn.FILL):n,v.fillRect(0,0,u,h),v.restore(),e.save(),e.transform(...f),e.scale(1,-1),Jd(e,m.canvas,0,0,u,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){jt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,n,s){if(!this.contentVisible)return;const o=this.getObject(t);if(!o){jt("Dependent image isn't ready yet");return}const l=o.width,u=o.height,h=[];for(let f=0,m=s.length;f<m;f+=2)h.push({transform:[e,0,0,n,s[f],s[f+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(o,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:s}=t,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,n=t.height,s=this.ctx;this.save();const{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none"),s.scale(1/e,-1/n);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",e,n).context;k0(f,t),l=this.applyTransferMapsToCanvas(f)}const u=this._scaleImage(l,pi(s));s.imageSmoothingEnabled=M0(Re(s),t.interpolate),Jd(s,u.img,0,0,u.paintWidth,u.paintHeight,0,-n,e,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const o=t.width,l=t.height,h=this.cachedCanvases.getCanvas("inlineImage",o,l).context;k0(h,t),s=this.applyTransferMapsToCanvas(h)}for(const o of e)n.save(),n.transform(...o.transform),n.scale(1,-1),Jd(n,s,o.x,o.y,o.w,o.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(n||(this.pendingClip===P0?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Re(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:s,d:o}=this.ctx.getTransform();let l,u;if(n===0&&s===0){const h=Math.abs(e),f=Math.abs(o);if(h===f)if(t===0)l=u=1/h;else{const m=h*t;l=u=m<1?1/m:1}else if(t===0)l=1/h,u=1/f;else{const m=h*t,v=f*t;l=m<1?1/m:1,u=v<1?1/v:1}}else{const h=Math.abs(e*o-n*s),f=Math.hypot(e,n),m=Math.hypot(s,o);if(t===0)l=m/h,u=f/h;else{const v=t*h;l=m>v?m/v:1,u=f>v?f/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:s}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(s||1)*o,n.stroke(t);return}const u=n.getLineDash();e&&n.save(),n.scale(o,l),ty.a=1/o,ty.d=1/l;const h=new Path2D;if(h.addPath(t,ty),u.length>0){const f=Math.max(o,l);n.setLineDash(u.map(m=>m/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const i in Ff)Ll.prototype[i]!==void 0&&(Ll.prototype[Ff[i]]=Ll.prototype[i]);class Ol{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class oj{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Tl=Symbol("INTERNAL");class lj{#t=!1;#e=!1;#n=!1;#s=!0;constructor(t,{name:e,intent:n,usage:s,rbGroups:o}){this.#t=!!(t&cs.DISPLAY),this.#e=!!(t&cs.PRINT),this.name=e,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(this.#n)return this.#s;if(!this.#s)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==Tl&&pe("Internal method `_setVisible` called."),this.#n=n,this.#s=e}}class cj{#t=null;#e=new Map;#n=null;#s=null;constructor(t,e=cs.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#s=t.order;for(const n of t.groups)this.#e.set(n.id,new lj(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(Tl,!1);for(const n of t.on)this.#e.get(n)._setVisible(Tl,!0);for(const n of t.off)this.#e.get(n)._setVisible(Tl,!1);this.#n=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let s=1;s<e;s++){const o=t[s];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return jt(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return vp("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(jt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return jt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return jt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return jt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return jt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return jt(`Unknown optional content policy ${t.policy}.`),!0}return jt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const s=this.#e.get(t);if(!s){jt(`Optional content group not found: ${t}`);return}if(n&&e&&s.rbGroups.length)for(const o of s.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(Tl,!1,!0);s._setVisible(Tl,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#e.get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new z1;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class uj{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Ze(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(n),!0)});Ze(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ze(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new hj(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new dj(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class hj{constructor(t,e,n=!1,s=null){this._stream=t,this._done=n||!1,this._filename=Yv(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dj{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function fj(i){let t=!0,e=n("filename\\*","i").exec(i);if(e){e=e[1];let m=u(e);return m=unescape(m),m=h(m),m=f(m),o(m)}if(e=l(i),e){const m=f(e);return o(m)}if(e=n("filename","i").exec(i),e){e=e[1];let m=u(e);return m=f(m),o(m)}function n(m,v){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function s(m,v){if(m){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const b=new TextDecoder(m,{fatal:!0}),A=dh(v);v=b.decode(A),t=!1}catch{}}return v}function o(m){return t&&/[\x80-\xff]/.test(m)&&(m=s("utf-8",m),t&&(m=s("iso-8859-1",m))),m}function l(m){const v=[];let b;const A=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=A.exec(m))!==null;){let[,S,N,R]=b;if(S=parseInt(S,10),S in v){if(S===0)break;continue}v[S]=[N,R]}const w=[];for(let S=0;S<v.length&&S in v;++S){let[N,R]=v[S];R=u(R),N&&(R=unescape(R),S===0&&(R=h(R))),w.push(R)}return w.join("")}function u(m){if(m.startsWith('"')){const v=m.slice(1).split('\\"');for(let b=0;b<v.length;++b){const A=v[b].indexOf('"');A!==-1&&(v[b]=v[b].slice(0,A),v.length=b+1),v[b]=v[b].replaceAll(/\\(.)/g,"$1")}m=v.join('"')}return m}function h(m){const v=m.indexOf("'");if(v===-1)return m;const b=m.slice(0,v),w=m.slice(v+1).replace(/^[^']*'/,"");return s(b,w)}function f(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,b,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,N){return String.fromCharCode(parseInt(N,16))}),s(b,w);try{w=atob(w)}catch{}return s(b,w)})}return""}function Y1(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const n in t){const s=t[n];s!==void 0&&e.append(n,s)}return e}function Ep(i){return URL.parse(i)?.origin??null}function X1({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(i.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*e)||n||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Q1(i){const t=i.get("Content-Disposition");if(t){let e=fj(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Yv(e))return e}return null}function gh(i,t){return new Bf(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function Z1(i){return i===200||i===206}function J1(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function tx(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(jt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class pj{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Y1(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new mj(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new gj(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class mj{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),s=e.url;fetch(s,J1(n,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=Ep(o.url),!Z1(o.status))throw gh(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:u,suggestedLength:h}=X1({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Q1(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new da("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:tx(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class gj{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${e}-${n-1}`);const l=s.url;fetch(l,J1(o,this._withCredentials,this._abortController)).then(u=>{const h=Ep(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Z1(u.status))throw gh(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:tx(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const ey=200,ny=206;function yj(i){const t=i.response;return typeof t!="string"?t:dh(t).buffer}class vj{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Y1(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[o,l]of this.headers)e.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=ny):s.expectedStatus=ey,e.responseType="arraybuffer",Ze(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||ey;if(!(o===ey&&n.expectedStatus===ny)&&o!==n.expectedStatus){n.onError(s.status);return}const u=yj(s);if(o===ny){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:u}):(jt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class _j{constructor(t){this._source=t,this._manager=new vj(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ze(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new bj(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new Aj(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class bj{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Ep(e.responseURL);const n=e.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=X1({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Q1(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=gh(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Aj{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Ep(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=gh(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Ej=/^[a-z][a-z0-9\-+.]+:/i;function wj(i){if(Ej.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class Sj{constructor(t){this.source=t,this.url=wj(t.url),Ze(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Tj(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new xj(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Tj{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=gh(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new da("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class xj{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const fu=Symbol("INITIAL_DATA");class ex{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:fu}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const n=this.#t[t];if(!n||n.data===fu)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==fu}delete(t){const e=this.#t[t];return!e||e.data===fu?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==fu&&(yield[t,e])}}}const Cj=1e5,L0=30;class Vn{#t=Promise.withResolvers();#e=null;#n=!1;#s=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#a=0;#o=0;#u=null;#c=null;#d=0;#l=0;#p=Object.create(null);#g=[];#f=null;#h=[];#m=new WeakMap;#_=null;static#y=new Map;static#A=new Map;static#E=new WeakMap;static#v=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#f=t;else if(typeof t=="object")this.#f=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#l=n.scale*Ti.pixelRatio,this.#d=n.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:l,pageY:u}=n.rawDims;this.#_=[1,0,0,-1,-l,u+o],this.#o=s,this.#a=o,Vn.#x(),vo(e,n),this.#t.promise.finally(()=>{Vn.#S.delete(this),this.#i=null,this.#p=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Sn.platform;return Gt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#u.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#p,e.styles),this.#I(e.items),t()},this.#t.reject)};return this.#u=this.#f.getReader(),Vn.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*Ti.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,vo(this.#c,{rotation:s})),n!==this.#l){e?.(),this.#l=n;const o={div:null,properties:null,ctx:Vn.#R(this.#r)};for(const l of this.#h)o.properties=this.#m.get(l),o.div=l,this.#N(o)}}cancel(){const t=new da("TextLayer task cancelled.");this.#u?.cancel(t).catch(()=>{}),this.#u=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#I(t){if(this.#n)return;this.#i.ctx??=Vn.#R(this.#r);const e=this.#h,n=this.#g;for(const s of t){if(e.length>Cj){jt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),o.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(s.str),this.#w(s)}}#w(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const s=St.transform(this.#_,t.transform);let o=Math.atan2(s[1],s[0]);const l=this.#p[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#s&&l.fontSubstitution||l.fontFamily;u=Vn.fontFamilyMap.get(u)||u;const h=Math.hypot(s[2],s[3]),f=h*Vn.#D(u,l,this.#r);let m,v;o===0?(m=s[4],v=s[5]-f):(m=s[4]+f*Math.sin(o),v=s[5]-f*Math.cos(o));const b="calc(var(--total-scale-factor) *",A=e.style;this.#e===this.#c?(A.left=`${(100*m/this.#o).toFixed(2)}%`,A.top=`${(100*v/this.#a).toFixed(2)}%`):(A.left=`${b}${m.toFixed(2)}px)`,A.top=`${b}${v.toFixed(2)}px)`),A.fontSize=`${b}${(Vn.#v*h).toFixed(2)}px)`,A.fontFamily=u,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#s&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(n.angle=o*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),N=Math.abs(t.transform[3]);S!==N&&Math.max(S,N)/Math.min(S,N)>1.5&&(w=!0)}if(w&&(n.canvasWidth=l.vertical?t.height:t.width),this.#m.set(e,n),this.#i.div=e,this.#i.properties=n,this.#N(this.#i),n.hasText&&this.#e.append(e),n.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#N(t){const{div:e,properties:n,ctx:s}=t,{style:o}=e;let l="";if(Vn.#v>1&&(l=`scale(${1/Vn.#v})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=o,{canvasWidth:h,fontSize:f}=n;Vn.#C(s,f*this.#l,u);const{width:m}=s.measureText(e.textContent);m>0&&(l=`scaleX(${h*this.#l/m}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#S.size>0)){this.#y.clear();for(const{canvas:t}of this.#A.values())t.remove();this.#A.clear()}}static#R(t=null){let e=this.#A.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#A.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#C(t,e,n){const s=this.#E.get(t);e===s.size&&n===s.family||(t.font=`${e}px ${n}`,s.size=e,s.family=n)}static#x(){if(this.#v!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#v=t.getBoundingClientRect().height,t.remove()}static#D(t,e,n){const s=this.#y.get(t);if(s)return s;const o=this.#R(n);o.canvas.width=o.canvas.height=L0,this.#C(o,L0,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return u?f=u/(u+h):(Sn.platform.isFirefox&&jt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#y.set(t,f),f}}class qu{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function s(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(qu.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&e.push({str:l}),!!o.children)for(const h of o.children)s(h)}return s(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Rj=100;function nx(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new n_,{docId:e}=t,n=i.url?jO(i.url):null,s=i.data?VO(i.data):null,o=i.httpHeaders||null,l=i.withCredentials===!0,u=i.password??null,h=i.range instanceof sx?i.range:null,f=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let m=i.worker instanceof $u?i.worker:null;const v=i.verbosity,b=typeof i.docBaseUrl=="string"&&!_p(i.docBaseUrl)?i.docBaseUrl:null,A=Qd(i.cMapUrl),w=i.cMapPacked!==!1,S=i.CMapReaderFactory||(Un?$O:w0),N=Qd(i.iccUrl),R=Qd(i.standardFontDataUrl),V=i.StandardFontDataFactory||(Un?KO:S0),M=Qd(i.wasmUrl),B=i.WasmFactory||(Un?WO:T0),L=i.stopAtErrors!==!0,F=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,C=i.isEvalSupported!==!1,I=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Un,k=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Un&&(Sn.platform.isFirefox||!globalThis.chrome),O=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,U=typeof i.disableFontFace=="boolean"?i.disableFontFace:Un,H=i.fontExtraProperties===!0,j=i.enableXfa===!0,_t=i.ownerDocument||globalThis.document,Pt=i.disableRange===!0,W=i.disableStream===!0,X=i.disableAutoFetch===!0,ut=i.pdfBug===!0,xt=i.CanvasFactory||(Un?qO:zO),q=i.FilterFactory||(Un?GO:HO),st=i.enableHWA===!0,ct=i.useWasm!==!1,K=h?h.length:i.length??NaN,ht=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Un&&!U,Nt=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(S===w0&&V===S0&&B===T0&&A&&R&&M&&wu(A,document.baseURI)&&wu(R,document.baseURI)&&wu(M,document.baseURI)),bt=null;mO(v);const Ut={canvasFactory:new xt({ownerDocument:_t,enableHWA:st}),filterFactory:new q({docId:e,ownerDocument:_t}),cMapReaderFactory:Nt?null:new S({baseUrl:A,isCompressed:w}),standardFontDataFactory:Nt?null:new V({baseUrl:R}),wasmFactory:Nt?null:new B({baseUrl:M})};m||(m=$u.create({verbosity:v,port:Ol.workerPort}),t._worker=m);const Qt={docId:e,apiVersion:"5.4.54",data:s,password:u,disableAutoFetch:X,rangeChunkSize:f,length:K,docBaseUrl:b,enableXfa:j,evaluatorOptions:{maxImageSize:F,disableFontFace:U,ignoreErrors:L,isEvalSupported:C,isOffscreenCanvasSupported:I,isImageDecoderSupported:k,canvasMaxAreaInBytes:O,fontExtraProperties:H,useSystemFonts:ht,useWasm:ct,useWorkerFetch:Nt,cMapUrl:A,iccUrl:N,standardFontDataUrl:R,wasmUrl:M}},Hn={ownerDocument:_t,pdfBug:ut,styleElement:bt,loadingParams:{disableAutoFetch:X,enableXfa:j}};return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const ps=m.messageHandler.sendWithPromise("GetDocRequest",Qt,s?[s.buffer]:null);let Mn;if(h)Mn=new uj(h,{disableRange:Pt,disableStream:W});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ft=wu(n)?pj:Un?Sj:_j;Mn=new ft({url:n,length:K,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:Pt,disableStream:W})}return ps.then(ft=>{if(t.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const Bt=new Su(e,ft,m.port),me=new kj(Bt,t,Mn,Hn,Ut,st);t._transport=me,Bt.send("Ready",null)})}).catch(t._capability.reject),t}class n_{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${n_.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class sx{#t=Promise.withResolvers();#e=[];#n=[];#s=[];#r=[];constructor(t,e,n=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#s.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#r)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#s)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){pe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Ij{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Nj{#t=!1;constructor(t,e,n,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=s?new b0:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new ex,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new ph({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Gt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:s="display",annotationMode:o=Zr.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:m=null,printAnnotationStorage:v=null,isEditing:b=!1}){this._stats?.time("Overall");const A=this._transport.getRenderingIntent(s,o,v,b),{renderingIntent:w,cacheKey:S}=A;this.#t=!1,h||=this._transport.getOptionalContentConfig(w);let N=this._intentStates.get(S);N||(N=Object.create(null),this._intentStates.set(S,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const R=!!(w&cs.PRINT);N.displayReadyCapability||(N.displayReadyCapability=Promise.withResolvers(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(A));const V=L=>{N.renderTasks.delete(M),R&&(this.#t=!0),this.#e(),L?(M.capability.reject(L),this._abortOperatorList({intentState:N,reason:L instanceof Error?L:new Error(L)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new Nl({callback:V,params:{canvas:e,canvasContext:t,viewport:n,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!R,pdfBug:this._pdfBug,pageColors:m,enableHWA:this._transport.enableHWA});(N.renderTasks||=new Set).add(M);const B=M.task;return Promise.all([N.displayReadyCapability.promise,h]).then(([L,F])=>{if(this.destroyed){V();return}if(this._stats?.time("Rendering"),!(F.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:L,optionalContentConfig:F}),M.operatorListChanged()}).catch(V),B}getOperatorList({intent:t="display",annotationMode:e=Zr.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,s,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>qu.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,s){function o(){l.read().then(function({value:h,done:f}){if(f){n(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),o()},s)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new b0),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,s=t.length;n<s;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:s},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const m=()=>{h.read().then(({value:v,done:b})=>{if(b){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,f),m())},v=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const b of f.renderTasks)b.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(v);else if(f.opListReadCapability)f.opListReadCapability.reject(v);else throw v}})};m()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Wv){let s=Rj;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new da(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Jr,Bs,sr,ao,Hf,oo,lo,Bn,yf,ix,rx,Tu,jl,vf;const Se=class Se{constructor({name:t=null,port:e=null,verbosity:n=gO()}={}){di(this,Bn);di(this,Jr,Promise.withResolvers());di(this,Bs,null);di(this,sr,null);di(this,ao,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(we(Se,lo).has(e))throw new Error("Cannot use more than one PDFWorker per port.");we(Se,lo).set(e,this),fi(this,Bn,ix).call(this,e)}else fi(this,Bn,rx).call(this)}get promise(){return we(this,Jr).promise}get port(){return we(this,sr)}get messageHandler(){return we(this,Bs)}destroy(){this.destroyed=!0,we(this,ao)?.terminate(),Wn(this,ao,null),we(Se,lo).delete(we(this,sr)),Wn(this,sr,null),we(this,Bs)?.destroy(),Wn(this,Bs,null)}static create(t){const e=we(this,lo).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Se(t)}static get workerSrc(){if(Ol.workerSrc)return Ol.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Gt(this,"_setupFakeWorkerGlobal",(async()=>we(this,jl,vf)?we(this,jl,vf):(await import(this.workerSrc)).WorkerMessageHandler)())}};Jr=new WeakMap,Bs=new WeakMap,sr=new WeakMap,ao=new WeakMap,Hf=new WeakMap,oo=new WeakMap,lo=new WeakMap,Bn=new WeakSet,yf=function(){we(this,Jr).resolve(),we(this,Bs).send("configure",{verbosity:this.verbosity})},ix=function(t){Wn(this,sr,t),Wn(this,Bs,new Su("main","worker",t)),we(this,Bs).on("ready",()=>{}),fi(this,Bn,yf).call(this)},rx=function(){if(we(Se,oo)||we(Se,jl,vf)){fi(this,Bn,Tu).call(this);return}let{workerSrc:t}=Se;try{Se._isSameOrigin(window.location,t)||(t=Se._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Su("main","worker",e),s=()=>{o.abort(),n.destroy(),e.terminate(),this.destroyed?we(this,Jr).reject(new Error("Worker was destroyed")):fi(this,Bn,Tu).call(this)},o=new AbortController;e.addEventListener("error",()=>{we(this,ao)||s()},{signal:o.signal}),n.on("test",u=>{if(o.abort(),this.destroyed||!u){s();return}Wn(this,Bs,n),Wn(this,sr,e),Wn(this,ao,e),fi(this,Bn,yf).call(this)}),n.on("ready",u=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{fi(this,Bn,Tu).call(this)}});const l=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};l();return}catch{vp("The worker has been disabled.")}fi(this,Bn,Tu).call(this)},Tu=function(){we(Se,oo)||(jt("Setting up fake worker."),Wn(Se,oo,!0)),Se._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){we(this,Jr).reject(new Error("Worker was destroyed"));return}const e=new BO;Wn(this,sr,e);const n=`fake${bE(Se,Hf)._++}`,s=new Su(n+"_worker",n,e);t.setup(s,e),Wn(this,Bs,new Su(n,n+"_worker",e)),fi(this,Bn,yf).call(this)}).catch(t=>{we(this,Jr).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},jl=new WeakSet,vf=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},di(Se,jl),di(Se,Hf,0),di(Se,oo,!1),di(Se,lo,new WeakMap),Un&&(Wn(Se,oo,!0),Ol.workerSrc||="./pdf.worker.mjs"),Se._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const s=new URL(e,n);return n.origin===s.origin},Se._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Se.fromPort=t=>{if(RO("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Se.create(t)};let $u=Se;class kj{#t=new Map;#e=new Map;#n=new Map;#s=new Map;#r=null;constructor(t,e,n,s,o,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new ex,this.fontLoader=new LO({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#i(t,e=null){const n=this.#t.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Gt(this,"annotationStorage",new Zv)}getRenderingIntent(t,e=Zr.ENABLE,n=null,s=!1,o=!1){let l=cs.DISPLAY,u=Oy;switch(t){case"any":l=cs.ANY;break;case"display":break;case"print":l=cs.PRINT;break;default:jt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&cs.PRINT&&n instanceof H1?n:this.annotationStorage;switch(e){case Zr.DISABLE:l+=cs.ANNOTATIONS_DISABLE;break;case Zr.ENABLE:break;case Zr.ENABLE_FORMS:l+=cs.ANNOTATIONS_FORMS;break;case Zr.ENABLE_STORAGE:l+=cs.ANNOTATIONS_STORAGE,u=h.serializable;break;default:jt(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(l+=cs.IS_EDITING),o&&(l+=cs.OPLIST);const{ids:f,hash:m}=h.modifiedIds,v=[l,u.hash,m];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#n.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Vn.cleanup(),this._networkStream?.cancelAllRequests(new da("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,s)=>{Ze(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}Ze(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:l}=this._fullReader;return(!s||!o)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(n,s)=>{Ze(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){s.close();return}Ze(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new Ij(n,this))}),t.on("DocException",n=>{e._capability.reject(Yn(n))}),t.on("PasswordRequest",n=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw Yn(n);const s=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};e.onPassword(s,n.code)}catch(s){this.#r.reject(s)}return this.#r.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const f=o.error;jt(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,m)=>globalThis.FontInspector.fontAdded(f,m):null,u=new OO(o,l);this.fontLoader.bind(u).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!u.fontExtraProperties&&u.data&&(u.data=null),this.commonObjs.resolve(n,u)});break;case"CopyLocalImage":const{imageRef:h}=o;Ze(h,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,m]of f.objs)if(m?.ref===h)return m.dataLen?(this.commonObjs.resolve(n,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([n,s,o,l])=>{if(this.destroyed)return;const u=this.#e.get(s);if(!u.objs.has(n)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&jt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#n.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#s.set(o.refStr,t);const l=new Nj(e,o,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#n.set(e,s),s}getPageIndex(t){return jy(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#i("GetOptionalContentConfig").then(e=>new cj(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new oj(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Vn.cleanup()}}cachedPageNumber(t){if(!jy(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#s.get(e)??null}}class Dj{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Nl{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:m=!1,pdfBug:v=!1,pageColors:b=null,enableHWA:A=!1}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=v,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Dj(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Nl.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Nl.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ll(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Nl.#e.delete(this._canvas),t||=new Wv(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Nl.#e.delete(this._canvas),this.callback())))}}const Mj="5.4.54",Pj="295fb3ec4";class Is{#t=null;#e=null;#n;#s=null;#r=!1;#i=!1;#a=null;#o;#u=null;#c=null;static#d=null;static get _keyboardManager(){return Gt(this,"_keyboardManager",new mh([[["Escape","mac+Escape"],Is.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Is.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Is.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Is.prototype._moveToPrevious],[["Home","mac+Home"],Is.prototype._moveToBeginning],[["End","mac+End"],Is.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#i=!1,this.#a=t):this.#i=!0,this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Is.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#c._signal;t.addEventListener("click",this.#f.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,t.append(n),t}renderMainDropdown(){const t=this.#s=this.#l();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#l(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",Ms,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[n,s]of this.#c.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",Is.#d[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.ariaSelected=s===this.#n,o.addEventListener("click",this.#p.bind(this,s),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#p(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Xt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#f(t);return}const e=t.target.getAttribute("data-color");e&&this.#p(e,t)}_moveToNext(t){if(!this.#m){this.#f(t);return}if(t.target===this.#t){this.#s.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#s?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#f(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#f(t);return}this.#s.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#f(t);return}this.#s.lastChild?.focus()}#g(t){Is._keyboardManager.exec(this,t)}#f(t){if(this.#m){this.hideDropdown();return}if(this.#r=t.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#t.ariaExpanded="true",this.#s){this.#s.classList.remove("hidden");return}const e=this.#s=this.#l();this.#t.append(e)}#h(t){this.#s?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#u?.abort(),this.#u=null}get#m(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#m){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#s)return;const e=this.#c.highlightColors.values();for(const n of this.#s.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#s?.remove(),this.#s=null}}class Ku{#t=null;#e=null;#n=null;static#s=null;constructor(t){this.#e=t,this.#n=t._uiManager,Ku.#s||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:n}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Ku.#s[t]),s.addEventListener("input",()=>{this.#n.updateParams(e,s.value)},{signal:this.#n._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function O0(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function pu(i){return Math.max(0,Math.min(255,255*i))}class j0{static CMYK_G([t,e,n,s]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=pu(t),[t,t,t]}static G_HTML([t]){const e=O0(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(pu)}static RGB_HTML(t){return`#${t.map(O0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,n+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,n,s]){return[pu(1-Math.min(1,t+s)),pu(1-Math.min(1,n+s)),pu(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const s=1-t,o=1-e,l=1-n,u=Math.min(s,o,l);return["CMYK",s,o,l,u]}}class Lj{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){pe("Abstract method `_createSVG` called.")}}class zf extends Lj{_createSVG(t){return document.createElementNS(er,t)}}class ax{static setupStorage(t,e,n,s,o){const l=s.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{s.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of n.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:s,linkService:o}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&o.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,s=t.xfaHtml,o=t.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const u=o!=="richText",h=t.div;if(h.append(l),t.viewport){const v=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=v}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const v=document.createTextNode(s.value);l.append(v),u&&qu.shouldBuildText(s.name)&&f.push(v)}return{textDivs:f}}const m=[[s,-1,l]];for(;m.length>0;){const[v,b,A]=m.at(-1);if(b+1===v.children.length){m.pop();continue}const w=v.children[++m.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const R=document.createTextNode(w.value);f.push(R),A.append(R);continue}const N=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(A.append(N),w.attributes&&this.setAttributes({html:N,element:w,storage:e,intent:o,linkService:n}),w.children?.length>0)m.push([w,-1,N]);else if(w.value){const R=document.createTextNode(w.value);u&&qu.shouldBuildText(S)&&f.push(R),N.append(R)}}for(const v of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Oj=9,_o=new WeakSet,jj=new Date().getTimezoneOffset()*60*1e3;class V0{static create(t){switch(t.data.annotationType){case We.LINK:return new s_(t);case We.TEXT:return new Vj(t);case We.WIDGET:switch(t.data.fieldType){case"Tx":return new Uj(t);case"Btn":return t.data.radioButton?new ox(t):t.data.checkBox?new Bj(t):new zj(t);case"Ch":return new Hj(t);case"Sig":return new Fj(t)}return new xo(t);case We.POPUP:return new Uy(t);case We.FREETEXT:return new lx(t);case We.LINE:return new qj(t);case We.SQUARE:return new $j(t);case We.CIRCLE:return new Kj(t);case We.POLYLINE:return new cx(t);case We.CARET:return new Yj(t);case We.INK:return new i_(t);case We.POLYGON:return new Wj(t);case We.HIGHLIGHT:return new ux(t);case We.UNDERLINE:return new Xj(t);case We.SQUIGGLY:return new Qj(t);case We.STRIKEOUT:return new Zj(t);case We.STAMP:return new hx(t);case We.FILEATTACHMENT:return new Jj(t);default:return new Be(t)}}}class Be{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Be._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#s(e);let s=this.#n?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#n.popup),s&&(s.updateEdited(t),n?.deleted&&(s.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:h}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-u)/o}%`,e.top=`${100*(l-t[3]+h)/l}%`,s===0?(e.width=`${100*(t[2]-t[0])/o}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),!(this instanceof xo)&&!(this instanceof s_)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex++,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof Uy){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:u,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,N=e.borderStyle.verticalCornerRadius;if(S>0||N>0){const V=`calc(${S}px * var(--total-scale-factor)) / calc(${N}px * var(--total-scale-factor))`;l.borderRadius=V}else if(this instanceof ox){const V=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=V}switch(e.borderStyle.style){case Sl.SOLID:l.borderStyle="solid";break;case Sl.DASHED:l.borderStyle="dashed";break;case Sl.BEVELED:jt("Unimplemented border style: beveled");break;case Sl.INSET:jt("Unimplemented border style: inset");break;case Sl.UNDERLINE:l.borderBottomStyle="solid";break}const R=e.borderColor||null;R?(this.#e=!0,l.borderColor=St.makeHexColor(R[0]|0,R[1]|0,R[2]|0)):l.borderWidth=0}const f=St.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:m,pageHeight:v,pageX:b,pageY:A}=s.rawDims;l.left=`${100*(f[0]-b)/m}%`,l.top=`${100*(f[1]-A)/v}%`;const{rotation:w}=e;return e.hasOwnCanvas||w===0?(l.width=`${100*u/m}%`,l.height=`${100*h/v}%`):this.setRotation(w,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),e.style.width=`${100*o/n}%`,e.style.height=`${100*l/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,s)=>{const o=s.detail[e],l=o[0],u=o.slice(1);s.target.style[n]=j0[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:j0[`${l}_rgb`](u)})};return Gt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||n[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[s,o]of Object.entries(e)){const l=n[s];if(l){const u={detail:{[s]:o},target:t};l(u),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,s,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,N,R,V]=t.subarray(2,6);if(s===S&&o===N&&e===R&&n===V)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:N}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${N}">`],this.container.classList.add("hasBorder")}const h=s-e,f=o-n,{svgFactory:m}=this,v=m.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0),v.role="none";const b=m.createElement("defs");v.append(b);const A=m.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),b.append(A);for(let S=2,N=t.length;S<N;S+=8){const R=t[S],V=t[S+1],M=t[S+2],B=t[S+3],L=m.createElement("rect"),F=(M-e)/h,C=(o-V)/f,I=(R-M)/h,k=(V-B)/f;L.setAttribute("x",F),L.setAttribute("y",C),L.setAttribute("width",I),L.setAttribute("height",k),A.append(L),u?.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${C}" width="${I}" height="${k}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(v),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:e}=this;let n,s;t?(n={str:t.text},s=t.date):(n=e.contentsObj,s=e.modificationDate);const o=this.#n=new Uy({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}render(){pe("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:o,id:l,exportValues:u}of s){if(o===-1||l===e)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!_o.has(f)){jt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(t)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==e&&_o.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class s_ extends Be{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#n(n,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),s=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#n(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const o=n.get(s);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){jt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:s,refs:o,include:l}=e,u=[];if(s.length!==0||o.length!==0){const m=new Set(o);for(const v of s){const b=this._fieldObjects[v]||[];for(const{id:A}of b)m.add(A)}for(const v of Object.values(this._fieldObjects))for(const b of v)m.has(b.id)===l&&u.push(b)}else for(const m of Object.values(this._fieldObjects))u.push(...m);const h=this.annotationStorage,f=[];for(const m of u){const{id:v}=m;switch(f.push(v),m.type){case"text":{const A=m.defaultValue||"";h.setValue(v,{value:A});break}case"checkbox":case"radiobutton":{const A=m.defaultValue===m.exportValues;h.setValue(v,{value:A});break}case"combobox":case"listbox":{const A=m.defaultValue||"";h.setValue(v,{value:A});break}default:continue}const b=document.querySelector(`[data-element-id="${v}"]`);if(b){if(!_o.has(b)){jt(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class Vj extends Be{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class xo extends Be{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Sn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,s,o){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}})})}_setEventListeners(t,e,n,s){for(const[o,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":St.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||Oj,o=t.style;let l;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),m=Math.round(f/(Yg*s))||1,v=f/m;l=Math.min(s,h(v/Yg))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(s,h(f/Yg))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=St.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Uj extends xo{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),o.setValue(l.id,{[s]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let o=s.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=s.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),_o.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:m,timeStep:v}=this.data,b=!!m&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",w=>{t.setValue(e,{value:w.target.value}),this.setPropertyOnSiblings(n,"value",w.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";n.value=h.userValue=S,h.formattedValue=null});let A=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{if(h.focused)return;const{target:N}=S;if(b&&(N.type=m,v&&(N.step=v)),h.userValue){const R=h.userValue;if(b)if(m==="time"){const V=new Date(R),M=[V.getHours(),V.getMinutes(),V.getSeconds()];N.value=M.map(B=>B.toString().padStart(2,"0")).join(":")}else N.value=new Date(R-jj).toISOString().split(m==="date"?"T":".",1)[0];else N.value=R}h.lastCommittedValue=N.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const N={value(R){h.userValue=R.detail.value??"",b||t.setValue(e,{value:h.userValue.toString()}),R.target.value=h.userValue},formattedValue(R){const{formattedValue:V}=R.detail;h.formattedValue=V,V!=null&&R.target!==document.activeElement&&(R.target.value=V);const M={formattedValue:V};b&&(M.value=V),t.setValue(e,M)},selRange(R){R.target.setSelectionRange(...R.detail.selRange)},charLimit:R=>{const{charLimit:V}=R.detail,{target:M}=R;if(V===0){M.removeAttribute("maxLength");return}M.setAttribute("maxLength",V);let B=h.userValue;!B||B.length<=V||(B=B.slice(0,V),M.value=h.userValue=B,t.setValue(e,{value:B}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:B,willCommit:!0,commitKey:1,selStart:M.selectionStart,selEnd:M.selectionEnd}}))}};this._dispatchEventFromSandbox(N,S)}),n.addEventListener("keydown",S=>{h.commitKey=1;let N=-1;if(S.key==="Escape"?N=0:S.key==="Enter"&&!this.data.multiLine?N=2:S.key==="Tab"&&(h.commitKey=3),N===-1)return;const{value:R}=S.target;h.lastCommittedValue!==R&&(h.lastCommittedValue=R,h.userValue=R,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,willCommit:!0,commitKey:N,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=A;A=null,n.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:N}=S;let{value:R}=N;if(b){if(R&&m==="time"){const V=R.split(":").map(M=>parseInt(M,10));R=new Date(2e3,0,1,V[0],V[1],V[2]||0).valueOf(),N.step=""}else R=new Date(R).valueOf();N.type="text"}h.userValue=R,h.lastCommittedValue!==R&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:R,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),w(S)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:N,target:R}=S,{value:V,selectionStart:M,selectionEnd:B}=R;let L=M,F=B;switch(S.inputType){case"deleteWordBackward":{const C=V.substring(0,M).match(/\w*[^\w]*$/);C&&(L-=C[0].length);break}case"deleteWordForward":{const C=V.substring(M).match(/^[^\w]*\w*/);C&&(F+=C[0].length);break}case"deleteContentBackward":M===B&&(L-=1);break;case"deleteContentForward":M===B&&(F+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:V,change:N||"",willCommit:!1,selStart:L,selEnd:F}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&n.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Fj extends xo{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Bj extends xo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return _o.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n)){const m=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=m),t.setValue(f.id,{value:m})}t.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class ox extends xo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(n,{value:s})),s)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(_o.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;o.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const m=l===f.detail.value;for(const v of this._getElementsByName(f.target.name)){const b=m&&v.id===n;v.domElement&&(v.domElement.checked=b),t.setValue(v.id,{value:b})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class zj extends s_{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class Hj extends xo{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");_o.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",m=>{const v=this.data.defaultFieldValue;for(const b of s.options)b.selected=b.value===v});for(const m of this.data.options){const v=document.createElement("option");v.textContent=m.displayValue,v.value=m.exportValue,n.value.includes(m.exportValue)&&(v.setAttribute("selected",!0),o=!1),s.append(v)}let l=null;if(o){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),s.prepend(m),l=()=>{m.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const u=m=>{const v=m?"value":"textContent",{options:b,multiple:A}=s;return A?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[v]):b.selectedIndex===-1?null:b[b.selectedIndex][v]};let h=u(!1);const f=m=>{const v=m.target.options;return Array.prototype.map.call(v,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",m=>{const v={value(b){l?.();const A=b.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const S of s.options)S.selected=w.has(S.value);t.setValue(e,{value:u(!0)}),h=u(!1)},multipleSelection(b){s.multiple=!0},remove(b){const A=s.options,w=b.detail.remove;A[w].selected=!1,s.remove(w),A.length>0&&Array.prototype.findIndex.call(A,N=>N.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),h=u(!1)},clear(b){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),h=u(!1)},insert(b){const{index:A,displayValue:w,exportValue:S}=b.detail.insert,N=s.children[A],R=document.createElement("option");R.textContent=w,R.value=S,N?N.before(R):s.append(R),t.setValue(e,{value:u(!0),items:f(b)}),h=u(!1)},items(b){const{items:A}=b.detail;for(;s.length!==0;)s.remove(0);for(const w of A){const{displayValue:S,exportValue:N}=w,R=document.createElement("option");R.textContent=S,R.value=N,s.append(R)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(b)}),h=u(!1)},indices(b){const A=new Set(b.detail.indices);for(const w of b.target.options)w.selected=A.has(w.index);t.setValue(e,{value:u(!0)}),h=u(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(v,m)}),s.addEventListener("input",m=>{const v=u(!0),b=u(!1);t.setValue(e,{value:v}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:b,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):s.addEventListener("input",function(m){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Uy extends Be{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:Be._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new Gj({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${Kv}${s}`).join(",")),this.container}}class Gj{#t=this.#N.bind(this);#e=this.#D.bind(this);#n=this.#x.bind(this);#s=this.#C.bind(this);#r=null;#i=null;#a=null;#o=null;#u=null;#c=null;#d=null;#l=!1;#p=null;#g=null;#f=null;#h=null;#m=null;#_=null;#y=null;#A=!1;constructor({container:t,color:e,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:u,parent:h,rect:f,parentRect:m,open:v}){this.#i=t,this.#_=s,this.#a=l,this.#m=u,this.#c=h,this.#r=e,this.#h=f,this.#d=m,this.#u=n,this.#o=Py.toDateObject(o),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),this.#E(),this.#i.hidden=!0,v&&this.#C()}#E(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("mouseenter",this.#n,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#u)e.container?.addEventListener("keydown",this.#t,{signal:t})}render(){if(this.#p)return;const t=this.#p=document.createElement("div");if(t.className="popup",this.#r){const s=t.style.outlineColor=St.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#_?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#_}if(t.append(e),this.#o){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),s.dateTime=this.#o.toISOString(),e.append(s)}const n=this.#v;if(n)ax.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#a);t.append(s)}this.#i.append(t)}get#v(){const t=this.#m,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#m.html||null}get#S(){return this.#v?.attributes?.style?.fontSize||0}get#I(){return this.#v?.attributes?.style?.color||null}#w(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#I,fontSize:this.#S?`calc(${this.#S}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:s});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let o=0,l=s.length;o<l;++o){const u=s[o];n.append(document.createTextNode(u)),o<l-1&&n.append(document.createElement("br"))}return n}#N(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#l)&&this.#C()}updateEdited({rect:t,popup:e,deleted:n}){if(n||e?.deleted){this.remove();return}this.#E(),this.#y||={contentsObj:this.#a,richText:this.#m},t&&(this.#f=null),e&&(this.#m=this.#w(e.text),this.#o=Py.toDateObject(e.date),this.#a=null),this.#p?.remove(),this.#p=null}resetEdited(){this.#y&&({contentsObj:this.#a,richText:this.#m}=this.#y,this.#y=null,this.#p?.remove(),this.#p=null,this.#f=null)}remove(){this.#g?.abort(),this.#g=null,this.#p?.remove(),this.#p=null,this.#A=!1,this.#l=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#R(){if(this.#f!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:s,pageY:o}}}=this.#c;let l=!!this.#d,u=l?this.#d:this.#h;for(const w of this.#u)if(!u||St.intersect(w.data.rect,u)!==null){u=w.data.rect,l=!0;break}const h=St.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),m=l?u[2]-u[0]+5:0,v=h[0]+m,b=h[1];this.#f=[100*(v-s)/e,100*(b-o)/n];const{style:A}=this.#i;A.left=`${this.#f[0]}%`,A.top=`${this.#f[1]}%`}#C(){this.#l=!this.#l,this.#l?(this.#x(),this.#i.addEventListener("click",this.#s),this.#i.addEventListener("keydown",this.#t)):(this.#D(),this.#i.removeEventListener("click",this.#s),this.#i.removeEventListener("keydown",this.#t))}#x(){this.#p||this.render(),this.isVisible?this.#l&&this.#i.classList.add("focused"):(this.#R(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#D(){this.#i.classList.remove("focused"),!(this.#l||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#A=this.isVisible,this.#A&&(this.#i.hidden=!0)}maybeShow(){this.#E(),this.#A&&(this.#p||this.#x(),this.#A=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class lx extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Ot.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class qj extends Be{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class $j extends Be{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",e-o),l.setAttribute("height",n-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Kj extends Be{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-o/2),l.setAttribute("ry",n/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class cx extends Be{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:s},width:o,height:l}=this;if(!e)return this.container;const u=this.svgFactory.create(o,l,!0);let h=[];for(let m=0,v=e.length;m<v;m+=2){const b=e[m]-t[0],A=t[3]-e[m+1];h.push(`${b},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Wj extends cx{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Yj extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class i_ extends Be{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ot.HIGHLIGHT:Ot.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:s,popupRef:o}}=this,{transform:l,width:u,height:h}=this.#n(e,t),f=this.svgFactory.create(u,h,!0),m=this.#t=this.svgFactory.createElement("svg:g");f.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",l);for(let v=0,b=n.length;v<b;v++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",n[v].join(",")),m.append(A)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:s}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),n)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",n[l].join(","));if(s){const{transform:l,width:u,height:h}=this.#n(this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ux extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ot.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Xj extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Qj extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Zj extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class hx extends Be{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ot.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Jj extends Be{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:s}=Sn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class r_{#t=null;#e=null;#n=new Map;#s=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l,structTreeLayer:u}){this.div=t,this.#t=e,this.#e=n,this.#s=u||null,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}async#r(t,e,n){const s=t.firstChild||t,o=s.id=`${Kv}${e}`,l=await this.#s?.getAriaAttributes(o);if(l)for(const[u,h]of l)s.setAttribute(u,h);n?n.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1))}async render(t){const{annotations:e}=t,n=this.div;vo(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new zf,annotationStorage:t.annotationStorage||new Zv,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const u=l.annotationType===We.POPUP;if(u){const m=s.get(l.id);if(!m)continue;o.elements=m}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=V0.create(o);if(!h.isRenderable)continue;if(!u&&l.popupRef){const m=s.get(l.popupRef);m?m.push(h):s.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id,o.elements),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#i()}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new zf,parent:this};for(const s of t){s.borderStyle||=r_._defaultBorderStyle,n.data=s;const o=V0.create(n);if(!o.isRenderable)continue;const l=o.render();await this.#r(l,s.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,vo(e,{rotation:t.rotation}),this.#i(),e.hidden=!1}#i(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Gt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Sl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const ef=/\r\n?|\n/g;class an extends Tt{#t;#e="";#n=`${this.id}-editor`;#s=null;#r;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=an.prototype,e=o=>o.isEmpty(),n=fa.TRANSLATE_SMALL,s=fa.TRANSLATE_BIG;return Gt(this,"_keyboardManager",new mh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=Ot.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||an._defaultColor||Tt._defaultLineColor,this.#r=t.fontSize||an._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){Tt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Xt.FREETEXT_SIZE:an._defaultFontSize=e;break;case Xt.FREETEXT_COLOR:an._defaultColor=e;break}}updateParams(t,e){switch(t){case Xt.FREETEXT_SIZE:this.#i(e);break;case Xt.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[Xt.FREETEXT_SIZE,an._defaultFontSize],[Xt.FREETEXT_COLOR,an._defaultColor||Tt._defaultLineColor]]}get propertiesToUpdate(){return[[Xt.FREETEXT_SIZE,this.#r],[Xt.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new Ku(this),[["colorPicker",this._colorPicker]]}get colorType(){return Xt.FREETEXT_COLOR}get colorValue(){return this.#t}#i(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#r)*this.parentScale),this.#r=s,this.#u()},n=this.#r;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=s=>{this.#t=this.editorDiv.style.color=s,this._colorPicker?.update(s)},n=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-an._internalPadding*t,-(an._internalPadding+this.#r)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;const t=this._uiManager.combinedSignal(this.#s);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(an.#c(n)),e=n);return t.join(`
`)}#u(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){an._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,m]=this.pageDimensions,[v,b]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=t+(l[0]-v)/f,w=e+this.height-(l[1]-b)/m;break;case 90:A=t+(l[0]-v)/f,w=e-(l[1]-b)/m,[u,h]=[h,-u];break;case 180:A=t-this.width+(l[0]-v)/f,w=e-(l[1]-b)/m,[u,h]=[-u,-h];break;case 270:A=t+(l[0]-v-this.height*m)/f,w=e+(l[1]-b-this.width*f)/m,[u,h]=[-h,u];break}this.setAt(A*s,w*o,u,h)}else this._moveAfterPaste(t,e);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ef,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const s=an.#p(e.getData("text")||"").replaceAll(ef,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:h}=l,f=[],m=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(m.push(u.nodeValue.slice(h).replaceAll(ef,"")),A!==this.editorDiv){let w=f;for(const S of this.editorDiv.childNodes){if(S===A){w=m;continue}w.push(an.#c(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(ef,""))}else if(u===this.editorDiv){let A=f,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(A=m),A.push(an.#c(S))}this.#e=`${f.join(`
`)}${s}${m.join(`
`)}`,this.#d();const v=new Range;let b=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(b<=w){v.setStart(A,b),v.setEnd(A,b);break}b-=w}o.removeAllRanges(),o.addRange(v)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#l(){return this.#e.replaceAll(""," ")}static#p(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,n){let s=null;if(t instanceof lx){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:f,id:m,popupRef:v,contentsObj:b},textContent:A,textPosition:w,parent:{page:{pageNumber:S}}}=t;if(!A||A.length===0)return null;s=t={annotationType:Ot.FREETEXT,color:Array.from(u),fontSize:l,value:A.join(`
`),position:w,pageIndex:S-1,rect:h.slice(0),rotation:f,annotationElementId:m,id:m,deleted:!1,popupRef:v,comment:b?.str||null}}const o=await super.deserialize(t,e,n);return o.#r=t.fontSize,o.#t=St.makeHexColor(...t.color),o.#e=an.#p(t.value),o._initialData=s,t.comment&&o.setCommentData(t.comment),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=an._internalPadding*this.parentScale,n=this.getRect(e,e),s=Tt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),o={annotationType:Ot.FREETEXT,color:s,fontSize:this.#r,value:this.#l(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(o),t?(o.isCopy=!0,o):this.annotationElementId&&!this.#g(o)?null:(o.id=this.annotationElementId,o)}#g(t){const{value:e,fontSize:n,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,u)=>l!==s[u])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t),{style:n}=e;n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.#t,e.replaceChildren();for(const l of this.#e.split(`
`)){const u=document.createElement("div");u.append(l?document.createTextNode(l):document.createElement("br")),e.append(u)}const s=an._internalPadding*this.parentScale,o={rect:this.getRect(s,s)};return o.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(o),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class gt{static PRECISION=1e-4;toSVGPath(){pe("Abstract method `toSVGPath` must be implemented.")}get box(){pe("Abstract getter `box` must be implemented.")}serialize(t,e){pe("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,s,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u]*s,l[u+1]=n+t[u+1]*o;return l}static _rescaleAndSwap(t,e,n,s,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u+1]*s,l[u+1]=n+t[u]*o;return l}static _translate(t,e,n,s){s||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)s[o]=e+t[o],s[o+1]=n+t[o+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,s,o){switch(o){case 90:return[1-e/n,t/s];case 180:return[1-t/n,1-e/s];case 270:return[e/n,1-t/s];default:return[t/n,e/s]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,s,o,l){return[(t+5*n)/6,(e+5*s)/6,(5*n+o)/6,(5*s+l)/6,(n+o)/2,(s+l)/2]}}class ro{#t;#e=[];#n;#s;#r=[];#i=new Float32Array(18);#a;#o;#u;#c;#d;#l;#p=[];static#g=8;static#f=2;static#h=ro.#g+ro.#f;constructor({x:t,y:e},n,s,o,l,u=0){this.#t=n,this.#l=o*s,this.#s=l,this.#i.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=u,this.#c=ro.#g*s,this.#u=ro.#h*s,this.#d=s,this.#p.push(t,e)}isEmpty(){return isNaN(this.#i[8])}#m(){const t=this.#i.subarray(4,6),e=this.#i.subarray(16,18),[n,s,o,l]=this.#t;return[(this.#a+(t[0]-e[0])/2-n)/o,(this.#o+(t[1]-e[1])/2-s)/l,(this.#a+(e[0]-t[0])/2-n)/o,(this.#o+(e[1]-t[1])/2-s)/l]}add({x:t,y:e}){this.#a=t,this.#o=e;const[n,s,o,l]=this.#t;let[u,h,f,m]=this.#i.subarray(8,12);const v=t-f,b=e-m,A=Math.hypot(v,b);if(A<this.#u)return!1;const w=A-this.#c,S=w/A,N=S*v,R=S*b;let V=u,M=h;u=f,h=m,f+=N,m+=R,this.#p?.push(t,e);const B=-R/w,L=N/w,F=B*this.#l,C=L*this.#l;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([f+F,m+C],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([f-F,m-C],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([u+F,h+C],2),this.#r.push(NaN,NaN,NaN,NaN,(u+F-n)/o,(h+C-s)/l),this.#i.set([u-F,h-C],14),this.#e.push(NaN,NaN,NaN,NaN,(u-F-n)/o,(h-C-s)/l)),this.#i.set([V,M,u,h,f,m],6),!this.isEmpty()):(this.#i.set([V,M,u,h,f,m],6),Math.abs(Math.atan2(M-h,V-u)-Math.atan2(R,N))<Math.PI/2?([u,h,f,m]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-n)/o,((h+m)/2-s)/l),[u,h,V,M]=this.#i.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((V+u)/2-n)/o,((M+h)/2-s)/l),!0):([V,M,u,h,f,m]=this.#i.subarray(0,6),this.#r.push(((V+5*u)/6-n)/o,((M+5*h)/6-s)/l,((5*u+f)/6-n)/o,((5*h+m)/6-s)/l,((u+f)/2-n)/o,((h+m)/2-s)/l),[f,m,u,h,V,M]=this.#i.subarray(12,18),this.#e.push(((V+5*u)/6-n)/o,((M+5*h)/6-s)/l,((5*u+f)/6-n)/o,((5*h+m)/6-s)/l,((u+f)/2-n)/o,((h+m)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#_();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#A(n);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#y(n),n.join(" ")}#_(){const[t,e,n,s]=this.#t,[o,l,u,h]=this.#m();return`M${(this.#i[2]-t)/n} ${(this.#i[3]-e)/s} L${(this.#i[4]-t)/n} ${(this.#i[5]-e)/s} L${o} ${l} L${u} ${h} L${(this.#i[16]-t)/n} ${(this.#i[17]-e)/s} L${(this.#i[14]-t)/n} ${(this.#i[15]-e)/s} Z`}#y(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#A(t){const[e,n,s,o]=this.#t,l=this.#i.subarray(4,6),u=this.#i.subarray(16,18),[h,f,m,v]=this.#m();t.push(`L${(l[0]-e)/s} ${(l[1]-n)/o} L${h} ${f} L${m} ${v} L${(u[0]-e)/s} ${(u[1]-n)/o}`)}newFreeDrawOutline(t,e,n,s,o,l){return new dx(t,e,n,s,o,l)}getOutlines(){const t=this.#r,e=this.#e,n=this.#i,[s,o,l,u]=this.#t,h=new Float32Array((this.#p?.length??0)+2);for(let v=0,b=h.length-2;v<b;v+=2)h[v]=(this.#p[v]-s)/l,h[v+1]=(this.#p[v+1]-o)/u;if(h[h.length-2]=(this.#a-s)/l,h[h.length-1]=(this.#o-o)/u,isNaN(n[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let m=t.length;for(let v=0;v<m;v+=2){if(isNaN(t[v])){f[v]=f[v+1]=NaN;continue}f[v]=t[v],f[v+1]=t[v+1]}m=this.#S(f,m);for(let v=e.length-6;v>=6;v-=6)for(let b=0;b<6;b+=2){if(isNaN(e[v+b])){f[m]=f[m+1]=NaN,m+=2;continue}f[m]=e[v+b],f[m+1]=e[v+b+1],m+=2}return this.#v(f,m),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#s)}#E(t){const e=this.#i,[n,s,o,l]=this.#t,[u,h,f,m]=this.#m(),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(e[2]-n)/o,(e[3]-s)/l,NaN,NaN,NaN,NaN,(e[4]-n)/o,(e[5]-s)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(e[16]-n)/o,(e[17]-s)/l,NaN,NaN,NaN,NaN,(e[14]-n)/o,(e[15]-s)/l],0),this.newFreeDrawOutline(v,t,this.#t,this.#d,this.#n,this.#s)}#v(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#S(t,e){const n=this.#i.subarray(4,6),s=this.#i.subarray(16,18),[o,l,u,h]=this.#t,[f,m,v,b]=this.#m();return t.set([NaN,NaN,NaN,NaN,(n[0]-o)/u,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,v,b,NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/h],e),e+=24}}class dx extends gt{#t;#e=new Float32Array(4);#n;#s;#r;#i;#a;constructor(t,e,n,s,o,l){super(),this.#a=t,this.#r=e,this.#t=n,this.#i=s,this.#n=o,this.#s=l,this.lastPoint=[NaN,NaN],this.#o(l);const[u,h,f,m]=this.#e;for(let v=0,b=t.length;v<b;v+=2)t[v]=(t[v]-u)/f,t[v+1]=(t[v+1]-h)/m;for(let v=0,b=e.length;v<b;v+=2)e[v]=(e[v]-u)/f,e[v+1]=(e[v+1]-h)/m}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,n=this.#a.length;e<n;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,s],o){const l=n-t,u=s-e;let h,f;switch(o){case 0:h=gt._rescale(this.#a,t,s,l,-u),f=gt._rescale(this.#r,t,s,l,-u);break;case 90:h=gt._rescaleAndSwap(this.#a,t,e,l,u),f=gt._rescaleAndSwap(this.#r,t,e,l,u);break;case 180:h=gt._rescale(this.#a,n,e,-l,u),f=gt._rescale(this.#r,n,e,-l,u);break;case 270:h=gt._rescaleAndSwap(this.#a,n,s,-l,-u),f=gt._rescaleAndSwap(this.#r,n,s,-l,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#a;let n=e[4],s=e[5];const o=[n,s,n,s];let l=n,u=s;const h=t?Math.max:Math.min;for(let m=6,v=e.length;m<v;m+=6){const b=e[m+4],A=e[m+5];if(isNaN(e[m]))St.pointBoundingBox(b,A,o),u<A?(l=b,u=A):u===A&&(l=h(l,b));else{const w=[1/0,1/0,-1/0,-1/0];St.bezierBoundingBox(n,s,...e.slice(m,m+6),w),St.rectBoundingBox(...w,o),u<w[3]?(l=w[2],u=w[3]):u===w[3]&&(l=h(l,w[2]))}n=b,s=A}const f=this.#e;f[0]=o[0]-this.#n,f[1]=o[1]-this.#n,f[2]=o[2]-o[0]+2*this.#n,f[3]=o[3]-o[1]+2*this.#n,this.lastPoint=[l,u]}get box(){return this.#e}newOutliner(t,e,n,s,o,l=0){return new ro(t,e,n,s,o,l)}getNewOutline(t,e){const[n,s,o,l]=this.#e,[u,h,f,m]=this.#t,v=o*f,b=l*m,A=n*f+u,w=s*m+h,S=this.newOutliner({x:this.#r[0]*v+A,y:this.#r[1]*b+w},this.#t,this.#i,t,this.#s,e??this.#n);for(let N=2;N<this.#r.length;N+=2)S.add({x:this.#r[N]*v+A,y:this.#r[N+1]*b+w});return S.getOutlines()}}class Fy{#t;#e;#n=[];#s=[];constructor(t,e=0,n=0,s=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:A,y:w,width:S,height:N}of t){const R=Math.floor((A-e)/l)*l,V=Math.ceil((A+S+e)/l)*l,M=Math.floor((w-e)/l)*l,B=Math.ceil((w+N+e)/l)*l,L=[R,M,B,!0],F=[V,M,B,!1];this.#n.push(L,F),St.rectBoundingBox(R,M,V,B,o)}const u=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,m=o[1]-n,v=this.#n.at(s?-1:-2),b=[v[0],v[2]];for(const A of this.#n){const[w,S,N]=A;A[0]=(w-f)/u,A[1]=(S-m)/h,A[2]=(N-m)/h}this.#t=new Float32Array([f,m,u,h]),this.#e=b}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#u(e)),this.#a(e)):(this.#o(e),t.push(...this.#u(e)));return this.#r(t)}#r(t){const e=[],n=new Set;for(const l of t){const[u,h,f]=l;e.push([u,h,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[u,h,f,m,v]=l;n.delete(l);let b=u,A=h;for(o=[u,f],s.push(o);;){let w;if(n.has(m))w=m;else if(n.has(v))w=v;else break;n.delete(w),[u,h,f,m,v]=w,b!==u&&(o.push(b,A,u,A===h?h:f),b=u),A=A===h?f:h}o.push(b,A)}return new tV(s,this.#t,this.#e)}#i(t){const e=this.#s;let n=0,s=e.length-1;for(;n<=s;){const o=n+s>>1,l=e[o][0];if(l===t)return o;l<t?n=o+1:s=o-1}return s+1}#a([,t,e]){const n=this.#i(t);this.#s.splice(n,0,[t,e])}#o([,t,e]){const n=this.#i(t);for(let s=n;s<this.#s.length;s++){const[o,l]=this.#s[s];if(o!==t)break;if(o===t&&l===e){this.#s.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=this.#s[s];if(o!==t)break;if(o===t&&l===e){this.#s.splice(s,1);return}}}#u(t){const[e,n,s]=t,o=[[e,n,s]],l=this.#i(s);for(let u=0;u<l;u++){const[h,f]=this.#s[u];for(let m=0,v=o.length;m<v;m++){const[,b,A]=o[m];if(!(f<=b||A<=h)){if(b>=h){if(A>f)o[m][1]=f;else{if(v===1)return[];o.splice(m,1),m--,v--}continue}o[m][2]=h,A>f&&o.push([e,f,A])}}}return o}}class tV extends gt{#t;#e;constructor(t,e,n){super(),this.#e=t,this.#t=e,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[n,s]=e;t.push(`M${n} ${s}`);for(let o=2;o<e.length;o+=2){const l=e[o],u=e[o+1];l===n?(t.push(`V${u}`),s=u):u===s&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,s],o){const l=[],u=n-t,h=s-e;for(const f of this.#e){const m=new Array(f.length);for(let v=0;v<f.length;v+=2)m[v]=t+f[v]*u,m[v+1]=s-f[v+1]*h;l.push(m)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class By extends ro{newFreeDrawOutline(t,e,n,s,o,l){return new eV(t,e,n,s,o,l)}}class eV extends dx{newOutliner(t,e,n,s,o,l=0){return new By(t,e,n,s,o,l)}}class Ve extends Tt{#t=null;#e=0;#n;#s=null;#r=null;#i=null;#a=null;#o=0;#u=null;#c=null;#d=null;#l=!1;#p=null;#g;#f=null;#h="";#m;#_="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ot.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Ve.prototype;return Gt(this,"_keyboardManager",new mh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Ve._defaultColor,this.#m=t.thickness||Ve._defaultThickness,this.#g=t.opacity||Ve._defaultOpacity,this.#n=t.boxes||null,this.#_=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#l=!0,this.#A(t),this.#w()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#y(),this.#w(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#l?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#_}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#y(){const t=new Fy(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new Fy(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=e.getOutlines();const{lastPoint:n}=this.#i;this.#p=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#A({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#c=t;const s=1.5;if(this.#i=t.getNewOutline(this.#m/2+s,.0025),e>=0)this.#d=e,this.#s=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#f=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Ve.#N(this.#c.box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#f,{bbox:Ve.#N(this.#i.box,m),path:{d:this.#i.toSVGPath()}})}const[o,l,u,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=h;break;case 90:{const[m,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*v/m,this.height=h*m/v;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=h;break;case 270:{const[m,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*v/m,this.height=h*m/v;break}}const{lastPoint:f}=this.#i;this.#p=[(f[0]-o)/u,(f[1]-l)/h]}static initialize(t,e){Tt.initialize(t,e),Ve._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Xt.HIGHLIGHT_COLOR:Ve._defaultColor=e;break;case Xt.HIGHLIGHT_THICKNESS:Ve._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#p}updateParams(t,e){switch(t){case Xt.HIGHLIGHT_COLOR:this.#E(e);break;case Xt.HIGHLIGHT_THICKNESS:this.#v(e);break}}static get defaultPropertiesToUpdate(){return[[Xt.HIGHLIGHT_COLOR,Ve._defaultColor],[Xt.HIGHLIGHT_THICKNESS,Ve._defaultThickness]]}get propertiesToUpdate(){return[[Xt.HIGHLIGHT_COLOR,this.color||Ve._defaultColor],[Xt.HIGHLIGHT_THICKNESS,this.#m||Ve._defaultThickness],[Xt.HIGHLIGHT_FREE,this.#l]]}#E(t){const e=(o,l)=>{this.color=o,this.#g=l,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:o,"fill-opacity":l}}),this.#r?.updateColor(o)},n=this.color,s=this.#g;this.addCommands({cmd:e.bind(this,t,Ve._defaultOpacity),undo:e.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#v(t){const e=this.#m,n=s=>{this.#m=s,this.#S(s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Xt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Is({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#x())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#x())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#I(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#w(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#I():t&&(this.#w(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#l)return;this.#A({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#I(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#w(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#s}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#l},path:{d:this.#c.toSVGPath()}},!1,!0),this.#f=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#l},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#l),this.#u&&(this.#u.style.clipPath=this.#s))}static#N([t,e,n,s],o){switch(o){case 90:return[1-e-s,t,s,n];case 180:return[1-t-n,1-e-s,n,s];case 270:return[e,1-t-n,s,n]}return[t,e,n,s]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#l?(t=(t-this.rotation+360)%360,n=Ve.#N(this.#c.box,t)):n=Ve.#N([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#f,{bbox:Ve.#N(this.#i.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#l?t.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const e=this.#u=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#s;const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),B1(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!1}})}#R(t){Ve._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#f&&this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{selected:!1}}),this.#l||this.#C(!1))}get _mustFixPosition(){return!this.#l}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!t}}))}#x(){return this.#l?this.rotation:0}#D(){if(this.#l)return null;const[t,e]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:h,y:f,width:m,height:v}of o){const b=h*t+n,A=(1-f)*e+s;l[u]=l[u+4]=b,l[u+1]=l[u+3]=A,l[u+2]=l[u+6]=b+m*t,l[u+5]=l[u+7]=A-v*e,u+=8}return l}#j(t){return this.#c.serialize(t,this.#x())}static startHighlighting(t,e,{target:n,x:s,y:o}){const{x:l,y:u,width:h,height:f}=n.getBoundingClientRect(),m=new AbortController,v=t.combinedSignal(m),b=A=>{m.abort(),this.#B(t,A)};window.addEventListener("blur",b,{signal:v}),window.addEventListener("pointerup",b,{signal:v}),window.addEventListener("pointerdown",Xe,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Ms,{signal:v}),n.addEventListener("pointermove",this.#M.bind(this,t),{signal:v}),this._freeHighlight=new By({x:s,y:o},[l,u,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#M(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let s=null;if(t instanceof ux){const{data:{quadPoints:w,rect:S,rotation:N,id:R,color:V,opacity:M,popupRef:B,contentsObj:L},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Ot.HIGHLIGHT,color:Array.from(V),opacity:M,quadPoints:w,boxes:null,pageIndex:F-1,rect:S.slice(0),rotation:N,annotationElementId:R,id:R,deleted:!1,popupRef:B,comment:L?.str||null}}else if(t instanceof i_){const{data:{inkLists:w,rect:S,rotation:N,id:R,color:V,borderStyle:{rawWidth:M},popupRef:B,contentsObj:L},parent:{page:{pageNumber:F}}}=t;s=t={annotationType:Ot.HIGHLIGHT,color:Array.from(V),thickness:M,inkLists:w,boxes:null,pageIndex:F-1,rect:S.slice(0),rotation:N,annotationElementId:R,id:R,deleted:!1,popupRef:B,comment:L?.str||null}}const{color:o,quadPoints:l,inkLists:u,opacity:h}=t,f=await super.deserialize(t,e,n);f.color=St.makeHexColor(...o),f.#g=h||1,u&&(f.#m=t.thickness),f._initialData=s,t.comment&&f.setCommentData(t.comment);const[m,v]=f.pageDimensions,[b,A]=f.pageTranslation;if(l){const w=f.#n=[];for(let S=0;S<l.length;S+=8)w.push({x:(l[S]-b)/m,y:1-(l[S+1]-A)/v,width:(l[S+2]-l[S])/m,height:(l[S+1]-l[S+5])/v});f.#y(),f.#w(),f.rotate(f.rotation)}else if(u){f.#l=!0;const w=u[0],S={x:w[0]-b,y:v-(w[1]-A)},N=new By(S,[0,0,m,v],1,f.#m/2,!0,.001);for(let M=0,B=w.length;M<B;M+=2)S.x=w[M]-b,S.y=v-(w[M+1]-A),N.add(S);const{id:R,clipPathId:V}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:N.toSVGPath()}},!0,!0);f.#A({highlightOutlines:N.getOutlines(),highlightId:R,clipPathId:V}),f.#w(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),n=Tt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:Ot.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#m,quadPoints:this.#D(),outlines:this.#j(e),pageIndex:this.pageIndex,rect:e,rotation:this.#x(),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!this.#T(s)?null:(s.id=this.annotationElementId,s)}#T(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,s)=>n!==e[s])}renderAnnotationElement(t){const e={rect:this.getRect(0,0)};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class fx{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){pe("Not implemented")}}class It extends Tt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#s=null;static#r=null;static#i=NaN;static#a=null;static#o=null;static#u=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#p())}#c({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:n}=e.drawLayer.draw(It._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[s,o]of Object.entries(e))n.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){pe("Not implemented")}static get typesMap(){pe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(It.#n.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)t.push([n,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,s]of this.constructor.typesMap)t.push([n,e[s]]);return t}_updateProperty(t,e,n){const s=this._drawingOptions,o=s[e],l=u=>{s.updateProperty(e,u);const h=this.#t.updateProperty(e,u);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(u)};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,It._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#f()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,It._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#f()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,It._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#f(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#l(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#p(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#l()):t&&(this._uiManager.addShouldRescale(this),this.#p(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#l(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#p(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#g([t,e,n,s]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[e,1-t,n*(l/o),s*(o/l)];case 180:return[1-t,1-e,n,s];case 270:return[1-e,t,n*(l/o),s*(o/l)];default:return[t,e,n,s]}}#f(){const{x:t,y:e,width:n,height:s,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-e,t,n*(o/l),s*(l/o)];case 180:return[1-t,1-e,n,s];case 270:return[e,1-t,n*(o/l),s*(l/o)];default:return[t,e,n,s]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}this._onResized()}#m(){const{x:t,y:e,width:n,height:s,rotation:o,parentRotation:l,parentDimensions:[u,h]}=this;switch((o*4+l)/90){case 1:return[1-e-s,t,s,n];case 2:return[1-t-n,1-e-s,n,s];case 3:return[e,1-t-n,s,n];case 4:return[t,e-n*(u/h),s*(h/u),n*(u/h)];case 5:return[1-e,t,n*(u/h),s*(h/u)];case 6:return[1-t-s*(h/u),1-e,s*(h/u),n*(u/h)];case 7:return[e-n*(u/h),1-t-s*(h/u),n*(u/h),s*(h/u)];case 8:return[t-n,e-s,n,s];case 9:return[1-e,t-n,s,n];case 10:return[1-t,1-e,n,s];case 11:return[e-s,1-t,s,n];case 12:return[t-s*(h/u),e,s*(h/u),n*(u/h)];case 13:return[1-e-n*(u/h),t-s*(h/u),n*(u/h),s*(h/u)];case 14:return[1-t,1-e-n*(u/h),s*(h/u),n*(u/h)];case 15:return[e,1-t,n*(u/h),s*(h/u)];default:return[t,e,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,It._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[o,l]=this.parentDimensions;return this.setDims(this.width*o,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,s,o){pe("Not implemented")}static startDrawing(t,e,n,s){const{target:o,offsetX:l,offsetY:u,pointerId:h,pointerType:f}=s;if(It.#a&&It.#a!==f)return;const{viewport:{rotation:m}}=t,{width:v,height:b}=o.getBoundingClientRect(),A=It.#s=new AbortController,w=t.combinedSignal(A);if(It.#i||=h,It.#a??=f,window.addEventListener("pointerup",S=>{It.#i===S.pointerId?this._endDraw(S):It.#o?.delete(S.pointerId)},{signal:w}),window.addEventListener("pointercancel",S=>{It.#i===S.pointerId?this._currentParent.endDrawingSession():It.#o?.delete(S.pointerId)},{signal:w}),window.addEventListener("pointerdown",S=>{It.#a===S.pointerType&&((It.#o||=new Set).add(S.pointerId),It.#n.isCancellable()&&(It.#n.removeLastElement(),It.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ms,{signal:w}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),o.addEventListener("touchmove",S=>{S.timeStamp===It.#u&&Xe(S)},{signal:w}),t.toggleDrawing(),e._editorUndoBar?.hide(),It.#n){t.drawLayer.updateProperties(this._currentDrawId,It.#n.startNew(l,u,v,b,m));return}e.updateUIForDefaultProperties(this),It.#n=this.createDrawerInstance(l,u,v,b,m),It.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(It.#r.toSVGProperties(),It.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(It.#u=-1,!It.#n)return;const{offsetX:e,offsetY:n,pointerId:s}=t;if(It.#i===s){if(It.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,It.#n.add(e,n)),It.#u=t.timeStamp,Xe(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,It.#n=null,It.#r=null,It.#a=null,It.#u=NaN),It.#s&&(It.#s.abort(),It.#s=null,It.#i=NaN,It.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,It.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=It.#n,s=this._currentDrawId,o=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,n.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Xt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Xt.DRAW_STEP),!It.#n.isEmpty()){const{pageDimensions:[n,s],scale:o}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:It.#n.getOutlines(n*o,s*o,o,this._INNER_MARGIN),drawingOptions:It.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,s,o,l){pe("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:u}}=e.viewport,h=this.deserializeDraw(l,u,s,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,n);return f.createDrawingOptions(t),f.#c({drawOutlines:h}),f.#p(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,n]=this.pageTranslation,[s,o]=this.pageDimensions;return this.#t.serialize([e,n,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class nV{#t=new Float64Array(6);#e;#n;#s;#r;#i;#a="";#o=0;#u=new yh;#c;#d;constructor(t,e,n,s,o,l){this.#c=n,this.#d=s,this.#s=o,this.#r=l,[t,e]=this.#l(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e],this.#n=[{line:u,points:this.#i}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#l(t,e){return gt._normalizePoint(t,e,this.#c,this.#d,this.#s)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(t,e){[t,e]=this.#l(t,e);const[n,s,o,l]=this.#t.subarray(2,6),u=t-o,h=e-l;return Math.hypot(this.#c*u,this.#d*h)<=2?null:(this.#i.push(t,e),isNaN(n)?(this.#t.set([o,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,s,o,l,t,e],0),this.#e.push(...gt.createBezierPoints(n,s,o,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,s,o){this.#c=n,this.#d=s,this.#s=o,[t,e]=this.#l(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#i}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#i=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#a="";for(let t=0,e=this.#n.length;t<e;t++){const{line:n,points:s}=this.#n[t];this.#e=n,this.#i=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=gt.svgRound(this.#e[4]),e=gt.svgRound(this.#e[5]);if(this.#i.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#i.length<=6){const s=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#i.length===4){const s=gt.svgRound(this.#e[10]),o=gt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${s} ${o}`,this.#o=12,this.#a}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,o=this.#e.length;s<o;s+=6){const[l,u,h,f,m,v]=this.#e.slice(s,s+6).map(gt.svgRound);n.push(`C${l} ${u} ${h} ${f} ${m} ${v}`)}return this.#a+=n.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,n,s){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#u.build(this.#n,t,e,n,this.#s,this.#r,s),this.#t=null,this.#e=null,this.#n=null,this.#a=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class yh extends gt{#t;#e=0;#n;#s;#r;#i;#a;#o;#u;build(t,e,n,s,o,l,u){this.#r=e,this.#i=n,this.#a=s,this.#o=o,this.#u=l,this.#n=u??0,this.#s=t,this.#l()}get thickness(){return this.#u}setLastElement(t){return this.#s.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#s){if(t.push(`M${gt.svgRound(e[4])} ${gt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${gt.svgRound(e[10])} ${gt.svgRound(e[11])}`);continue}for(let n=6,s=e.length;n<s;n+=6){const[o,l,u,h,f,m]=e.subarray(n,n+6).map(gt.svgRound);t.push(`C${o} ${l} ${u} ${h} ${f} ${m}`)}}return t.join("")}serialize([t,e,n,s],o){const l=[],u=[],[h,f,m,v]=this.#d();let b,A,w,S,N,R,V,M,B;switch(this.#o){case 0:B=gt._rescale,b=t,A=e+s,w=n,S=-s,N=t+h*n,R=e+(1-f-v)*s,V=t+(h+m)*n,M=e+(1-f)*s;break;case 90:B=gt._rescaleAndSwap,b=t,A=e,w=n,S=s,N=t+f*n,R=e+h*s,V=t+(f+v)*n,M=e+(h+m)*s;break;case 180:B=gt._rescale,b=t+n,A=e,w=-n,S=s,N=t+(1-h-m)*n,R=e+f*s,V=t+(1-h)*n,M=e+(f+v)*s;break;case 270:B=gt._rescaleAndSwap,b=t+n,A=e+s,w=-n,S=-s,N=t+(1-f-v)*n,R=e+(1-h-m)*s,V=t+(1-f)*n,M=e+(1-h)*s;break}for(const{line:L,points:F}of this.#s)l.push(B(L,b,A,w,S,o?new Array(L.length):null)),u.push(B(F,b,A,w,S,o?new Array(F.length):null));return{lines:l,points:u,rect:[N,R,V,M]}}static deserialize(t,e,n,s,o,{paths:{lines:l,points:u},rotation:h,thickness:f}){const m=[];let v,b,A,w,S;switch(h){case 0:S=gt._rescale,v=-t/n,b=e/s+1,A=1/n,w=-1/s;break;case 90:S=gt._rescaleAndSwap,v=-e/s,b=-t/n,A=1/s,w=1/n;break;case 180:S=gt._rescale,v=t/n+1,b=-e/s,A=-1/n,w=1/s;break;case 270:S=gt._rescaleAndSwap,v=e/s+1,b=t/n+1,A=-1/s,w=-1/n;break}if(!l){l=[];for(const R of u){const V=R.length;if(V===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1]]));continue}if(V===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,R[0],R[1],NaN,NaN,NaN,NaN,R[2],R[3]]));continue}const M=new Float32Array(3*(V-2));l.push(M);let[B,L,F,C]=R.subarray(0,4);M.set([NaN,NaN,NaN,NaN,B,L],0);for(let I=4;I<V;I+=2){const k=R[I],O=R[I+1];M.set(gt.createBezierPoints(B,L,F,C,k,O),(I-2)*3),[B,L,F,C]=[F,C,k,O]}}}for(let R=0,V=l.length;R<V;R++)m.push({line:S(l[R].map(M=>M??NaN),v,b,A,w),points:S(u[R].map(M=>M??NaN),v,b,A,w)});const N=new this.prototype.constructor;return N.build(m,n,s,1,h,f,o),N}#c(t=this.#u){const e=this.#n+t/2*this.#a;return this.#o%180===0?[e/this.#r,e/this.#i]:[e/this.#i,e/this.#r]}#d(){const[t,e,n,s]=this.#t,[o,l]=this.#c(0);return[t+o,e+l,n-2*o,s-2*l]}#l(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#s){if(s.length<=12){for(let u=4,h=s.length;u<h;u+=6)St.pointBoundingBox(s[u],s[u+1],t);continue}let o=s[4],l=s[5];for(let u=6,h=s.length;u<h;u+=6){const[f,m,v,b,A,w]=s.subarray(u,u+6);St.bezierBoundingBox(o,l,f,m,v,b,A,w,t),o=A,l=w}}const[e,n]=this.#c();t[0]=Fn(t[0]-e,0,1),t[1]=Fn(t[1]-n,0,1),t[2]=Fn(t[2]+e,0,1),t[3]=Fn(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#p(e):null}#p(t){const[e,n]=this.#c();this.#u=t;const[s,o]=this.#c(),[l,u]=[s-e,o-n],h=this.#t;return h[0]-=l,h[1]-=u,h[2]+=2*l,h[3]+=2*u,h}updateParentDimensions([t,e],n){const[s,o]=this.#c();this.#r=t,this.#i=e,this.#a=n;const[l,u]=this.#c(),h=l-s,f=u-o,m=this.#t;return m[0]-=h,m[1]-=f,m[2]+=2*h,m[3]+=2*f,m}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(gt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,s=0,o=0,l=0,u=0,h=0;switch(this.#e){case 90:s=e/t,o=-t/e,u=t;break;case 180:n=-1,l=-1,u=t,h=e;break;case 270:s=-e/t,o=t/e,h=e;break;default:return""}return`matrix(${n} ${s} ${o} ${l} ${gt.svgRound(u)} ${gt.svgRound(h)})`}getPathResizingSVGProperties([t,e,n,s]){const[o,l]=this.#c(),[u,h,f,m]=this.#t;if(Math.abs(f-o)<=gt.PRECISION||Math.abs(m-l)<=gt.PRECISION){const S=t+n/2-(u+f/2),N=e+s/2-(h+m/2);return{path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${N})`}}}const v=(n-2*o)/(f-2*o),b=(s-2*l)/(m-2*l),A=f/n,w=m/s;return{path:{"transform-origin":`${gt.svgRound(u)} ${gt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${w}) translate(${gt.svgRound(o)} ${gt.svgRound(l)}) scale(${v} ${b}) translate(${gt.svgRound(-o)} ${gt.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,s]){const[o,l]=this.#c(),u=this.#t,[h,f,m,v]=u;if(u[0]=t,u[1]=e,u[2]=n,u[3]=s,Math.abs(m-o)<=gt.PRECISION||Math.abs(v-l)<=gt.PRECISION){const N=t+n/2-(h+m/2),R=e+s/2-(f+v/2);for(const{line:V,points:M}of this.#s)gt._translate(V,N,R,V),gt._translate(M,N,R,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(n-2*o)/(m-2*o),A=(s-2*l)/(v-2*l),w=-b*(h+o)+t+o,S=-A*(f+l)+e+l;if(b!==1||A!==1||w!==0||S!==0)for(const{line:N,points:R}of this.#s)gt._rescale(N,w,S,b,A,N),gt._rescale(R,w,S,b,A,R);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[s,o]=n,l=this.#t,u=t-l[0],h=e-l[1];if(this.#r===s&&this.#i===o)for(const{line:f,points:m}of this.#s)gt._translate(f,u,h,f),gt._translate(m,u,h,m);else{const f=this.#r/s,m=this.#i/o;this.#r=s,this.#i=o;for(const{line:v,points:b}of this.#s)gt._rescale(v,u,h,f,m,v),gt._rescale(b,u,h,f,m,b);l[2]*=f,l[3]*=m}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${gt.svgRound(t)} ${gt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${gt.svgRound(t[0])} ${gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class wp extends fx{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Tt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new wp(this._viewParameters);return t.updateAll(this),t}}class a_ extends It{static _type="ink";static _editorType=Ot.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Tt.initialize(t,e),this._defaultDrawingOptions=new wp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Gt(this,"typesMap",new Map([[Xt.INK_THICKNESS,"stroke-width"],[Xt.INK_COLOR,"stroke"],[Xt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,s,o){return new nV(t,e,n,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,s,o,l){return yh.deserialize(t,e,n,s,o,l)}static async deserialize(t,e,n){let s=null;if(t instanceof i_){const{data:{inkLists:l,rect:u,rotation:h,id:f,color:m,opacity:v,borderStyle:{rawWidth:b},popupRef:A,contentsObj:w},parent:{page:{pageNumber:S}}}=t;s=t={annotationType:Ot.INK,color:Array.from(m),thickness:b,opacity:v,paths:{points:l},boxes:null,pageIndex:S-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:A,comment:w?.str||null}}const o=await super.deserialize(t,e,n);return o._initialData=s,t.comment&&o.setCommentData(t.comment),o}get toolbarButtons(){return this._colorPicker||=new Ku(this),[["colorPicker",this._colorPicker]]}get colorType(){return Xt.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=a_.getDefaultDrawingOptions({stroke:St.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":u}}=this,h={annotationType:Ot.INK,color:Tt._colorManager.convert(o),opacity:l,thickness:u,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:n,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==e[u])||t.thickness!==n||t.opacity!==s||t.pageIndex!==o}renderAnnotationElement(t){const{points:e,rect:n}=this.serializeDraw(!1),s={rect:n,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}}class zy extends yh{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const nf=8,mu=3;class xl{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,s){return n-=t,s-=e,n===0?s>0?0:4:n===1?s+6:2-s}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#s(t,e,n,s,o,l,u){const h=this.#e(n,s,o,l);for(let f=0;f<8;f++){const m=(-f+h-u+16)%8,v=this.#n[2*m],b=this.#n[2*m+1];if(t[(n+v)*e+(s+b)]!==0)return m}return-1}static#r(t,e,n,s,o,l,u){const h=this.#e(n,s,o,l);for(let f=0;f<8;f++){const m=(f+h+u+16)%8,v=this.#n[2*m],b=this.#n[2*m+1];if(t[(n+v)*e+(s+b)]!==0)return m}return-1}static#i(t,e,n,s){const o=t.length,l=new Int32Array(o);for(let m=0;m<o;m++)l[m]=t[m]<=s?1:0;for(let m=1;m<n-1;m++)l[m*e]=l[m*e+e-1]=0;for(let m=0;m<e;m++)l[m]=l[e*n-1-m]=0;let u=1,h;const f=[];for(let m=1;m<n-1;m++){h=1;for(let v=1;v<e-1;v++){const b=m*e+v,A=l[b];if(A===0)continue;let w=m,S=v;if(A===1&&l[b-1]===0)u+=1,S-=1;else if(A>=1&&l[b+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const N=[v,m],R=S===v+1,V={isHole:R,points:N,id:u,parent:0};f.push(V);let M;for(const U of f)if(U.id===h){M=U;break}M?M.isHole?V.parent=R?M.parent:h:V.parent=R?h:M.parent:V.parent=R?h:0;const B=this.#s(l,e,m,v,w,S,0);if(B===-1){l[b]=-u,l[b]!==1&&(h=Math.abs(l[b]));continue}let L=this.#n[2*B],F=this.#n[2*B+1];const C=m+L,I=v+F;w=C,S=I;let k=m,O=v;for(;;){const U=this.#r(l,e,k,O,w,S,1);L=this.#n[2*U],F=this.#n[2*U+1];const H=k+L,j=O+F;N.push(j,H);const _t=k*e+O;if(l[_t+1]===0?l[_t]=-u:l[_t]===1&&(l[_t]=u),H===m&&j===v&&k===C&&O===I){l[b]!==1&&(h=Math.abs(l[b]));break}else w=k,S=O,k=H,O=j}}}return f}static#a(t,e,n,s){if(n-e<=4){for(let C=e;C<n-2;C+=2)s.push(t[C],t[C+1]);return}const o=t[e],l=t[e+1],u=t[n-4]-o,h=t[n-3]-l,f=Math.hypot(u,h),m=u/f,v=h/f,b=m*l-v*o,A=h/u,w=1/f,S=Math.atan(A),N=Math.cos(S),R=Math.sin(S),V=w*(Math.abs(N)+Math.abs(R)),M=w*(1-V+V**2),B=Math.max(Math.atan(Math.abs(R+N)*M),Math.atan(Math.abs(R-N)*M));let L=0,F=e;for(let C=e+2;C<n-2;C+=2){const I=Math.abs(b-m*t[C+1]+v*t[C]);I>L&&(F=C,L=I)}L>(f*B)**2?(this.#a(t,e,F+2,s),this.#a(t,F,n,s)):s.push(o,l)}static#o(t){const e=[],n=t.length;return this.#a(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#u(t,e,n,s,o,l){const u=new Float32Array(l**2),h=-2*s**2,f=l>>1;for(let S=0;S<l;S++){const N=(S-f)**2;for(let R=0;R<l;R++)u[S*l+R]=Math.exp((N+(R-f)**2)/h)}const m=new Float32Array(256),v=-2*o**2;for(let S=0;S<256;S++)m[S]=Math.exp(S**2/v);const b=t.length,A=new Uint8Array(b),w=new Uint32Array(256);for(let S=0;S<n;S++)for(let N=0;N<e;N++){const R=S*e+N,V=t[R];let M=0,B=0;for(let F=0;F<l;F++){const C=S+F-f;if(!(C<0||C>=n))for(let I=0;I<l;I++){const k=N+I-f;if(k<0||k>=e)continue;const O=t[C*e+k],U=u[F*l+I]*m[Math.abs(O-V)];M+=O*U,B+=U}}const L=A[R]=Math.round(M/B);w[L]++}return[A,w]}static#c(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let s=-1/0,o=1/0;for(let u=0,h=n.length;u<h;u++){const f=n[u]=t[u<<2];s=Math.max(s,f),o=Math.min(o,f)}const l=255/(s-o);for(let u=0,h=n.length;u<h;u++)n[u]=(n[u]-o)*l;return n}static#l(t){let e,n=-1/0,s=-1/0;const o=t.findIndex(h=>h!==0);let l=o,u=o;for(e=o;e<256;e++){const h=t[e];h>n&&(e-l>s&&(s=e-l,u=e-1),n=h,l=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#p(t){const e=t,{width:n,height:s}=t,{maxDim:o}=this.#t;let l=n,u=s;if(n>o||s>o){let b=n,A=s,w=Math.log2(Math.max(n,s)/o);const S=Math.floor(w);w=w===S?S-1:S;for(let R=0;R<w;R++){l=Math.ceil(b/2),u=Math.ceil(A/2);const V=new OffscreenCanvas(l,u);V.getContext("2d").drawImage(t,0,0,b,A,0,0,l,u),b=l,A=u,t!==e&&t.close(),t=V.transferToImageBitmap()}const N=Math.min(o/l,o/u);l=Math.round(l*N),u=Math.round(u*N)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const m=f.getImageData(0,0,l,u).data;return[this.#d(m),l,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:s},o,l,u,h){let f=new OffscreenCanvas(1,1),m=f.getContext("2d",{alpha:!1});const v=200,b=m.font=`${n} ${s} ${v}px ${e}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:S,actualBoundingBoxDescent:N,fontBoundingBoxAscent:R,fontBoundingBoxDescent:V,width:M}=m.measureText(t),B=1.5,L=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,M)*B),F=Math.ceil(Math.max(Math.abs(S)+Math.abs(N)||v,Math.abs(R)+Math.abs(V)||v)*B);f=new OffscreenCanvas(L,F),m=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),m.font=b,m.filter="grayscale(1)",m.fillStyle="white",m.fillRect(0,0,L,F),m.fillStyle="black",m.fillText(t,L*(B-1)/2,F*(3-B)/2);const C=this.#d(m.getImageData(0,0,L,F).data),I=this.#c(C),k=this.#l(I),O=this.#i(C,L,F,k);return this.processDrawnLines({lines:{curves:O,width:L,height:F},pageWidth:o,pageHeight:l,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,s,o){const[l,u,h]=this.#p(t),[f,m]=this.#u(l,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),v=this.#l(m),b=this.#i(f,u,h,v);return this.processDrawnLines({lines:{curves:b,width:u,height:h},pageWidth:e,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:l,areContours:u}){s%180!==0&&([e,n]=[n,e]);const{curves:h,width:f,height:m}=t,v=t.thickness??0,b=[],A=Math.min(e/f,n/m),w=A/e,S=A/n,N=[];for(const{points:V}of h){const M=l?this.#o(V):V;if(!M)continue;N.push(M);const B=M.length,L=new Float32Array(B),F=new Float32Array(3*(B===2?2:B-2));if(b.push({line:F,points:L}),B===2){L[0]=M[0]*w,L[1]=M[1]*S,F.set([NaN,NaN,NaN,NaN,L[0],L[1]],0);continue}let[C,I,k,O]=M;C*=w,I*=S,k*=w,O*=S,L.set([C,I,k,O],0),F.set([NaN,NaN,NaN,NaN,C,I],0);for(let U=4;U<B;U+=2){const H=L[U]=M[U]*w,j=L[U+1]=M[U+1]*S;F.set(gt.createBezierPoints(C,I,k,O,H,j),(U-2)*3),[C,I,k,O]=[k,O,H,j]}}if(b.length===0)return null;const R=u?new zy:new yh;return R.build(b,e,n,1,s,u?0:v,o),{outline:R,newCurves:N,areContours:u,thickness:v,width:f,height:m}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:s,height:o}){let l=1/0,u=-1/0,h=0;for(const M of t){h+=M.length;for(let B=2,L=M.length;B<L;B++){const F=M[B]-M[B-2];l=Math.min(l,F),u=Math.max(u,F)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const m=t.length,v=nf+mu*m,b=new Uint32Array(v);let A=0;b[A++]=v*Uint32Array.BYTES_PER_ELEMENT+(h-2*m)*f.BYTES_PER_ELEMENT,b[A++]=0,b[A++]=s,b[A++]=o,b[A++]=e?0:1,b[A++]=Math.max(0,Math.floor(n??0)),b[A++]=m,b[A++]=f.BYTES_PER_ELEMENT;for(const M of t)b[A++]=M.length-2,b[A++]=M[0],b[A++]=M[1];const w=new CompressionStream("deflate-raw"),S=w.writable.getWriter();await S.ready,S.write(b);const N=f.prototype.constructor;for(const M of t){const B=new N(M.length-2);for(let L=2,F=M.length;L<F;L++)B[L-2]=M[L]-M[L-2];S.write(B)}S.close();const R=await new Response(w.readable).arrayBuffer(),V=new Uint8Array(R);return F1(V)}static async decompressSignature(t){try{const e=TO(t),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(e).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const M of n)l||=new Uint8Array(new Uint32Array(M.buffer,0,4)[0]),l.set(M,u),u+=M.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const m=h[2],v=h[3],b=h[4]===0,A=h[5],w=h[6],S=h[7],N=[],R=(nf+mu*w)*Uint32Array.BYTES_PER_ELEMENT;let V;switch(S){case Int8Array.BYTES_PER_ELEMENT:V=new Int8Array(l.buffer,R);break;case Int16Array.BYTES_PER_ELEMENT:V=new Int16Array(l.buffer,R);break;case Int32Array.BYTES_PER_ELEMENT:V=new Int32Array(l.buffer,R);break}u=0;for(let M=0;M<w;M++){const B=h[mu*M+nf],L=new Float32Array(B+2);N.push(L);for(let F=0;F<mu-1;F++)L[F]=h[mu*M+nf+F+1];for(let F=0;F<B;F++)L[F+2]=L[F]+V[u++]}return{areContours:b,thickness:A,outlines:N,width:m,height:v}}catch(e){return jt(`decompressSignature: ${e}`),null}}}class o_ extends fx{constructor(){super(),super.updateProperties({fill:Tt._defaultLineColor,"stroke-width":0})}clone(){const t=new o_;return t.updateAll(this),t}}class l_ extends wp{constructor(t){super(t),super.updateProperties({stroke:Tt._defaultLineColor,"stroke-width":1})}clone(){const t=new l_(this._viewParameters);return t.updateAll(this),t}}class gi extends It{#t=!1;#e=null;#n=null;#s=null;static _type="signature";static _editorType=Ot.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Tt.initialize(t,e),this._defaultDrawingOptions=new o_,this._defaultDrawnSignatureOptions=new l_(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Gt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:s,mustSmooth:o,areContours:l,description:u,uuid:h,heightInPage:f}=this.#n,{rawDims:{pageWidth:m,pageHeight:v},rotation:b}=this.parent.viewport,A=xl.processDrawnLines({lines:s,pageWidth:m,pageHeight:v,rotation:b,innerMargin:gi._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(A,f,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#s=t,this.addEditToolbar()}getUuid(){return this.#s}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:s,height:o}=this.#n,l=Math.max(s,o),u=xl.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:n,width:s,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,s){const{x:o,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof zy,this.description=n;let h;this.#t?h=gi.getDefaultDrawingOptions():(h=gi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[f,m]=this.parentDimensions,[,v]=this.pageDimensions;let b=e/v;b=b>=1?.5:b,this.width*=b/this.height,this.width>=1&&(b*=.9/this.width,this.width=.9),this.height=b,this.setDims(f*this.width,m*this.height),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return xl.process(t,e,n,s,gi._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return xl.extractContoursFromText(t,e,n,s,o,gi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return xl.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:gi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=gi.getDefaultDrawingOptions():(this._drawingOptions=gi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,l={annotationType:Ot.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:o,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(l),t?(l.paths={lines:e,points:n},l.uuid=this.#s,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,n,s,o,l){return l.areContours?zy.deserialize(t,e,n,s,o,l):yh.deserialize(t,e,n,s,o,l)}static async deserialize(t,e,n){const s=await super.deserialize(t,e,n);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#s=t.uuid,s}}class sV extends Tt{#t=null;#e=null;#n=null;#s=null;#r=null;#i="";#a=null;#o=!1;#u=null;#c=!1;#d=!1;static _type="stamp";static _editorType=Ot.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#s=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Tt.initialize(t,e)}static isHandlingMimeForPasting(t){return Ly.includes(t)}static paste(t,e){e.pasteEditor({mode:Ot.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#l(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#i=t.file.name),this.#f()}#p(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await n.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#l(n,!0)).finally(()=>this.#p());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#l(s)).finally(()=>this.#p());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(s=>this.#l(s)).finally(()=>this.#p());return}const t=document.createElement("input");t.type="file",t.accept=Ly.join(",");const e=this._uiManager._signal;this.#n=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#l(s)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#p()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#s||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#f():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,s&&(this.#t=s),this.#o=!1,this.#f())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#u!==null&&clearTimeout(this.#u);const t=200;this.#u=setTimeout(()=>{this.#u=null,this.#m()},t)}#f(){const{div:t}=this;let{width:e,height:n}=this.#t;const[s,o]=this.pageDimensions,l=.75;if(this.width)e=this.width*s,n=this.height*o;else if(e>l*s||n>l*o){const m=Math.min(l*s/e,l*o/n);e*=m,n*=m}const[u,h]=this.parentDimensions;this.setDims(e*u/s,n*h/o),this._uiManager.enableWaiting(!1);const f=this.#a=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/s,this.height=n/o,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:s,height:o}=this.#t,l=new Ti;let u=this.#t,h=s,f=o,m=null;if(e){if(s>e||o>e){const F=Math.min(e/s,e/o);h=Math.floor(s*F),f=Math.floor(o*F)}m=document.createElement("canvas");const b=m.width=Math.ceil(h*l.sx),A=m.height=Math.ceil(f*l.sy);this.#c||(u=this.#h(b,A));const w=m.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",N="#cfcfd8";this._uiManager.hcmFilter!=="none"?N="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",N="#42414d");const R=15,V=R*l.sx,M=R*l.sy,B=new OffscreenCanvas(V*2,M*2),L=B.getContext("2d");L.fillStyle=S,L.fillRect(0,0,V*2,M*2),L.fillStyle=N,L.fillRect(0,0,V,M),L.fillRect(V,M,V,M),w.fillStyle=w.createPattern(B,"repeat"),w.fillRect(0,0,b,A),w.drawImage(u,0,0,u.width,u.height,0,0,b,A)}let v=null;if(n){let b,A;if(l.symmetric&&u.width<t&&u.height<t)b=u.width,A=u.height;else if(u=this.#t,s>t||o>t){const N=Math.min(t/s,t/o);b=Math.floor(s*N),A=Math.floor(o*N),this.#c||(u=this.#h(b,A))}const S=new OffscreenCanvas(b,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,b,A),v={width:b,height:A,data:S.getImageData(0,0,b,A).data}}return{canvas:m,width:h,height:f,imageData:v}}#h(t,e){const{width:n,height:s}=this.#t;let o=n,l=s,u=this.#t;for(;o>2*t||l>2*e;){const h=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const m=new OffscreenCanvas(o,l);m.getContext("2d").drawImage(u,0,0,h,f,0,0,o,l),u=m.transferToImageBitmap()}return u}#m(){const[t,e]=this.parentDimensions,{width:n,height:s}=this,o=new Ti,l=Math.ceil(n*t*o.sx),u=Math.ceil(s*e*o.sy),h=this.#a;if(!h||h.width===l&&h.height===u)return;h.width=l,h.height=u;const f=this.#c?this.#t:this.#h(l,u),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#_(t){if(t){if(this.#c){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,n]=this.pageDimensions,s=Math.round(this.width*e*Gl.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*Gl.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let s=null,o=!1;if(t instanceof hx){const{data:{rect:S,rotation:N,id:R,structParent:V,popupRef:M,contentsObj:B},container:L,parent:{page:{pageNumber:F}},canvas:C}=t;let I,k;C?(delete t.canvas,{id:I,bitmap:k}=n.imageManager.getFromCanvas(L.id,C),C.remove()):(o=!0,t._hasNoCanvas=!0);const O=(await e._structTree.getAriaAttributes(`${Kv}${R}`))?.get("aria-label")||"";s=t={annotationType:Ot.STAMP,bitmapId:I,bitmap:k,pageIndex:F-1,rect:S.slice(0),rotation:N,annotationElementId:R,id:R,deleted:!1,accessibilityData:{decorative:!1,altText:O},isSvg:!1,structParent:V,popupRef:M,comment:B?.str||null}}const l=await super.deserialize(t,e,n),{rect:u,bitmap:h,bitmapUrl:f,bitmapId:m,isSvg:v,accessibilityData:b}=t;o?(n.addMissingCanvas(t.id,l),l.#o=!0):m&&n.imageManager.isValidId(m)?(l.#e=m,h&&(l.#t=h)):l.#s=f,l.#c=v;const[A,w]=l.pageDimensions;return l.width=(u[2]-u[0])/A,l.height=(u[3]-u[1])/w,b&&(l.altTextData=b),l._initialData=s,t.comment&&l.setCommentData(t.comment),l.#d=!!s,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Ot.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=this.#_(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#y(n);if(u.isSame)return null;u.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,e===null)return n;e.stamps||=new Map;const l=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#_(!1);else if(this.#c){const u=e.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#_(!1))}return n}#y(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,s=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}}renderAnnotationElement(t){const e={rect:this.getRect(0,0)};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}class nr{#t;#e=!1;#n=null;#s=null;#r=null;#i=new Map;#a=!1;#o=!1;#u=!1;#c=null;#d=null;#l=null;#p=null;#g=null;#f=-1;#h;static _initialized=!1;static#m=new Map([an,a_,sV,Ve,gi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:h,viewport:f,l10n:m}){const v=[...nr.#m.values()];if(!nr._initialized){nr._initialized=!0;for(const b of v)b.initialize(m,t)}t.registerEditorTypes(v),this.#h=t,this.pageIndex=e,this.div=n,this.#t=o,this.#n=l,this.viewport=f,this.#l=h,this.drawLayer=u,this._structTree=s,this.#h.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===Ot.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#v(),t){case Ot.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ot.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ot.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of nr.#m.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#l?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#i.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#h.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!this.#n){this.#u=!1;return}const e=this.#n.getEditableAnnotations();for(const n of e){if(n.hide(),this.#h.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#u=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#l&&!this.#g){this.#g=new AbortController;const s=this.#h.combinedSignal(this.#g);this.#l.div.addEventListener("pointerdown",o=>{const{clientX:u,clientY:h,timeStamp:f}=o,m=this.#f;if(f-m>500){this.#f=f;return}this.#f=-1;const{classList:v}=this.div;v.toggle("getElements",!0);const b=document.elementsFromPoint(u,h);if(v.toggle("getElements",!1),!this.div.contains(b[0]))return;let A;const w=new RegExp(`^${L1}[0-9]+$`);for(const N of b)if(w.test(N.id)){A=N.id;break}if(!A)return;const S=this.#i.get(A);S?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),S.dblclick())},{signal:s,capture:!0})}const t=new Map,e=new Map;for(const s of this.#i.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const o of s){const{id:l}=o.data;if(this.#h.isDeletedAnnotationElement(l)){o.updateEdited({deleted:!0});continue}let u=e.get(l);if(u){u.resetAnnotationElement(o),u.show(!1),o.show();continue}u=t.get(l),u&&(this.#h.addChangedExistingAnnotation(u),u.renderAnnotationElement(o)&&u.show(!1)),o.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of nr.#m.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#l?.div&&!this.#p){this.#p=new AbortController;const t=this.#h.combinedSignal(this.#p);this.#l.div.addEventListener("pointerdown",this.#_.bind(this),{signal:t}),this.#l.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#l?.div&&this.#p&&(this.#p.abort(),this.#p=null,this.#l.div.classList.remove("highlighting"))}#_(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#l.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#l.div.contains(e)){const{isMac:n}=Sn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#h.showAllEditors("highlight",!0,!0),this.#l.div.classList.add("free"),this.toggleDrawing(),Ve.startHighlighting(this,this.#h.direction==="ltr",{target:this.#l.div,x:t.x,y:t.y}),this.#l.div.addEventListener("pointerup",()=>{this.#l.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;const t=this.#h.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#s?.abort(),this.#s=null}attach(t){this.#i.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#i.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),Tt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#u),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return this.#h.getId()}get#y(){return nr.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#A(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:n,offsetY:s}=this.#E(),o=this.getNextId(),l=this.#A({parent:this,id:o,x:n,y:s,uiManager:this.#h,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await nr.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,n={}){const s=this.getNextId(),o=this.#A({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...n});return o&&this.add(o),o}#E(){const{x:t,y:e,width:n,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+s),f=(o+u)/2-t,m=(l+h)/2-e,[v,b]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:v,offsetY:b}}addNewEditor(t={}){this.createAndAddNewEditor(this.#E(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#h.getMode();if(n===Ot.STAMP||n===Ot.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===Ot.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const n=this.#h.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#h.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#h.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,n){const s=this.#h.findParent(e,n);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#i.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#i.clear(),this.#h.removeLayer(this)}#v(){for(const t of this.#i.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,vo(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#v();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,vo(this.div,{rotation:n}),e!==n)for(const s of this.#i.values())s.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class An{#t=null;#e=new Map;#n=new Map;static#s=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Gt(this,"_svgFactory",new zf)}static#r(t,[e,n,s,o]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*s}%`,l.height=`${100*o}%`}#i(){const t=An._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const n=An._svgFactory.createElement("clipPath");t.append(n);const s=`clip_${e}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=An._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),s}#o(t,e){for(const[n,s]of Object.entries(e))s===null?t.removeAttribute(n):t.setAttribute(n,s)}draw(t,e=!1,n=!1){const s=An.#s++,o=this.#i(),l=An._svgFactory.createElement("defs");o.append(l);const u=An._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${s}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(s,u);const f=n?this.#a(l,h):null,m=An._svgFactory.createElement("use");return o.append(m),m.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#e.set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=An.#s++,s=this.#i(),o=An._svgFactory.createElement("defs");s.append(o);const l=An._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const v=An._svgFactory.createElement("mask");o.append(v),h=`mask_p${this.pageIndex}_${n}`,v.setAttribute("id",h),v.setAttribute("maskUnits","objectBoundingBox");const b=An._svgFactory.createElement("rect");v.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const A=An._svgFactory.createElement("use");v.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=An._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const m=f.cloneNode();return s.append(m),f.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(n,s),n}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:s,rootClass:o,path:l}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(n&&this.#o(u,n),s&&An.#r(u,s),o){const{classList:h}=u;for(const[f,m]of Object.entries(o))h.toggle(f,m)}if(l){const f=u.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Fy};globalThis.pdfjsLib={AbortException:da,AnnotationEditorLayer:nr,AnnotationEditorParamsType:Xt,AnnotationEditorType:Ot,AnnotationEditorUIManager:fa,AnnotationLayer:r_,AnnotationMode:Zr,AnnotationType:We,build:Pj,ColorPicker:Is,createValidAbsoluteUrl:O1,DOMSVGFactory:zf,DrawLayer:An,FeatureTest:Sn,fetchData:fh,getDocument:nx,getFilenameFromUrl:xO,getPdfFilenameFromUrl:CO,getRGB:bp,getUuid:U1,getXfaPageViewport:IO,GlobalWorkerOptions:Ol,ImageKind:gf,InvalidPDFException:My,isDataScheme:_p,isPdfFile:Yv,isValidExplicitDest:FO,MathClamp:Fn,noContextMenu:Ms,normalizeUnicode:wO,OPS:Ff,OutputScale:Ti,PasswordResponses:pO,PDFDataRangeTransport:sx,PDFDateString:Py,PDFWorker:$u,PermissionFlag:fO,PixelsPerInch:Gl,RenderingCancelledException:Wv,ResponseException:Bf,setLayerDimensions:vo,shadow:Gt,SignatureExtractor:xl,stopEvent:Xe,SupportedImageMimeTypes:Ly,TextLayer:Vn,TouchManager:Ap,updateUrlHash:j1,Util:St,VerbosityLevel:gp,version:Mj,XfaLayer:ax};Ol.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.6.82/pdf.worker.min.js";const iV=({url:i,height:t=600})=>{const e=z.useRef(null),[n,s]=z.useState(null),[o,l]=z.useState(1),[u,h]=z.useState(1),[f,m]=z.useState(!0),[v,b]=z.useState(null);return z.useEffect(()=>{let A=!0;return m(!0),b(null),s(null),l(1),nx({url:i,withCredentials:!1}).promise.then(w=>{A&&(s(w),h(w.numPages))}).catch(()=>{A&&b("Gagal memuat PDF")}).finally(()=>A&&m(!1)),()=>{A=!1}},[i]),z.useEffect(()=>{(async()=>{if(!n||!e.current)return;const w=await n.getPage(o),S=w.getViewport({scale:1.5}),N=e.current,R=N.getContext("2d");R&&(N.width=S.width,N.height=S.height,await w.render({canvasContext:R,canvas:N,viewport:S}).promise)})()},[n,o]),f?y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat PDF..."})]}):v?y.jsx("div",{className:"error-message",children:v}):y.jsxs("div",{style:{userSelect:"none"},onContextMenu:A=>A.preventDefault(),children:[y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[y.jsxs("div",{style:{color:"#64748b"},children:["Halaman ",o," dari ",u]}),y.jsxs("div",{style:{display:"flex",gap:8},children:[y.jsx("button",{className:"btn-secondary",onClick:()=>l(A=>Math.max(1,A-1)),disabled:o<=1,children:""}),y.jsx("button",{className:"btn-secondary",onClick:()=>l(A=>Math.min(u,A+1)),disabled:o>=u,children:""})]})]}),y.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,overflow:"hidden",maxHeight:t},children:y.jsx("canvas",{ref:e,style:{width:"100%",height:t}})})]})},rV=()=>{const{moduleId:i,lessonId:t}=$0(),e=Ky(),{user:n,userDoc:s}=yr(),[o,l]=z.useState(!0),[u,h]=z.useState(null),[f,m]=z.useState(null),v=z.useRef(!1);z.useEffect(()=>{(async()=>{if(i){l(!0),h(null);try{const L=await vt.getModuleWithLessons(i);m(L)}catch(L){h(L?.message||"Gagal memuat materi")}finally{l(!1)}}})()},[i]);const b=z.useRef(!1);z.useEffect(()=>{if(!n||!i||!t)return;b.current=!1;const B=window.setTimeout(async()=>{if(!b.current)try{await vt.markLessonRead(n.uid,i,t),b.current=!0}catch{}},1e4);return()=>{window.clearTimeout(B)}},[n,i,t]),z.useEffect(()=>{const B=()=>{v.current||(v.current=!0,e("/belajar",{replace:!0}))},L=()=>{document.visibilityState==="hidden"&&B()},F=()=>{B()};return document.addEventListener("visibilitychange",L),window.addEventListener("blur",F),()=>{document.removeEventListener("visibilitychange",L),window.removeEventListener("blur",F)}},[e]);const A=z.useMemo(()=>{if(!f||!t)return null;const B=f.lessons.findIndex(I=>I.id===t);if(B===-1)return null;const L=f.lessons[B],F=B>0?f.lessons[B-1]:null,C=B<f.lessons.length-1?f.lessons[B+1]:null;return{idx:B,current:L,prev:F,next:C}},[f,t]),w=A?.current?.assets&&A.current.assets[0]||"",S=z.useMemo(()=>{if(!w)return"";const B=w.trim();if(/drive\.google\.com/.test(B)){const L=B.match(/drive\.google\.com\/file\/d\/([^/]+)/);if(L&&L[1])return`https://drive.google.com/file/d/${L[1]}/preview`;const F=B.match(/[?&]id=([^&]+)/);if(F&&F[1])return`https://drive.google.com/file/d/${decodeURIComponent(F[1])}/preview`;const C=B.match(/uc\?id=([^&]+)/);return C&&C[1]?`https://drive.google.com/file/d/${decodeURIComponent(C[1])}/preview`:B.replace("/view","/preview")}return B},[w]);if(o)return y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat materi..."})]})})});if(u||!f||!A)return y.jsx("div",{className:"dashboard-main",children:y.jsxs("div",{className:"container",children:[u?y.jsx("div",{className:"error-message",children:u}):y.jsx("div",{className:"card",children:y.jsx("p",{children:"Materi tidak ditemukan."})}),y.jsx(Ns,{className:"btn-secondary",to:"/belajar",style:{display:"inline-block",marginTop:12},children:"Kembali ke Belajar"})]})});const{current:N,prev:R,next:V}=A,M=s?.role==="teacher";return N.visible===!1&&!M?y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsx("div",{className:"card",style:{maxWidth:720,margin:"0 auto"},children:y.jsxs("div",{className:"card-content",children:[y.jsx("h3",{style:{marginTop:0},children:"Materi Tertutup"}),y.jsx("p",{children:"Materi ini belum ditampilkan untuk siswa. Silakan hubungi guru Anda."}),y.jsx("div",{className:"form-actions",children:y.jsx(Ns,{className:"btn-secondary",to:"/belajar",children:"Kembali ke Belajar"})})]})})})}):y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsxs("div",{className:"card",style:{maxWidth:900,margin:"0 auto"},children:[y.jsx("div",{style:{marginBottom:8},children:y.jsx(Ns,{to:"/belajar",className:"btn-secondary",style:{display:"inline-block"},children:" Kembali ke Bab"})}),y.jsx("h3",{style:{marginBottom:8},children:f?.title||"Bab"}),y.jsx("h1",{style:{marginTop:0},children:N.title}),y.jsx("div",{style:{marginTop:12,lineHeight:1.7,color:"#334155",whiteSpace:"pre-wrap"},children:N.content||"Belum ada konten."}),S?y.jsxs("div",{style:{marginTop:16},onContextMenu:B=>B.preventDefault(),children:[y.jsx("h4",{style:{margin:"12px 0"},children:"Lampiran"}),/drive\.google\.com/.test(S)?y.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,overflow:"hidden"},children:y.jsx("iframe",{src:S,style:{width:"100%",height:600,border:"none"},title:"Lampiran PDF"})}):y.jsx(iV,{url:S,height:600})]}):y.jsx("div",{style:{marginTop:12,color:"#64748b"},children:"Tidak ada lampiran."}),y.jsxs("div",{className:"form-actions",style:{justifyContent:"space-between",marginTop:24},children:[y.jsx("button",{className:"btn-secondary",disabled:!R,onClick:()=>R&&e(`/belajar/m/${f.id}/lesson/${R.id}`),children:" Sebelumnya"}),y.jsx("button",{className:"btn-primary",disabled:!V,onClick:()=>V&&e(`/belajar/m/${f.id}/lesson/${V.id}`),children:"Lanjutkan "})]})]})})})},aV=()=>{const{quizId:i}=$0(),{user:t}=yr(),[e,n]=z.useState(!0),[s,o]=z.useState(null),[l,u]=z.useState(null),[h,f]=z.useState([]),[m,v]=z.useState({}),[b,A]=z.useState(!1),w=z.useRef(!1),[S,N]=z.useState(!1),[R,V]=z.useState(0);z.useEffect(()=>{(async()=>{if(i){n(!0),o(null);try{const k=(await vt.getQuizzes()).find(O=>O.id===i)||null;if(u(k),k){const O=await vt.getQuestions(k.id);if(f(O),t){(await vt.getAnswersByUser(t.uid,k.id)).length>0&&N(!0);const H=await vt.getRetakeGrant(t.uid,k.id);V(H?.allowed??0)}}}catch(I){o(I?.message||"Gagal memuat kuis")}finally{n(!1)}}})()},[i,t]);const M=z.useMemo(()=>h.length>0,[h]),B=z.useCallback(()=>h.map(C=>{let I=-1;C.type==="multiple_choice"||C.type==="dropdown"?I=typeof m[C.id]=="number"?m[C.id]:-1:C.type==="checkboxes"?I=(Array.isArray(m[C.id])?m[C.id]:[]).length?-2:-1:I=-1;const k=typeof C.correctIndex=="number"&&I===C.correctIndex;return{questionId:C.id,selectedIndex:I,isCorrect:k}}),[h,m]),L=z.useCallback(async()=>{if(!(!t||!l)&&!w.current){w.current=!0;try{A(!0);try{(await vt.getAnswersByUser(t.uid,l.id)).length>0&&await vt.consumeRetake(t.uid,l.id)}catch{}const C=B();await vt.replaceAnswers(t.uid,l.id,C),alert("Kuis selesai. Jawaban telah disimpan."),window.location.hash="#/dashboard"}catch(C){console.error(C),alert("Gagal menyimpan jawaban.")}finally{A(!1)}}},[t,l,B]);if(z.useEffect(()=>{const C=()=>{document.visibilityState==="hidden"&&L()},I=()=>{L()},k=()=>{L()};return document.addEventListener("visibilitychange",C),window.addEventListener("blur",I),window.addEventListener("pagehide",k),()=>{document.removeEventListener("visibilitychange",C),window.removeEventListener("blur",I),window.removeEventListener("pagehide",k)}},[L]),!t)return null;if(e)return y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsxs("div",{className:"loading-state",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Memuat kuis..."})]})})});if(s||!l)return y.jsx("div",{className:"dashboard-main",children:y.jsxs("div",{className:"container",children:[s?y.jsx("div",{className:"error-message",children:s}):y.jsx("div",{className:"card",children:y.jsx("p",{children:"Kuis tidak ditemukan."})}),y.jsx(Ns,{className:"btn-secondary",to:"/belajar",style:{display:"inline-block",marginTop:12},children:"Kembali ke Belajar"})]})});if(S&&R<=0)return y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsx("div",{className:"card",style:{maxWidth:720,margin:"0 auto"},children:y.jsxs("div",{className:"card-content",children:[y.jsx("h3",{style:{marginTop:0},children:"Kuis Sudah Diselesaikan"}),y.jsx("p",{children:"Anda telah menyelesaikan kuis ini. Silakan kembali ke halaman Belajar atau Dashboard."}),y.jsxs("div",{className:"form-actions",children:[y.jsx(Ns,{className:"btn-secondary",to:"/belajar",children:"Kembali ke Belajar"}),y.jsx(Ns,{className:"btn-primary",to:"/dashboard",children:"Ke Dashboard"})]})]})})})});const F=S&&R>0;return y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsxs("div",{className:"card",style:{maxWidth:900,margin:"0 auto"},children:[y.jsx("div",{style:{marginBottom:8},children:y.jsx(Ns,{to:"/belajar",className:"btn-secondary",style:{display:"inline-block"},children:" Kembali ke Belajar"})}),y.jsx("h1",{style:{marginTop:0},children:l.title}),l.timeLimitSec&&y.jsxs("p",{style:{color:"#64748b"},children:["Batas waktu: ",Math.round(l.timeLimitSec/60)," menit"]}),F&&y.jsx("div",{className:"card",style:{background:"#f8fafc",border:"1px dashed #94a3b8",padding:12,marginBottom:12},children:y.jsxs("p",{style:{margin:0},children:["Guru telah memberikan akses ulang untuk kuis ini. Sisa kesempatan: ",y.jsx("strong",{children:R}),"."]})}),h.length===0?y.jsx("div",{className:"empty-state",children:"Belum ada pertanyaan."}):y.jsxs("form",{className:"form-grid",onSubmit:C=>{C.preventDefault(),L()},children:[h.map((C,I)=>y.jsx("div",{className:"content-card",children:y.jsxs("div",{className:"card-content",children:[y.jsxs("h4",{style:{marginTop:0},children:["Pertanyaan ",I+1]}),y.jsx("p",{style:{whiteSpace:"pre-wrap"},children:C.text}),C.type==="multiple_choice"&&C.options&&y.jsx("div",{className:"quiz-options",children:C.options.map((k,O)=>y.jsxs("label",{style:{display:"block",marginBottom:6},children:[y.jsx("input",{type:"radio",name:`q_${C.id}`,value:O,onChange:()=>v(U=>({...U,[C.id]:O})),checked:m[C.id]===O})," ",k]},O))}),C.type==="checkboxes"&&C.options&&y.jsx("div",{className:"quiz-options",children:C.options.map((k,O)=>y.jsxs("label",{style:{display:"block",marginBottom:6},children:[y.jsx("input",{type:"checkbox",value:O,onChange:U=>{v(H=>{const j=Array.isArray(H[C.id])?H[C.id]:[],_t=new Set(j);return U.target.checked?_t.add(O):_t.delete(O),{...H,[C.id]:Array.from(_t).sort()}})},checked:Array.isArray(m[C.id])&&m[C.id].includes(O)})," ",k]},O))}),C.type==="dropdown"&&C.options&&y.jsxs("select",{value:m[C.id]??"",onChange:k=>v(O=>({...O,[C.id]:Number(k.target.value)})),children:[y.jsx("option",{value:"",disabled:!0,children:"Pilih jawaban"}),C.options.map((k,O)=>y.jsx("option",{value:O,children:k},O))]}),C.type==="short_answer"&&y.jsx("input",{type:"text",className:"input",placeholder:"Jawaban singkat",value:m[C.id]??"",onChange:k=>v(O=>({...O,[C.id]:k.target.value}))}),C.type==="paragraph"&&y.jsx("textarea",{className:"input",placeholder:"Jawaban panjang",rows:4,value:m[C.id]??"",onChange:k=>v(O=>({...O,[C.id]:k.target.value}))})]})},C.id)),y.jsx("div",{className:"form-actions",style:{justifyContent:"flex-end"},children:y.jsx("button",{type:"submit",className:"btn-primary",disabled:!M||b,children:b?"Menyimpan...":"Kumpulkan"})})]})]})})})};function gu({children:i}){const{isAuthenticated:t,loading:e,userDoc:n}=yr();return e?y.jsxs("div",{className:"app-loading",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Loading..."})]}):t?n?.role==="student"&&(n?.status??"approved")!=="approved"?y.jsx("div",{className:"dashboard-main",children:y.jsx("div",{className:"container",children:y.jsx("div",{className:"card",style:{maxWidth:720,margin:"0 auto"},children:y.jsxs("div",{className:"card-content",children:[y.jsx("h3",{style:{marginTop:0},children:"Menunggu Persetujuan Guru"}),y.jsx("p",{children:"Akun Anda telah terdaftar sebagai siswa, namun akses belajar masih menunggu persetujuan dari guru."}),y.jsx("p",{children:"Silakan tunggu. Setelah disetujui, Anda dapat mulai belajar."}),y.jsx("div",{className:"form-actions",style:{justifyContent:"flex-end"},children:y.jsx("button",{className:"btn-secondary",onClick:()=>window.location.reload(),children:"Cek Lagi"})})]})})})}):!n||n?.status==="rejected"?y.jsx(Cl,{to:"/?msg=rejected",replace:!0}):i:y.jsx(Cl,{to:"/auth",replace:!0})}function oV(){const{isAuthenticated:i,loading:t,userDoc:e}=yr();return t?y.jsxs("div",{className:"app-loading",children:[y.jsx("div",{className:"loading-spinner"}),y.jsx("p",{children:"Loading..."})]}):y.jsx(lI,{children:y.jsxs(UR,{children:[y.jsx(Ji,{path:"/",element:i&&(!e||e.status==="rejected")?y.jsx(g0,{onLoginClick:()=>{window.location.hash="#/auth"}}):i?y.jsx(Cl,{to:"/dashboard",replace:!0}):y.jsx(g0,{onLoginClick:()=>{window.location.hash="#/auth"}})}),y.jsx(Ji,{path:"/auth",element:i?!e||e.status==="rejected"?y.jsx(Cl,{to:"/?msg=rejected",replace:!0}):y.jsx(Cl,{to:"/dashboard",replace:!0}):y.jsx(tO,{})}),y.jsx(Ji,{path:"/dashboard",element:y.jsx(gu,{children:y.jsx(uO,{})})}),y.jsx(Ji,{path:"/belajar",element:y.jsx(gu,{children:y.jsx(hO,{})})}),y.jsx(Ji,{path:"/belajar/m/:moduleId/lesson/:lessonId",element:y.jsx(gu,{children:y.jsx(rV,{})})}),y.jsx(Ji,{path:"/kuis",element:y.jsx(gu,{children:y.jsx(dO,{})})}),y.jsx(Ji,{path:"/kuis/:quizId",element:y.jsx(gu,{children:y.jsx(aV,{})})}),y.jsx(Ji,{path:"*",element:y.jsx(Cl,{to:"/",replace:!0})})]})})}YC.createRoot(document.getElementById("root")).render(y.jsx(z.StrictMode,{children:y.jsx(oV,{})}));
